{"version":3,"file":"1436.bundle.a03dcb587616b6ce81cf.js","mappings":";sGAMA,MAAMA,EAMJ,WAAAC,CAAYC,GACVC,KAAKC,SAAWF,CAClB,CASA,YAAAG,GAEE,MAAMC,EAAaH,KAAKC,SAASG,UAAU,EAAG,IACxCC,EAAaL,KAAKC,SAASG,UAAU,GAAI,IAEzCE,EAAOC,SAASJ,EAAWC,UAAU,EAAG,GAAI,IAC5CI,EAAKL,EAAWM,QAAU,EAAIF,SAASJ,EAAWC,UAAU,EAAG,GAAI,SAAMM,EACzEC,EAAKR,EAAWM,QAAU,GAAKF,SAASJ,EAAWC,UAAU,EAAG,IAAK,SAAMM,EAEjF,GAAIE,MAAMN,SAAgBI,IAAPF,GAAoBI,MAAMJ,SAAcE,IAAPC,GAAoBC,MAAMD,IAAOL,EAAO,KAAQE,IAAOA,EAAK,GAAKA,EAAK,KAAOG,IAAOA,EAAK,GAAKA,EAAK,IACrJ,MAAM,IAAIE,MAAM,iBAAiBV,MAGnC,MAAMW,EAAS,IAAIC,KAAK,GAAGZ,sBAErBa,EAAKT,SAASF,EAAWD,UAAU,EAAG,GAAI,IAC1Ca,EAAKZ,EAAWI,QAAU,EAAIF,SAASF,EAAWD,UAAU,EAAG,GAAI,SAAMM,EACzEQ,EAAKb,EAAWI,QAAU,EAAIF,SAASF,EAAWD,UAAU,EAAG,GAAI,SAAMM,EACzES,EAAgBd,EAAWD,UAAU,EAAG,IACxCgB,EAASD,EAAgBZ,SAASY,EAAe,IAAME,KAAKC,IAAI,IAAKH,EAAcV,aAAUC,EAEnG,GAAIE,MAAMI,SAAcN,IAAPO,GAAoBL,MAAMK,SAAcP,IAAPQ,GAAoBN,MAAMM,SAAkBR,IAAXU,GAAwBR,MAAMQ,IAAWJ,EAAK,GAAKA,EAAK,IAAMC,IAAOA,EAAK,GAAKA,EAAK,KAAOC,IAAOA,EAAK,GAAKA,EAAK,KAAOE,IAAWA,EAAS,GAAKA,EAAS,QAC3O,MAAM,IAAIP,MAAM,iBAAiBR,MAGnC,IAAIkB,EAAYT,EAAOU,UAAY,IAenC,OAdAD,GAAkB,KAALP,OAEFN,IAAPO,IACFM,GAAkB,GAALN,QAGJP,IAAPQ,IACFK,GAAaL,QAGAR,IAAXU,IACFG,GAAaH,GAGRG,CACT,CASA,iBAAAE,GAEE,OAD6C,IAAtBzB,KAAKE,cAE9B,EAYF,SAASwB,EAAgB3B,EAAM4B,GAC7B,MAAMC,EAAQ,GAAGD,EAAKC,OAAS,OAAOC,SAAS,EAAG,KAC5CC,EAAU,GAAGH,EAAKG,SAAW,OAAOD,SAAS,EAAG,KAChDE,EAAU,GAAGJ,EAAKI,SAAW,OAAOF,SAAS,EAAG,KAChDG,EAAQ,GAAGjC,EAAKiC,QAAQH,SAAS,EAAG,KACpCI,EAAM,GAAGlC,EAAKkC,MAAMJ,SAAS,EAAG,KAChCK,EAAoB,GAAGP,EAAKO,mBAAqB,WAAWC,OAAO,EAAG,KACtEhC,EAAa,GAAGJ,EAAKqC,QAAQJ,KAASC,IAG5C,OAAO,IAAIpC,EADY,GAAGM,IADP,IAAIyB,KAASE,KAAWC,KAAWG,OAGxD,CAoDA,SAASG,EAAQtC,GACf,GAAIA,SAAuD,IAAhBA,EAAKU,QAAgC,iBAATV,EACrE,MAAM,IAAIc,MAAM,eAAed,MAGjC,MAAMO,EAAOC,SAASR,EAAKK,UAAU,EAAG,GAAI,IACtCI,EAAKD,SAASR,EAAKK,UAAU,EAAG,GAAI,IACpCO,EAAKJ,SAASR,EAAKK,UAAU,EAAG,GAAI,IAE1C,IAAkC,IAzBfkC,EAyBH3B,EAzBM4B,EAyBF/B,EAzBKgC,EAyBDlC,GAvBpBM,MAAM4B,IAIHD,EAAI,GAAKA,GAAK,IAAMD,EAAI,GAAKA,GAhCtC,SAAqBC,EAAGC,GAEtB,OAAQD,GACN,KAAK,EACH,OAAOC,EAAI,GAAM,GAAKA,EAAI,KAAOA,EAAI,KAAQ,EAAI,GAAK,GAExD,KAAK,EACL,KAAK,EACL,KAAK,EACL,KAAK,GACH,OAAO,GAET,QACE,OAAO,GAEb,CAiB2CC,CAAYF,EAAGC,IAoBtD,MAAM,IAAI3B,MAAM,eAAed,MA1BnC,IAAqBuC,EAAGC,EAAGC,EA6BzB,MAAO,CACLJ,KAAM9B,EACN0B,MAAOxB,EACPyB,IAAKtB,EAET,CAOA,SAAS+B,EAAQf,GACf,GAAIA,SAAuCA,EAAKlB,OAAS,GAAqB,iBAATkB,EAEnE,MAAM,IAAId,MAAM,eAAec,MAKjC,MAAMgB,EAAKpC,SAASoB,EAAKvB,UAAU,EAAG,GAAI,IACpCI,EAAKmB,EAAKlB,QAAU,EAAIF,SAASoB,EAAKvB,UAAU,EAAG,GAAI,SAAMM,EAC7DkC,EAAKjB,EAAKlB,QAAU,EAAIF,SAASoB,EAAKvB,UAAU,EAAG,GAAI,SAAMM,EAC7DS,EAAgBQ,EAAKlB,QAAU,EAAIkB,EAAKvB,UAAU,EAAG,SAAMM,EAC3DmC,EAAS1B,EAAgBZ,SAASY,EAAe,IAAME,KAAKC,IAAI,GAAI,EAAIH,EAAcV,aAAUC,EAEtG,GAAIE,MAAM+B,SAAcjC,IAAPF,GAAoBI,MAAMJ,SAAcE,IAAPkC,GAAoBhC,MAAMgC,SAAkBlC,IAAXmC,GAAwBjC,MAAMiC,IAAWF,EAAK,GAAKA,EAAK,IAAMnC,IAAOA,EAAK,GAAKA,EAAK,KAAOoC,IAAOA,EAAK,GAAKA,EAAK,KAAOC,IAAWA,EAAS,GAAKA,EAAS,QAC3O,MAAM,IAAIhC,MAAM,eAAec,MAGjC,MAAO,CACLC,MAAOe,EACPb,QAAStB,EACTuB,QAASa,EACTV,kBAAmBW,EAEvB,CAUA,SAASC,EAA4BC,GACnC,GAAIA,QACF,MAAM,IAAIlC,MAAM,uDAKlB,OAAOa,EAFMW,EAAQU,EAAS3C,UAAU,EAAG,IAC9BsC,EAAQK,EAAS3C,UAAU,IAE1C,CA+NA,SAAS4C,EAAyBC,GAChC,MAAM,sBACJC,EAAqB,qBACrBC,EAAoB,iCACpBC,EAAgC,6BAChCC,EAA4B,WAC5BC,GACEL,EAAU,GAEd,GAAIC,QACF,MAAM,IAAIrC,MAAM,qEAGlB,GAAIsC,QACF,MAAM,IAAItC,MAAM,oEAGlB,MAAM0C,EAtOR,SAA4BN,GAC1B,MAAM,WACJK,EAAU,WACVE,EAAU,+BACVC,GACER,EAAU,GACRS,EAAU,IAAIC,MAAMV,EAAUxC,QAG9BmD,EAAiBlC,EAFJW,EAAQiB,GACRZ,EAAQc,IAE3B,IAAIK,EAA8B,IAAIhE,EAAkB,+BACpDiE,EAAYD,EAA4B3D,eAiB5C,GAhBA+C,EAAUc,SAAQC,IAChB,MAAM,gBACJC,EAAe,gBACfC,GACEF,EAGEG,EAAsBzC,EAFJW,EAAQ4B,GACRvB,EAAQwB,IAI9BL,EADEA,EAA4B3D,gBAAkB4D,GAGlBK,EAAoBjE,eAAiB2D,EAA4B3D,eAFjEiE,EAEwGN,CACxI,IAGEA,EAA4B3D,gBAAkB4D,EAChD,MAAM,IAAIjD,MAAM,0DAGlB,OAAI+C,EAAe1D,gBAAkB2D,EAA4B3D,eACxDwD,EAAQU,KAAKR,GAEhBH,EAEKC,EAAQU,KAAKtB,EAA4BW,IAazCC,EAAQU,KAAKP,EA6D1B,CAuHoBQ,CAAmBpB,GAC/BqB,EAjDR,SAA4BC,GAC1B,MAAM,iCACJnB,EAAgC,6BAChCC,EAA4B,WAC5BC,GACEiB,EACJ,IAAI5C,EACA5B,EAEJ,GAAIqD,EACF,OAAON,EAA4BM,GAC9B,GAAIC,GAAgCC,EAMzC,OAFA3B,EAAOe,EAAQW,GACftD,EAAOsC,EAAQiB,GACR5B,EAAgB3B,EAAM4B,GAG/B,MAAM,IAAId,MAAM,kBAAkB0D,IACpC,CA4BoBC,CAAmB,CACnCpB,mCACAC,+BACAC,eAEF,OAAOL,EAAUwB,KAAI,CAACC,EAAGC,KACvB,MACMC,EADWrB,EAAUoB,GACKzE,eAAiBoE,EAAUpE,eAE3D,GAAI0E,EAAiB,EACnB,MAAM,IAAI/D,MAAM,uCAIlB,OAAO,GADaqC,EAAwB7B,KAAKC,IAAI,GAAIsD,EAAiBzB,GACpD,GAE1B,CASA,MAAM0B,EAAa,CAACC,EAAGC,IACdD,IAAMC,GAAKpB,MAAMqB,QAAQF,IAAMnB,MAAMqB,QAAQD,IAAMD,EAAErE,SAAWsE,EAAEtE,QAAUqE,EAAEG,OAAM,CAACC,EAAKP,IAAUO,IAAQH,EAAEJ,KAcvH,SAASQ,EAA2BlC,GAClC,MAAM,eACJmC,EAAc,MACdC,EAAK,uBACLC,EAAsB,cACtBC,EAAa,WACbC,EAAU,YACVC,GACExC,EAAU,GAEd,IAAKmC,EAAeM,SAAS,UAAYN,EAAeM,SAAS,QAC/D,MAAM,IAAI7E,MAAM,kDAAkDuE,KAUpE,IAJuBnC,EAAUgC,OAAMjB,GAC9BA,EAASqB,QAAUA,GAASR,EAAWb,EAASoB,eAAgBA,IAAmBpB,EAASuB,gBAAkBA,GAAiBvB,EAASwB,aAAeA,GAAcxB,EAASyB,cAAgBA,GAAezB,EAASb,uBAAyBF,EAAU,GAAGE,sBAAwBa,EAASd,wBAA0BD,EAAU,GAAGC,uBAAyBc,EAAS2B,kBAAoB1C,EAAU,GAAG0C,iBAAmB3B,EAASV,aAAeL,EAAU,GAAGK,YAAcU,EAASR,aAAeP,EAAU,GAAGO,aAIzf,MAAM,IAAI3C,MAAM,gJAIlB,IAAK0E,EACH,MAAM,IAAI1E,MAAM,mFAGlB,IAAI+E,EAAuB,IAAIjC,MAAMV,EAAUxC,QAC/CmF,EAAuB5C,EAAyBC,GAChD,IAAIS,EAAU,IAAIC,MAAMV,EAAUxC,QAClC,MAAMoF,EAAgC,IAAhBN,EAEtB,GAAc,SAAVF,EACF3B,EAAUkC,EAAqBnB,KAAI,SAAUqB,GAC3C,OAAOA,EAAQD,CACjB,SACK,GAAc,SAAVR,EAAkB,CAC3B,MAAMU,EAAyB9C,EAAUgC,OAAMjB,IAC7C,IAAIgC,EAAuBC,EAAwBC,EAEnD,OAAOlC,EAASsB,wBAAuL,QAA9F,QAA7DU,EAAwBhC,EAASsB,8BAA8D,IAA1BU,OAAmC,EAASA,EAAsBG,sBAA4LzF,KAAhG,QAA9DuF,EAAyBjC,EAASsB,8BAA+D,IAA3BW,OAAoC,EAASA,EAAuBE,iBAAiM,KAAhG,QAA9DD,EAAyBlC,EAASsB,8BAA+D,IAA3BY,OAAoC,EAASA,EAAuBC,eAAqB,IAEzhBC,EAA2CnD,EAAUgC,OAAMjB,IAC/D,IAAIqC,EAAwBC,EAAwBC,EAEpD,OAAOvC,EAASsB,0BAA2F,QAA9De,EAAyBrC,EAASsB,8BAA+D,IAA3Be,GAAqCA,EAAuBF,sBAAqMzF,KAAlH,QAA9D4F,EAAyBtC,EAASsB,8BAA+D,IAA3BgB,OAAoC,EAASA,EAAuBE,mCAAqO,KAAlH,QAA9DD,EAAyBvC,EAASsB,8BAA+D,IAA3BiB,OAAoC,EAASA,EAAuBC,iCAAuC,IAItjB,GAAIT,EACFrC,EAAUT,EAAUwB,KAEpBT,GAAYA,EAASsB,uBAAuBa,qBACvC,KAAIC,EAST,MAAM,IAAIvF,MAAM,qEAAqE4F,KAAKC,UAAUpB,MANpG5B,EAAUT,EAAUwB,KAAI,CAACT,EAAUW,IAG1BX,EAASsB,uBAAuBkB,iCAAmCZ,EAAqBjB,GAASkB,GAI5G,CACF,KAAO,IAAc,QAAVR,EAIT,MAAM,IAAIxE,MAAM,+BAA+BwE,KAF/C3B,EAAQU,KAAK,EAGf,CAGA,IAAIuC,EAaAC,EACAC,EAZJ,GAAIpB,QACFqB,QAAQC,KAAK,yFACR,CAKLJ,EAlMJ,SAAsCK,GACpC,MAAM,cACJzB,EAAa,YACbE,GACEuB,EAEJ,OADU3F,KAAKC,IAAIiE,EAAe,MAASlE,KAAKC,IAAkB,IAAdmE,EAAmB,MAAS,KAElF,CA2LmBwB,CAJG,CAChB1B,gBACAE,eAGJ,CAMA,GAAIA,QACFqB,QAAQC,KAAK,0FACR,GAAIvB,QACTsB,QAAQC,KAAK,wFACR,CACL,MAAMG,EAAe,CACnB3B,gBACAC,aACAC,eAEFmB,EAnQJ,SAAsCI,GACpC,MAAM,WACJxB,EAAU,cACVD,EAAa,YACbE,GACEuB,EACJ,IAAIG,EACJ,MAAMC,EAAmB/F,KAAKC,IAAIiE,GAA+B,IAAdE,GAAoB,GAEvE,GAAmB,MAAfD,EACF2B,EAAM,KAAO5B,EAAgB,IAAM6B,MAC9B,IAAmB,MAAf5B,EAGT,MAAM,IAAI3E,MAAM,mCAAmC2E,KAFnD2B,EAAM,IAAM5B,EAAgB,IAAM6B,CAGpC,CAEA,OAAa,IAAND,CACT,CAiPmBE,CAA6BH,GAC5CL,EAxOJ,SAAmDG,GACjD,MAAM,WACJxB,EAAU,cACVD,EAAa,YACbE,GACEuB,EACJ,IAAIG,EACJ,MAAMG,EAAgB/B,EAAgBlE,KAAKC,IAAImE,EAAa,GAE5D,GAAmB,MAAfD,EACF2B,EAAM,KAAO5B,GAAiB,KAAO,IAAM+B,OACtC,IAAmB,MAAf9B,EAGT,MAAM,IAAI3E,MAAM,mCAAmC2E,KAFnD2B,EAAM,KAAO5B,GAAiB,KAAO,IAAM+B,EAG7C,CAEA,OAAa,IAANH,CACT,CAsNwBI,CAA0CL,EAChE,CAEA,OAAOxD,EAAQe,KAAI,SAAU+C,EAAQ7C,GACnC,MAAM8C,EAAU,CACdC,MAAOF,GAmBT,OAhBIb,IAEFc,EAAQE,OAAS/B,EAAqBjB,GAASgC,GAG7CC,IAEFa,EAAQG,OAAShC,EAAqBjB,GAASiC,GAG7CC,IACFY,EAAQI,YAAcjC,EAAqBjB,GAASkC,GAK/CY,CACT,GACF,iDCnnBA,MAiQA,EAjQ8B,CAC1B,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAA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","sources":["webpack:///../../../node_modules/@cornerstonejs/calculate-suv/dist/calculate-suv.esm.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/constants/COLOR_LUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/MouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/elementCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/ImageMouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/SVGCursorDescriptor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/SVGMouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/setCursorForElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/getSvgDrawingHelper.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/draw.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/setAttributesIfNecessary.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/setNewAttributesIfValid.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawCircle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawEllipseByCoordinates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawEllipse.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHandle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHandles.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHeight.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawPolyline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawPath.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawTextBox.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLink.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLinkedTextBox.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRectByCoordinates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRect.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawArrow.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRedactionRect.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/ChangeTypes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/Events.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/StrategyCallbacks.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/ToolModes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/Touch.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/AnnotationStyleStates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/WorkerTypes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/contourSegmentation/contourSegmentationCompleted.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/mouse/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/touch/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/wheel/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/labelmap/onLabelmapSegmentationDataModified.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationDataModifiedEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationModifiedEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/imageChangeEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationCompletedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationSelectionListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationModifiedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationRemovedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/contourSegmentation/contourSegmentationRemoved.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/imageRenderedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/keyboardToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/cameraModifiedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/imageSpacingCalibratedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/annotationInterpolationEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/cameraResetEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/addEnabledElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getSynchronizersForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/removeEnabledElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/cancelActiveManipulations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/Synchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/createSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/destroy.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getAllSynchronizers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/destroySynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationRepresentationModifiedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/init.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/cameraSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createCameraPositionSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/presentationViewSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createPresentationViewSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/voiSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createVOISynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/zoomPanSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createZoomPanSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/imageSliceSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/areViewportsCoplanar.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createImageSliceSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/slabThicknessSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createSlabThicknessSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/PanTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/TrackballRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/WindowLevelTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/WindowLevelRegionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/StackScrollTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/PlanarRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ZoomTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/MIPJumpToClickTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/CrosshairsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/MagnifyTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/AdvancedMagnifyTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ReferenceLinesTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/OverlayGridTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/SegmentationIntersectionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ReferenceCursors.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ScaleOverlayTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/SculptorTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/VolumeRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LengthTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/HeightTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ProbeTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/DragProbeTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/EllipticalROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/CircleROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ETDRSGridTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/SplineROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/SplineContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LivewireContourTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LivewireContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ArrowAnnotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/AngleTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/CobbAngleTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/UltrasoundDirectionalTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/KeyImageTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/AnnotationEraserTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/CircleScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/SphereScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/CircleROIStartEndThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/PaintFillTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/OrientationMarkerTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/SegmentSelectTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/VideoRedactionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/AnnotationRenderingEngine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/FrameOfReferenceSpecificAnnotationManager.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationLocking.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationSelection.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/ToolStyle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/helpers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/getState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/getFont.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/getAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/helpers/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/AnnotationGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationRenderingEngine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationStateManager.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationStyle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/activeSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/setActiveSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addColorLUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/internalAddSegmentationRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addSegmentationRepresentationsToViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/normalizeSegmentationInput.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/segmentationColor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/events/triggerSegmentationDataModified.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getActiveSegmentIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getActiveSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getCurrentLabelmapImageIdForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentationRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentationRepresentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getViewportIdsWithSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getViewportSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/computeVolumeLabelmapFromStack.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/updateSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/segmentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/setSegmentationRepresentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/styleHelpers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/clearSegmentValue.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegment.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getLabelmapImageIds.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Contour/computeAndAddContourRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Labelmap/computeAndAddLabelmapRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/computeAndAddSurfaceRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/updateSurfaceData.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/createAndCacheSurfacesFromRaw.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/convertContourToSurface.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/convertLabelmapToSurface.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/surfaceComputationStrategies.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/canComputeRequestedRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/computeAndAddRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegmentationRepresentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentLocking.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeColorLUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getStackSegmentationImageIdsForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentationState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/updateLabelmapSegmentationImageReferences.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroupForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/ToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/createToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/destroyToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/destroy.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getAllToolGroups.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroupsWithToolName.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/addTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/svgNodeCache.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/BidirectionalTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/PlanarFreehandContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/PlanarFreehandROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/RectangleROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/base/AnnotationDisplayTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/base/BaseTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Contour/contourDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Labelmap/labelmapDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Surface/surfaceDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/BrushTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleROIStartEndThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleROIThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/types/ContourAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getViewportsForAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/vec2/findClosestPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getUniqueSegmentIndices.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/invalidateBrushCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/utilities.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/triggerAnnotationRenderForViewportIds.js","webpack:///../../../node_modules/@icons/material/CheckIcon.js","webpack:///../../../node_modules/@icons/material/UnfoldMoreHorizontalIcon.js","webpack:///../../../node_modules/dicomweb-client/build/dicomweb-client.es.js","webpack:///../../../node_modules/lodash.get/index.js","webpack:///../../../node_modules/lodash/_DataView.js","webpack:///../../../node_modules/lodash/_Hash.js","webpack:///../../../node_modules/lodash/_ListCache.js","webpack:///../../../node_modules/lodash/_Map.js","webpack:///../../../node_modules/lodash/_MapCache.js","webpack:///../../../node_modules/lodash/_Promise.js","webpack:///../../../node_modules/lodash/_Set.js","webpack:///../../../node_modules/lodash/_SetCache.js","webpack:///../../../node_modules/lodash/_Stack.js","webpack:///../../../node_modules/lodash/_Uint8Array.js","webpack:///../../../node_modules/lodash/_WeakMap.js","webpack:///../../../node_modules/lodash/_arrayEach.js","webpack:///../../../node_modules/lodash/_arrayFilter.js","webpack:///../../../node_modules/lodash/_arrayLikeKeys.js","webpack:///../../../node_modules/lodash/_arrayMap.js","webpack:///../../../node_modules/lodash/_arrayPush.js","webpack:///../../../node_modules/lodash/_arraySome.js","webpack:///../../../node_modules/lodash/_assignValue.js","webpack:///../../../node_modules/lodash/_assocIndexOf.js","webpack:///../../../node_modules/lodash/_baseAssign.js","webpack:///../../../node_modules/lodash/_baseAssignIn.js","webpack:///../../../node_modules/lodash/_baseAssignValue.js","webpack:///../../../node_modules/lodash/_baseClone.js","webpack:///../../../node_modules/lodash/_baseCreate.js","webpack:///../../../node_modules/lodash/_baseEach.js","webpack:///../../../node_modules/lodash/_baseFor.js","webpack:///../../../node_modules/lodash/_baseForOwn.js","webpack:///../../../node_modules/lodash/_baseGet.js","webpack:///../../../node_modules/lodash/_baseGetAllKeys.js","webpack:///../../../node_modules/lodash/_baseHasIn.js","webpack:///../../../node_modules/lodash/_baseIsArguments.js","webpack:///../../../node_modules/lodash/_baseIsEqual.js","webpack:///../../../node_modules/lodash/_baseIsEqualDeep.js","webpack:///../../../node_modules/lodash/_baseIsMap.js","webpack:///../../../node_modules/lodash/_baseIsMatch.js","webpack:///../../../node_modules/lodash/_baseIsNative.js","webpack:///../../../node_modules/lodash/_baseIsSet.js","webpack:///../../../node_modules/lodash/_baseIsTypedArray.js","webpack:///../../../node_modules/lodash/_baseIteratee.js","webpack:///../../../node_modules/lodash/_baseKeys.js","webpack:///../../../node_modules/lodash/_baseKeysIn.js","webpack:///../../../node_modules/lodash/_baseMap.js","webpack:///../../../node_modules/lodash/_baseMatches.js","webpack:///../../../node_modules/lodash/_baseMatchesProperty.js","webpack:///../../../node_modules/lodash/_baseProperty.js","webpack:///../../../node_modules/lodash/_basePropertyDeep.js","webpack:///../../../node_modules/lodash/_baseTimes.js","webpack:///../../../node_modules/lodash/_baseToString.js","webpack:///../../../node_modules/lodash/_baseUnary.js","webpack:///../../../node_modules/lodash/_cacheHas.js","webpack:///../../../node_modules/lodash/_castFunction.js","webpack:///../../../node_modules/lodash/_castPath.js","webpack:///../../../node_modules/lodash/_cloneArrayBuffer.js","webpack:///../../../node_modules/lodash/_cloneBuffer.js","webpack:///../../../node_modules/lodash/_cloneDataView.js","webpack:///../../../node_modules/lodash/_cloneRegExp.js","webpack:///../../../node_modules/lodash/_cloneSymbol.js","webpack:///../../../node_modules/lodash/_cloneTypedArray.js","webpack:///../../../node_modules/lodash/_copyArray.js","webpack:///../../../node_modules/lodash/_copyObject.js","webpack:///../../../node_modules/lodash/_copySymbols.js","webpack:///../../../node_modules/lodash/_copySymbolsIn.js","webpack:///../../../node_modules/lodash/_coreJsData.js","webpack:///../../../node_modules/lodash/_createBaseEach.js","webpack:///../../../node_modules/lodash/_createBaseFor.js","webpack:///../../../node_modules/lodash/_defineProperty.js","webpack:///../../../node_modules/lodash/_equalArrays.js","webpack:///../../../node_modules/lodash/_equalByTag.js","webpack:///../../../node_modules/lodash/_equalObjects.js","webpack:///../../../node_modules/lodash/_getAllKeys.js","webpack:///../../../node_modules/lodash/_getAllKeysIn.js","webpack:///../../../node_modules/lodash/_getMapData.js","webpack:///../../../node_modules/lodash/_getMatchData.js","webpack:///../../../node_modules/lodash/_getNative.js","webpack:///../../../node_modules/lodash/_getPrototype.js","webpack:///../../../node_modules/lodash/_getSymbols.js","webpack:///../../../node_modules/lodash/_getSymbolsIn.js","webpack:///../../../node_modules/lodash/_getTag.js","webpack:///../../../node_modules/lodash/_getValue.js","webpack:///../../../node_modules/lodash/_hasPath.js","webpack:///../../../node_modules/lodash/_hashClear.js","webpack:///../../../node_modules/lodash/_hashDelete.js","webpack:///../../../node_modules/lodash/_hashGet.js","webpack:///../../../node_modules/lodash/_hashHas.js","webpack:///../../../node_modules/lodash/_hashSet.js","webpack:///../../../node_modules/lodash/_initCloneArray.js","webpack:///../../../node_modules/lodash/_initCloneByTag.js","webpack:///../../../node_modules/lodash/_initCloneObject.js","webpack:///../../../node_modules/lodash/_isIndex.js","webpack:///../../../node_modules/lodash/_isKey.js","webpack:///../../../node_modules/lodash/_isKeyable.js","webpack:///../../../node_modules/lodash/_isMasked.js","webpack:///../../../node_modules/lodash/_isPrototype.js","webpack:///../../../node_modules/lodash/_isStrictComparable.js","webpack:///../../../node_modules/lodash/_listCacheClear.js","webpack:///../../../node_modules/lodash/_listCacheDelete.js","webpack:///../../../node_modules/lodash/_listCacheGet.js","webpack:///../../../node_modules/lodash/_listCacheHas.js","webpack:///../../../node_modules/lodash/_listCacheSet.js","webpack:///../../../node_modules/lodash/_mapCacheClear.js","webpack:///../../../node_modules/lodash/_mapCacheDelete.js","webpack:///../../../node_modules/lodash/_mapCacheGet.js","webpack:///../../../node_modules/lodash/_mapCacheHas.js","webpack:///../../../node_modules/lodash/_mapCacheSet.js","webpack:///../../../node_modules/lodash/_mapToArray.js","webpack:///../../../node_modules/lodash/_matchesStrictComparable.js","webpack:///../../../node_modules/lodash/_memoizeCapped.js","webpack:///../../../node_modules/lodash/_nativeCreate.js","webpack:///../../../node_modules/lodash/_nativeKeys.js","webpack:///../../../node_modules/lodash/_nativeKeysIn.js","webpack:///../../../node_modules/lodash/_nodeUtil.js","webpack:///../../../node_modules/lodash/_overArg.js","webpack:///../../../node_modules/lodash/_setCacheAdd.js","webpack:///../../../node_modules/lodash/_setCacheHas.js","webpack:///../../../node_modules/lodash/_setToArray.js","webpack:///../../../node_modules/lodash/_stackClear.js","webpack:///../../../node_modules/lodash/_stackDelete.js","webpack:///../../../node_modules/lodash/_stackGet.js","webpack:///../../../node_modules/lodash/_stackHas.js","webpack:///../../../node_modules/lodash/_stackSet.js","webpack:///../../../node_modules/lodash/_stringToPath.js","webpack:///../../../node_modules/lodash/_toKey.js","webpack:///../../../node_modules/lodash/_toSource.js","webpack:///../../../node_modules/lodash/cloneDeep.js","webpack:///../../../node_modules/lodash/eq.js","webpack:///../../../node_modules/lodash/forOwn.js","webpack:///../../../node_modules/lodash/get.js","webpack:///../../../node_modules/lodash/hasIn.js","webpack:///../../../node_modules/lodash/identity.js","webpack:///../../../node_modules/lodash/isArguments.js","webpack:///../../../node_modules/lodash/isArray.js","webpack:///../../../node_modules/lodash/isArrayLike.js","webpack:///../../../node_modules/lodash/isBuffer.js","webpack:///../../../node_modules/lodash/isFunction.js","webpack:///../../../node_modules/lodash/isLength.js","webpack:///../../../node_modules/lodash/isMap.js","webpack:///../../../node_modules/lodash/isPlainObject.js","webpack:///../../../node_modules/lodash/isSet.js","webpack:///../../../node_modules/lodash/isString.js","webpack:///../../../node_modules/lodash/isTypedArray.js","webpack:///../../../node_modules/lodash/keys.js","webpack:///../../../node_modules/lodash/keysIn.js","webpack:///../../../node_modules/lodash/map.js","webpack:///../../../node_modules/lodash/memoize.js","webpack:///../../../node_modules/lodash/property.js","webpack:///../../../node_modules/lodash/stubArray.js","webpack:///../../../node_modules/lodash/stubFalse.js","webpack:///../../../node_modules/lodash/toString.js","webpack:///../../../node_modules/react-color/es/helpers/checkboard.js","webpack:///../../../node_modules/react-color/es/components/common/Checkboard.js","webpack:///../../../node_modules/react-color/es/components/common/Alpha.js","webpack:///../../../node_modules/react-color/es/helpers/alpha.js","webpack:///../../../node_modules/react-color/es/components/common/EditableInput.js","webpack:///../../../node_modules/react-color/es/helpers/hue.js","webpack:///../../../node_modules/react-color/es/components/common/Hue.js","webpack:///../../../node_modules/lodash-es/_listCacheClear.js","webpack:///../../../node_modules/lodash-es/eq.js","webpack:///../../../node_modules/lodash-es/_assocIndexOf.js","webpack:///../../../node_modules/lodash-es/_listCacheDelete.js","webpack:///../../../node_modules/lodash-es/_listCacheGet.js","webpack:///../../../node_modules/lodash-es/_listCacheHas.js","webpack:///../../../node_modules/lodash-es/_listCacheSet.js","webpack:///../../../node_modules/lodash-es/_ListCache.js","webpack:///../../../node_modules/lodash-es/_stackClear.js","webpack:///../../../node_modules/lodash-es/_stackDelete.js","webpack:///../../../node_modules/lodash-es/_stackGet.js","webpack:///../../../node_modules/lodash-es/_stackHas.js","webpack:///../../../node_modules/lodash-es/_freeGlobal.js","webpack:///../../../node_modules/lodash-es/_root.js","webpack:///../../../node_modules/lodash-es/_Symbol.js","webpack:///../../../node_modules/lodash-es/_getRawTag.js","webpack:///../../../node_modules/lodash-es/_objectToString.js","webpack:///../../../node_modules/lodash-es/_baseGetTag.js","webpack:///../../../node_modules/lodash-es/isObject.js","webpack:///../../../node_modules/lodash-es/isFunction.js","webpack:///../../../node_modules/lodash-es/_coreJsData.js","webpack:///../../../node_modules/lodash-es/_isMasked.js","webpack:///../../../node_modules/lodash-es/_toSource.js","webpack:///../../../node_modules/lodash-es/_baseIsNative.js","webpack:///../../../node_modules/lodash-es/_getValue.js","webpack:///../../../node_modules/lodash-es/_getNative.js","webpack:///../../../node_modules/lodash-es/_Map.js","webpack:///../../../node_modules/lodash-es/_nativeCreate.js","webpack:///../../../node_modules/lodash-es/_hashClear.js","webpack:///../../../node_modules/lodash-es/_hashDelete.js","webpack:///../../../node_modules/lodash-es/_hashGet.js","webpack:///../../../node_modules/lodash-es/_hashHas.js","webpack:///../../../node_modules/lodash-es/_hashSet.js","webpack:///../../../node_modules/lodash-es/_Hash.js","webpack:///../../../node_modules/lodash-es/_mapCacheClear.js","webpack:///../../../node_modules/lodash-es/_isKeyable.js","webpack:///../../../node_modules/lodash-es/_getMapData.js","webpack:///../../../node_modules/lodash-es/_mapCacheDelete.js","webpack:///../../../node_modules/lodash-es/_mapCacheGet.js","webpack:///../../../node_modules/lodash-es/_mapCacheHas.js","webpack:///../../../node_modules/lodash-es/_mapCacheSet.js","webpack:///../../../node_modules/lodash-es/_MapCache.js","webpack:///../../../node_modules/lodash-es/_stackSet.js","webpack:///../../../node_modules/lodash-es/_Stack.js","webpack:///../../../node_modules/lodash-es/_defineProperty.js","webpack:///../../../node_modules/lodash-es/_baseAssignValue.js","webpack:///../../../node_modules/lodash-es/_assignMergeValue.js","webpack:///../../../node_modules/lodash-es/_baseFor.js","webpack:///../../../node_modules/lodash-es/_createBaseFor.js","webpack:///../../../node_modules/lodash-es/_cloneBuffer.js","webpack:///../../../node_modules/lodash-es/_Uint8Array.js","webpack:///../../../node_modules/lodash-es/_cloneArrayBuffer.js","webpack:///../../../node_modules/lodash-es/_cloneTypedArray.js","webpack:///../../../node_modules/lodash-es/_copyArray.js","webpack:///../../../node_modules/lodash-es/_baseCreate.js","webpack:///../../../node_modules/lodash-es/_overArg.js","webpack:///../../../node_modules/lodash-es/_getPrototype.js","webpack:///../../../node_modules/lodash-es/_isPrototype.js","webpack:///../../../node_modules/lodash-es/_initCloneObject.js","webpack:///../../../node_modules/lodash-es/isObjectLike.js","webpack:///../../../node_modules/lodash-es/_baseIsArguments.js","webpack:///../../../node_modules/lodash-es/isArguments.js","webpack:///../../../node_modules/lodash-es/isArray.js","webpack:///../../../node_modules/lodash-es/isLength.js","webpack:///../../../node_modules/lodash-es/isArrayLike.js","webpack:///../../../node_modules/lodash-es/isArrayLikeObject.js","webpack:///../../../node_modules/lodash-es/stubFalse.js","webpack:///../../../node_modules/lodash-es/isBuffer.js","webpack:///../../../node_modules/lodash-es/isPlainObject.js","webpack:///../../../node_modules/lodash-es/_baseIsTypedArray.js","webpack:///../../../node_modules/lodash-es/_baseUnary.js","webpack:///../../../node_modules/lodash-es/_nodeUtil.js","webpack:///../../../node_modules/lodash-es/isTypedArray.js","webpack:///../../../node_modules/lodash-es/_safeGet.js","webpack:///../../../node_modules/lodash-es/_assignValue.js","webpack:///../../../node_modules/lodash-es/_copyObject.js","webpack:///../../../node_modules/lodash-es/_baseTimes.js","webpack:///../../../node_modules/lodash-es/_isIndex.js","webpack:///../../../node_modules/lodash-es/_arrayLikeKeys.js","webpack:///../../../node_modules/lodash-es/_nativeKeysIn.js","webpack:///../../../node_modules/lodash-es/_baseKeysIn.js","webpack:///../../../node_modules/lodash-es/keysIn.js","webpack:///../../../node_modules/lodash-es/toPlainObject.js","webpack:///../../../node_modules/lodash-es/_baseMergeDeep.js","webpack:///../../../node_modules/lodash-es/_baseMerge.js","webpack:///../../../node_modules/lodash-es/identity.js","webpack:///../../../node_modules/lodash-es/_apply.js","webpack:///../../../node_modules/lodash-es/_overRest.js","webpack:///../../../node_modules/lodash-es/constant.js","webpack:///../../../node_modules/lodash-es/_baseSetToString.js","webpack:///../../../node_modules/lodash-es/_shortOut.js","webpack:///../../../node_modules/lodash-es/_setToString.js","webpack:///../../../node_modules/lodash-es/_baseRest.js","webpack:///../../../node_modules/lodash-es/_isIterateeCall.js","webpack:///../../../node_modules/lodash-es/merge.js","webpack:///../../../node_modules/lodash-es/_createAssigner.js","webpack:///../../../node_modules/react-color/es/components/common/Raised.js","webpack:///../../../node_modules/lodash-es/now.js","webpack:///../../../node_modules/lodash-es/_trimmedEndIndex.js","webpack:///../../../node_modules/lodash-es/_baseTrim.js","webpack:///../../../node_modules/lodash-es/isSymbol.js","webpack:///../../../node_modules/lodash-es/toNumber.js","webpack:///../../../node_modules/lodash-es/debounce.js","webpack:///../../../node_modules/lodash-es/throttle.js","webpack:///../../../node_modules/react-color/es/helpers/saturation.js","webpack:///../../../node_modules/react-color/es/components/common/Saturation.js","webpack:///../../../node_modules/lodash-es/_arrayEach.js","webpack:///../../../node_modules/lodash-es/_nativeKeys.js","webpack:///../../../node_modules/lodash-es/_baseKeys.js","webpack:///../../../node_modules/lodash-es/keys.js","webpack:///../../../node_modules/lodash-es/_baseEach.js","webpack:///../../../node_modules/lodash-es/_createBaseEach.js","webpack:///../../../node_modules/lodash-es/_baseForOwn.js","webpack:///../../../node_modules/lodash-es/_castFunction.js","webpack:///../../../node_modules/lodash-es/forEach.js","webpack:///../../../node_modules/tinycolor2/esm/tinycolor.js","webpack:///../../../node_modules/react-color/es/helpers/color.js","webpack:///../../../node_modules/react-color/es/components/common/ColorWrap.js","webpack:///../../../node_modules/react-color/es/helpers/interaction.js","webpack:///../../../node_modules/react-color/es/components/common/Swatch.js","webpack:///../../../node_modules/react-color/es/components/alpha/AlphaPointer.js","webpack:///../../../node_modules/react-color/es/components/alpha/Alpha.js","webpack:///../../../node_modules/lodash-es/_arrayMap.js","webpack:///../../../node_modules/lodash-es/_setCacheAdd.js","webpack:///../../../node_modules/lodash-es/_setCacheHas.js","webpack:///../../../node_modules/lodash-es/_SetCache.js","webpack:///../../../node_modules/lodash-es/_arraySome.js","webpack:///../../../node_modules/lodash-es/_cacheHas.js","webpack:///../../../node_modules/lodash-es/_equalArrays.js","webpack:///../../../node_modules/lodash-es/_mapToArray.js","webpack:///../../../node_modules/lodash-es/_setToArray.js","webpack:///../../../node_modules/lodash-es/_equalByTag.js","webpack:///../../../node_modules/lodash-es/_arrayPush.js","webpack:///../../../node_modules/lodash-es/_baseGetAllKeys.js","webpack:///../../../node_modules/lodash-es/_arrayFilter.js","webpack:///../../../node_modules/lodash-es/stubArray.js","webpack:///../../../node_modules/lodash-es/_getSymbols.js","webpack:///../../../node_modules/lodash-es/_getAllKeys.js","webpack:///../../../node_modules/lodash-es/_equalObjects.js","webpack:///../../../node_modules/lodash-es/_DataView.js","webpack:///../../../node_modules/lodash-es/_Promise.js","webpack:///../../../node_modules/lodash-es/_Set.js","webpack:///../../../node_modules/lodash-es/_WeakMap.js","webpack:///../../../node_modules/lodash-es/_getTag.js","webpack:///../../../node_modules/lodash-es/_baseIsEqualDeep.js","webpack:///../../../node_modules/lodash-es/_baseIsEqual.js","webpack:///../../../node_modules/lodash-es/_baseIsMatch.js","webpack:///../../../node_modules/lodash-es/_isStrictComparable.js","webpack:///../../../node_modules/lodash-es/_getMatchData.js","webpack:///../../../node_modules/lodash-es/_matchesStrictComparable.js","webpack:///../../../node_modules/lodash-es/_baseMatches.js","webpack:///../../../node_modules/lodash-es/_isKey.js","webpack:///../../../node_modules/lodash-es/memoize.js","webpack:///../../../node_modules/lodash-es/_stringToPath.js","webpack:///../../../node_modules/lodash-es/_memoizeCapped.js","webpack:///../../../node_modules/lodash-es/_baseToString.js","webpack:///../../../node_modules/lodash-es/toString.js","webpack:///../../../node_modules/lodash-es/_castPath.js","webpack:///../../../node_modules/lodash-es/_toKey.js","webpack:///../../../node_modules/lodash-es/_baseGet.js","webpack:///../../../node_modules/lodash-es/get.js","webpack:///../../../node_modules/lodash-es/_baseHasIn.js","webpack:///../../../node_modules/lodash-es/_hasPath.js","webpack:///../../../node_modules/lodash-es/hasIn.js","webpack:///../../../node_modules/lodash-es/_baseMatchesProperty.js","webpack:///../../../node_modules/lodash-es/_baseProperty.js","webpack:///../../../node_modules/lodash-es/_basePropertyDeep.js","webpack:///../../../node_modules/lodash-es/property.js","webpack:///../../../node_modules/lodash-es/_baseIteratee.js","webpack:///../../../node_modules/lodash-es/_baseMap.js","webpack:///../../../node_modules/lodash-es/map.js","webpack:///../../../node_modules/react-color/es/components/block/BlockSwatches.js","webpack:///../../../node_modules/react-color/es/components/block/Block.js","webpack:///../../../node_modules/material-colors/dist/colors.es2015.js","webpack:///../../../node_modules/react-color/es/components/circle/CircleSwatch.js","webpack:///../../../node_modules/react-color/es/components/circle/Circle.js","webpack:///../../../node_modules/lodash-es/isUndefined.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromeFields.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromePointer.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromePointerCircle.js","webpack:///../../../node_modules/react-color/es/components/chrome/Chrome.js","webpack:///../../../node_modules/react-color/es/components/compact/CompactColor.js","webpack:///../../../node_modules/react-color/es/components/compact/CompactFields.js","webpack:///../../../node_modules/react-color/es/components/compact/Compact.js","webpack:///../../../node_modules/react-color/es/components/github/GithubSwatch.js","webpack:///../../../node_modules/react-color/es/components/github/Github.js","webpack:///../../../node_modules/react-color/es/components/hue/HuePointer.js","webpack:///../../../node_modules/react-color/es/components/hue/Hue.js","webpack:///../../../node_modules/react-color/es/components/material/Material.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopFields.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPointerCircle.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPointer.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopButton.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPreviews.js","webpack:///../../../node_modules/react-color/es/components/photoshop/Photoshop.js","webpack:///../../../node_modules/react-color/es/components/sketch/SketchFields.js","webpack:///../../../node_modules/react-color/es/components/sketch/SketchPresetColors.js","webpack:///../../../node_modules/react-color/es/components/sketch/Sketch.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderSwatch.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderSwatches.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderPointer.js","webpack:///../../../node_modules/react-color/es/components/slider/Slider.js","webpack:///../../../node_modules/react-color/es/components/swatches/SwatchesColor.js","webpack:///../../../node_modules/react-color/es/components/swatches/SwatchesGroup.js","webpack:///../../../node_modules/react-color/es/components/swatches/Swatches.js","webpack:///../../../node_modules/react-color/es/components/twitter/Twitter.js","webpack:///../../../node_modules/react-color/es/components/google/GooglePointerCircle.js","webpack:///../../../node_modules/react-color/es/components/google/GooglePointer.js","webpack:///../../../node_modules/react-color/es/components/google/GoogleFields.js","webpack:///../../../node_modules/react-color/es/components/google/Google.js","webpack:///../../../node_modules/react-window/dist/index.esm.js","webpack:///../../../node_modules/reactcss/lib/autoprefix.js","webpack:///../../../node_modules/reactcss/lib/components/active.js","webpack:///../../../node_modules/reactcss/lib/components/hover.js","webpack:///../../../node_modules/reactcss/lib/flattenNames.js","webpack:///../../../node_modules/reactcss/lib/index.js","webpack:///../../../node_modules/reactcss/lib/loop.js","webpack:///../../../node_modules/reactcss/lib/mergeClasses.js","webpack:///../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js","webpack:///../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js","webpack:///../../../node_modules/use-sync-external-store/shim/index.js","webpack:///../../../node_modules/use-sync-external-store/shim/with-selector.js","webpack:///../node_modules/zustand/esm/vanilla.mjs","webpack:///../node_modules/zustand/esm/index.mjs","webpack:///../node_modules/zustand/esm/middleware.mjs"],"sourcesContent":["/**\r\n * Javascript object that handles dates and compute the time.\r\n *\r\n * @export\r\n * @class FullDateInterface\r\n */\nclass FullDateInterface {\n  /**\r\n   * Creates an instance of FullDateInterface.\r\n   * @param {string} date formatted as yyyy-mm-ddTHH:MM:SS.FFFFFFZ\r\n   * @memberof FullDateInterface\r\n   */\n  constructor(date) {\n    this.fullDate = date;\n  }\n  /**\r\n   * returns time since 1 january 1970\r\n   *\r\n   * @returns {number} time in sec\r\n   * @memberof FullDateInterface\r\n   */\n\n\n  getTimeInSec() {\n    // yyyy-mm-ddTHH:MM:SS.FFFFFFZ\n    const dateString = this.fullDate.substring(0, 10);\n    const timeString = this.fullDate.substring(11, 28); // yyyy-mm-dd\n\n    const yyyy = parseInt(dateString.substring(0, 4), 10);\n    const mm = dateString.length >= 7 ? parseInt(dateString.substring(5, 7), 10) : undefined;\n    const dd = dateString.length >= 10 ? parseInt(dateString.substring(8, 10), 10) : undefined;\n\n    if (isNaN(yyyy) || mm !== undefined && isNaN(mm) || dd !== undefined && isNaN(dd) || yyyy > 3000 || mm && (mm < 1 || mm > 12) || dd && (dd < 1 || dd > 31)) {\n      throw new Error(`invalid date '${dateString}'`);\n    }\n\n    const dateJS = new Date(`${dateString}T00:00:00.000000Z`); // HHMMSS.FFFFFF\n\n    const HH = parseInt(timeString.substring(0, 2), 10);\n    const MM = timeString.length >= 5 ? parseInt(timeString.substring(3, 5), 10) : undefined;\n    const SS = timeString.length >= 8 ? parseInt(timeString.substring(6, 8), 10) : undefined;\n    const fractionalStr = timeString.substring(9, 15);\n    const FFFFFF = fractionalStr ? parseInt(fractionalStr, 10) * Math.pow(10, -fractionalStr.length) : undefined;\n\n    if (isNaN(HH) || MM !== undefined && isNaN(MM) || SS !== undefined && isNaN(SS) || FFFFFF !== undefined && isNaN(FFFFFF) || HH < 0 || HH > 23 || MM && (MM < 0 || MM > 59) || SS && (SS < 0 || SS > 59) || FFFFFF && (FFFFFF < 0 || FFFFFF > 999999)) {\n      throw new Error(`invalid time '${timeString}'`);\n    }\n\n    let timeInSec = dateJS.getTime() / 1000;\n    timeInSec += HH * 3600;\n\n    if (MM !== undefined) {\n      timeInSec += MM * 60;\n    }\n\n    if (SS !== undefined) {\n      timeInSec += SS;\n    }\n\n    if (FFFFFF !== undefined) {\n      timeInSec += FFFFFF;\n    }\n\n    return timeInSec;\n  }\n  /**\r\n   * returns time since 1 january 1970\r\n   *\r\n   * @returns {number} time in microsec\r\n   * @memberof FullDateInterface\r\n   */\n\n\n  getTimeInMicroSec() {\n    const timeInMicroSec = this.getTimeInSec() * 1e6;\n    return timeInMicroSec;\n  }\n\n}\n/**\r\n * Combines two javascript objects containing the date and time information\r\n *\r\n * @export\r\n * @param {DateInterface} date\r\n * @param {TimeInterface} time\r\n * @returns {FullDateInterface}\r\n */\n\nfunction combineDateTime(date, time) {\n  const hours = `${time.hours || '00'}`.padStart(2, '0');\n  const minutes = `${time.minutes || '00'}`.padStart(2, '0');\n  const seconds = `${time.seconds || '00'}`.padStart(2, '0');\n  const month = `${date.month}`.padStart(2, '0');\n  const day = `${date.day}`.padStart(2, '0');\n  const fractionalSeconds = `${time.fractionalSeconds || '000000'}`.padEnd(6, '0');\n  const dateString = `${date.year}-${month}-${day}`;\n  const timeString = `T${hours}:${minutes}:${seconds}.${fractionalSeconds}Z`;\n  const fullDateString = `${dateString}${timeString}`;\n  return new FullDateInterface(fullDateString);\n}\n\n/**\r\n * Check the number of days for a picked month and year\r\n * algorithm based on http://stackoverflow.com/questions/1433030/validate-number-of-days-in-a-given-month\r\n *\r\n * @param {number} m\r\n * @param {number} y\r\n * @returns {number} number of days\r\n */\nfunction daysInMonth(m, y) {\n  // m is 0 indexed: 0-11\n  switch (m) {\n    case 2:\n      return y % 4 === 0 && y % 100 || y % 400 === 0 ? 29 : 28;\n\n    case 9:\n    case 4:\n    case 6:\n    case 11:\n      return 30;\n\n    default:\n      return 31;\n  }\n}\n/**\r\n * Check if the date is valid\r\n *\r\n * @param {number} d\r\n * @param {number} m\r\n * @param {number} y\r\n * @returns {boolean} boolean result\r\n */\n\n\nfunction isValidDate(d, m, y) {\n  // make year is a number\n  if (isNaN(y)) {\n    return false;\n  }\n\n  return m > 0 && m <= 12 && d > 0 && d <= daysInMonth(m, y);\n}\n/**\r\n * Parses a DA formatted string into a Javascript object\r\n * @param {string} date a string in the DA VR format\r\n * @param {boolean} [validate] - true if an exception should be thrown if the date is invalid\r\n * @returns {DateInterface} Javascript object with properties year, month and day or undefined if not present or not 8 bytes long\r\n */\n\n\nfunction parseDA(date) {\n  if (date === undefined || date === null || date.length !== 8 || typeof date !== 'string') {\n    throw new Error(`invalid DA '${date}'`);\n  }\n\n  const yyyy = parseInt(date.substring(0, 4), 10);\n  const mm = parseInt(date.substring(4, 6), 10);\n  const dd = parseInt(date.substring(6, 8), 10);\n\n  if (isValidDate(dd, mm, yyyy) !== true) {\n    throw new Error(`invalid DA '${date}'`);\n  }\n\n  return {\n    year: yyyy,\n    month: mm,\n    day: dd\n  };\n}\n\n/**\r\n * Parses a TM formatted string into a javascript object with properties for hours, minutes, seconds and fractionalSeconds\r\n * @param {string} time - a string in the TM VR format\r\n * @returns {string} javascript object with properties for hours, minutes, seconds and fractionalSeconds or undefined if no element or data.  Missing fields are set to undefined\r\n */\nfunction parseTM(time) {\n  if (time === null || time === undefined || time.length < 2 || typeof time !== 'string') {\n    // must at least have HH\n    throw new Error(`invalid TM '${time}'`);\n  } // 0123456789\n  // HHMMSS.FFFFFF\n\n\n  const hh = parseInt(time.substring(0, 2), 10);\n  const mm = time.length >= 4 ? parseInt(time.substring(2, 4), 10) : undefined;\n  const ss = time.length >= 6 ? parseInt(time.substring(4, 6), 10) : undefined;\n  const fractionalStr = time.length >= 8 ? time.substring(7, 13) : undefined;\n  const ffffff = fractionalStr ? parseInt(fractionalStr, 10) * Math.pow(10, 6 - fractionalStr.length) : undefined;\n\n  if (isNaN(hh) || mm !== undefined && isNaN(mm) || ss !== undefined && isNaN(ss) || ffffff !== undefined && isNaN(ffffff) || hh < 0 || hh > 23 || mm && (mm < 0 || mm > 59) || ss && (ss < 0 || ss > 59) || ffffff && (ffffff < 0 || ffffff > 999999)) {\n    throw new Error(`invalid TM '${time}'`);\n  }\n\n  return {\n    hours: hh,\n    minutes: mm,\n    seconds: ss,\n    fractionalSeconds: ffffff\n  };\n}\n\n/**\r\n * Utility to create a FullDateInterface object given a string formatted as yyyy-mm-ddTHH:MM:SS.FFFFFFZ\r\n *\r\n * @export\r\n * @param {string} dateTime\r\n * @returns {FullDateInterface}\r\n */\n\nfunction dateTimeToFullDateInterface(dateTime) {\n  if (dateTime === undefined || dateTime === null) {\n    throw new Error('dateTimeToFullDateInterface : dateTime not defined.');\n  }\n\n  const date = parseDA(dateTime.substring(0, 8));\n  const time = parseTM(dateTime.substring(8));\n  return combineDateTime(date, time);\n}\n\n/**\r\n * Calculate the scan times\r\n *\r\n * @export\r\n * @param {InstanceMetadataForScanTimes[]} instances\r\n * @returns {FullDateInterface[]}\r\n */\n\nfunction calculateScanTimes(instances) {\n  const {\n    SeriesDate,\n    SeriesTime,\n    GEPrivatePostInjectionDateTime\n  } = instances[0];\n  const results = new Array(instances.length);\n  const seriesDate = parseDA(SeriesDate);\n  const seriesTime = parseTM(SeriesTime);\n  const seriesDateTime = combineDateTime(seriesDate, seriesTime);\n  let earliestAcquisitionDateTime = new FullDateInterface(`3000-01-01T00:00:00.000000Z`);\n  let timeError = earliestAcquisitionDateTime.getTimeInSec();\n  instances.forEach(instance => {\n    const {\n      AcquisitionDate,\n      AcquisitionTime\n    } = instance;\n    const acquisitionDate = parseDA(AcquisitionDate);\n    const acquisitionTime = parseTM(AcquisitionTime);\n    const acquisitionDateTime = combineDateTime(acquisitionDate, acquisitionTime);\n\n    if (earliestAcquisitionDateTime.getTimeInSec() >= timeError) {\n      earliestAcquisitionDateTime = acquisitionDateTime;\n    } else {\n      earliestAcquisitionDateTime = acquisitionDateTime.getTimeInSec() < earliestAcquisitionDateTime.getTimeInSec() ? acquisitionDateTime : earliestAcquisitionDateTime;\n    }\n  });\n\n  if (earliestAcquisitionDateTime.getTimeInSec() >= timeError) {\n    throw new Error('Earliest acquisition time or date could not be parsed.');\n  }\n\n  if (seriesDateTime.getTimeInSec() <= earliestAcquisitionDateTime.getTimeInSec()) {\n    return results.fill(seriesDateTime);\n  } else {\n    if (GEPrivatePostInjectionDateTime) {\n      // GE Private scan\n      return results.fill(dateTimeToFullDateInterface(GEPrivatePostInjectionDateTime));\n    } else {\n      /*const hasValidFrameTimes = instances.every(instance => {\r\n        return (\r\n          instance.FrameReferenceTime &&\r\n          instance.FrameReferenceTime > 0 &&\r\n          instance.ActualFrameDuration &&\r\n          instance.ActualFrameDuration > 0\r\n        );\r\n      });*/\n      // TODO: Temporarily commented out the checks and logic below to\n      // investigate the BQML_AC_DT_lessThan_S_DT_SIEMENS-instances case\n      //if (!hasValidFrameTimes) {\n      return results.fill(earliestAcquisitionDateTime); //}\n\n      /* Siemens PETsyngo\t3.x\tmulti-injection logic\r\n      - backcompute\tfrom\tcenter\t(average\tcount\trate\t)\tof\ttime\twindow\tfor\tbed\tposition\t(frame)\tin\tseries (reliable\tin\tall\tcases)\r\n      - Acquisition\tDate\t(0x0008,0x0022)\tand\tTime\t(0x0008,0x0032) are\tthe\tstart\tof\tthe\tbed\tposition\t(frame)\r\n      - Frame\tReference\tTime\t(0x0054,0x1300) is\tthe\toffset\t(ms)\tfrom\tthe\tscan\tDate\tand\tTime we\twant\tto\tthe\taverage\tcount\trate\ttime\r\n      */\n\n      /*return instances.map(instance => {\r\n        const {\r\n          FrameReferenceTime,\r\n          ActualFrameDuration,\r\n          RadionuclideHalfLife,\r\n          AcquisitionDate,\r\n          AcquisitionTime,\r\n        } = instance;\r\n        // Some of these checks are only here because the compiler is complaining\r\n        // We could potentially use the ! operator instead\r\n        if (!FrameReferenceTime || FrameReferenceTime <= 0) {\r\n          throw new Error(\r\n            `FrameReferenceTime is invalid: ${FrameReferenceTime}`\r\n          );\r\n        }\r\n               if (!ActualFrameDuration || ActualFrameDuration <= 0) {\r\n          throw new Error(\r\n            `ActualFrameDuration is invalid: ${ActualFrameDuration}`\r\n          );\r\n        }\r\n               if (!RadionuclideHalfLife) {\r\n          throw new Error('RadionuclideHalfLife is required');\r\n        }\r\n               if (!AcquisitionDate) {\r\n          throw new Error('AcquisitionDate is required');\r\n        }\r\n               if (!AcquisitionTime) {\r\n          throw new Error('AcquisitionTime is required');\r\n        }\r\n               const acquisitionDate: DateInterface = parseDA(AcquisitionDate);\r\n        const acquisitionTime: TimeInterface = parseTM(AcquisitionTime);\r\n        const acquisitionDateTime: FullDateInterface = combineDateTime(\r\n          acquisitionDate,\r\n          acquisitionTime\r\n        );\r\n               const frameDurationInSec = ActualFrameDuration / 1000;\r\n        const decayConstant = Math.log(2) / RadionuclideHalfLife;\r\n        const decayDuringFrame = decayConstant * frameDurationInSec;\r\n        // TODO: double check this is correctly copied from QIBA pseudocode\r\n        const averageCountRateTimeWithinFrameInSec =\r\n          (1 / decayConstant) *\r\n          Math.log(decayDuringFrame / (1 - Math.exp(-decayConstant)));\r\n        const scanDateTimeAsNumber =\r\n          Number(acquisitionDateTime) -\r\n          FrameReferenceTime / 1000 +\r\n          averageCountRateTimeWithinFrameInSec;\r\n               const scanDate = new Date(scanDateTimeAsNumber);\r\n        console.log('SIEMENS PATH');\r\n        console.log(new Date(scanDateTimeAsNumber));\r\n        return scanDate;\r\n      });*/\n    }\n  }\n}\n\nfunction calculateSUVlbmScalingFactor(inputs) {\n  const {\n    PatientSex,\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let LBM;\n  const weightSizeFactor = Math.pow(PatientWeight / (PatientSize * 100), 2); // reference: https://www.medicalconnections.co.uk/kb/calculating-suv-from-pet-images/\n\n  if (PatientSex === 'F') {\n    LBM = 1.07 * PatientWeight - 148 * weightSizeFactor;\n  } else if (PatientSex === 'M') {\n    LBM = 1.1 * PatientWeight - 120 * weightSizeFactor;\n  } else {\n    throw new Error(`PatientSex is an invalid value: ${PatientSex}`);\n  }\n\n  return LBM * 1000; // convert in gr\n}\n/**\r\n * From https://link.springer.com/article/10.1007/s00259-014-2961-x\r\n * and https://link.springer.com/article/10.2165/00003088-200544100-00004\r\n * and\r\n * @param inputs\r\n * @returns\r\n */\n\n\nfunction calculateSUVlbmJanmahasatianScalingFactor(inputs) {\n  const {\n    PatientSex,\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let LBM;\n  const bodyMassIndex = PatientWeight / Math.pow(PatientSize, 2);\n\n  if (PatientSex === 'F') {\n    LBM = 9270 * PatientWeight / (8780 + 244 * bodyMassIndex);\n  } else if (PatientSex === 'M') {\n    LBM = 9270 * PatientWeight / (6680 + 216 * bodyMassIndex);\n  } else {\n    throw new Error(`PatientSex is an invalid value: ${PatientSex}`);\n  }\n\n  return LBM * 1000; // convert in gr\n}\n\nfunction calculateSUVbsaScalingFactor(inputs) {\n  const {\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let BSA = Math.pow(PatientWeight, 0.425) * Math.pow(PatientSize * 100, 0.725) * 71.84;\n  return BSA;\n}\n\n/**\r\n * Calculate start time\r\n *\r\n * @export\r\n * @param {{\r\n *   RadiopharmaceuticalStartDateTime?: string;\r\n *   RadiopharmaceuticalStartTime?: string;\r\n *   SeriesDate?: string;\r\n * }} input\r\n * @returns {FullDateInterface}\r\n */\n\nfunction calculateStartTime(input) {\n  const {\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  } = input;\n  let time;\n  let date;\n\n  if (RadiopharmaceuticalStartDateTime) {\n    return dateTimeToFullDateInterface(RadiopharmaceuticalStartDateTime);\n  } else if (RadiopharmaceuticalStartTime && SeriesDate) {\n    // start Date\tis not explicit - assume\tsame as\tSeries Date;\n    // but consider\tspanning midnight\n    // TODO: do we need some logic to check if the scan went over midnight?\n    time = parseTM(RadiopharmaceuticalStartTime);\n    date = parseDA(SeriesDate);\n    return combineDateTime(date, time);\n  }\n\n  throw new Error(`Invalid input: ${input}`);\n}\n\n/**\r\n * The injected dose used to calculate SUV is corrected for the\r\n * decay that occurs between the time of injection and the start of the scan\r\n *\r\n * @param {InstanceMetadata[]} instances\r\n * @returns {number[]}\r\n */\n\nfunction calculateDecayCorrection(instances) {\n  const {\n    RadionuclideTotalDose,\n    RadionuclideHalfLife,\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  } = instances[0];\n\n  if (RadionuclideTotalDose === undefined || RadionuclideTotalDose === null) {\n    throw new Error('calculateDecayCorrection : RadionuclideTotalDose value not found.');\n  }\n\n  if (RadionuclideHalfLife === undefined || RadionuclideHalfLife === null) {\n    throw new Error('calculateDecayCorrection : RadionuclideHalfLife value not found.');\n  }\n\n  const scanTimes = calculateScanTimes(instances);\n  const startTime = calculateStartTime({\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  });\n  return instances.map((_, index) => {\n    const scanTime = scanTimes[index];\n    const decayTimeInSec = scanTime.getTimeInSec() - startTime.getTimeInSec();\n\n    if (decayTimeInSec < 0) {\n      throw new Error('Decay time cannot be less than zero');\n    }\n\n    const decayedDose = RadionuclideTotalDose * Math.pow(2, -decayTimeInSec / RadionuclideHalfLife);\n    return 1 / decayedDose;\n  });\n}\n/**\r\n *\r\n * @param a Simple value or array of simple values\r\n * @param b Simple value or array of simple values\r\n * @returns boolean true if the values are equal.\r\n */\n\n\nconst deepEquals = (a, b) => {\n  return a === b || Array.isArray(a) && Array.isArray(b) && a.length === b.length && a.every((val, index) => val === b[index]);\n};\n/**\r\n * Calculate the SUV factor\r\n *\r\n * Note: Rescale Slope / Intercept must still be applied. These must be applied\r\n *       on a per-Frame basis, since some scanners may have different values per Frame.\r\n *\r\n * @export\r\n * @param {InstanceMetadata[]} instances\r\n * @returns {ScalingFactorResult[]}\r\n */\n\n\nfunction calculateSUVScalingFactors(instances) {\n  const {\n    CorrectedImage,\n    Units,\n    PhilipsPETPrivateGroup,\n    PatientWeight,\n    PatientSex,\n    PatientSize\n  } = instances[0];\n\n  if (!CorrectedImage.includes('ATTN') || !CorrectedImage.includes('DECY')) {\n    throw new Error(`CorrectedImage must contain \"ATTN\" and \"DECY\": ${CorrectedImage}`);\n  } // Sanity check that every instance provided has identical\n  // values for series-level metadata. If not, the provided\n  // data is invalid.\n\n\n  const isSingleSeries = instances.every(instance => {\n    return instance.Units === Units && deepEquals(instance.CorrectedImage, CorrectedImage) && instance.PatientWeight === PatientWeight && instance.PatientSex === PatientSex && instance.PatientSize === PatientSize && instance.RadionuclideHalfLife === instances[0].RadionuclideHalfLife && instance.RadionuclideTotalDose === instances[0].RadionuclideTotalDose && instance.DecayCorrection === instances[0].DecayCorrection && instance.SeriesDate === instances[0].SeriesDate && instance.SeriesTime === instances[0].SeriesTime;\n  });\n\n  if (!isSingleSeries) {\n    throw new Error('The set of instances does not appear to come from one Series. Every instance must have identical values for series-level metadata properties');\n  } // Treat null, undefined and zero as a missing PatientWeight.\n\n\n  if (!PatientWeight) {\n    throw new Error('PatientWeight value is missing. It is not possible to calculate the SUV factors');\n  }\n\n  let decayCorrectionArray = new Array(instances.length);\n  decayCorrectionArray = calculateDecayCorrection(instances);\n  let results = new Array(instances.length);\n  const weightInGrams = PatientWeight * 1000;\n\n  if (Units === 'BQML') {\n    results = decayCorrectionArray.map(function (value) {\n      return value * weightInGrams;\n    });\n  } else if (Units === 'CNTS') {\n    const hasValidSUVScaleFactor = instances.every(instance => {\n      var _instance$PhilipsPETP, _instance$PhilipsPETP2, _instance$PhilipsPETP3;\n\n      return instance.PhilipsPETPrivateGroup && ((_instance$PhilipsPETP = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP === void 0 ? void 0 : _instance$PhilipsPETP.SUVScaleFactor) !== null && ((_instance$PhilipsPETP2 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP2 === void 0 ? void 0 : _instance$PhilipsPETP2.SUVScaleFactor) !== undefined && ((_instance$PhilipsPETP3 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP3 === void 0 ? void 0 : _instance$PhilipsPETP3.SUVScaleFactor) !== 0;\n    });\n    const hasValidActivityConcentrationScaleFactor = instances.every(instance => {\n      var _instance$PhilipsPETP4, _instance$PhilipsPETP5, _instance$PhilipsPETP6;\n\n      return instance.PhilipsPETPrivateGroup && !((_instance$PhilipsPETP4 = instance.PhilipsPETPrivateGroup) !== null && _instance$PhilipsPETP4 !== void 0 && _instance$PhilipsPETP4.SUVScaleFactor) && ((_instance$PhilipsPETP5 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP5 === void 0 ? void 0 : _instance$PhilipsPETP5.ActivityConcentrationScaleFactor) !== undefined && ((_instance$PhilipsPETP6 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP6 === void 0 ? void 0 : _instance$PhilipsPETP6.ActivityConcentrationScaleFactor) !== 0;\n    }); //console.log(`hasValidSUVScaleFactor: ${hasValidSUVScaleFactor}`);\n    //console.log(`hasValidActivityConcentrationScaleFactor: ${hasValidActivityConcentrationScaleFactor}`);\n\n    if (hasValidSUVScaleFactor) {\n      results = instances.map( // Added ! to tell Typescript that this can't be undefined, since we are testing it\n      // in the .every loop above.\n      instance => instance.PhilipsPETPrivateGroup.SUVScaleFactor);\n    } else if (hasValidActivityConcentrationScaleFactor) {\n      // if (0x7053,0x1000) not present, but (0x7053,0x1009) is present, then (0x7053,0x1009) * Rescale Slope,\n      // scales pixels to Bq/ml, and proceed as if Units are BQML\n      results = instances.map((instance, index) => {\n        // Added ! to tell Typescript that this can't be undefined, since we are testing it\n        // in the .every loop above.\n        return instance.PhilipsPETPrivateGroup.ActivityConcentrationScaleFactor * decayCorrectionArray[index] * weightInGrams;\n      });\n    } else {\n      throw new Error(`Units are in CNTS, but PhilipsPETPrivateGroup has invalid values: ${JSON.stringify(PhilipsPETPrivateGroup)}`);\n    }\n  } else if (Units === 'GML') {\n    // assumes that GML indicates SUVbw instead of SUVlbm\n    results.fill(1);\n  } else {\n    throw new Error(`Units has an invalid value: ${Units}`);\n  } // get BSA\n\n\n  let suvbsaFactor;\n\n  if (PatientSize === null || PatientSize === undefined) {\n    console.warn('PatientSize value is missing. It is not possible to calculate the SUV bsa factors');\n  } else {\n    const sulInputs = {\n      PatientWeight,\n      PatientSize\n    };\n    suvbsaFactor = calculateSUVbsaScalingFactor(sulInputs);\n  } // get LBM\n\n\n  let suvlbmFactor;\n  let suvlbmJenmaFactor;\n\n  if (PatientSize === null || PatientSize === undefined) {\n    console.warn('PatientSize value is missing. It is not possible to calculate the SUV lbm factors');\n  } else if (PatientSex === null || PatientSex === undefined) {\n    console.warn('PatientSex value is missing. It is not possible to calculate the SUV lbm factors');\n  } else {\n    const suvlbmInputs = {\n      PatientWeight,\n      PatientSex,\n      PatientSize\n    };\n    suvlbmFactor = calculateSUVlbmScalingFactor(suvlbmInputs);\n    suvlbmJenmaFactor = calculateSUVlbmJanmahasatianScalingFactor(suvlbmInputs);\n  }\n\n  return results.map(function (result, index) {\n    const factors = {\n      suvbw: result\n    };\n\n    if (suvbsaFactor) {\n      // multiply for BSA\n      factors.suvbsa = decayCorrectionArray[index] * suvbsaFactor;\n    }\n\n    if (suvlbmFactor) {\n      // multiply for LBM\n      factors.suvlbm = decayCorrectionArray[index] * suvlbmFactor;\n    }\n\n    if (suvlbmJenmaFactor) {\n      factors.suvlbmJanma = decayCorrectionArray[index] * suvlbmJenmaFactor;\n    } // factor formulaes taken from:\n    // https://www.medicalconnections.co.uk/kb/calculating-suv-from-pet-images/\n\n\n    return factors;\n  });\n}\n\nexport { calculateSUVScalingFactors };\n//# sourceMappingURL=calculate-suv.esm.js.map\n","const CORNERSTONE_COLOR_LUT = [\n    [0, 0, 0, 0],\n    [221, 84, 84, 255],\n    [77, 228, 121, 255],\n    [166, 70, 235, 255],\n    [189, 180, 116, 255],\n    [109, 182, 196, 255],\n    [204, 101, 157, 255],\n    [123, 211, 94, 255],\n    [93, 87, 218, 255],\n    [225, 128, 80, 255],\n    [73, 232, 172, 255],\n    [181, 119, 186, 255],\n    [176, 193, 112, 255],\n    [105, 153, 200, 255],\n    [208, 97, 120, 255],\n    [90, 215, 101, 255],\n    [135, 83, 222, 255],\n    [229, 178, 76, 255],\n    [122, 183, 181, 255],\n    [190, 115, 171, 255],\n    [149, 197, 108, 255],\n    [100, 118, 205, 255],\n    [212, 108, 93, 255],\n    [86, 219, 141, 255],\n    [183, 79, 226, 255],\n    [233, 233, 72, 255],\n    [118, 167, 187, 255],\n    [194, 111, 146, 255],\n    [116, 201, 104, 255],\n    [115, 96, 209, 255],\n    [216, 147, 89, 255],\n    [82, 223, 188, 255],\n    [230, 75, 224, 255],\n    [163, 184, 121, 255],\n    [114, 143, 191, 255],\n    [198, 107, 114, 255],\n    [99, 206, 122, 255],\n    [153, 92, 213, 255],\n    [220, 192, 85, 255],\n    [78, 215, 227, 255],\n    [234, 71, 173, 255],\n    [141, 188, 117, 255],\n    [110, 113, 195, 255],\n    [202, 128, 103, 255],\n    [95, 210, 157, 255],\n    [195, 88, 217, 255],\n    [206, 224, 81, 255],\n    [74, 166, 231, 255],\n    [185, 120, 139, 255],\n    [113, 192, 113, 255],\n    [133, 106, 199, 255],\n    [207, 162, 98, 255],\n    [91, 214, 198, 255],\n    [221, 84, 198, 255],\n    [159, 228, 77, 255],\n    [70, 111, 235, 255],\n    [189, 119, 116, 255],\n    [109, 196, 138, 255],\n    [165, 101, 204, 255],\n    [211, 201, 94, 255],\n    [87, 191, 218, 255],\n    [225, 80, 153, 255],\n    [106, 232, 73, 255],\n    [124, 119, 186, 255],\n    [193, 142, 112, 255],\n    [105, 200, 168, 255],\n    [203, 97, 208, 255],\n    [184, 215, 90, 255],\n    [83, 147, 222, 255],\n    [229, 76, 101, 255],\n    [122, 183, 130, 255],\n    [146, 115, 190, 255],\n    [197, 171, 108, 255],\n    [100, 205, 205, 255],\n    [212, 93, 177, 255],\n    [141, 219, 86, 255],\n    [79, 97, 226, 255],\n    [233, 99, 72, 255],\n    [118, 187, 150, 255],\n    [173, 111, 194, 255],\n    [197, 201, 104, 255],\n    [96, 171, 209, 255],\n    [216, 89, 137, 255],\n    [94, 223, 82, 255],\n    [107, 75, 230, 255],\n    [184, 153, 121, 255],\n    [114, 191, 175, 255],\n    [198, 107, 191, 255],\n    [166, 206, 99, 255],\n    [92, 132, 213, 255],\n    [220, 85, 91, 255],\n    [78, 227, 115, 255],\n    [159, 71, 234, 255],\n    [188, 176, 117, 255],\n    [110, 185, 195, 255],\n    [202, 103, 161, 255],\n    [129, 210, 95, 255],\n    [88, 88, 217, 255],\n    [224, 123, 81, 255],\n    [74, 231, 166, 255],\n    [177, 120, 185, 255],\n    [179, 192, 113, 255],\n    [106, 156, 199, 255],\n    [207, 98, 125, 255],\n    [91, 214, 96, 255],\n    [130, 84, 221, 255],\n    [228, 171, 77, 255],\n    [70, 235, 221, 255],\n    [189, 116, 174, 255],\n    [153, 196, 109, 255],\n    [101, 123, 204, 255],\n    [211, 104, 94, 255],\n    [87, 218, 136, 255],\n    [177, 80, 225, 255],\n    [232, 225, 73, 255],\n    [119, 169, 186, 255],\n    [193, 112, 149, 255],\n    [121, 200, 105, 255],\n    [111, 97, 208, 255],\n    [215, 142, 90, 255],\n    [83, 222, 181, 255],\n    [229, 76, 229, 255],\n    [165, 183, 122, 255],\n    [115, 146, 190, 255],\n    [197, 108, 119, 255],\n    [100, 205, 118, 255],\n    [148, 93, 212, 255],\n    [219, 186, 86, 255],\n    [79, 220, 226, 255],\n    [233, 72, 179, 255],\n    [144, 187, 118, 255],\n    [111, 118, 194, 255],\n    [201, 124, 104, 255],\n    [96, 209, 153, 255],\n    [189, 89, 216, 255],\n    [211, 223, 82, 255],\n    [75, 172, 230, 255],\n    [184, 121, 142, 255],\n    [117, 191, 114, 255],\n    [130, 107, 198, 255],\n    [206, 157, 99, 255],\n    [92, 213, 193, 255],\n    [220, 85, 203, 255],\n    [165, 227, 78, 255],\n    [71, 118, 234, 255],\n    [188, 117, 117, 255],\n    [110, 195, 135, 255],\n    [161, 103, 202, 255],\n    [210, 195, 95, 255],\n    [88, 195, 217, 255],\n    [224, 81, 158, 255],\n    [113, 231, 74, 255],\n    [123, 120, 185, 255],\n    [192, 139, 113, 255],\n    [106, 199, 164, 255],\n    [198, 98, 207, 255],\n    [188, 214, 91, 255],\n    [84, 153, 221, 255],\n    [228, 77, 108, 255],\n    [70, 235, 84, 255],\n    [143, 116, 189, 255],\n    [196, 167, 109, 255],\n    [101, 204, 199, 255],\n    [211, 94, 182, 255],\n    [147, 218, 87, 255],\n    [80, 104, 225, 255],\n    [232, 93, 73, 255],\n    [119, 186, 147, 255],\n    [170, 112, 193, 255],\n    [200, 200, 105, 255],\n    [97, 175, 208, 255],\n    [215, 90, 142, 255],\n    [100, 222, 83, 255],\n    [101, 76, 229, 255],\n    [183, 150, 122, 255],\n    [115, 190, 171, 255],\n    [197, 108, 194, 255],\n    [170, 205, 100, 255],\n    [93, 138, 212, 255],\n    [219, 86, 97, 255],\n    [79, 226, 110, 255],\n    [153, 72, 233, 255],\n    [187, 173, 118, 255],\n    [111, 187, 194, 255],\n    [201, 104, 165, 255],\n    [134, 209, 96, 255],\n    [89, 95, 216, 255],\n    [223, 117, 82, 255],\n    [75, 230, 159, 255],\n    [174, 121, 184, 255],\n    [182, 191, 114, 255],\n    [107, 160, 198, 255],\n    [206, 99, 130, 255],\n    [92, 213, 92, 255],\n    [124, 85, 220, 255],\n    [227, 165, 78, 255],\n    [71, 234, 214, 255],\n    [188, 117, 176, 255],\n    [156, 195, 110, 255],\n    [103, 128, 202, 255],\n    [210, 100, 95, 255],\n    [88, 217, 131, 255],\n    [170, 81, 224, 255],\n    [231, 218, 74, 255],\n    [120, 172, 185, 255],\n    [192, 113, 153, 255],\n    [125, 199, 106, 255],\n    [107, 98, 207, 255],\n    [214, 137, 91, 255],\n    [84, 221, 175, 255],\n    [222, 77, 228, 255],\n    [194, 235, 70, 255],\n    [116, 149, 189, 255],\n    [196, 109, 123, 255],\n    [101, 204, 114, 255],\n    [143, 94, 211, 255],\n    [218, 180, 87, 255],\n    [80, 225, 225, 255],\n    [232, 73, 186, 255],\n    [147, 186, 119, 255],\n    [112, 122, 193, 255],\n    [200, 121, 105, 255],\n    [97, 208, 148, 255],\n    [184, 90, 215, 255],\n    [216, 222, 83, 255],\n    [76, 178, 229, 255],\n    [183, 122, 145, 255],\n    [121, 190, 115, 255],\n    [126, 108, 197, 255],\n    [205, 153, 100, 255],\n    [93, 212, 187, 255],\n    [219, 86, 208, 255],\n    [171, 226, 79, 255],\n    [72, 126, 233, 255],\n    [187, 118, 121, 255],\n    [111, 194, 132, 255],\n    [157, 104, 201, 255],\n    [209, 190, 96, 255],\n    [89, 200, 216, 255],\n    [223, 82, 164, 255],\n    [120, 230, 75, 255],\n    [121, 121, 184, 255],\n    [191, 136, 114, 255],\n    [107, 198, 160, 255],\n    [192, 99, 206, 255],\n    [193, 213, 92, 255],\n    [85, 158, 220, 255],\n    [227, 78, 115, 255],\n    [71, 234, 78, 255],\n    [141, 117, 188, 255],\n    [195, 163, 110, 255],\n    [103, 202, 194, 255],\n    [210, 95, 186, 255],\n    [153, 217, 88, 255],\n    [81, 111, 224, 255],\n];\nexport default CORNERSTONE_COLOR_LUT;\n","const DEFINED_CURSORS = Symbol('DefinedCursors');\nconst STANDARD_CURSORS = new Set([\n    'alias',\n    'all-scroll',\n    'auto',\n    'cell',\n    'col-resize',\n    'context-menu',\n    'copy',\n    'crosshair',\n    'default',\n    'e-resize',\n    'ew-resize',\n    'grab',\n    'grabbing',\n    'help',\n    'move',\n    'ne-resize',\n    'nesw-resize',\n    'no-drop',\n    'none',\n    'not-allowed',\n    'n-resize',\n    'ns-resize',\n    'nw-resize',\n    'nwse-resize',\n    'pointer',\n    'progress',\n    'row-resize',\n    'se-resize',\n    's-resize',\n    'sw-resize',\n    'text',\n    'vertical-text',\n    'wait',\n    'w-resize',\n    'zoom-in',\n    'zoom-out',\n]);\nexport default class MouseCursor {\n    constructor(name, fallback) {\n        this.name = name + '';\n        this.fallback = fallback;\n    }\n    getName() {\n        return this.name + '';\n    }\n    addFallbackStyleProperty(style) {\n        const { fallback } = this;\n        if (fallback instanceof MouseCursor) {\n            return `${style}, ${fallback.getStyleProperty()}`;\n        }\n        return style + '';\n    }\n    getStyleProperty() {\n        return this.addFallbackStyleProperty(this.name) + '';\n    }\n    static getDefinedCursor(name) {\n        const definedCursors = getDefinedCursors(MouseCursor, DEFINED_CURSORS);\n        let mouseCursor = definedCursors.get(name);\n        if (mouseCursor instanceof MouseCursor) {\n            return mouseCursor;\n        }\n        if (STANDARD_CURSORS.has(name)) {\n            mouseCursor = new MouseCursor(name);\n            definedCursors.set(name, mouseCursor);\n            return mouseCursor;\n        }\n    }\n    static setDefinedCursor(name, cursor) {\n        if (cursor instanceof MouseCursor) {\n            const definedCursors = getDefinedCursors(MouseCursor, DEFINED_CURSORS);\n            definedCursors.set(name, cursor);\n            return true;\n        }\n        return false;\n    }\n}\nfunction getDefinedCursors(context, symbol) {\n    let definedCursors = context[symbol];\n    if (!(definedCursors instanceof Map)) {\n        definedCursors = new Map();\n        Object.defineProperty(context, symbol, { value: definedCursors });\n    }\n    return definedCursors;\n}\nconst standardCursorNames = STANDARD_CURSORS.values();\nexport { standardCursorNames };\n","import MouseCursor from './MouseCursor';\nconst ELEMENT_CURSORS_MAP = Symbol('ElementCursorsMap');\nfunction initElementCursor(element, cursor) {\n    _getElementCursors(element)[0] = cursor;\n    _setElementCursor(element, cursor);\n}\nfunction _setElementCursor(element, cursor) {\n    const cursors = _getElementCursors(element);\n    cursors[1] = cursors[0];\n    cursors[0] = cursor;\n    element.style.cursor = (cursor instanceof MouseCursor\n        ? cursor\n        : MouseCursor.getDefinedCursor('auto')).getStyleProperty();\n}\nfunction resetElementCursor(element) {\n    _setElementCursor(element, _getElementCursors(element)[1]);\n}\nfunction hideElementCursor(element) {\n    _setElementCursor(element, MouseCursor.getDefinedCursor('none'));\n}\nfunction _getElementCursors(element) {\n    let map = _getElementCursors[ELEMENT_CURSORS_MAP];\n    if (!(map instanceof WeakMap)) {\n        map = new WeakMap();\n        Object.defineProperty(_getElementCursors, ELEMENT_CURSORS_MAP, {\n            value: map,\n        });\n    }\n    let cursors = map.get(element);\n    if (!cursors) {\n        cursors = [null, null];\n        map.set(element, cursors);\n    }\n    return cursors;\n}\nexport { initElementCursor, resetElementCursor, hideElementCursor, _setElementCursor as setElementCursor, };\n","import { utilities } from '@cornerstonejs/core';\nimport MouseCursor from './MouseCursor';\nconst DEFAULT_NAME = 'image-cursor';\nexport default class ImageMouseCursor extends MouseCursor {\n    constructor(url, x, y, name, fallback) {\n        super(name || ImageMouseCursor.getUniqueInstanceName(DEFAULT_NAME), fallback);\n        this.url = url;\n        this.x = Number(x) || 0;\n        this.y = Number(y) || 0;\n    }\n    getStyleProperty() {\n        const { url, x, y } = this;\n        let style = `url('${url}')`;\n        if (x >= 0 && y >= 0 && (x > 0 || y > 0)) {\n            style += ` ${x} ${y}`;\n        }\n        return this.addFallbackStyleProperty(style);\n    }\n    static getUniqueInstanceName(prefix) {\n        return `${prefix}-${utilities.getRuntimeId(ImageMouseCursor)}`;\n    }\n}\n","const BASE = {\n    iconContent: '',\n    iconSize: 16,\n    viewBox: {\n        x: 16,\n        y: 16,\n    },\n    mousePoint: {\n        x: 8,\n        y: 8,\n    },\n    mousePointerGroupString: `\n    <path stroke=\"{{color}}\" d=\"M8 16L8 0\"></path>\n    <path stroke=\"{{color}}\" d=\"M16 8L0 8\"></path>\n  `,\n};\nconst SEGMENTATION_CURSOR_BOUNDARIES = {\n    x: 127,\n    y: 60,\n};\nconst MINUS_RECT = `\n<rect fill=\"{{color}}\" x=\"80.19\" y=\"25.03\" width=\"47.14\" height=\"15.85\"/>\n`;\nconst PLUS_RECT = `\n<rect fill=\"{{color}}\" x=\"80.19\" y=\"25.03\" width=\"47.14\" height=\"15.85\"/>\n<rect fill=\"{{color}}\" x=\"95.84\" y=\"9.38\" width=\"15.85\" height=\"47.14\"/>\n`;\nconst SCISSOR_ICON = `<path fill=\"{{color}}\" d=\"M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z\" transform=\"translate(-1.17 -0.96)\"/>`;\nconst RECTANGLE_ICON = `<path fill=\"{{color}}\" d=\"M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z\" transform=\"translate(-8.86 -2.25)\"/>`;\nconst CIRCLE_ICON = `<path fill=\"{{color}}\" d=\"M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z\" transform=\"translate(-8.86 -2.25)\"/>`;\nconst CursorSVG = {\n    Angle: extend(BASE, {\n        name: 'Angle',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n    50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n    10l50 50q10 10 10 23z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    ArrowAnnotate: extend(BASE, {\n        name: 'ArrowAnnotate',\n        iconContent: `<g id=\"arrowAnnotate-group\" fill=\"none\" stroke-width=\"1\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"arrowAnnotate-arrow\" d=\"M23,7 l-15,15 M7,17 l0,6 6,0\" stroke-width=\"2\" />\n  </g>`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Bidirectional: extend(BASE, {\n        name: 'Bidirectional',\n        iconContent: `<g fill=\"{{color}}\" stroke-width=\"3\" stroke=\"{{color}}\">\n    <path d=\"M27.63 3.21L3.12 28.81\"></path>\n    <path d=\"M27.63 15.75L15.27 4.43\"></path>\n    <path d=\"M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z\" ></path>\n    <path d=\"M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z\"></path>\n    <path d=\"M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z\"></path>\n    <path d=\"M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z\"></path>\n  </g>`,\n        viewBox: {\n            x: 48,\n            y: 48,\n        },\n    }),\n    CobbAngle: extend(BASE, {\n        name: 'CobbAngle',\n        iconContent: `<g stroke=\"{{color}}\" stroke-width=\"3\">\n    <path d=\"M28.59 2.34L3.82 12.32\"></path>\n    <path d=\"M28.59 29.66L3.82 19.68\"></path>\n    <path stroke-dasharray=\"2\" fill-opacity=\"0\" d=\"M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63\">\n    </path>\n  </g>`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    CircleROI: extend(BASE, {\n        name: 'CircleROI',\n        iconContent: `<circle stroke=\"{{color}}\" fill=\"none\" stroke-width=\"3\" cx=\"16\" cy=\"16\" r=\"14\" />`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    EllipticalROI: extend(BASE, {\n        name: 'EllipticalROI',\n        iconContent: `<path stroke=\"{{color}}\" fill=\"none\" stroke-width=\"3\" d=\"M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z\" />`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    FreehandROI: extend(BASE, {\n        name: 'FreehandROI',\n        iconContent: `<g fill=\"{{color}}\" stroke=\"{{color}}\" stroke-width=\"2\">\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_3\" cy=\"4.240343\" cx=\"14.306499\"/>\n    <line id=\"svg_4\" y2=\"3.58462\" x2=\"12.242186\" y1=\"3.997482\" x1=\"13.432202\"/>\n    <line id=\"svg_5\" y2=\"3.268901\" x2=\"10.857882\" y1=\"3.608906\" x1=\"12.387902\"/>\n    <line id=\"svg_6\" y2=\"3.147471\" x2=\"9.740724\" y1=\"3.293187\" x1=\"10.955026\"/>\n    <line id=\"svg_7\" y2=\"3.147471\" x2=\"8.089274\" y1=\"3.196043\" x1=\"9.983585\"/>\n    <line id=\"svg_8\" y2=\"3.268901\" x2=\"6.874972\" y1=\"3.123185\" x1=\"8.307848\"/>\n    <line id=\"svg_9\" y2=\"3.657478\" x2=\"5.587812\" y1=\"3.220329\" x1=\"7.020688\"/>\n    <line id=\"svg_10\" y2=\"4.046054\" x2=\"4.737801\" y1=\"3.560334\" x1=\"5.854959\"/>\n    <line id=\"svg_11\" y2=\"4.337487\" x2=\"4.300652\" y1=\"3.997482\" x1=\"4.834945\"/>\n    <line id=\"svg_12\" y2=\"4.726063\" x2=\"3.88779\" y1=\"4.191771\" x1=\"4.470655\"/>\n    <line id=\"svg_15\" y2=\"5.3575\" x2=\"3.377783\" y1=\"4.604633\" x1=\"3.960648\"/>\n    <line id=\"svg_16\" y2=\"6.183226\" x2=\"2.916348\" y1=\"5.138926\" x1=\"3.547785\"/>\n    <line id=\"svg_17\" y2=\"6.960379\" x2=\"2.770632\" y1=\"5.867507\" x1=\"3.037779\"/>\n    <line id=\"svg_18\" y2=\"7.713246\" x2=\"2.673488\" y1=\"6.741804\" x1=\"2.819204\"/>\n    <line id=\"svg_19\" y2=\"8.684687\" x2=\"2.697774\" y1=\"7.616102\" x1=\"2.673488\"/>\n    <line id=\"svg_20\" y2=\"9.753273\" x2=\"2.892062\" y1=\"8.611829\" x1=\"2.697774\"/>\n    <line id=\"svg_21\" y2=\"10.724714\" x2=\"3.134923\" y1=\"9.534698\" x1=\"2.84349\"/>\n    <line id=\"svg_23\" y2=\"11.647583\" x2=\"3.596357\" y1=\"10.578998\" x1=\"3.086351\"/>\n    <line id=\"svg_25\" y2=\"12.521881\" x2=\"4.276366\" y1=\"11.501867\" x1=\"3.499213\"/>\n    <line id=\"svg_26\" y2=\"13.930471\" x2=\"5.830673\" y1=\"12.376165\" x1=\"4.13065\"/>\n    <line id=\"svg_28\" y2=\"14.707624\" x2=\"7.263549\" y1=\"13.881899\" x1=\"5.733528\"/>\n    <line id=\"svg_29\" y2=\"15.339061\" x2=\"8.963571\" y1=\"14.61048\" x1=\"7.06926\"/>\n    <line id=\"svg_30\" y2=\"15.581921\" x2=\"10.882168\" y1=\"15.314775\" x1=\"8.817855\"/>\n    <line id=\"svg_31\" y2=\"15.460491\" x2=\"12.023612\" y1=\"15.581921\" x1=\"10.785024\"/>\n    <line id=\"svg_33\" y2=\"15.120487\" x2=\"13.092197\" y1=\"15.484777\" x1=\"11.877895\"/>\n    <line id=\"svg_34\" y2=\"14.586194\" x2=\"13.86935\" y1=\"15.217631\" x1=\"12.897909\"/>\n    <line id=\"svg_35\" y2=\"13.833327\" x2=\"14.597931\" y1=\"14.756196\" x1=\"13.699348\"/>\n    <line id=\"svg_37\" y2=\"12.716169\" x2=\"15.180796\" y1=\"13.881899\" x1=\"14.549359\"/>\n    <line id=\"svg_39\" y2=\"11.429009\" x2=\"15.520801\" y1=\"12.813313\" x1=\"15.15651\"/>\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_40\" cy=\"10.967574\" cx=\"15.520801\"/>\n  </g>`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    FreehandROISculptor: extend(BASE, {\n        name: 'FreehandROISculptor',\n        iconContent: `<g id=\"icon-freehand-sculpt\" fill=\"none\" stroke-width=\"1.5\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <line id=\"svg_1\" y2=\"2.559367\" x2=\"10.184807\" y1=\"4.467781\" x1=\"8.81711\"/>\n    <line id=\"svg_4\" y2=\"1.493836\" x2=\"11.727442\" y1=\"2.766112\" x1=\"10.089386\"/>\n    <line id=\"svg_7\" y2=\"1.080346\" x2=\"13.047428\" y1=\"1.748291\" x1=\"11.345759\"/>\n    <line id=\"svg_8\" y2=\"1.000829\" x2=\"14.351511\" y1=\"1.112153\" x1=\"12.77707\"/>\n    <line id=\"svg_9\" y2=\"1.350705\" x2=\"15.242104\" y1=\"0.905408\" x1=\"13.969828\"/>\n    <line id=\"svg_10\" y2=\"2.098167\" x2=\"15.862339\" y1=\"1.14396\" x1=\"14.955842\"/>\n    <line id=\"svg_11\" y2=\"3.195505\" x2=\"16.41896\" y1=\"1.939133\" x1=\"15.766918\"/>\n    <line id=\"svg_12\" y2=\"4.292843\" x2=\"16.530284\" y1=\"2.925147\" x1=\"16.387153\"/>\n    <line id=\"svg_16\" y2=\"5.644637\" x2=\"16.196311\" y1=\"3.831643\" x1=\"16.593898\"/>\n    <line id=\"svg_18\" y2=\"7.266789\" x2=\"15.623787\" y1=\"5.19934\" x1=\"16.275829\"/>\n    <line id=\"svg_19\" y2=\"10.813258\" x2=\"14.526449\" y1=\"6.726071\" x1=\"15.766918\"/>\n    <line id=\"svg_20\" y2=\"5.056209\" x2=\"8.085552\" y1=\"4.181519\" x1=\"8.976145\"/>\n    <line id=\"svg_23\" y2=\"5.326568\" x2=\"7.481221\" y1=\"4.78585\" x1=\"8.403621\"/>\n    <line id=\"svg_24\" y2=\"5.565119\" x2=\"6.749662\" y1=\"5.294761\" x1=\"7.624352\"/>\n    <line id=\"svg_25\" y2=\"5.994512\" x2=\"5.429675\" y1=\"5.533312\" x1=\"6.956407\"/>\n    <line id=\"svg_27\" y2=\"6.551133\" x2=\"4.284627\" y1=\"5.962706\" x1=\"5.572807\"/>\n    <line id=\"svg_28\" y2=\"7.584858\" x2=\"3.044158\" y1=\"6.392099\" x1=\"4.427758\"/>\n    <line id=\"svg_29\" y2=\"8.84123\" x2=\"2.185372\" y1=\"7.489437\" x1=\"3.219096\"/>\n    <line id=\"svg_31\" y2=\"10.606513\" x2=\"1.644654\" y1=\"8.602678\" x1=\"2.280792\"/>\n    <line id=\"svg_32\" y2=\"13.214679\" x2=\"1.48562\" y1=\"10.352058\" x1=\"1.724171\"/>\n    <line id=\"svg_33\" y2=\"14.375631\" x2=\"1.676461\" y1=\"12.992031\" x1=\"1.453813\"/>\n    <line id=\"svg_34\" y2=\"15.298031\" x2=\"2.264889\" y1=\"14.152983\" x1=\"1.517427\"/>\n    <line id=\"svg_35\" y2=\"16.172721\" x2=\"3.521261\" y1=\"14.948155\" x1=\"1.915013\"/>\n    <line id=\"svg_36\" y2=\"16.824762\" x2=\"5.207027\" y1=\"15.997783\" x1=\"3.28271\"/>\n    <line id=\"svg_38\" y2=\"17.063314\" x2=\"7.035924\" y1=\"16.745245\" x1=\"4.968475\"/>\n    <line id=\"svg_39\" y2=\"16.888376\" x2=\"9.278311\" y1=\"17.047411\" x1=\"6.733758\"/>\n    <line id=\"svg_40\" y2=\"16.284045\" x2=\"10.661911\" y1=\"16.983797\" x1=\"8.992048\"/>\n    <line id=\"svg_41\" y2=\"15.313934\" x2=\"11.647925\" y1=\"16.395369\" x1=\"10.455166\"/>\n    <line id=\"svg_44\" y2=\"13.898527\" x2=\"12.82478\" y1=\"15.425259\" x1=\"11.504794\"/>\n    <line id=\"svg_45\" y2=\"12.037824\" x2=\"14.144766\" y1=\"14.312017\" x1=\"12.522614\"/>\n    <line id=\"svg_47\" y2=\"10.59061\" x2=\"14.605966\" y1=\"12.228665\" x1=\"13.953925\"/>\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_48\" cy=\"3.982726\" cx=\"13.460918\"/>\n  </g>`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    Length: extend(BASE, {\n        name: 'Length',\n        iconContent: `<g id=\"length-group\" fill=\"none\" stroke-width=\"1\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"length-dashes\" d=\"m22.5,6 -16.5,16.5\" stroke-width=\"3\" stroke-dasharray=\"0.6666,5\" />\n  </g>`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Height: extend(BASE, {\n        name: 'Height',\n        iconContent: `<path d=\"m 6 22 l 8.5 0 v -16 h 8\" stroke-width=\"3\" fill=\"none\" stroke=\"{{color}}\" />`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Probe: extend(BASE, {\n        name: 'Probe',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    RectangleROI: extend(BASE, {\n        name: 'RectangleROI',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    TextMarker: extend(BASE, {\n        name: 'TextMarker',\n        iconContent: `<path fill=\"{{color}}\" d=\"M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Crosshairs: extend(BASE, {\n        name: 'Crosshairs',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Eraser: extend(BASE, {\n        name: 'Eraser',\n        iconContent: `<path transform=\"translate(0,1792) scale(1,-1)\" fill=\"{{color}}\" d=\"M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n    34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n    0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n    0 69.5 20.5t47.5 54.5z\" />`,\n        viewBox: {\n            x: 2048,\n            y: 1792,\n        },\n    }),\n    Magnify: extend(BASE, {\n        name: 'Magnify',\n        iconContent: `<path fill=\"{{color}}\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z\" />`,\n        viewBox: {\n            x: 512,\n            y: 512,\n        },\n    }),\n    Pan: extend(BASE, {\n        name: 'Pan',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n    39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n    355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n    39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n    0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n    144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n    45v448q0 42-39 59-13 5-25 5-26 0-45-19z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Rotate: extend(BASE, {\n        name: 'Rotate',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n    14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n    163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n    225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n    132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n    164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n    39 17 39 59z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    StackScroll: extend(BASE, {\n        name: 'StackScroll',\n        iconContent: `<path fill=\"{{color}}\" d=\"M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n    0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n    0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z\" />`,\n        viewBox: {\n            x: 24,\n            y: 28,\n        },\n    }),\n    WindowLevelRegion: extend(BASE, {\n        name: 'WindowLevelRegion',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    WindowLevel: extend(BASE, {\n        name: 'WindowLevel',\n        iconContent: `\n    <path fill=\"{{color}}\" d=\"M14.5,3.5 a1 1 0 0 1 -11,11 Z\" stroke=\"none\" opacity=\"0.8\" />\n    <circle cx=\"9\" cy=\"9\" r=\"8\" fill=\"none\" stroke-width=\"2\" stroke=\"{{color}}\" />`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    Zoom: extend(BASE, {\n        name: 'Zoom',\n        iconContent: `\n  <path fill=\"{{color}}\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z\" />\n  <path fill=\"{{color}}\" transform=\"scale(0.22,0.22) translate(1400,0)\" d=\"M1216\n    320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n    19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n    0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z\" />`,\n        viewBox: {\n            x: 640,\n            y: 512,\n        },\n    }),\n    SegmentationFreeHandEraseInside: extend(BASE, {\n        name: 'SegmentationFreeHandEraseInside',\n        iconContent: `${SCISSOR_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandFillInside: extend(BASE, {\n        name: 'SegmentationFreeHandFillInside',\n        iconContent: `${SCISSOR_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandEraseOutside: extend(BASE, {\n        name: 'SegmentationFreeHandEraseOutside',\n        iconContent: `${SCISSOR_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandFillOutside: extend(BASE, {\n        name: 'SegmentationFreeHandFillOutside',\n        iconContent: `${SCISSOR_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationRectangleEraseInside: extend(BASE, {\n        name: 'SegmentationRectangleEraseInside',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    RectangleScissor: extend(BASE, {\n        name: 'RectangleScissor',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.FILL_INSIDE': extend(BASE, {\n        name: 'RectangleScissor.FILL_INSIDE',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.FILL_OUTSIDE': extend(BASE, {\n        name: 'RectangleScissor.FILL_OUTSIDE',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.ERASE_OUTSIDE': extend(BASE, {\n        name: 'RectangleScissor.ERASE_OUTSIDE',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.ERASE_INSIDE': extend(BASE, {\n        name: 'RectangleScissor.ERASE_INSIDE',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    CircleScissor: extend(BASE, {\n        name: 'CircleScissor',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.FILL_INSIDE': extend(BASE, {\n        name: 'CircleScissor.FILL_INSIDE',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.ERASE_OUTSIDE': extend(BASE, {\n        name: 'CircleScissor.ERASE_OUTSIDE',\n        iconContent: `${CIRCLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.FILL_OUTSIDE': extend(BASE, {\n        name: 'CircleScissor.FILL_OUTSIDE',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n};\nfunction extend(base, values) {\n    return Object.assign(Object.create(base), {\n        ...values,\n        name: values.name || base.name,\n    });\n}\nfunction registerCursor(toolName, iconContent, viewBox) {\n    CursorSVG[toolName] = extend(BASE, {\n        iconContent,\n        viewBox,\n    });\n}\nfunction getDefinedSVGCursorDescriptor(name) {\n    return CursorSVG[name];\n}\nconst svgCursorNames = Object.keys(CursorSVG);\nexport { getDefinedSVGCursorDescriptor, registerCursor, svgCursorNames, CursorSVG, };\n","import { ToolModes, AnnotationStyleStates } from '../enums';\nimport ImageMouseCursor from './ImageMouseCursor';\nimport { getDefinedSVGCursorDescriptor } from './SVGCursorDescriptor';\nimport { getStyleProperty } from '../stateManagement/annotation/config/helpers';\nconst PROPERTY = 'color';\nconst STATE = AnnotationStyleStates.Highlighted;\nconst MODE = ToolModes.Active;\nexport default class SVGMouseCursor extends ImageMouseCursor {\n    constructor(url, x, y, name, fallback) {\n        super(url, x, y, name, fallback);\n    }\n    static getDefinedCursor(name, pointer = false, color) {\n        if (!color) {\n            color = getStyleProperty(PROPERTY, {}, STATE, MODE);\n        }\n        const urn = getCursorURN(name, pointer, color);\n        let cursor = super.getDefinedCursor(urn);\n        if (!cursor) {\n            const descriptor = getDefinedSVGCursorDescriptor(name);\n            if (descriptor) {\n                cursor = createSVGMouseCursor(descriptor, urn, pointer, color, super.getDefinedCursor('default'));\n                super.setDefinedCursor(urn, cursor);\n            }\n        }\n        return cursor;\n    }\n}\nfunction format(template, dictionary) {\n    const dict = Object(dictionary);\n    const defined = Object.prototype.hasOwnProperty.bind(dict);\n    return (template + '').replace(/\\{\\{(\\w+)\\}\\}/g, (match, key) => {\n        return defined(key) ? dict[key] + '' : '';\n    });\n}\nfunction getCursorURN(name, pointer, color) {\n    const type = pointer ? 'pointer' : 'cursor';\n    return `${type}:${name}/${color}`;\n}\nfunction createSVGMouseCursor(descriptor, name, pointer, color, fallback) {\n    const { x, y } = descriptor.mousePoint;\n    return new SVGMouseCursor(createSVGIconUrl(descriptor, pointer, { color }), x, y, name, fallback);\n}\nfunction createSVGIconUrl(descriptor, pointer, options) {\n    const blob = createSVGIconBlob(descriptor, pointer, options);\n    const url = URL.createObjectURL(blob);\n    const urn = `${url}#${descriptor.name || 'unknown'}-${pointer ? 'pointer' : 'cursor'}`;\n    return urn;\n}\nfunction createSVGIconBlob(descriptor, pointer, options) {\n    const svgString = (pointer ? createSVGIconWithPointer : createSVGIcon)(descriptor, options);\n    return new Blob([svgString], { type: 'image/svg+xml' });\n}\nfunction createSVGIcon(descriptor, options) {\n    const { iconContent, iconSize, viewBox } = descriptor;\n    const svgString = `\n    <svg data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"${iconSize}\" height=\"${iconSize}\" viewBox=\"0 0\n      ${viewBox.x} ${viewBox.y}\">\n      ${iconContent}\n    </svg>`;\n    return format(svgString, options);\n}\nfunction createSVGIconWithPointer(descriptor, options) {\n    const { iconContent, iconSize, viewBox, mousePointerGroupString } = descriptor;\n    const scale = iconSize / Math.max(viewBox.x, viewBox.y, 1);\n    const svgSize = 16 + iconSize;\n    const svgString = `\n    <svg data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"${svgSize}\" height=\"${svgSize}\" viewBox=\"0 0 ${svgSize} ${svgSize}\">\n      <g>${mousePointerGroupString}</g>\n      <g transform=\"translate(16, 16) scale(${scale})\">${iconContent}</g>\n    </svg>`;\n    return format(svgString, options);\n}\n","import { setElementCursor } from './elementCursor';\nimport MouseCursor from './MouseCursor';\nimport SVGMouseCursor from './SVGMouseCursor';\nfunction setCursorForElement(element, cursorName) {\n    let cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n    if (!cursor) {\n        cursor = MouseCursor.getDefinedCursor(cursorName);\n    }\n    if (!cursor) {\n        console.log(`Cursor ${cursorName} is not defined either as SVG or as a standard cursor.`);\n        cursor = MouseCursor.getDefinedCursor(cursorName);\n    }\n    setElementCursor(element, cursor);\n}\nexport default setCursorForElement;\n","import MouseCursor, { standardCursorNames } from './MouseCursor';\nimport ImageMouseCursor from './ImageMouseCursor';\nimport SVGMouseCursor from './SVGMouseCursor';\nimport * as elementCursor from './elementCursor';\nimport setCursorForElement from './setCursorForElement';\nimport { registerCursor, svgCursorNames, CursorSVG, } from './SVGCursorDescriptor';\nconst CursorNames = [...svgCursorNames, ...standardCursorNames];\nexport { MouseCursor, ImageMouseCursor, SVGMouseCursor, elementCursor, registerCursor, CursorNames, CursorSVG, setCursorForElement, };\n","import { state } from '../store/state';\nimport { getEnabledElement } from '@cornerstonejs/core';\nconst VIEWPORT_ELEMENT = 'viewport-element';\nfunction getSvgDrawingHelper(element) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId, renderingEngineId } = enabledElement;\n    const canvasHash = `${viewportId}:${renderingEngineId}`;\n    const svgLayerElement = _getSvgLayer(element);\n    Object.keys(state.svgNodeCache[canvasHash]).forEach((cacheKey) => {\n        state.svgNodeCache[canvasHash][cacheKey].touched = false;\n    });\n    return {\n        svgLayerElement: svgLayerElement,\n        svgNodeCacheForCanvas: state.svgNodeCache,\n        getSvgNode: getSvgNode.bind(this, canvasHash),\n        appendNode: appendNode.bind(this, svgLayerElement, canvasHash),\n        setNodeTouched: setNodeTouched.bind(this, canvasHash),\n        clearUntouched: clearUntouched.bind(this, svgLayerElement, canvasHash),\n    };\n}\nfunction _getSvgLayer(element) {\n    const viewportElement = `.${VIEWPORT_ELEMENT}`;\n    const internalDivElement = element.querySelector(viewportElement);\n    const svgLayer = internalDivElement?.querySelector(':scope > .svg-layer');\n    return svgLayer;\n}\nfunction getSvgNode(canvasHash, cacheKey) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return;\n    }\n    if (state.svgNodeCache[canvasHash][cacheKey]) {\n        return state.svgNodeCache[canvasHash][cacheKey].domRef;\n    }\n}\nfunction appendNode(svgLayerElement, canvasHash, svgNode, cacheKey) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return null;\n    }\n    state.svgNodeCache[canvasHash][cacheKey] = {\n        touched: true,\n        domRef: svgNode,\n    };\n    svgLayerElement.appendChild(svgNode);\n}\nfunction setNodeTouched(canvasHash, cacheKey) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return;\n    }\n    if (state.svgNodeCache[canvasHash][cacheKey]) {\n        state.svgNodeCache[canvasHash][cacheKey].touched = true;\n    }\n}\nfunction clearUntouched(svgLayerElement, canvasHash) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return;\n    }\n    Object.keys(state.svgNodeCache[canvasHash]).forEach((cacheKey) => {\n        const cacheEntry = state.svgNodeCache[canvasHash][cacheKey];\n        if (!cacheEntry.touched && cacheEntry.domRef) {\n            svgLayerElement.removeChild(cacheEntry.domRef);\n            delete state.svgNodeCache[canvasHash][cacheKey];\n        }\n    });\n}\nexport default getSvgDrawingHelper;\n","import getSvgDrawingHelper from './getSvgDrawingHelper';\nfunction draw(element, fn) {\n    const svgDrawingHelper = getSvgDrawingHelper(element);\n    fn(svgDrawingHelper);\n    svgDrawingHelper.clearUntouched();\n}\nexport default draw;\n","export function setAttributesIfNecessary(attributes, svgNode) {\n    Object.keys(attributes).forEach((key) => {\n        const currentValue = svgNode.getAttribute(key);\n        const newValue = attributes[key];\n        if (newValue === undefined || newValue === '') {\n            svgNode.removeAttribute(key);\n        }\n        else if (currentValue !== newValue) {\n            svgNode.setAttribute(key, newValue);\n        }\n    });\n}\nexport default setAttributesIfNecessary;\n","export function setNewAttributesIfValid(attributes, svgNode) {\n    Object.keys(attributes).forEach((key) => {\n        const newValue = attributes[key];\n        if (newValue !== undefined && newValue !== '') {\n            svgNode.setAttribute(key, newValue);\n        }\n    });\n}\nexport default setNewAttributesIfValid;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nfunction drawCircle(svgDrawingHelper, annotationUID, circleUID, center, radius, options = {}, dataId = '') {\n    const { color, fill, width, lineWidth, lineDash, fillOpacity, strokeOpacity, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        fill: 'transparent',\n        width: '2',\n        lineDash: undefined,\n        lineWidth: undefined,\n        strokeOpacity: 1,\n        fillOpacity: 1,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'circle', circleUID);\n    const existingCircleElement = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const attributes = {\n        cx: `${center[0]}`,\n        cy: `${center[1]}`,\n        r: `${radius}`,\n        stroke: color,\n        fill,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n        'fill-opacity': fillOpacity,\n        'stroke-opacity': strokeOpacity,\n    };\n    if (existingCircleElement) {\n        setAttributesIfNecessary(attributes, existingCircleElement);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newCircleElement = document.createElementNS(svgns, 'circle');\n        if (dataId !== '') {\n            newCircleElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, newCircleElement);\n        svgDrawingHelper.appendNode(newCircleElement, svgNodeHash);\n    }\n}\nexport default drawCircle;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nfunction drawEllipseByCoordinates(svgDrawingHelper, annotationUID, ellipseUID, canvasCoordinates, options = {}, dataId = '') {\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'ellipse', ellipseUID);\n    const existingEllipse = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const [bottom, top, left, right] = canvasCoordinates;\n    const w = Math.hypot(left[0] - right[0], left[1] - right[1]);\n    const h = Math.hypot(top[0] - bottom[0], top[1] - bottom[1]);\n    const angle = (Math.atan2(left[1] - right[1], left[0] - right[0]) * 180) / Math.PI;\n    const center = [(left[0] + right[0]) / 2, (top[1] + bottom[1]) / 2];\n    const radiusX = w / 2;\n    const radiusY = h / 2;\n    const attributes = {\n        cx: `${center[0]}`,\n        cy: `${center[1]}`,\n        rx: `${radiusX}`,\n        ry: `${radiusY}`,\n        stroke: color,\n        fill: 'transparent',\n        transform: `rotate(${angle} ${center[0]} ${center[1]})`,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingEllipse) {\n        setAttributesIfNecessary(attributes, existingEllipse);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgEllipseElement = document.createElementNS(svgns, 'ellipse');\n        if (dataId !== '') {\n            svgEllipseElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, svgEllipseElement);\n        svgDrawingHelper.appendNode(svgEllipseElement, svgNodeHash);\n    }\n}\nexport default drawEllipseByCoordinates;\n","import _getHash from './_getHash';\nimport drawEllipseByCoordinates from './drawEllipseByCoordinates';\nfunction drawEllipse(svgDrawingHelper, annotationUID, ellipseUID, corner1, corner2, options = {}, dataId = '') {\n    const top = [(corner1[0] + corner2[0]) / 2, corner1[1]];\n    const bottom = [(corner1[0] + corner2[0]) / 2, corner2[1]];\n    const left = [corner1[0], (corner1[1] + corner2[1]) / 2];\n    const right = [corner2[0], (corner1[1] + corner2[1]) / 2];\n    drawEllipseByCoordinates(svgDrawingHelper, annotationUID, ellipseUID, [bottom, top, left, right], (options = {}), (dataId = ''));\n}\nexport default drawEllipse;\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nfunction drawHandle(svgDrawingHelper, annotationUID, handleGroupUID, handle, options = {}, uniqueIndex) {\n    const { color, handleRadius, width, lineWidth, fill, type, opacity } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        handleRadius: '6',\n        width: '2',\n        lineWidth: undefined,\n        fill: 'transparent',\n        type: 'circle',\n        opacity: 1,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'handle', `hg-${handleGroupUID}-index-${uniqueIndex}`);\n    let attributes;\n    if (type === 'circle') {\n        attributes = {\n            cx: `${handle[0]}`,\n            cy: `${handle[1]}`,\n            r: handleRadius,\n            stroke: color,\n            fill,\n            'stroke-width': strokeWidth,\n            opacity: opacity,\n        };\n    }\n    else if (type === 'rect') {\n        const handleRadiusFloat = parseFloat(handleRadius);\n        const side = handleRadiusFloat * 1.5;\n        const x = handle[0] - side * 0.5;\n        const y = handle[1] - side * 0.5;\n        attributes = {\n            x: `${x}`,\n            y: `${y}`,\n            width: `${side}`,\n            height: `${side}`,\n            stroke: color,\n            fill,\n            'stroke-width': strokeWidth,\n            rx: `${side * 0.1}`,\n            opacity: opacity,\n        };\n    }\n    else {\n        throw new Error(`Unsupported handle type: ${type}`);\n    }\n    const existingHandleElement = svgDrawingHelper.getSvgNode(svgNodeHash);\n    if (existingHandleElement) {\n        setAttributesIfNecessary(attributes, existingHandleElement);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newHandleElement = document.createElementNS(svgns, type);\n        setNewAttributesIfValid(attributes, newHandleElement);\n        svgDrawingHelper.appendNode(newHandleElement, svgNodeHash);\n    }\n}\nexport default drawHandle;\n","import drawHandle from './drawHandle';\nfunction drawHandles(svgDrawingHelper, annotationUID, handleGroupUID, handlePoints, options = {}) {\n    handlePoints.forEach((handle, i) => {\n        drawHandle(svgDrawingHelper, annotationUID, handleGroupUID, handle, options, i);\n    });\n}\nexport default drawHandles;\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, options = {}, dataId = '') {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash, shadow } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n        shadow: undefined,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'line', lineUID);\n    const existingLine = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const dropShadowStyle = shadow\n        ? `filter:url(#shadow-${svgDrawingHelper.svgLayerElement.id});`\n        : '';\n    const attributes = {\n        x1: `${start[0]}`,\n        y1: `${start[1]}`,\n        x2: `${end[0]}`,\n        y2: `${end[1]}`,\n        stroke: color,\n        style: dropShadowStyle,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingLine) {\n        setAttributesIfNecessary(attributes, existingLine);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newLine = document.createElementNS(svgns, 'line');\n        if (dataId !== '') {\n            newLine.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, newLine);\n        svgDrawingHelper.appendNode(newLine, svgNodeHash);\n    }\n}\n","import drawLine from './drawLine';\nexport default function drawHeight(svgDrawingHelper, annotationUID, heightUID, start, end, options = {}) {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const midX = end[0] + (start[0] - end[0]) / 2;\n    const endfirstLine = [midX, start[1]];\n    const endsecondLine = [midX, end[1]];\n    const firstLine = {\n        start: start,\n        end: endfirstLine,\n    };\n    const secondLine = {\n        start: endfirstLine,\n        end: endsecondLine,\n    };\n    const threeLine = {\n        start: endsecondLine,\n        end: end,\n    };\n    drawLine(svgDrawingHelper, annotationUID, '1', firstLine.start, firstLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '2', secondLine.start, secondLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '3', threeLine.start, threeLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n}\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawPolyline(svgDrawingHelper, annotationUID, polylineUID, points, options) {\n    if (points.length < 2) {\n        return;\n    }\n    const { color = 'rgb(0, 255, 0)', width = 10, fillColor = 'none', fillOpacity = 0, lineWidth, lineDash, closePath = false, } = options;\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'polyline', polylineUID);\n    const existingPolyLine = svgDrawingHelper.getSvgNode(svgNodeHash);\n    let pointsAttribute = '';\n    for (const point of points) {\n        pointsAttribute += `${point[0].toFixed(1)}, ${point[1].toFixed(1)} `;\n    }\n    if (closePath) {\n        const firstPoint = points[0];\n        pointsAttribute += `${firstPoint[0]}, ${firstPoint[1]}`;\n    }\n    const attributes = {\n        points: pointsAttribute,\n        stroke: color,\n        fill: fillColor,\n        'fill-opacity': fillOpacity,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingPolyLine) {\n        setAttributesIfNecessary(attributes, existingPolyLine);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newPolyLine = document.createElementNS(svgns, 'polyline');\n        setNewAttributesIfValid(attributes, newPolyLine);\n        svgDrawingHelper.appendNode(newPolyLine, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawPath(svgDrawingHelper, annotationUID, pathUID, points, options) {\n    const hasSubArrays = points.length && points[0].length && Array.isArray(points[0][0]);\n    const pointsArrays = hasSubArrays ? points : [points];\n    const { color = 'rgb(0, 255, 0)', width = 10, fillColor = 'none', fillOpacity = 0, lineWidth, lineDash, closePath = false, } = options;\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'path', pathUID);\n    const existingNode = svgDrawingHelper.getSvgNode(svgNodeHash);\n    let pointsAttribute = '';\n    for (let i = 0, numArrays = pointsArrays.length; i < numArrays; i++) {\n        const points = pointsArrays[i];\n        const numPoints = points.length;\n        if (numPoints < 2) {\n            continue;\n        }\n        for (let j = 0; j < numPoints; j++) {\n            const point = points[j];\n            const cmd = j ? 'L' : 'M';\n            pointsAttribute += `${cmd} ${point[0].toFixed(1)}, ${point[1].toFixed(1)} `;\n        }\n        if (closePath) {\n            pointsAttribute += 'Z ';\n        }\n    }\n    if (!pointsAttribute) {\n        return;\n    }\n    const attributes = {\n        d: pointsAttribute,\n        stroke: color,\n        fill: fillColor,\n        'fill-opacity': fillOpacity,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingNode) {\n        setAttributesIfNecessary(attributes, existingNode);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newNode = document.createElementNS(svgns, 'path');\n        setNewAttributesIfValid(attributes, newNode);\n        svgDrawingHelper.appendNode(newNode, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nfunction drawTextBox(svgDrawingHelper, annotationUID, textUID, textLines, position, options = {}) {\n    const mergedOptions = Object.assign({\n        fontFamily: 'Helvetica, Arial, sans-serif',\n        fontSize: '14px',\n        color: 'rgb(255, 255, 0)',\n        background: '',\n        padding: 25,\n        centerX: false,\n        centerY: true,\n    }, options);\n    const textGroupBoundingBox = _drawTextGroup(svgDrawingHelper, annotationUID, textUID, textLines, position, mergedOptions);\n    return textGroupBoundingBox;\n}\nfunction _drawTextGroup(svgDrawingHelper, annotationUID, textUID, textLines = [''], position, options) {\n    const { padding, color, fontFamily, fontSize, background } = options;\n    let textGroupBoundingBox;\n    const [x, y] = [position[0] + padding, position[1] + padding];\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'text', textUID);\n    const existingTextGroup = svgDrawingHelper.getSvgNode(svgNodeHash);\n    if (existingTextGroup) {\n        const textElement = existingTextGroup.querySelector('text');\n        const textSpans = Array.from(textElement.children);\n        for (let i = 0; i < textSpans.length; i++) {\n            const textSpanElement = textSpans[i];\n            const text = textLines[i] || '';\n            textSpanElement.textContent = text;\n        }\n        if (textLines.length > textSpans.length) {\n            for (let i = 0; i < textLines.length - textSpans.length; i++) {\n                const textLine = textLines[i + textSpans.length];\n                const textSpan = _createTextSpan(textLine);\n                textElement.appendChild(textSpan);\n            }\n            existingTextGroup.appendChild(textElement);\n            svgDrawingHelper.appendNode(existingTextGroup, svgNodeHash);\n        }\n        const textAttributes = {\n            fill: color,\n            'font-size': fontSize,\n            'font-family': fontFamily,\n        };\n        const textGroupAttributes = {\n            transform: `translate(${x} ${y})`,\n        };\n        setAttributesIfNecessary(textAttributes, textElement);\n        setAttributesIfNecessary(textGroupAttributes, existingTextGroup);\n        textGroupBoundingBox = _drawTextBackground(existingTextGroup, background);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const textGroup = document.createElementNS(svgns, 'g');\n        textGroup.setAttribute('transform', `translate(${x} ${y})`);\n        const textElement = _createTextElement(svgDrawingHelper, options);\n        for (let i = 0; i < textLines.length; i++) {\n            const textLine = textLines[i];\n            const textSpan = _createTextSpan(textLine);\n            textElement.appendChild(textSpan);\n        }\n        textGroup.appendChild(textElement);\n        svgDrawingHelper.appendNode(textGroup, svgNodeHash);\n        textGroupBoundingBox = _drawTextBackground(textGroup, background);\n    }\n    return Object.assign({}, textGroupBoundingBox, {\n        x,\n        y,\n        height: textGroupBoundingBox.height + padding,\n        width: textGroupBoundingBox.width + padding,\n    });\n}\nfunction _createTextElement(svgDrawingHelper, options) {\n    const { color, fontFamily, fontSize } = options;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const textElement = document.createElementNS(svgns, 'text');\n    const noSelectStyle = 'user-select: none; pointer-events: none; -webkit-tap-highlight-color:  rgba(255, 255, 255, 0);';\n    const dropShadowStyle = `filter:url(#shadow-${svgDrawingHelper.svgLayerElement.id});`;\n    const combinedStyle = `${noSelectStyle}${dropShadowStyle}`;\n    textElement.setAttribute('x', '0');\n    textElement.setAttribute('y', '0');\n    textElement.setAttribute('fill', color);\n    textElement.setAttribute('font-family', fontFamily);\n    textElement.setAttribute('font-size', fontSize);\n    textElement.setAttribute('style', combinedStyle);\n    return textElement;\n}\nfunction _createTextSpan(text) {\n    const svgns = 'http://www.w3.org/2000/svg';\n    const textSpanElement = document.createElementNS(svgns, 'tspan');\n    textSpanElement.setAttribute('x', '0');\n    textSpanElement.setAttribute('dy', '1.2em');\n    textSpanElement.textContent = text;\n    return textSpanElement;\n}\nfunction _drawTextBackground(group, color) {\n    let element = group.querySelector('rect.background');\n    if (!color) {\n        if (element) {\n            group.removeChild(element);\n        }\n        return group.getBBox();\n    }\n    if (!element) {\n        element = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n        element.setAttribute('class', 'background');\n        group.insertBefore(element, group.firstChild);\n    }\n    const bBox = group.getBBox();\n    const attributes = {\n        x: `${bBox.x}`,\n        y: `${bBox.y}`,\n        width: `${bBox.width}`,\n        height: `${bBox.height}`,\n        fill: color,\n    };\n    setAttributesIfNecessary(attributes, element);\n    return bBox;\n}\nexport default drawTextBox;\n","import drawLine from './drawLine';\nimport findClosestPoint from '../utilities/math/vec2/findClosestPoint';\nfunction drawLink(svgDrawingHelper, annotationUID, linkUID, annotationAnchorPoints, refPoint, boundingBox, options = {}) {\n    const start = annotationAnchorPoints.length > 0\n        ? findClosestPoint(annotationAnchorPoints, refPoint)\n        : refPoint;\n    const boundingBoxPoints = _boundingBoxPoints(boundingBox);\n    const end = findClosestPoint(boundingBoxPoints, start);\n    const mergedOptions = Object.assign({\n        color: 'rgb(255, 255, 0)',\n        lineWidth: '1',\n        lineDash: '2,3',\n    }, options);\n    drawLine(svgDrawingHelper, annotationUID, `link-${linkUID}`, start, end, mergedOptions);\n}\nfunction _boundingBoxPoints(boundingBox) {\n    const { x: left, y: top, height, width } = boundingBox;\n    const halfWidth = width / 2;\n    const halfHeight = height / 2;\n    const topMiddle = [left + halfWidth, top];\n    const leftMiddle = [left, top + halfHeight];\n    const bottomMiddle = [left + halfWidth, top + height];\n    const rightMiddle = [left + width, top + halfHeight];\n    return [topMiddle, leftMiddle, bottomMiddle, rightMiddle];\n}\nexport default drawLink;\n","import drawTextBox from './drawTextBox';\nimport drawLink from './drawLink';\nfunction drawLinkedTextBox(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, annotationAnchorPoints, textBox, options = {}) {\n    const mergedOptions = Object.assign({\n        handleRadius: '6',\n        centering: {\n            x: false,\n            y: true,\n        },\n    }, options);\n    const canvasBoundingBox = drawTextBox(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, mergedOptions);\n    drawLink(svgDrawingHelper, annotationUID, textBoxUID, annotationAnchorPoints, textBoxPosition, canvasBoundingBox, mergedOptions);\n    return canvasBoundingBox;\n}\nexport default drawLinkedTextBox;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nexport default function drawRectByCoordinates(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates, options = {}, dataId = '') {\n    const { color, width: _width, lineWidth, lineDash, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || _width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'rect', rectangleUID);\n    const existingRect = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const [topLeft, topRight, bottomLeft, bottomRight] = canvasCoordinates;\n    const width = Math.hypot(topLeft[0] - topRight[0], topLeft[1] - topRight[1]);\n    const height = Math.hypot(topLeft[0] - bottomLeft[0], topLeft[1] - bottomLeft[1]);\n    const center = [\n        (bottomRight[0] + topLeft[0]) / 2,\n        (bottomRight[1] + topLeft[1]) / 2,\n    ];\n    const leftEdgeCenter = [\n        (bottomLeft[0] + topLeft[0]) / 2,\n        (bottomLeft[1] + topLeft[1]) / 2,\n    ];\n    const angle = (Math.atan2(center[1] - leftEdgeCenter[1], center[0] - leftEdgeCenter[0]) *\n        180) /\n        Math.PI;\n    const attributes = {\n        x: `${center[0] - width / 2}`,\n        y: `${center[1] - height / 2}`,\n        width: `${width}`,\n        height: `${height}`,\n        stroke: color,\n        fill: 'transparent',\n        transform: `rotate(${angle} ${center[0]} ${center[1]})`,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingRect) {\n        setAttributesIfNecessary(attributes, existingRect);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgRectElement = document.createElementNS(svgns, 'rect');\n        if (dataId !== '') {\n            svgRectElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, svgRectElement);\n        svgDrawingHelper.appendNode(svgRectElement, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport drawRectByCoordinates from './drawRectByCoordinates';\nexport default function drawRect(svgDrawingHelper, annotationUID, rectangleUID, start, end, options = {}, dataId = '') {\n    const topLeft = [start[0], start[1]];\n    const topRight = [end[0], start[1]];\n    const bottomLeft = [start[0], end[1]];\n    const bottomRight = [end[0], end[1]];\n    drawRectByCoordinates(svgDrawingHelper, annotationUID, rectangleUID, [topLeft, topRight, bottomLeft, bottomRight], options, dataId);\n}\n","import drawLine from './drawLine';\nexport default function drawArrow(svgDrawingHelper, annotationUID, arrowUID, start, end, options = {}) {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    drawLine(svgDrawingHelper, annotationUID, arrowUID, start, end, {\n        color,\n        width,\n        lineWidth,\n        lineDash,\n    });\n    const headLength = 10;\n    const angle = Math.atan2(end[1] - start[1], end[0] - start[0]);\n    const firstLine = {\n        start: [\n            end[0] - headLength * Math.cos(angle - Math.PI / 7),\n            end[1] - headLength * Math.sin(angle - Math.PI / 7),\n        ],\n        end: end,\n    };\n    const secondLine = {\n        start: [\n            end[0] - headLength * Math.cos(angle + Math.PI / 7),\n            end[1] - headLength * Math.sin(angle + Math.PI / 7),\n        ],\n        end: end,\n    };\n    drawLine(svgDrawingHelper, annotationUID, '2', firstLine.start, firstLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '3', secondLine.start, secondLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n}\n","import _getHash from './_getHash';\nimport _setAttributesIfNecessary from './setAttributesIfNecessary';\nimport _setNewAttributesIfValid from './setNewAttributesIfValid';\nexport default function drawRedactionRect(svgDrawingHelper, annotationUID, rectangleUID, start, end, options = {}) {\n    const { color, width: _width, lineWidth, lineDash, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || _width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'rect', rectangleUID);\n    const existingRect = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const tlhc = [Math.min(start[0], end[0]), Math.min(start[1], end[1])];\n    const width = Math.abs(start[0] - end[0]);\n    const height = Math.abs(start[1] - end[1]);\n    const attributes = {\n        x: `${tlhc[0]}`,\n        y: `${tlhc[1]}`,\n        width: `${width}`,\n        height: `${height}`,\n        stroke: color,\n        fill: 'black',\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingRect) {\n        _setAttributesIfNecessary(attributes, existingRect);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgRectElement = document.createElementNS(svgns, 'rect');\n        _setNewAttributesIfValid(attributes, svgRectElement);\n        svgDrawingHelper.appendNode(svgRectElement, svgNodeHash);\n    }\n}\n","var ChangeTypes;\n(function (ChangeTypes) {\n    ChangeTypes[\"Interaction\"] = \"Interaction\";\n    ChangeTypes[\"HandlesUpdated\"] = \"HandlesUpdated\";\n    ChangeTypes[\"StatsUpdated\"] = \"StatsUpdated\";\n    ChangeTypes[\"InitialSetup\"] = \"InitialSetup\";\n    ChangeTypes[\"Completed\"] = \"Completed\";\n    ChangeTypes[\"InterpolationUpdated\"] = \"InterpolationUpdated\";\n})(ChangeTypes || (ChangeTypes = {}));\nexport default ChangeTypes;\n","var Events;\n(function (Events) {\n    Events[\"TOOL_ACTIVATED\"] = \"CORNERSTONE_TOOLS_TOOL_ACTIVATED\";\n    Events[\"TOOLGROUP_VIEWPORT_ADDED\"] = \"CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_ADDED\";\n    Events[\"TOOLGROUP_VIEWPORT_REMOVED\"] = \"CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_REMOVED\";\n    Events[\"TOOL_MODE_CHANGED\"] = \"CORNERSTONE_TOOLS_TOOL_MODE_CHANGED\";\n    Events[\"ANNOTATION_ADDED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_ADDED\";\n    Events[\"ANNOTATION_COMPLETED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_COMPLETED\";\n    Events[\"ANNOTATION_MODIFIED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_MODIFIED\";\n    Events[\"ANNOTATION_REMOVED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_REMOVED\";\n    Events[\"ANNOTATION_SELECTION_CHANGE\"] = \"CORNERSTONE_TOOLS_ANNOTATION_SELECTION_CHANGE\";\n    Events[\"ANNOTATION_LOCK_CHANGE\"] = \"CORNERSTONE_TOOLS_ANNOTATION_LOCK_CHANGE\";\n    Events[\"ANNOTATION_VISIBILITY_CHANGE\"] = \"CORNERSTONE_TOOLS_ANNOTATION_VISIBILITY_CHANGE\";\n    Events[\"ANNOTATION_RENDERED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_RENDERED\";\n    Events[\"ANNOTATION_INTERPOLATION_PROCESS_COMPLETED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_INTERPOLATION_PROCESS_COMPLETED\";\n    Events[\"INTERPOLATED_ANNOTATIONS_REMOVED\"] = \"CORNERSTONE_TOOLS_INTERPOLATED_ANNOTATIONS_REMOVED\";\n    Events[\"SEGMENTATION_MODIFIED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_MODIFIED\";\n    Events[\"SEGMENTATION_RENDERED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_RENDERED\";\n    Events[\"SEGMENTATION_REPRESENTATION_ADDED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_ADDED\";\n    Events[\"SEGMENTATION_ADDED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_ADDED\";\n    Events[\"SEGMENTATION_REPRESENTATION_MODIFIED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_MODIFIED\";\n    Events[\"SEGMENTATION_REMOVED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REMOVED\";\n    Events[\"SEGMENTATION_REPRESENTATION_REMOVED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_REMOVED\";\n    Events[\"SEGMENTATION_DATA_MODIFIED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_DATA_MODIFIED\";\n    Events[\"KEY_DOWN\"] = \"CORNERSTONE_TOOLS_KEY_DOWN\";\n    Events[\"KEY_UP\"] = \"CORNERSTONE_TOOLS_KEY_UP\";\n    Events[\"MOUSE_DOWN\"] = \"CORNERSTONE_TOOLS_MOUSE_DOWN\";\n    Events[\"MOUSE_UP\"] = \"CORNERSTONE_TOOLS_MOUSE_UP\";\n    Events[\"MOUSE_DOWN_ACTIVATE\"] = \"CORNERSTONE_TOOLS_MOUSE_DOWN_ACTIVATE\";\n    Events[\"MOUSE_DRAG\"] = \"CORNERSTONE_TOOLS_MOUSE_DRAG\";\n    Events[\"MOUSE_MOVE\"] = \"CORNERSTONE_TOOLS_MOUSE_MOVE\";\n    Events[\"MOUSE_CLICK\"] = \"CORNERSTONE_TOOLS_MOUSE_CLICK\";\n    Events[\"MOUSE_DOUBLE_CLICK\"] = \"CORNERSTONE_TOOLS_MOUSE_DOUBLE_CLICK\";\n    Events[\"MOUSE_WHEEL\"] = \"CORNERSTONE_TOOLS_MOUSE_WHEEL\";\n    Events[\"TOUCH_START\"] = \"CORNERSTONE_TOOLS_TOUCH_START\";\n    Events[\"TOUCH_START_ACTIVATE\"] = \"CORNERSTONE_TOOLS_TOUCH_START_ACTIVATE\";\n    Events[\"TOUCH_PRESS\"] = \"CORNERSTONE_TOOLS_TOUCH_PRESS\";\n    Events[\"TOUCH_DRAG\"] = \"CORNERSTONE_TOOLS_TOUCH_DRAG\";\n    Events[\"TOUCH_END\"] = \"CORNERSTONE_TOOLS_TOUCH_END\";\n    Events[\"TOUCH_TAP\"] = \"CORNERSTONE_TOOLS_TAP\";\n    Events[\"TOUCH_SWIPE\"] = \"CORNERSTONE_TOOLS_SWIPE\";\n})(Events || (Events = {}));\nexport default Events;\n","var StrategyCallbacks;\n(function (StrategyCallbacks) {\n    StrategyCallbacks[\"OnInteractionStart\"] = \"onInteractionStart\";\n    StrategyCallbacks[\"OnInteractionEnd\"] = \"onInteractionEnd\";\n    StrategyCallbacks[\"Preview\"] = \"preview\";\n    StrategyCallbacks[\"RejectPreview\"] = \"rejectPreview\";\n    StrategyCallbacks[\"AcceptPreview\"] = \"acceptPreview\";\n    StrategyCallbacks[\"Fill\"] = \"fill\";\n    StrategyCallbacks[\"StrategyFunction\"] = \"strategyFunction\";\n    StrategyCallbacks[\"CreateIsInThreshold\"] = \"createIsInThreshold\";\n    StrategyCallbacks[\"Initialize\"] = \"initialize\";\n    StrategyCallbacks[\"INTERNAL_setValue\"] = \"setValue\";\n    StrategyCallbacks[\"ComputeInnerCircleRadius\"] = \"computeInnerCircleRadius\";\n})(StrategyCallbacks || (StrategyCallbacks = {}));\nexport default StrategyCallbacks;\n","var ToolModes;\n(function (ToolModes) {\n    ToolModes[\"Active\"] = \"Active\";\n    ToolModes[\"Passive\"] = \"Passive\";\n    ToolModes[\"Enabled\"] = \"Enabled\";\n    ToolModes[\"Disabled\"] = \"Disabled\";\n})(ToolModes || (ToolModes = {}));\nexport default ToolModes;\n","var Swipe;\n(function (Swipe) {\n    Swipe[\"UP\"] = \"UP\";\n    Swipe[\"DOWN\"] = \"DOWN\";\n    Swipe[\"LEFT\"] = \"LEFT\";\n    Swipe[\"RIGHT\"] = \"RIGHT\";\n})(Swipe || (Swipe = {}));\nexport { Swipe };\n","var AnnotationStyleStates;\n(function (AnnotationStyleStates) {\n    AnnotationStyleStates[\"Default\"] = \"\";\n    AnnotationStyleStates[\"Highlighted\"] = \"Highlighted\";\n    AnnotationStyleStates[\"Selected\"] = \"Selected\";\n    AnnotationStyleStates[\"Locked\"] = \"Locked\";\n    AnnotationStyleStates[\"AutoGenerated\"] = \"AutoGenerated\";\n})(AnnotationStyleStates || (AnnotationStyleStates = {}));\nexport default AnnotationStyleStates;\n","var ChangeTypes;\n(function (ChangeTypes) {\n    ChangeTypes[\"POLYSEG_CONTOUR_TO_LABELMAP\"] = \"Converting Contour to Labelmap\";\n    ChangeTypes[\"POLYSEG_SURFACE_TO_LABELMAP\"] = \"Converting Surfaces to Labelmap\";\n    ChangeTypes[\"POLYSEG_CONTOUR_TO_SURFACE\"] = \"Converting Contour to Surface\";\n    ChangeTypes[\"POLYSEG_LABELMAP_TO_SURFACE\"] = \"Converting Labelmap to Surface\";\n    ChangeTypes[\"SURFACE_CLIPPING\"] = \"Clipping Surfaces\";\n})(ChangeTypes || (ChangeTypes = {}));\nexport default ChangeTypes;\n","import { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport getViewportsForAnnotation from '../../../utilities/getViewportsForAnnotation';\nimport * as math from '../../../utilities/math';\nimport triggerAnnotationRenderForViewportIds from '../../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getViewportIdsWithToolToRender } from '../../../utilities/viewportFilters';\nimport { addAnnotation, removeAnnotation, getAllAnnotations, getChildAnnotations, addChildAnnotation, clearParentAnnotation, } from '../../../stateManagement/annotation/annotationState';\nimport { ContourWindingDirection } from '../../../types/ContourAnnotation';\nimport { triggerAnnotationModified } from '../../../stateManagement/annotation/helpers/state';\nimport updateContourPolyline from '../../../utilities/contours/updateContourPolyline';\nimport { addContourSegmentationAnnotation, areSameSegment, isContourSegmentationAnnotation, removeContourSegmentationAnnotation, } from '../../../utilities/contourSegmentation';\nimport { getToolGroupForViewport } from '../../../store/ToolGroupManager';\nimport { hasTool, hasToolByName } from '../../../store/addTool';\nconst DEFAULT_CONTOUR_SEG_TOOL_NAME = 'PlanarFreehandContourSegmentationTool';\nexport default async function contourSegmentationCompletedListener(evt) {\n    const sourceAnnotation = evt.detail\n        .annotation;\n    if (!isContourSegmentationAnnotation(sourceAnnotation)) {\n        return;\n    }\n    const viewport = getViewport(sourceAnnotation);\n    const contourSegmentationAnnotations = getValidContourSegmentationAnnotations(viewport, sourceAnnotation);\n    if (!contourSegmentationAnnotations.length) {\n        return;\n    }\n    const sourcePolyline = convertContourPolylineToCanvasSpace(sourceAnnotation.data.contour.polyline, viewport);\n    const targetAnnotationInfo = findIntersectingContour(viewport, sourcePolyline, contourSegmentationAnnotations);\n    if (!targetAnnotationInfo) {\n        return;\n    }\n    const { targetAnnotation, targetPolyline, isContourHole } = targetAnnotationInfo;\n    if (isContourHole) {\n        const { contourHoleProcessingEnabled = false } = evt.detail;\n        if (!contourHoleProcessingEnabled) {\n            return;\n        }\n        createPolylineHole(viewport, targetAnnotation, sourceAnnotation);\n    }\n    else {\n        combinePolylines(viewport, targetAnnotation, targetPolyline, sourceAnnotation, sourcePolyline);\n    }\n}\nfunction isFreehandContourSegToolRegisteredForViewport(viewport, silent = false) {\n    const toolName = 'PlanarFreehandContourSegmentationTool';\n    const toolGroup = getToolGroupForViewport(viewport.id, viewport.renderingEngineId);\n    let errorMessage;\n    if (!toolGroup.hasTool(toolName)) {\n        errorMessage = `Tool ${toolName} not added to ${toolGroup.id} toolGroup`;\n    }\n    else if (!toolGroup.getToolOptions(toolName)) {\n        errorMessage = `Tool ${toolName} must be in active/passive state`;\n    }\n    if (errorMessage && !silent) {\n        console.warn(errorMessage);\n    }\n    return !errorMessage;\n}\nfunction getViewport(annotation) {\n    const viewports = getViewportsForAnnotation(annotation);\n    const viewportWithToolRegistered = viewports.find((viewport) => isFreehandContourSegToolRegisteredForViewport(viewport, true));\n    return viewportWithToolRegistered ?? viewports[0];\n}\nfunction convertContourPolylineToCanvasSpace(polyline, viewport) {\n    const numPoints = polyline.length;\n    const projectedPolyline = new Array(numPoints);\n    for (let i = 0; i < numPoints; i++) {\n        projectedPolyline[i] = viewport.worldToCanvas(polyline[i]);\n    }\n    return projectedPolyline;\n}\nfunction getValidContourSegmentationAnnotations(viewport, sourceAnnotation) {\n    const { annotationUID: sourceAnnotationUID } = sourceAnnotation;\n    const allAnnotations = getAllAnnotations();\n    return allAnnotations.filter((targetAnnotation) => targetAnnotation.annotationUID &&\n        targetAnnotation.annotationUID !== sourceAnnotationUID &&\n        isContourSegmentationAnnotation(targetAnnotation) &&\n        areSameSegment(targetAnnotation, sourceAnnotation) &&\n        viewport.isReferenceViewable(targetAnnotation.metadata));\n}\nfunction findIntersectingContour(viewport, sourcePolyline, contourSegmentationAnnotations) {\n    const sourceAABB = math.polyline.getAABB(sourcePolyline);\n    for (let i = 0; i < contourSegmentationAnnotations.length; i++) {\n        const targetAnnotation = contourSegmentationAnnotations[i];\n        const targetPolyline = convertContourPolylineToCanvasSpace(targetAnnotation.data.contour.polyline, viewport);\n        const targetAABB = math.polyline.getAABB(targetPolyline);\n        const aabbIntersect = math.aabb.intersectAABB(sourceAABB, targetAABB);\n        const lineSegmentsIntersect = aabbIntersect &&\n            math.polyline.intersectPolyline(sourcePolyline, targetPolyline);\n        const isContourHole = aabbIntersect &&\n            !lineSegmentsIntersect &&\n            math.polyline.containsPoints(targetPolyline, sourcePolyline);\n        if (lineSegmentsIntersect || isContourHole) {\n            return { targetAnnotation, targetPolyline, isContourHole };\n        }\n    }\n}\nexport function createPolylineHole(viewport, targetAnnotation, holeAnnotation) {\n    const { windingDirection: targetWindingDirection } = targetAnnotation.data.contour;\n    const { windingDirection: holeWindingDirection } = holeAnnotation.data.contour;\n    addChildAnnotation(targetAnnotation, holeAnnotation);\n    removeContourSegmentationAnnotation(holeAnnotation);\n    const { contour: holeContour } = holeAnnotation.data;\n    const holePolyline = convertContourPolylineToCanvasSpace(holeContour.polyline, viewport);\n    updateContourPolyline(holeAnnotation, {\n        points: holePolyline,\n        closed: holeContour.closed,\n    }, viewport);\n    const { element } = viewport;\n    const updatedToolNames = new Set([\n        DEFAULT_CONTOUR_SEG_TOOL_NAME,\n        targetAnnotation.metadata.toolName,\n        holeAnnotation.metadata.toolName,\n    ]);\n    for (const toolName of updatedToolNames.values()) {\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, toolName);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n}\nfunction getContourHolesData(viewport, annotation) {\n    return getChildAnnotations(annotation).map((holeAnnotation) => {\n        const polyline = convertContourPolylineToCanvasSpace(holeAnnotation.data.contour.polyline, viewport);\n        return { annotation: holeAnnotation, polyline };\n    });\n}\nfunction combinePolylines(viewport, targetAnnotation, targetPolyline, sourceAnnotation, sourcePolyline) {\n    if (!hasToolByName(DEFAULT_CONTOUR_SEG_TOOL_NAME)) {\n        console.warn(`${DEFAULT_CONTOUR_SEG_TOOL_NAME} is not registered in cornerstone`);\n        return;\n    }\n    if (!isFreehandContourSegToolRegisteredForViewport(viewport)) {\n        return;\n    }\n    const sourceStartPoint = sourcePolyline[0];\n    const mergePolylines = math.polyline.containsPoint(targetPolyline, sourceStartPoint);\n    const contourHolesData = getContourHolesData(viewport, targetAnnotation);\n    const unassignedContourHolesSet = new Set(contourHolesData);\n    const reassignedContourHolesMap = new Map();\n    const assignHoleToPolyline = (parentPolyline, holeData) => {\n        let holes = reassignedContourHolesMap.get(parentPolyline);\n        if (!holes) {\n            holes = [];\n            reassignedContourHolesMap.set(parentPolyline, holes);\n        }\n        holes.push(holeData);\n        unassignedContourHolesSet.delete(holeData);\n    };\n    const newPolylines = [];\n    if (mergePolylines) {\n        const mergedPolyline = math.polyline.mergePolylines(targetPolyline, sourcePolyline);\n        newPolylines.push(mergedPolyline);\n        Array.from(unassignedContourHolesSet.keys()).forEach((holeData) => assignHoleToPolyline(mergedPolyline, holeData));\n    }\n    else {\n        const subtractedPolylines = math.polyline.subtractPolylines(targetPolyline, sourcePolyline);\n        subtractedPolylines.forEach((newPolyline) => {\n            newPolylines.push(newPolyline);\n            Array.from(unassignedContourHolesSet.keys()).forEach((holeData) => {\n                const containsHole = math.polyline.containsPoints(newPolyline, holeData.polyline);\n                if (containsHole) {\n                    assignHoleToPolyline(newPolyline, holeData);\n                    unassignedContourHolesSet.delete(holeData);\n                }\n            });\n        });\n    }\n    Array.from(reassignedContourHolesMap.values()).forEach((contourHolesDataArray) => contourHolesDataArray.forEach((contourHoleData) => clearParentAnnotation(contourHoleData.annotation)));\n    const { element } = viewport;\n    const enabledElement = getEnabledElement(element);\n    const { metadata, data } = targetAnnotation;\n    const { handles, segmentation } = data;\n    const { textBox } = handles;\n    removeAnnotation(sourceAnnotation.annotationUID);\n    removeAnnotation(targetAnnotation.annotationUID);\n    for (let i = 0; i < newPolylines.length; i++) {\n        const polyline = newPolylines[i];\n        const startPoint = viewport.canvasToWorld(polyline[0]);\n        const endPoint = viewport.canvasToWorld(polyline[polyline.length - 1]);\n        const newAnnotation = {\n            metadata: {\n                ...metadata,\n                toolName: DEFAULT_CONTOUR_SEG_TOOL_NAME,\n                originalToolName: metadata.originalToolName || metadata.toolName,\n            },\n            data: {\n                cachedStats: {},\n                handles: {\n                    points: [startPoint, endPoint],\n                    textBox: textBox ? { ...textBox } : undefined,\n                },\n                contour: {\n                    polyline: [],\n                    closed: true,\n                },\n                spline: targetAnnotation.data.spline,\n                segmentation: {\n                    ...segmentation,\n                },\n            },\n            annotationUID: csUtils.uuidv4(),\n            highlighted: true,\n            invalidated: true,\n            isLocked: false,\n            isVisible: undefined,\n            interpolationUID: targetAnnotation.interpolationUID,\n            interpolationCompleted: targetAnnotation.interpolationCompleted,\n        };\n        updateContourPolyline(newAnnotation, {\n            points: polyline,\n            closed: true,\n            targetWindingDirection: ContourWindingDirection.Clockwise,\n        }, viewport);\n        addAnnotation(newAnnotation, element);\n        addContourSegmentationAnnotation(newAnnotation);\n        triggerAnnotationModified(newAnnotation, viewport.element);\n        reassignedContourHolesMap\n            .get(polyline)\n            ?.forEach((holeData) => addChildAnnotation(newAnnotation, holeData.annotation));\n    }\n    updateViewports(enabledElement, targetAnnotation, sourceAnnotation);\n}\nfunction updateViewports(enabledElement, targetAnnotation, sourceAnnotation) {\n    const { viewport } = enabledElement;\n    const { element } = viewport;\n    const updatedTtoolNames = new Set([\n        DEFAULT_CONTOUR_SEG_TOOL_NAME,\n        targetAnnotation.metadata.toolName,\n        sourceAnnotation.metadata.toolName,\n    ]);\n    for (const toolName of updatedTtoolNames.values()) {\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, toolName);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    return new Promise((resolve) => window.requestAnimationFrame(resolve));\n}\n","import mouseDoubleClickListener from './mouseDoubleClickListener';\nimport mouseDownListener, { mouseDoubleClickIgnoreListener, } from './mouseDownListener';\nimport mouseMoveListener from './mouseMoveListener';\nfunction disable(element) {\n    element.removeEventListener('dblclick', mouseDoubleClickListener);\n    element.removeEventListener('mousedown', mouseDownListener);\n    element.removeEventListener('mousemove', mouseMoveListener);\n    element.removeEventListener('dblclick', mouseDoubleClickIgnoreListener, {\n        capture: true,\n    });\n}\nfunction enable(element) {\n    disable(element);\n    element.addEventListener('dblclick', mouseDoubleClickListener);\n    element.addEventListener('mousedown', mouseDownListener);\n    element.addEventListener('mousemove', mouseMoveListener);\n    element.addEventListener('dblclick', mouseDoubleClickIgnoreListener, {\n        capture: true,\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import preventGhostClick from './preventGhostClick';\nimport touchStartListener from './touchStartListener';\nfunction disable(element) {\n    preventGhostClick.disable(element);\n    element.removeEventListener('touchstart', touchStartListener);\n}\nfunction enable(element) {\n    disable(element);\n    preventGhostClick.enable(element);\n    element.addEventListener('touchstart', touchStartListener, {\n        passive: false,\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import wheelListener from './wheelListener';\nfunction enable(element) {\n    disable(element);\n    element.addEventListener('wheel', wheelListener, { passive: false });\n}\nfunction disable(element) {\n    element.removeEventListener('wheel', wheelListener);\n}\nexport default {\n    enable,\n    disable,\n};\n","import { cache, utilities as csUtils, VolumeViewport, getEnabledElementByViewportId, StackViewport, } from '@cornerstonejs/core';\nimport * as SegmentationState from '../../../stateManagement/segmentation/segmentationState';\nimport { SegmentationRepresentations } from '../../../enums';\nimport { getLabelmapActorEntry } from '../../../stateManagement/segmentation/helpers/getSegmentationActor';\nconst onLabelmapSegmentationDataModified = function (evt) {\n    const { segmentationId, modifiedSlicesToUse } = evt.detail;\n    const { representationData } = SegmentationState.getSegmentation(segmentationId);\n    const viewportIds = SegmentationState.getViewportIdsWithSegmentation(segmentationId);\n    const hasVolumeViewport = viewportIds.some((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        return viewport instanceof VolumeViewport;\n    });\n    const hasStackViewport = viewportIds.some((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        return viewport instanceof StackViewport;\n    });\n    const hasBothStackAndVolume = hasVolumeViewport && hasStackViewport;\n    viewportIds.forEach((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        if (viewport instanceof VolumeViewport) {\n            performVolumeLabelmapUpdate({\n                modifiedSlicesToUse: hasBothStackAndVolume ? [] : modifiedSlicesToUse,\n                representationData,\n                type: SegmentationRepresentations.Labelmap,\n            });\n        }\n        if (viewport instanceof StackViewport) {\n            performStackLabelmapUpdate({\n                viewportIds,\n                segmentationId,\n            });\n        }\n    });\n};\nfunction performVolumeLabelmapUpdate({ modifiedSlicesToUse, representationData, type, }) {\n    const segmentationVolume = cache.getVolume(representationData[type].volumeId);\n    if (!segmentationVolume) {\n        console.warn('segmentation not found in cache');\n        return;\n    }\n    const { imageData, vtkOpenGLTexture } = segmentationVolume;\n    let slicesToUpdate;\n    if (modifiedSlicesToUse?.length > 0) {\n        slicesToUpdate = modifiedSlicesToUse;\n    }\n    else {\n        const numSlices = imageData.getDimensions()[2];\n        slicesToUpdate = [...Array(numSlices).keys()];\n    }\n    slicesToUpdate.forEach((i) => {\n        vtkOpenGLTexture.setUpdatedFrame(i);\n    });\n    imageData.modified();\n}\nfunction performStackLabelmapUpdate({ viewportIds, segmentationId }) {\n    viewportIds.forEach((viewportId) => {\n        let representations = SegmentationState.getSegmentationRepresentations(viewportId, { segmentationId });\n        representations = representations.filter((representation) => representation.type === SegmentationRepresentations.Labelmap);\n        representations.forEach((representation) => {\n            if (representation.segmentationId !== segmentationId) {\n                return;\n            }\n            const enabledElement = getEnabledElementByViewportId(viewportId);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            if (viewport instanceof VolumeViewport) {\n                return;\n            }\n            const actorEntry = getLabelmapActorEntry(viewportId, segmentationId);\n            if (!actorEntry) {\n                return;\n            }\n            const segImageData = actorEntry.actor.getMapper().getInputData();\n            const currentSegmentationImageId = SegmentationState.getCurrentLabelmapImageIdForViewport(viewportId, segmentationId);\n            const segmentationImage = cache.getImage(currentSegmentationImageId);\n            segImageData.modified();\n            csUtils.updateVTKImageDataWithCornerstoneImage(segImageData, segmentationImage);\n        });\n    });\n}\nexport default onLabelmapSegmentationDataModified;\n","import { triggerSegmentationRenderBySegmentationId } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nimport onLabelmapSegmentationDataModified from './labelmap/onLabelmapSegmentationDataModified';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nconst onSegmentationDataModified = function (evt) {\n    const { segmentationId } = evt.detail;\n    const { representationData } = getSegmentation(segmentationId);\n    if (representationData.Labelmap) {\n        onLabelmapSegmentationDataModified(evt);\n    }\n    triggerSegmentationRenderBySegmentationId(segmentationId);\n};\nexport default onSegmentationDataModified;\n","import { triggerSegmentationRenderBySegmentationId } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nconst segmentationModifiedListener = function (evt) {\n    const { segmentationId } = evt.detail;\n    triggerSegmentationRenderBySegmentationId(segmentationId);\n};\nexport default segmentationModifiedListener;\n","import vtkDataArray from '@kitware/vtk.js/Common/Core/DataArray';\nimport vtkImageData from '@kitware/vtk.js/Common/DataModel/ImageData';\nimport { BaseVolumeViewport, getEnabledElement, Enums, getEnabledElementByIds, cache, utilities, } from '@cornerstonejs/core';\nimport { triggerSegmentationRender } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nimport { updateLabelmapSegmentationImageReferences } from '../../stateManagement/segmentation/updateLabelmapSegmentationImageReferences';\nimport { getCurrentLabelmapImageIdForViewport } from '../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nimport { SegmentationRepresentations } from '../../enums';\nimport { getLabelmapActorEntry } from '../../stateManagement/segmentation/helpers/getSegmentationActor';\nimport { getSegmentationRepresentations } from '../../stateManagement/segmentation/getSegmentationRepresentation';\nconst enable = function (element) {\n    const { viewport } = getEnabledElement(element);\n    if (viewport instanceof BaseVolumeViewport) {\n        return;\n    }\n    element.addEventListener(Enums.Events.STACK_NEW_IMAGE, _imageChangeEventListener);\n    element.addEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.STACK_NEW_IMAGE, _imageChangeEventListener);\n    element.removeEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n};\nconst perViewportManualTriggers = new Map();\nfunction _imageChangeEventListener(evt) {\n    const eventData = evt.detail;\n    const { viewportId, renderingEngineId } = eventData;\n    const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n    const representations = getSegmentationRepresentations(viewportId);\n    if (!representations?.length) {\n        return;\n    }\n    const labelmapRepresentations = representations.filter((representation) => representation.type === SegmentationRepresentations.Labelmap);\n    const actors = viewport.getActors();\n    labelmapRepresentations.forEach((representation) => {\n        const { segmentationId } = representation;\n        updateLabelmapSegmentationImageReferences(viewportId, segmentationId);\n    });\n    const labelmapActors = labelmapRepresentations\n        .map((representation) => {\n        return getLabelmapActorEntry(viewportId, representation.segmentationId);\n    })\n        .filter((actor) => actor !== undefined);\n    if (!labelmapActors.length) {\n        return;\n    }\n    labelmapActors.forEach((actor) => {\n        const validActor = labelmapRepresentations.find((representation) => {\n            const derivedImageId = getCurrentLabelmapImageIdForViewport(viewportId, representation.segmentationId);\n            return derivedImageId === actor.referencedId;\n        });\n        if (!validActor) {\n            viewport.removeActors([actor.uid]);\n        }\n    });\n    labelmapRepresentations.forEach((representation) => {\n        const { segmentationId } = representation;\n        const currentImageId = viewport.getCurrentImageId();\n        const derivedImageId = getCurrentLabelmapImageIdForViewport(viewportId, segmentationId);\n        if (!derivedImageId) {\n            return;\n        }\n        const derivedImage = cache.getImage(derivedImageId);\n        if (!derivedImage) {\n            console.warn('No derived image found in the cache for segmentation representation', representation);\n            return;\n        }\n        const segmentationActorInput = actors.find((actor) => actor.referencedId === derivedImageId);\n        if (!segmentationActorInput) {\n            const { dimensions, spacing, direction } = viewport.getImageDataMetadata(derivedImage);\n            const currentImage = cache.getImage(currentImageId) ||\n                {\n                    imageId: currentImageId,\n                };\n            const { origin: currentOrigin } = viewport.getImageDataMetadata(currentImage);\n            const originToUse = currentOrigin;\n            const constructor = derivedImage.voxelManager.getConstructor();\n            const newPixelData = derivedImage.voxelManager.getScalarData();\n            const scalarArray = vtkDataArray.newInstance({\n                name: 'Pixels',\n                numberOfComponents: 1,\n                values: new constructor(newPixelData),\n            });\n            const imageData = vtkImageData.newInstance();\n            imageData.setDimensions(dimensions[0], dimensions[1], 1);\n            imageData.setSpacing(spacing);\n            imageData.setDirection(direction);\n            imageData.setOrigin(originToUse);\n            imageData.getPointData().setScalars(scalarArray);\n            imageData.modified();\n            viewport.addImages([\n                {\n                    imageId: derivedImageId,\n                    representationUID: `${segmentationId}-${SegmentationRepresentations.Labelmap}`,\n                    callback: ({ imageActor }) => {\n                        imageActor.getMapper().setInputData(imageData);\n                    },\n                },\n            ]);\n            triggerSegmentationRender(viewportId);\n            return;\n        }\n        else {\n            const segmentationImageData = segmentationActorInput.actor\n                .getMapper()\n                .getInputData();\n            if (segmentationImageData.setDerivedImage) {\n                segmentationImageData.setDerivedImage(derivedImage);\n            }\n            else {\n                utilities.updateVTKImageDataWithCornerstoneImage(segmentationImageData, derivedImage);\n            }\n        }\n        viewport.render();\n        if (evt.type === Enums.Events.IMAGE_RENDERED) {\n            viewport.element.removeEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n        }\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import * as contourSegUtils from '../../utilities/contourSegmentation';\nimport { contourSegmentationCompleted } from './contourSegmentation';\nexport default function annotationCompletedListener(evt) {\n    const annotation = evt.detail.annotation;\n    if (contourSegUtils.isContourSegmentationAnnotation(annotation)) {\n        contourSegmentationCompleted(evt);\n    }\n}\n","import { getRenderingEngines } from '@cornerstonejs/core';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities/triggerAnnotationRenderForViewportIds';\nfunction annotationSelectionListener(evt) {\n    const deselectedAnnotation = evt.detail.removed;\n    if (!deselectedAnnotation.length) {\n        return;\n    }\n    const renderingEngines = getRenderingEngines();\n    renderingEngines.forEach((renderingEngine) => {\n        const viewports = renderingEngine.getViewports();\n        const viewportIds = viewports.map((vp) => vp.id);\n        triggerAnnotationRenderForViewportIds(viewportIds);\n    });\n}\nexport default annotationSelectionListener;\n","import triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nfunction annotationModifiedListener(evt) {\n    const { viewportId } = evt.detail;\n    triggerAnnotationRenderForViewportIds([viewportId]);\n}\nexport default annotationModifiedListener;\n","import * as contourSegUtils from '../../utilities/contourSegmentation';\nimport { contourSegmentationRemoved } from './contourSegmentation';\nexport default function annotationRemovedListener(evt) {\n    const annotation = evt.detail.annotation;\n    if (contourSegUtils.isContourSegmentationAnnotation(annotation)) {\n        contourSegmentationRemoved(evt);\n    }\n}\n","import { removeContourSegmentationAnnotation } from '../../../utilities/contourSegmentation';\nexport default function contourSegmentationRemovedListener(evt) {\n    const annotation = evt.detail.annotation;\n    removeContourSegmentationAnnotation(annotation);\n}\n","import { Enums } from '@cornerstonejs/core';\nimport triggerAnnotationRender from '../utilities/triggerAnnotationRender';\nconst onImageRendered = function (evt) {\n    triggerAnnotationRender(evt.detail.element);\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.IMAGE_RENDERED, onImageRendered);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.IMAGE_RENDERED, onImageRendered);\n};\nexport default {\n    enable,\n    disable,\n};\n","import Events from '../enums/Events';\nimport { mouseClick, mouseDown, mouseDownActivate, mouseDoubleClick, mouseDrag, mouseMove, mouseUp, mouseWheel, } from './mouseEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.MOUSE_CLICK, mouseClick);\n    element.addEventListener(Events.MOUSE_DOWN, mouseDown);\n    element.addEventListener(Events.MOUSE_DOWN_ACTIVATE, mouseDownActivate);\n    element.addEventListener(Events.MOUSE_DOUBLE_CLICK, mouseDoubleClick);\n    element.addEventListener(Events.MOUSE_DRAG, mouseDrag);\n    element.addEventListener(Events.MOUSE_MOVE, mouseMove);\n    element.addEventListener(Events.MOUSE_UP, mouseUp);\n    element.addEventListener(Events.MOUSE_WHEEL, mouseWheel);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.MOUSE_CLICK, mouseClick);\n    element.removeEventListener(Events.MOUSE_DOWN, mouseDown);\n    element.removeEventListener(Events.MOUSE_DOWN_ACTIVATE, mouseDownActivate);\n    element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, mouseDoubleClick);\n    element.removeEventListener(Events.MOUSE_DRAG, mouseDrag);\n    element.removeEventListener(Events.MOUSE_MOVE, mouseMove);\n    element.removeEventListener(Events.MOUSE_UP, mouseUp);\n    element.removeEventListener(Events.MOUSE_WHEEL, mouseWheel);\n};\nconst mouseToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default mouseToolEventDispatcher;\n","import Events from '../enums/Events';\nimport { keyDown, keyUp } from './keyboardEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.KEY_DOWN, keyDown);\n    element.addEventListener(Events.KEY_UP, keyUp);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.KEY_DOWN, keyDown);\n    element.removeEventListener(Events.KEY_UP, keyUp);\n};\nconst keyboardToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default keyboardToolEventDispatcher;\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onCameraModified = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onCameraModified) {\n            tool.onCameraModified(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.CAMERA_MODIFIED, onCameraModified);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.CAMERA_MODIFIED, onCameraModified);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onImageSpacingCalibrated = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onImageSpacingCalibrated) {\n            tool.onImageSpacingCalibrated(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.IMAGE_SPACING_CALIBRATED, onImageSpacingCalibrated);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.IMAGE_SPACING_CALIBRATED, onImageSpacingCalibrated);\n};\nexport default {\n    enable,\n    disable,\n};\n","import Events from '../enums/Events';\nimport { touchStart, touchStartActivate, touchDrag, touchEnd, touchTap, touchPress, } from './touchEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.TOUCH_START, touchStart);\n    element.addEventListener(Events.TOUCH_START_ACTIVATE, touchStartActivate);\n    element.addEventListener(Events.TOUCH_DRAG, touchDrag);\n    element.addEventListener(Events.TOUCH_END, touchEnd);\n    element.addEventListener(Events.TOUCH_TAP, touchTap);\n    element.addEventListener(Events.TOUCH_PRESS, touchPress);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.TOUCH_START, touchStart);\n    element.removeEventListener(Events.TOUCH_START_ACTIVATE, touchStartActivate);\n    element.removeEventListener(Events.TOUCH_DRAG, touchDrag);\n    element.removeEventListener(Events.TOUCH_END, touchEnd);\n    element.removeEventListener(Events.TOUCH_PRESS, touchPress);\n};\nconst touchToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default touchToolEventDispatcher;\n","import { eventTarget } from '@cornerstonejs/core';\nimport Events from '../enums/Events';\nimport InterpolationManager from '../utilities/segmentation/InterpolationManager/InterpolationManager';\nconst enable = function () {\n    eventTarget.addEventListener(Events.ANNOTATION_COMPLETED, InterpolationManager.handleAnnotationCompleted);\n    eventTarget.addEventListener(Events.ANNOTATION_MODIFIED, InterpolationManager.handleAnnotationUpdate);\n    eventTarget.addEventListener(Events.ANNOTATION_REMOVED, InterpolationManager.handleAnnotationDelete);\n};\nconst disable = function () {\n    eventTarget.removeEventListener(Events.ANNOTATION_COMPLETED, InterpolationManager.handleAnnotationCompleted);\n    eventTarget.removeEventListener(Events.ANNOTATION_MODIFIED, InterpolationManager.handleAnnotationUpdate);\n    eventTarget.removeEventListener(Events.ANNOTATION_REMOVED, InterpolationManager.handleAnnotationDelete);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onCameraReset = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onResetCamera) {\n            tool.onResetCamera(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.CAMERA_RESET, onCameraReset);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.CAMERA_RESET, onCameraReset);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { mouseEventListeners, wheelEventListener, touchEventListeners, keyEventListener, imageChangeEventListener, } from '../eventListeners';\nimport { imageRenderedEventDispatcher, cameraModifiedEventDispatcher, mouseToolEventDispatcher, touchToolEventDispatcher, keyboardToolEventDispatcher, imageSpacingCalibratedEventDispatcher, cameraResetEventDispatcher, } from '../eventDispatchers';\nimport { state } from './state';\nimport { annotationRenderingEngine } from '../stateManagement/annotation/AnnotationRenderingEngine';\nexport default function addEnabledElement(evt) {\n    const { element, viewportId } = evt.detail;\n    const svgLayer = _createSvgAnnotationLayer(viewportId);\n    _setSvgNodeCache(element);\n    _appendChild(svgLayer, element);\n    annotationRenderingEngine.addViewportElement(viewportId, element);\n    mouseEventListeners.enable(element);\n    wheelEventListener.enable(element);\n    touchEventListeners.enable(element);\n    keyEventListener.enable(element);\n    imageChangeEventListener.enable(element);\n    imageRenderedEventDispatcher.enable(element);\n    cameraModifiedEventDispatcher.enable(element);\n    imageSpacingCalibratedEventDispatcher.enable(element);\n    cameraResetEventDispatcher.enable(element);\n    mouseToolEventDispatcher.enable(element);\n    keyboardToolEventDispatcher.enable(element);\n    touchToolEventDispatcher.enable(element);\n    state.enabledElements.push(element);\n}\nfunction _createSvgAnnotationLayer(viewportId) {\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgLayer = document.createElementNS(svgns, 'svg');\n    const svgLayerId = `svg-layer-${viewportId}`;\n    svgLayer.classList.add('svg-layer');\n    svgLayer.setAttribute('id', svgLayerId);\n    svgLayer.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n    svgLayer.style.width = '100%';\n    svgLayer.style.height = '100%';\n    svgLayer.style.pointerEvents = 'none';\n    svgLayer.style.position = 'absolute';\n    const defs = document.createElementNS(svgns, 'defs');\n    const filter = document.createElementNS(svgns, 'filter');\n    const feOffset = document.createElementNS(svgns, 'feOffset');\n    const feColorMatrix = document.createElementNS(svgns, 'feColorMatrix');\n    const feBlend = document.createElementNS(svgns, 'feBlend');\n    filter.setAttribute('id', `shadow-${svgLayerId}`);\n    filter.setAttribute('filterUnits', 'userSpaceOnUse');\n    feOffset.setAttribute('result', 'offOut');\n    feOffset.setAttribute('in', 'SourceGraphic');\n    feOffset.setAttribute('dx', '0.5');\n    feOffset.setAttribute('dy', '0.5');\n    feColorMatrix.setAttribute('result', 'matrixOut');\n    feColorMatrix.setAttribute('in', 'offOut');\n    feColorMatrix.setAttribute('in2', 'matrix');\n    feColorMatrix.setAttribute('values', '0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0');\n    feBlend.setAttribute('in', 'SourceGraphic');\n    feBlend.setAttribute('in2', 'matrixOut');\n    feBlend.setAttribute('mode', 'normal');\n    filter.appendChild(feOffset);\n    filter.appendChild(feColorMatrix);\n    filter.appendChild(feBlend);\n    defs.appendChild(filter);\n    svgLayer.appendChild(defs);\n    return svgLayer;\n}\nfunction _setSvgNodeCache(element) {\n    const { viewportUid: viewportId, renderingEngineUid: renderingEngineId } = element.dataset;\n    const elementHash = `${viewportId}:${renderingEngineId}`;\n    state.svgNodeCache[elementHash] = {};\n}\nfunction _appendChild(newNode, referenceNode) {\n    referenceNode.querySelector('div.viewport-element').appendChild(newNode);\n}\n","import { state } from '../state';\nfunction getSynchronizersForViewport(viewportId, renderingEngineId) {\n    const synchronizersFilteredByIds = [];\n    if (!renderingEngineId && !viewportId) {\n        throw new Error('At least one of renderingEngineId or viewportId should be given');\n    }\n    for (let i = 0; i < state.synchronizers.length; i++) {\n        const synchronizer = state.synchronizers[i];\n        const notDisabled = !synchronizer.isDisabled();\n        const hasSourceViewport = synchronizer.hasSourceViewport(renderingEngineId, viewportId);\n        const hasTargetViewport = synchronizer.hasTargetViewport(renderingEngineId, viewportId);\n        if (notDisabled && (hasSourceViewport || hasTargetViewport)) {\n            synchronizersFilteredByIds.push(synchronizer);\n        }\n    }\n    return synchronizersFilteredByIds;\n}\nexport default getSynchronizersForViewport;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { mouseEventListeners, wheelEventListener, touchEventListeners, keyEventListener, imageChangeEventListener, } from '../eventListeners';\nimport { imageRenderedEventDispatcher, cameraModifiedEventDispatcher, mouseToolEventDispatcher, keyboardToolEventDispatcher, imageSpacingCalibratedEventDispatcher, touchToolEventDispatcher, cameraResetEventDispatcher, } from '../eventDispatchers';\nimport filterToolsWithAnnotationsForElement from './filterToolsWithAnnotationsForElement';\nimport { state } from './state';\nimport getToolsWithModesForElement from '../utilities/getToolsWithModesForElement';\nimport { ToolModes } from '../enums';\nimport { removeAnnotation } from '../stateManagement';\nimport getSynchronizersForViewport from './SynchronizerManager/getSynchronizersForViewport';\nimport getToolGroupForViewport from './ToolGroupManager/getToolGroupForViewport';\nimport { annotationRenderingEngine } from '../stateManagement/annotation/AnnotationRenderingEngine';\nconst VIEWPORT_ELEMENT = 'viewport-element';\nfunction removeEnabledElement(elementDisabledEvt) {\n    const { element, viewportId } = elementDisabledEvt.detail;\n    _resetSvgNodeCache(element);\n    _removeSvgNode(element);\n    annotationRenderingEngine.removeViewportElement(viewportId, element);\n    mouseEventListeners.disable(element);\n    wheelEventListener.disable(element);\n    touchEventListeners.disable(element);\n    keyEventListener.disable(element);\n    imageChangeEventListener.disable(element);\n    imageRenderedEventDispatcher.disable(element);\n    cameraModifiedEventDispatcher.disable(element);\n    imageSpacingCalibratedEventDispatcher.disable(element);\n    cameraResetEventDispatcher.disable(element);\n    mouseToolEventDispatcher.disable(element);\n    keyboardToolEventDispatcher.disable(element);\n    touchToolEventDispatcher.disable(element);\n    _removeViewportFromSynchronizers(element);\n    _removeViewportFromToolGroup(element);\n    _removeEnabledElement(element);\n}\nconst _removeViewportFromSynchronizers = (element) => {\n    const enabledElement = getEnabledElement(element);\n    const synchronizers = getSynchronizersForViewport(enabledElement.viewportId, enabledElement.renderingEngineId);\n    synchronizers.forEach((sync) => {\n        sync.remove(enabledElement);\n    });\n};\nconst _removeViewportFromToolGroup = (element) => {\n    const { renderingEngineId, viewportId } = getEnabledElement(element);\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (toolGroup) {\n        toolGroup.removeViewports(renderingEngineId, viewportId);\n    }\n};\nconst _removeAllToolsForElement = function (element) {\n    const tools = getToolsWithModesForElement(element, [\n        ToolModes.Active,\n        ToolModes.Passive,\n    ]);\n    const toolsWithData = filterToolsWithAnnotationsForElement(element, tools);\n    toolsWithData.forEach(({ annotations }) => {\n        annotations.forEach((annotation) => {\n            removeAnnotation(annotation.annotationUID);\n        });\n    });\n};\nfunction _resetSvgNodeCache(element) {\n    const { viewportUid: viewportId, renderingEngineUid: renderingEngineId } = element.dataset;\n    const elementHash = `${viewportId}:${renderingEngineId}`;\n    delete state.svgNodeCache[elementHash];\n}\nfunction _removeSvgNode(element) {\n    const internalViewportNode = element.querySelector(`div.${VIEWPORT_ELEMENT}`);\n    const svgLayer = internalViewportNode.querySelector('svg');\n    if (svgLayer) {\n        internalViewportNode.removeChild(svgLayer);\n    }\n}\nconst _removeEnabledElement = function (element) {\n    const foundElementIndex = state.enabledElements.findIndex((el) => el === element);\n    if (foundElementIndex > -1) {\n        state.enabledElements.splice(foundElementIndex, 1);\n    }\n};\nexport default removeEnabledElement;\n","import { ToolModes } from '../enums';\nimport getToolsWithModesForElement from '../utilities/getToolsWithModesForElement';\nimport filterToolsWithAnnotationsForElement from './filterToolsWithAnnotationsForElement';\nexport default function cancelActiveManipulations(element) {\n    const tools = getToolsWithModesForElement(element, [\n        ToolModes.Active,\n        ToolModes.Passive,\n    ]);\n    const toolsWithData = filterToolsWithAnnotationsForElement(element, tools);\n    for (const { tool } of toolsWithData) {\n        const annotationUID = tool.cancel(element);\n        if (annotationUID) {\n            return annotationUID;\n        }\n    }\n}\n","import { getRenderingEngine, getEnabledElement, eventTarget, Enums, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nclass Synchronizer {\n    constructor(synchronizerId, eventName, eventHandler, options) {\n        this._viewportOptions = {};\n        this._onEvent = (evt) => {\n            if (this._ignoreFiredEvents === true) {\n                return;\n            }\n            if (!this._targetViewports.length) {\n                return;\n            }\n            const enabledElement = this._eventSource === 'element'\n                ? getEnabledElement(evt.currentTarget)\n                : getEnabledElementByViewportId(evt.detail?.viewportId);\n            if (!enabledElement) {\n                return;\n            }\n            const { renderingEngineId, viewportId } = enabledElement;\n            if (!this._sourceViewports.find((s) => s.viewportId === viewportId)) {\n                return;\n            }\n            this.fireEvent({\n                renderingEngineId,\n                viewportId,\n            }, evt);\n        };\n        this._enabled = true;\n        this._eventName = eventName;\n        this._eventHandler = eventHandler;\n        this._ignoreFiredEvents = false;\n        this._sourceViewports = [];\n        this._targetViewports = [];\n        this._options = options || {};\n        this._eventSource = this._options.eventSource || 'element';\n        this._auxiliaryEvents = this._options.auxiliaryEvents || [];\n        this.id = synchronizerId;\n    }\n    isDisabled() {\n        return !this._enabled || !this._hasSourceElements();\n    }\n    setOptions(viewportId, options = {}) {\n        this._viewportOptions[viewportId] = options;\n    }\n    setEnabled(enabled) {\n        this._enabled = enabled;\n    }\n    getOptions(viewportId) {\n        return this._viewportOptions[viewportId];\n    }\n    add(viewportInfo) {\n        this.addTarget(viewportInfo);\n        this.addSource(viewportInfo);\n    }\n    addSource(viewportInfo) {\n        if (_containsViewport(this._sourceViewports, viewportInfo)) {\n            return;\n        }\n        const { renderingEngineId, viewportId } = viewportInfo;\n        const viewport = getRenderingEngine(renderingEngineId).getViewport(viewportId);\n        if (!viewport) {\n            console.warn(`Synchronizer.addSource: No viewport for ${renderingEngineId} ${viewportId}`);\n            return;\n        }\n        const eventSource = this._eventSource === 'element' ? viewport.element : eventTarget;\n        eventSource.addEventListener(this._eventName, this._onEvent.bind(this));\n        this._auxiliaryEvents.forEach(({ name, source }) => {\n            const target = source === 'element' ? viewport.element : eventTarget;\n            target.addEventListener(name, this._onEvent.bind(this));\n        });\n        this._updateDisableHandlers();\n        this._sourceViewports.push(viewportInfo);\n    }\n    addTarget(viewportInfo) {\n        if (_containsViewport(this._targetViewports, viewportInfo)) {\n            return;\n        }\n        this._targetViewports.push(viewportInfo);\n        this._updateDisableHandlers();\n    }\n    getSourceViewports() {\n        return this._sourceViewports;\n    }\n    getTargetViewports() {\n        return this._targetViewports;\n    }\n    destroy() {\n        this._sourceViewports.forEach((s) => this.removeSource(s));\n        this._targetViewports.forEach((t) => this.removeTarget(t));\n    }\n    remove(viewportInfo) {\n        this.removeTarget(viewportInfo);\n        this.removeSource(viewportInfo);\n    }\n    removeSource(viewportInfo) {\n        const index = _getViewportIndex(this._sourceViewports, viewportInfo);\n        if (index === -1) {\n            return;\n        }\n        const eventSource = this._eventSource === 'element'\n            ? this.getViewportElement(viewportInfo)\n            : eventTarget;\n        this._sourceViewports.splice(index, 1);\n        eventSource.removeEventListener(this._eventName, this._eventHandler);\n        this._auxiliaryEvents.forEach(({ name, source }) => {\n            const target = source === 'element'\n                ? this.getViewportElement(viewportInfo)\n                : eventTarget;\n            target.removeEventListener(name, this._eventHandler);\n        });\n        this._updateDisableHandlers();\n    }\n    removeTarget(viewportInfo) {\n        const index = _getViewportIndex(this._targetViewports, viewportInfo);\n        if (index === -1) {\n            return;\n        }\n        this._targetViewports.splice(index, 1);\n        this._updateDisableHandlers();\n    }\n    hasSourceViewport(renderingEngineId, viewportId) {\n        return _containsViewport(this._sourceViewports, {\n            renderingEngineId,\n            viewportId,\n        });\n    }\n    hasTargetViewport(renderingEngineId, viewportId) {\n        return _containsViewport(this._targetViewports, {\n            renderingEngineId,\n            viewportId,\n        });\n    }\n    fireEvent(sourceViewport, sourceEvent) {\n        if (this.isDisabled() || this._ignoreFiredEvents) {\n            return;\n        }\n        this._ignoreFiredEvents = true;\n        const promises = [];\n        try {\n            for (let i = 0; i < this._targetViewports.length; i++) {\n                const targetViewport = this._targetViewports[i];\n                const targetIsSource = sourceViewport.viewportId === targetViewport.viewportId;\n                if (targetIsSource) {\n                    continue;\n                }\n                const result = this._eventHandler(this, sourceViewport, targetViewport, sourceEvent, this._options);\n                if (result instanceof Promise) {\n                    promises.push(result);\n                }\n            }\n        }\n        catch (ex) {\n            console.warn(`Synchronizer, for: ${this._eventName}`, ex);\n        }\n        finally {\n            if (promises.length) {\n                Promise.allSettled(promises).then(() => {\n                    this._ignoreFiredEvents = false;\n                });\n            }\n            else {\n                this._ignoreFiredEvents = false;\n            }\n        }\n    }\n    _hasSourceElements() {\n        return this._sourceViewports.length !== 0;\n    }\n    _updateDisableHandlers() {\n        const viewports = _getUniqueViewports(this._sourceViewports, this._targetViewports);\n        const _remove = this.remove.bind(this);\n        const disableHandler = (elementDisabledEvent) => {\n            _remove(elementDisabledEvent.detail.element);\n        };\n        viewports.forEach((vp) => {\n            const eventSource = this.getEventSource(vp);\n            if (!eventSource) {\n                return;\n            }\n            eventSource.removeEventListener(Enums.Events.ELEMENT_DISABLED, disableHandler);\n            eventSource.addEventListener(Enums.Events.ELEMENT_DISABLED, disableHandler);\n        });\n    }\n    getEventSource(viewportInfo) {\n        return this._eventSource === 'element'\n            ? this.getViewportElement(viewportInfo)\n            : eventTarget;\n    }\n    getViewportElement(viewportInfo) {\n        const { renderingEngineId, viewportId } = viewportInfo;\n        const renderingEngine = getRenderingEngine(renderingEngineId);\n        if (!renderingEngine) {\n            return null;\n        }\n        const viewport = renderingEngine.getViewport(viewportId);\n        if (!viewport) {\n            return null;\n        }\n        return viewport.element;\n    }\n}\nfunction _getUniqueViewports(vp1, vp2) {\n    const unique = [];\n    const vps = vp1.concat(vp2);\n    for (let i = 0; i < vps.length; i++) {\n        const vp = vps[i];\n        if (!unique.some((u) => vp.renderingEngineId === u.renderingEngineId &&\n            vp.viewportId === u.viewportId)) {\n            unique.push(vp);\n        }\n    }\n    return unique;\n}\nfunction _getViewportIndex(arr, vp) {\n    return arr.findIndex((ar) => vp.renderingEngineId === ar.renderingEngineId &&\n        vp.viewportId === ar.viewportId);\n}\nfunction _containsViewport(arr, vp) {\n    return arr.some((ar) => ar.renderingEngineId === vp.renderingEngineId &&\n        ar.viewportId === vp.viewportId);\n}\nexport default Synchronizer;\n","import { state } from '../state';\nimport Synchronizer, {} from './Synchronizer';\nfunction createSynchronizer(synchronizerId, eventName, eventHandler, options) {\n    const synchronizerWithSameIdExists = state.synchronizers.some((sync) => sync.id === synchronizerId);\n    if (synchronizerWithSameIdExists) {\n        throw new Error(`Synchronizer with id '${synchronizerId}' already exists.`);\n    }\n    const synchronizer = new Synchronizer(synchronizerId, eventName, eventHandler, options);\n    state.synchronizers.push(synchronizer);\n    return synchronizer;\n}\nexport default createSynchronizer;\n","import { state } from '../state';\nfunction destroy() {\n    while (state.synchronizers.length > 0) {\n        const synchronizer = state.synchronizers.pop();\n        synchronizer.destroy();\n    }\n}\nexport default destroy;\n","import { state } from '../state';\nfunction getSynchronizer(synchronizerId) {\n    return state.synchronizers.find((s) => s.id === synchronizerId);\n}\nexport default getSynchronizer;\n","import { state } from '../state';\nfunction getAllSynchronizers() {\n    return state.synchronizers;\n}\nexport default getAllSynchronizers;\n","import { state } from '../state';\nfunction destroySynchronizer(synchronizerId) {\n    const synchronizerIndex = state.synchronizers.findIndex((sync) => sync.id === synchronizerId);\n    if (synchronizerIndex > -1) {\n        const synchronizer = state.synchronizers[synchronizerIndex];\n        synchronizer.destroy();\n        state.synchronizers.splice(synchronizerIndex, 1);\n    }\n}\nexport default destroySynchronizer;\n","import { triggerSegmentationRender } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nconst segmentationRepresentationModifiedListener = function (evt) {\n    const { viewportId } = evt.detail;\n    triggerSegmentationRender(viewportId);\n};\nexport default segmentationRepresentationModifiedListener;\n","import { eventTarget, Enums } from '@cornerstonejs/core';\nimport { getAnnotationManager } from './stateManagement/annotation/annotationState';\nimport { Events as TOOLS_EVENTS } from './enums';\nimport { addEnabledElement, removeEnabledElement } from './store';\nimport { resetCornerstoneToolsState } from './store/state';\nimport { annotationCompletedListener, annotationRemovedListener, annotationSelectionListener, annotationModifiedListener, segmentationDataModifiedEventListener, segmentationModifiedListener, } from './eventListeners';\nimport { annotationInterpolationEventDispatcher } from './eventDispatchers';\nimport * as ToolGroupManager from './store/ToolGroupManager';\nimport { defaultSegmentationStateManager } from './stateManagement/segmentation/SegmentationStateManager';\nimport segmentationRepresentationModifiedListener from './eventListeners/segmentation/segmentationRepresentationModifiedListener';\nlet csToolsInitialized = false;\nexport function init(defaultConfiguration = {}) {\n    if (csToolsInitialized) {\n        return;\n    }\n    _addCornerstoneEventListeners();\n    _addCornerstoneToolsEventListeners();\n    csToolsInitialized = true;\n}\nexport function destroy() {\n    _removeCornerstoneEventListeners();\n    _removeCornerstoneToolsEventListeners();\n    ToolGroupManager.destroy();\n    resetCornerstoneToolsState();\n    const annotationManager = getAnnotationManager();\n    const segmentationStateManager = defaultSegmentationStateManager;\n    annotationManager.restoreAnnotations({});\n    segmentationStateManager.resetState();\n    csToolsInitialized = false;\n}\nfunction _addCornerstoneEventListeners() {\n    _removeCornerstoneEventListeners();\n    const elementEnabledEvent = Enums.Events.ELEMENT_ENABLED;\n    const elementDisabledEvent = Enums.Events.ELEMENT_DISABLED;\n    eventTarget.addEventListener(elementEnabledEvent, addEnabledElement);\n    eventTarget.addEventListener(elementDisabledEvent, removeEnabledElement);\n    annotationInterpolationEventDispatcher.enable();\n}\nfunction _removeCornerstoneEventListeners() {\n    const elementEnabledEvent = Enums.Events.ELEMENT_ENABLED;\n    const elementDisabledEvent = Enums.Events.ELEMENT_DISABLED;\n    eventTarget.removeEventListener(elementEnabledEvent, addEnabledElement);\n    eventTarget.removeEventListener(elementDisabledEvent, removeEnabledElement);\n    annotationInterpolationEventDispatcher.disable();\n}\nfunction _addCornerstoneToolsEventListeners() {\n    _removeCornerstoneToolsEventListeners();\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_COMPLETED, annotationCompletedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_MODIFIED, annotationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_REMOVED, annotationRemovedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_MODIFIED, segmentationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_DATA_MODIFIED, segmentationDataModifiedEventListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_MODIFIED, segmentationRepresentationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_ADDED, segmentationRepresentationModifiedListener);\n}\nfunction _removeCornerstoneToolsEventListeners() {\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_COMPLETED, annotationCompletedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_MODIFIED, annotationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_MODIFIED, segmentationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_DATA_MODIFIED, segmentationDataModifiedEventListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_MODIFIED, segmentationRepresentationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_ADDED, segmentationRepresentationModifiedListener);\n}\nexport default init;\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function cameraSyncCallback(synchronizerInstance, sourceViewport, targetViewport, cameraModifiedEvent) {\n    const { camera } = cameraModifiedEvent.detail;\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    tViewport.setCamera(camera);\n    tViewport.render();\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport cameraSyncCallback from '../callbacks/cameraSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createCameraPositionSynchronizer(synchronizerName) {\n    const cameraPositionSynchronizer = createSynchronizer(synchronizerName, CAMERA_MODIFIED, cameraSyncCallback);\n    return cameraPositionSynchronizer;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function presentationViewSyncCallback(_synchronizerInstance, sourceViewport, targetViewport, _sourceEvent, options) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const presentationView = sViewport.getViewPresentation(options);\n    tViewport.setViewPresentation(presentationView);\n    tViewport.render();\n}\n","import { Enums } from '@cornerstonejs/core';\nimport { createSynchronizer } from '../../store/SynchronizerManager';\nimport presentationViewSyncCallback from '../callbacks/presentationViewSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createPresentationViewSynchronizer(synchronizerName, options) {\n    const presentationView = createSynchronizer(synchronizerName, CAMERA_MODIFIED, presentationViewSyncCallback, { viewPresentation: options });\n    return presentationView;\n}\n","import { BaseVolumeViewport, getRenderingEngine, StackViewport, } from '@cornerstonejs/core';\nexport default function voiSyncCallback(synchronizerInstance, sourceViewport, targetViewport, modifiedEvent, options) {\n    const eventDetail = modifiedEvent.detail;\n    const { volumeId, range, invertStateChanged, invert, colormap } = eventDetail;\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`Rendering Engine does not exist: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const tProperties = {\n        voiRange: range,\n    };\n    if (options?.syncInvertState && invertStateChanged) {\n        tProperties.invert = invert;\n    }\n    if (options?.syncColormap && colormap) {\n        tProperties.colormap = colormap;\n    }\n    if (tViewport instanceof BaseVolumeViewport) {\n        const isFusion = tViewport._actors && tViewport._actors.size > 1;\n        if (isFusion) {\n            tViewport.setProperties(tProperties, volumeId);\n        }\n        else {\n            tViewport.setProperties(tProperties);\n        }\n    }\n    else if (tViewport instanceof StackViewport) {\n        tViewport.setProperties(tProperties);\n    }\n    else {\n        throw new Error('Viewport type not supported.');\n    }\n    tViewport.render();\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport voiSyncCallback from '../callbacks/voiSyncCallback';\nexport default function createVOISynchronizer(synchronizerName, options) {\n    options = Object.assign({ syncInvertState: true, syncColormap: true }, options);\n    const VOISynchronizer = createSynchronizer(synchronizerName, Enums.Events.VOI_MODIFIED, voiSyncCallback, {\n        auxiliaryEvents: [\n            {\n                name: Enums.Events.COLORMAP_MODIFIED,\n            },\n        ],\n        ...options,\n    });\n    return VOISynchronizer;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function zoomPanSyncCallback(synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const options = synchronizerInstance.getOptions(targetViewport.viewportId);\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    if (options?.syncZoom !== false) {\n        const srcZoom = sViewport.getZoom();\n        tViewport.setZoom(srcZoom);\n    }\n    if (options?.syncPan !== false) {\n        const srcPan = sViewport.getPan();\n        tViewport.setPan(srcPan);\n    }\n    tViewport.render();\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport zoomPanSyncCallback from '../callbacks/zoomPanSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createZoomPanSynchronizer(synchronizerName) {\n    const zoomPanSynchronizer = createSynchronizer(synchronizerName, CAMERA_MODIFIED, zoomPanSyncCallback);\n    return zoomPanSynchronizer;\n}\n","import { vec3, mat4 } from 'gl-matrix';\nimport { getRenderingEngine, metaData, utilities, VolumeViewport, } from '@cornerstonejs/core';\nimport areViewportsCoplanar from './areViewportsCoplanar';\nconst getSpatialRegistration = (targetId, sourceId) => utilities.spatialRegistrationMetadataProvider.get('spatialRegistrationModule', targetId, sourceId);\nexport default async function imageSliceSyncCallback(synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const options = synchronizerInstance.getOptions(targetViewport.viewportId);\n    if (options?.disabled) {\n        return;\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const imageId1 = sViewport.getCurrentImageId();\n    const imagePlaneModule1 = metaData.get('imagePlaneModule', imageId1);\n    const sourceImagePositionPatient = imagePlaneModule1.imagePositionPatient;\n    const targetImageIds = tViewport.getImageIds();\n    if (!areViewportsCoplanar(sViewport, tViewport)) {\n        return;\n    }\n    let registrationMatrixMat4 = getSpatialRegistration(targetViewport.viewportId, sourceViewport.viewportId);\n    if (!registrationMatrixMat4) {\n        const frameOfReferenceUID1 = sViewport.getFrameOfReferenceUID();\n        const frameOfReferenceUID2 = tViewport.getFrameOfReferenceUID();\n        if (frameOfReferenceUID1 === frameOfReferenceUID2 &&\n            options?.useInitialPosition !== false) {\n            registrationMatrixMat4 = mat4.identity(mat4.create());\n        }\n        else {\n            utilities.calculateViewportsSpatialRegistration(sViewport, tViewport);\n            registrationMatrixMat4 = getSpatialRegistration(targetViewport.viewportId, sourceViewport.viewportId);\n        }\n        if (!registrationMatrixMat4) {\n            return;\n        }\n    }\n    const targetImagePositionPatientWithRegistrationMatrix = vec3.transformMat4(vec3.create(), sourceImagePositionPatient, registrationMatrixMat4);\n    const closestImageIdIndex2 = _getClosestImageIdIndex(targetImagePositionPatientWithRegistrationMatrix, targetImageIds);\n    let imageIndexToSet = closestImageIdIndex2.index;\n    if (tViewport instanceof VolumeViewport) {\n        imageIndexToSet = targetImageIds.length - closestImageIdIndex2.index - 1;\n    }\n    if (closestImageIdIndex2.index !== -1 &&\n        tViewport.getCurrentImageIdIndex() !== closestImageIdIndex2.index) {\n        await utilities.jumpToSlice(tViewport.element, {\n            imageIndex: imageIndexToSet,\n        });\n    }\n}\nfunction _getClosestImageIdIndex(targetPoint, imageIds) {\n    return imageIds.reduce((closestImageIdIndex, imageId, index) => {\n        const { imagePositionPatient } = metaData.get('imagePlaneModule', imageId);\n        const distance = vec3.distance(imagePositionPatient, targetPoint);\n        if (distance < closestImageIdIndex.distance) {\n            return {\n                distance,\n                index,\n            };\n        }\n        return closestImageIdIndex;\n    }, {\n        distance: Infinity,\n        index: -1,\n    });\n}\n","import { vec3 } from 'gl-matrix';\nexport default function areViewportsCoplanar(viewport1, viewport2) {\n    const { viewPlaneNormal: viewPlaneNormal1 } = viewport1.getCamera();\n    const { viewPlaneNormal: viewPlaneNormal2 } = viewport2.getCamera();\n    const dotProducts = vec3.dot(viewPlaneNormal1, viewPlaneNormal2);\n    return Math.abs(dotProducts) > 0.9;\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport imageSliceSyncCallback from '../callbacks/imageSliceSyncCallback';\nconst { STACK_NEW_IMAGE, VOLUME_NEW_IMAGE } = Enums.Events;\nexport default function createImageSliceSynchronizer(synchronizerName) {\n    const stackImageSynchronizer = createSynchronizer(synchronizerName, STACK_NEW_IMAGE, imageSliceSyncCallback, {\n        auxiliaryEvents: [\n            {\n                name: 'VOLUME_NEW_IMAGE',\n            },\n        ],\n    });\n    return stackImageSynchronizer;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function slabThicknessSyncCallback(_synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const slabThickness = sViewport.getSlabThickness?.();\n    if (!slabThickness) {\n        return;\n    }\n    tViewport.setSlabThickness?.(slabThickness);\n    tViewport.render();\n}\n","import { Enums } from '@cornerstonejs/core';\nimport { createSynchronizer } from '../../store/SynchronizerManager';\nimport slabThicknessSyncCallback from '../callbacks/slabThicknessSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createPresentationViewSynchronizer(synchronizerName) {\n    const presentationView = createSynchronizer(synchronizerName, CAMERA_MODIFIED, slabThicknessSyncCallback);\n    return presentationView;\n}\n","import createCameraPositionSynchronizer from './synchronizers/createCameraPositionSynchronizer';\nimport createPresentationViewSynchronizer from './synchronizers/createPresentationViewSynchronizer';\nimport createVOISynchronizer from './synchronizers/createVOISynchronizer';\nimport createZoomPanSynchronizer from './synchronizers/createZoomPanSynchronizer';\nimport createImageSliceSynchronizer from './synchronizers/createImageSliceSynchronizer';\nimport createSlabThicknessSynchronizer from './synchronizers/createSlabThicknessSynchronizer';\nconst createStackImageSynchronizer = createImageSliceSynchronizer;\nexport { createCameraPositionSynchronizer, createPresentationViewSynchronizer, createVOISynchronizer, createZoomPanSynchronizer, createImageSliceSynchronizer, createStackImageSynchronizer, createSlabThicknessSynchronizer, };\n","import { BaseTool } from './base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nclass PanTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    touchDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    mouseDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    _dragCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const deltaPointsWorld = deltaPoints.world;\n        if (deltaPointsWorld[0] === 0 &&\n            deltaPointsWorld[1] === 0 &&\n            deltaPointsWorld[2] === 0) {\n            return;\n        }\n        const camera = enabledElement.viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        enabledElement.viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        enabledElement.viewport.render();\n    }\n}\nPanTool.toolName = 'Pan';\nexport default PanTool;\n","import vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { Events } from '../enums';\nimport { eventTarget, getEnabledElement, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { BaseTool } from './base';\nimport { getToolGroup } from '../store/ToolGroupManager';\nclass TrackballRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            rotateIncrementDegrees: 2,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._resizeObservers = new Map();\n        this._hasResolutionChanged = false;\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const actorEntry = viewport.getDefaultActor();\n            const actor = actorEntry.actor;\n            const mapper = actor.getMapper();\n            const hasSampleDistance = 'getSampleDistance' in mapper || 'getCurrentSampleDistance' in mapper;\n            if (!hasSampleDistance) {\n                return true;\n            }\n            const originalSampleDistance = mapper.getSampleDistance();\n            if (!this._hasResolutionChanged) {\n                mapper.setSampleDistance(originalSampleDistance * 2);\n                this._hasResolutionChanged = true;\n                if (this.cleanUp !== null) {\n                    document.removeEventListener('mouseup', this.cleanUp);\n                }\n                this.cleanUp = () => {\n                    mapper.setSampleDistance(originalSampleDistance);\n                    viewport.render();\n                    this._hasResolutionChanged = false;\n                };\n                document.addEventListener('mouseup', this.cleanUp, { once: true });\n            }\n            return true;\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.onSetToolActive = () => {\n            const subscribeToElementResize = () => {\n                const viewportsInfo = this._getViewportsInfo();\n                viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                    if (!this._resizeObservers.has(viewportId)) {\n                        const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId) || { viewport: null };\n                        if (!viewport) {\n                            return;\n                        }\n                        const { element } = viewport;\n                        const resizeObserver = new ResizeObserver(() => {\n                            const element = getEnabledElementByIds(viewportId, renderingEngineId);\n                            if (!element) {\n                                return;\n                            }\n                            const { viewport } = element;\n                            viewport.resetCamera();\n                            viewport.render();\n                        });\n                        resizeObserver.observe(element);\n                        this._resizeObservers.set(viewportId, resizeObserver);\n                    }\n                });\n            };\n            subscribeToElementResize();\n            this._viewportAddedListener = (evt) => {\n                if (evt.detail.toolGroupId === this.toolGroupId) {\n                    subscribeToElementResize();\n                }\n            };\n            eventTarget.addEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, this._viewportAddedListener);\n        };\n        this.onSetToolDisabled = () => {\n            this._resizeObservers.forEach((resizeObserver, viewportId) => {\n                resizeObserver.disconnect();\n                this._resizeObservers.delete(viewportId);\n            });\n            if (this._viewportAddedListener) {\n                eventTarget.removeEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, this._viewportAddedListener);\n                this._viewportAddedListener = null;\n            }\n        };\n        this.rotateCamera = (viewport, centerWorld, axis, angle) => {\n            const vtkCamera = viewport.getVtkActiveCamera();\n            const viewUp = vtkCamera.getViewUp();\n            const focalPoint = vtkCamera.getFocalPoint();\n            const position = vtkCamera.getPosition();\n            const newPosition = [0, 0, 0];\n            const newFocalPoint = [0, 0, 0];\n            const newViewUp = [0, 0, 0];\n            const transform = mat4.identity(new Float32Array(16));\n            mat4.translate(transform, transform, centerWorld);\n            mat4.rotate(transform, transform, angle, axis);\n            mat4.translate(transform, transform, [\n                -centerWorld[0],\n                -centerWorld[1],\n                -centerWorld[2],\n            ]);\n            vec3.transformMat4(newPosition, position, transform);\n            vec3.transformMat4(newFocalPoint, focalPoint, transform);\n            mat4.identity(transform);\n            mat4.rotate(transform, transform, angle, axis);\n            vec3.transformMat4(newViewUp, viewUp, transform);\n            viewport.setCamera({\n                position: newPosition,\n                viewUp: newViewUp,\n                focalPoint: newFocalPoint,\n            });\n        };\n        this.touchDragCallback = this._dragCallback.bind(this);\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _dragCallback(evt) {\n        const { element, currentPoints, lastPoints } = evt.detail;\n        const currentPointsCanvas = currentPoints.canvas;\n        const lastPointsCanvas = lastPoints.canvas;\n        const { rotateIncrementDegrees } = this.configuration;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const width = element.clientWidth;\n        const height = element.clientHeight;\n        const normalizedPosition = [\n            currentPointsCanvas[0] / width,\n            currentPointsCanvas[1] / height,\n        ];\n        const normalizedPreviousPosition = [\n            lastPointsCanvas[0] / width,\n            lastPointsCanvas[1] / height,\n        ];\n        const center = [width * 0.5, height * 0.5];\n        const centerWorld = viewport.canvasToWorld(center);\n        const normalizedCenter = [0.5, 0.5];\n        const radsq = (1.0 + Math.abs(normalizedCenter[0])) ** 2.0;\n        const op = [normalizedPreviousPosition[0], 0, 0];\n        const oe = [normalizedPosition[0], 0, 0];\n        const opsq = op[0] ** 2;\n        const oesq = oe[0] ** 2;\n        const lop = opsq > radsq ? 0 : Math.sqrt(radsq - opsq);\n        const loe = oesq > radsq ? 0 : Math.sqrt(radsq - oesq);\n        const nop = [op[0], 0, lop];\n        vtkMath.normalize(nop);\n        const noe = [oe[0], 0, loe];\n        vtkMath.normalize(noe);\n        const dot = vtkMath.dot(nop, noe);\n        if (Math.abs(dot) > 0.0001) {\n            const angleX = -2 *\n                Math.acos(vtkMath.clampValue(dot, -1.0, 1.0)) *\n                Math.sign(normalizedPosition[0] - normalizedPreviousPosition[0]) *\n                rotateIncrementDegrees;\n            const upVec = camera.viewUp;\n            const atV = camera.viewPlaneNormal;\n            const rightV = [0, 0, 0];\n            const forwardV = [0, 0, 0];\n            vtkMath.cross(upVec, atV, rightV);\n            vtkMath.normalize(rightV);\n            vtkMath.cross(atV, rightV, forwardV);\n            vtkMath.normalize(forwardV);\n            vtkMath.normalize(upVec);\n            this.rotateCamera(viewport, centerWorld, forwardV, angleX);\n            const angleY = (normalizedPreviousPosition[1] - normalizedPosition[1]) *\n                rotateIncrementDegrees;\n            this.rotateCamera(viewport, centerWorld, rightV, angleY);\n            viewport.render();\n        }\n    }\n}\nTrackballRotateTool.toolName = 'TrackballRotate';\nexport default TrackballRotateTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement, VolumeViewport, cache, utilities, } from '@cornerstonejs/core';\nconst DEFAULT_MULTIPLIER = 4;\nconst DEFAULT_IMAGE_DYNAMIC_RANGE = 1024;\nconst PT = 'PT';\nclass WindowLevelTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this._getImageDynamicRangeFromMiddleSlice = (scalarData, dimensions) => {\n            const middleSliceIndex = Math.floor(dimensions[2] / 2);\n            const frameLength = dimensions[0] * dimensions[1];\n            let bytesPerVoxel;\n            let TypedArrayConstructor;\n            if (scalarData instanceof Float32Array) {\n                bytesPerVoxel = 4;\n                TypedArrayConstructor = Float32Array;\n            }\n            else if (scalarData instanceof Uint8Array) {\n                bytesPerVoxel = 1;\n                TypedArrayConstructor = Uint8Array;\n            }\n            else if (scalarData instanceof Uint16Array) {\n                bytesPerVoxel = 2;\n                TypedArrayConstructor = Uint16Array;\n            }\n            else if (scalarData instanceof Int16Array) {\n                bytesPerVoxel = 2;\n                TypedArrayConstructor = Int16Array;\n            }\n            const buffer = scalarData.buffer;\n            const byteOffset = middleSliceIndex * frameLength * bytesPerVoxel;\n            const frame = new TypedArrayConstructor(buffer, byteOffset, frameLength);\n            const { max, min } = this._getMinMax(frame, frameLength);\n            return max - min;\n        };\n    }\n    touchDragCallback(evt) {\n        this.mouseDragCallback(evt);\n    }\n    mouseDragCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let volumeId, lower, upper, modality, newRange, viewportsContainingVolumeUID;\n        let isPreScaled = false;\n        const properties = viewport.getProperties();\n        if (viewport instanceof VolumeViewport) {\n            volumeId = viewport.getVolumeId();\n            viewportsContainingVolumeUID =\n                utilities.getViewportsWithVolumeId(volumeId);\n            ({ lower, upper } = properties.voiRange);\n            const volume = cache.getVolume(volumeId);\n            if (!volume) {\n                throw new Error('Volume not found ' + volumeId);\n            }\n            modality = volume.metadata.Modality;\n            isPreScaled = volume.scaling && Object.keys(volume.scaling).length > 0;\n        }\n        else if (properties.voiRange) {\n            modality = viewport.modality;\n            ({ lower, upper } = properties.voiRange);\n            const { preScale = { scaled: false } } = viewport.getImageData?.() || {};\n            isPreScaled =\n                preScale.scaled && preScale.scalingParameters?.suvbw !== undefined;\n        }\n        else {\n            throw new Error('Viewport is not a valid type');\n        }\n        if (modality === PT && isPreScaled) {\n            newRange = this.getPTScaledNewRange({\n                deltaPointsCanvas: deltaPoints.canvas,\n                lower,\n                upper,\n                clientHeight: element.clientHeight,\n                isPreScaled,\n                viewport,\n                volumeId,\n            });\n        }\n        else {\n            newRange = this.getNewRange({\n                viewport,\n                deltaPointsCanvas: deltaPoints.canvas,\n                volumeId,\n                lower,\n                upper,\n            });\n        }\n        if (newRange.lower >= newRange.upper) {\n            return;\n        }\n        viewport.setProperties({\n            voiRange: newRange,\n        });\n        viewport.render();\n        if (viewport instanceof VolumeViewport) {\n            viewportsContainingVolumeUID.forEach((vp) => {\n                if (viewport !== vp) {\n                    vp.render();\n                }\n            });\n            return;\n        }\n    }\n    getPTScaledNewRange({ deltaPointsCanvas, lower, upper, clientHeight, viewport, volumeId, isPreScaled, }) {\n        let multiplier = DEFAULT_MULTIPLIER;\n        if (isPreScaled) {\n            multiplier = 5 / clientHeight;\n        }\n        else {\n            multiplier =\n                this._getMultiplierFromDynamicRange(viewport, volumeId) ||\n                    DEFAULT_MULTIPLIER;\n        }\n        const deltaY = deltaPointsCanvas[1];\n        const wcDelta = deltaY * multiplier;\n        upper -= wcDelta;\n        upper = isPreScaled ? Math.max(upper, 0.1) : upper;\n        return { lower, upper };\n    }\n    getNewRange({ viewport, deltaPointsCanvas, volumeId, lower, upper }) {\n        const multiplier = this._getMultiplierFromDynamicRange(viewport, volumeId) ||\n            DEFAULT_MULTIPLIER;\n        const wwDelta = deltaPointsCanvas[0] * multiplier;\n        const wcDelta = deltaPointsCanvas[1] * multiplier;\n        let { windowWidth, windowCenter } = utilities.windowLevel.toWindowLevel(lower, upper);\n        windowWidth += wwDelta;\n        windowCenter += wcDelta;\n        windowWidth = Math.max(windowWidth, 1);\n        return utilities.windowLevel.toLowHighRange(windowWidth, windowCenter);\n    }\n    _getMultiplierFromDynamicRange(viewport, volumeId) {\n        let imageDynamicRange;\n        if (volumeId) {\n            const imageVolume = cache.getVolume(volumeId);\n            const { voxelManager } = viewport.getImageData();\n            const middleSlicePixelData = voxelManager.getMiddleSliceData();\n            const calculatedDynamicRange = middleSlicePixelData.reduce((acc, pixel) => {\n                return [Math.min(acc[0], pixel), Math.max(acc[1], pixel)];\n            }, [Infinity, -Infinity]);\n            const BitsStored = imageVolume?.metadata?.BitsStored;\n            const metadataDynamicRange = BitsStored ? 2 ** BitsStored : Infinity;\n            imageDynamicRange = Math.min(calculatedDynamicRange, metadataDynamicRange);\n        }\n        else {\n            imageDynamicRange = this._getImageDynamicRangeFromViewport(viewport);\n        }\n        const ratio = imageDynamicRange / DEFAULT_IMAGE_DYNAMIC_RANGE;\n        return ratio > 1 ? Math.round(ratio) : ratio;\n    }\n    _getImageDynamicRangeFromViewport(viewport) {\n        const { imageData, voxelManager } = viewport.getImageData();\n        if (voxelManager?.getRange) {\n            const range = voxelManager.getRange();\n            return range[1] - range[0];\n        }\n        const dimensions = imageData.getDimensions();\n        if (imageData.getRange) {\n            const imageDataRange = imageData.getRange();\n            return imageDataRange[1] - imageDataRange[0];\n        }\n        let scalarData;\n        if (imageData.getScalarData) {\n            scalarData = imageData.getScalarData();\n        }\n        else {\n            scalarData = imageData.getPointData().getScalars().getData();\n        }\n        if (dimensions[2] !== 1) {\n            return this._getImageDynamicRangeFromMiddleSlice(scalarData, dimensions);\n        }\n        let range;\n        if (scalarData.getRange) {\n            range = scalarData.getRange();\n        }\n        else {\n            const { min, max } = this._getMinMax(scalarData, scalarData.length);\n            range = [min, max];\n        }\n        return range[1] - range[0];\n    }\n    _getMinMax(frame, frameLength) {\n        let min = Infinity;\n        let max = -Infinity;\n        for (let i = 0; i < frameLength; i++) {\n            const voxel = frame[i];\n            if (voxel < min) {\n                min = voxel;\n            }\n            if (voxel > max) {\n                max = voxel;\n            }\n        }\n        return { max, min };\n    }\n}\nWindowLevelTool.toolName = 'WindowLevel';\nexport default WindowLevelTool;\n","import { AnnotationTool } from './base';\nimport { getEnabledElement, utilities } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../stateManagement';\nimport { triggerAnnotationCompleted } from '../stateManagement/annotation/helpers/state';\nimport { drawRect as drawRectSvg } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { windowLevel } from '../utilities/voi';\nclass WindowLevelRegionTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            minWindowWidth: 10,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            removeAnnotation(annotation.annotationUID);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            triggerAnnotationCompleted(annotation);\n            this.applyWindowLevelRegion(annotation, element);\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            const { currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n            const worldPos = currentPoints.world;\n            const { points } = data.handles;\n            const DEFAULT_HANDLE_INDEX = 3;\n            points[DEFAULT_HANDLE_INDEX] = [...worldPos];\n            const bottomLeftCanvas = worldToCanvas(points[0]);\n            const topRightCanvas = worldToCanvas(points[3]);\n            const bottomRightCanvas = [\n                topRightCanvas[0],\n                bottomLeftCanvas[1],\n            ];\n            const topLeftCanvas = [\n                bottomLeftCanvas[0],\n                topRightCanvas[1],\n            ];\n            const bottomRightWorld = canvasToWorld(bottomRightCanvas);\n            const topLeftWorld = canvasToWorld(topLeftCanvas);\n            points[1] = bottomRightWorld;\n            points[2] = topLeftWorld;\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const dataId = `${annotationUID}-rect`;\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this.applyWindowLevelRegion = (annotation, element) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const imageData = windowLevel.extractWindowLevelRegionToolData(viewport);\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const startCanvas = canvasCoordinates[0];\n            const endCanvas = canvasCoordinates[3];\n            let left = Math.min(startCanvas[0], endCanvas[0]);\n            let top = Math.min(startCanvas[1], endCanvas[1]);\n            let width = Math.abs(startCanvas[0] - endCanvas[0]);\n            let height = Math.abs(startCanvas[1] - endCanvas[1]);\n            left = utilities.clip(left, 0, imageData.width);\n            top = utilities.clip(top, 0, imageData.height);\n            width = Math.floor(Math.min(width, Math.abs(imageData.width - left)));\n            height = Math.floor(Math.min(height, Math.abs(imageData.height - top)));\n            const pixelLuminanceData = windowLevel.getLuminanceFromRegion(imageData, Math.round(left), Math.round(top), width, height);\n            const minMaxMean = windowLevel.calculateMinMaxMean(pixelLuminanceData, imageData.minPixelValue, imageData.maxPixelValue);\n            if (this.configuration.minWindowWidth === undefined) {\n                this.configuration.minWindowWidth = 10;\n            }\n            const windowWidth = Math.max(Math.abs(minMaxMean.max - minMaxMean.min), this.configuration.minWindowWidth);\n            const windowCenter = minMaxMean.mean;\n            const voiRange = utilities.windowLevel.toLowHighRange(windowWidth, windowCenter);\n            viewport.setProperties({ voiRange });\n            viewport.render();\n        };\n        this.cancel = () => {\n            return null;\n        };\n        this.isPointNearTool = () => {\n            return null;\n        };\n        this.toolSelectedCallback = () => {\n            return null;\n        };\n        this.handleSelectedCallback = () => {\n            return null;\n        };\n        this._activateModify = () => {\n            return null;\n        };\n        this._deactivateModify = () => {\n            return null;\n        };\n    }\n}\nWindowLevelRegionTool.toolName = 'WindowLevelRegion';\nexport default WindowLevelRegionTool;\n","import { getEnabledElementByIds, getEnabledElement, VolumeViewport, BaseVolumeViewport, utilities, } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nclass StackScrollTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            invert: false,\n            debounceIfNotLoaded: true,\n            loop: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.deltaY = 1;\n    }\n    mouseWheelCallback(evt) {\n        this._scroll(evt);\n    }\n    mouseDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    touchDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    _dragCallback(evt) {\n        this._scrollDrag(evt);\n    }\n    _scrollDrag(evt) {\n        const { deltaPoints, viewportId, renderingEngineId } = evt.detail;\n        const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n        const { debounceIfNotLoaded, invert, loop } = this.configuration;\n        const deltaPointY = deltaPoints.canvas[1];\n        let volumeId;\n        if (viewport instanceof VolumeViewport) {\n            volumeId = viewport.getVolumeId();\n        }\n        const pixelsPerImage = this._getPixelPerImage(viewport);\n        const deltaY = deltaPointY + this.deltaY;\n        if (!pixelsPerImage) {\n            return;\n        }\n        if (Math.abs(deltaY) >= pixelsPerImage) {\n            const imageIdIndexOffset = Math.round(deltaY / pixelsPerImage);\n            utilities.scroll(viewport, {\n                delta: invert ? -imageIdIndexOffset : imageIdIndexOffset,\n                volumeId,\n                debounceLoading: debounceIfNotLoaded,\n                loop: loop,\n            });\n            this.deltaY = deltaY % pixelsPerImage;\n        }\n        else {\n            this.deltaY = deltaY;\n        }\n    }\n    _scroll(evt) {\n        const { wheel, element } = evt.detail;\n        const { direction } = wheel;\n        const { invert } = this.configuration;\n        const { viewport } = getEnabledElement(element);\n        const delta = direction * (invert ? -1 : 1);\n        utilities.scroll(viewport, {\n            delta,\n            debounceLoading: this.configuration.debounceIfNotLoaded,\n            loop: this.configuration.loop,\n            volumeId: viewport instanceof BaseVolumeViewport\n                ? viewport.getVolumeId()\n                : undefined,\n            scrollSlabs: this.configuration.scrollSlabs,\n        });\n    }\n    _getPixelPerImage(viewport) {\n        const { element } = viewport;\n        const numberOfSlices = viewport.getNumberOfSlices();\n        return Math.max(2, element.offsetHeight / Math.max(numberOfSlices, 8));\n    }\n}\nStackScrollTool.toolName = 'StackScroll';\nexport default StackScrollTool;\n","import { BaseVolumeViewport, getEnabledElement } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { BaseTool } from './base';\nimport angleBetweenLines from '../utilities/math/angle/angleBetweenLines';\nclass PlanarRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.mouseWheelCallback = (evt) => {\n            const { element, wheel } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { invert } = this.configuration;\n            const angle = wheel.direction * 10 * (invert ? -1 : 1);\n            this.setAngle(viewport, angle);\n        };\n        this.touchDragCallback = this._dragCallback.bind(this);\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _dragCallback(evt) {\n        const { element, currentPoints, startPoints } = evt.detail;\n        const currentPointWorld = currentPoints.world;\n        const startPointWorld = startPoints.world;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const width = element.clientWidth;\n        const height = element.clientHeight;\n        const centerCanvas = [width * 0.5, height * 0.5];\n        const centerWorld = viewport.canvasToWorld(centerCanvas);\n        let angle = angleBetweenLines([startPointWorld, centerWorld], [centerWorld, currentPointWorld]);\n        const { viewPlaneNormal } = camera;\n        const v1 = vec3.sub(vec3.create(), centerWorld, startPointWorld);\n        const v2 = vec3.sub(vec3.create(), centerWorld, currentPointWorld);\n        const cross = vec3.cross(vec3.create(), v1, v2);\n        if (vec3.dot(viewPlaneNormal, cross) > 0) {\n            angle = -angle;\n        }\n        if (Number.isNaN(angle)) {\n            return;\n        }\n        this.setAngle(viewport, angle);\n    }\n    setAngle(viewport, angle) {\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        if (viewport instanceof BaseVolumeViewport) {\n            const rotAngle = (((angle + 360) % 360) * Math.PI) / 180;\n            const rotMat = mat4.identity(new Float32Array(16));\n            mat4.rotate(rotMat, rotMat, rotAngle, viewPlaneNormal);\n            const rotatedViewUp = vec3.transformMat4(vec3.create(), viewUp, rotMat);\n            viewport.setCamera({ viewUp: rotatedViewUp });\n        }\n        else {\n            const { rotation } = viewport.getViewPresentation();\n            viewport.setViewPresentation({\n                rotation: (rotation + angle + 360) % 360,\n            });\n        }\n        viewport.render();\n    }\n}\nPlanarRotateTool.toolName = 'PlanarRotate';\nexport default PlanarRotateTool;\n","import { vec3 } from 'gl-matrix';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nclass ZoomTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            zoomToCenter: false,\n            minZoomScale: 0.001,\n            maxZoomScale: 3000,\n            pinchToZoom: true,\n            pan: true,\n            invert: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const camera = enabledElement.viewport.getCamera();\n            const { focalPoint } = camera;\n            this.initialMousePosWorld = worldPos;\n            let dirVec = vec3.fromValues(focalPoint[0] - worldPos[0], focalPoint[1] - worldPos[1], focalPoint[2] - worldPos[2]);\n            dirVec = vec3.normalize(vec3.create(), dirVec);\n            this.dirVec = dirVec;\n            return false;\n        };\n        this.preTouchStartCallback = (evt) => {\n            if (!this.configuration.pinchToZoom) {\n                return this.preMouseDownCallback(evt);\n            }\n        };\n        this._dragParallelProjection = (evt, viewport, camera, pinch = false) => {\n            const { element, deltaPoints } = evt.detail;\n            const deltaY = pinch\n                ? evt.detail.deltaDistance.canvas\n                : deltaPoints.canvas[1];\n            const size = [element.clientWidth, element.clientHeight];\n            const { parallelScale, focalPoint, position } = camera;\n            const zoomScale = 5 / size[1];\n            const k = deltaY * zoomScale * (this.configuration.invert ? -1 : 1);\n            const parallelScaleToSet = (1.0 - k) * parallelScale;\n            let focalPointToSet = focalPoint;\n            let positionToSet = position;\n            if (!this.configuration.zoomToCenter) {\n                const distanceToCanvasCenter = vec3.distance(focalPoint, this.initialMousePosWorld);\n                positionToSet = vec3.scaleAndAdd(vec3.create(), position, this.dirVec, -distanceToCanvasCenter * k);\n                focalPointToSet = vec3.scaleAndAdd(vec3.create(), focalPoint, this.dirVec, -distanceToCanvasCenter * k);\n            }\n            const imageData = viewport.getImageData();\n            let spacing = [1, 1, 1];\n            if (imageData) {\n                spacing = imageData.spacing;\n            }\n            const { minZoomScale, maxZoomScale } = this.configuration;\n            const t = element.clientHeight * spacing[1] * 0.5;\n            const scale = t / parallelScaleToSet;\n            let cappedParallelScale = parallelScaleToSet;\n            let thresholdExceeded = false;\n            if (imageData) {\n                if (scale < minZoomScale) {\n                    cappedParallelScale = t / minZoomScale;\n                    thresholdExceeded = true;\n                }\n                else if (scale >= maxZoomScale) {\n                    cappedParallelScale = t / maxZoomScale;\n                    thresholdExceeded = true;\n                }\n            }\n            viewport.setCamera({\n                parallelScale: cappedParallelScale,\n                focalPoint: thresholdExceeded ? focalPoint : focalPointToSet,\n                position: thresholdExceeded ? position : positionToSet,\n            });\n        };\n        this._dragPerspectiveProjection = (evt, viewport, camera, pinch = false) => {\n            const { element, deltaPoints } = evt.detail;\n            const deltaY = pinch\n                ? evt.detail.deltaDistance.canvas\n                : deltaPoints.canvas[1];\n            const size = [element.clientWidth, element.clientHeight];\n            const { position, focalPoint, viewPlaneNormal } = camera;\n            const distance = vtkMath.distance2BetweenPoints(position, focalPoint);\n            const zoomScale = Math.sqrt(distance) / size[1];\n            const directionOfProjection = [\n                -viewPlaneNormal[0],\n                -viewPlaneNormal[1],\n                -viewPlaneNormal[2],\n            ];\n            const k = this.configuration.invert\n                ? deltaY / zoomScale\n                : deltaY * zoomScale;\n            let tmp = k * directionOfProjection[0];\n            position[0] += tmp;\n            focalPoint[0] += tmp;\n            tmp = k * directionOfProjection[1];\n            position[1] += tmp;\n            focalPoint[1] += tmp;\n            tmp = k * directionOfProjection[2];\n            position[2] += tmp;\n            focalPoint[2] += tmp;\n            viewport.setCamera({ position, focalPoint });\n        };\n        this.initialMousePosWorld = [0, 0, 0];\n        this.dirVec = [0, 0, 0];\n        if (this.configuration.pinchToZoom) {\n            this.touchDragCallback = this._pinchCallback.bind(this);\n        }\n        else {\n            this.touchDragCallback = this._dragCallback.bind(this);\n        }\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _pinchCallback(evt) {\n        const pointsList = evt.detail\n            .currentPointsList;\n        if (pointsList.length > 1) {\n            const { element, currentPoints } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const worldPos = currentPoints.world;\n            const { focalPoint } = camera;\n            this.initialMousePosWorld = worldPos;\n            let dirVec = vec3.fromValues(focalPoint[0] - worldPos[0], focalPoint[1] - worldPos[1], focalPoint[2] - worldPos[2]);\n            dirVec = vec3.normalize(vec3.create(), dirVec);\n            this.dirVec = dirVec;\n            if (camera.parallelProjection) {\n                this._dragParallelProjection(evt, viewport, camera, true);\n            }\n            else {\n                this._dragPerspectiveProjection(evt, viewport, camera, true);\n            }\n            viewport.render();\n        }\n        if (this.configuration.pan) {\n            this._panCallback(evt);\n        }\n    }\n    _dragCallback(evt) {\n        const { element } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        if (camera.parallelProjection) {\n            this._dragParallelProjection(evt, viewport, camera);\n        }\n        else {\n            this._dragPerspectiveProjection(evt, viewport, camera);\n        }\n        viewport.render();\n    }\n    _panCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const deltaPointsWorld = deltaPoints.world;\n        const camera = enabledElement.viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        enabledElement.viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        enabledElement.viewport.render();\n    }\n}\nZoomTool.toolName = 'Zoom';\nexport default ZoomTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement, VolumeViewport } from '@cornerstonejs/core';\nimport { utilities } from '@cornerstonejs/core';\nimport { getPointInLineOfSightWithCriteria } from '../utilities/planar';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass MIPJumpToClickTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            targetViewportIds: [],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    mouseClickCallback(evt) {\n        const { element, currentPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        const volumeId = viewport.getVolumeId();\n        if (!volumeId) {\n            throw new Error(`MIPJumpToClickTool: targetId is not a volumeId, you should only use MIPJumpToClickTool with a volumeId as the targetId`);\n        }\n        let maxIntensity = -Infinity;\n        const maxFn = (intensity, point) => {\n            if (intensity > maxIntensity) {\n                maxIntensity = intensity;\n                return point;\n            }\n        };\n        const brightestPoint = getPointInLineOfSightWithCriteria(viewport, currentPoints.world, volumeId, maxFn);\n        if (!brightestPoint || !brightestPoint.length) {\n            return;\n        }\n        const { targetViewportIds, toolGroupId } = this.configuration;\n        const viewports = renderingEngine.getViewports().filter((vp) => {\n            if (targetViewportIds?.indexOf(vp.id) >= 0) {\n                return true;\n            }\n            const foundToolGroup = getToolGroupForViewport(vp.id, renderingEngine.id);\n            if (toolGroupId && toolGroupId === foundToolGroup?.id) {\n                return true;\n            }\n            return false;\n        });\n        viewports.forEach((viewport) => {\n            if (viewport instanceof VolumeViewport) {\n                viewport.jumpToWorld(brightestPoint);\n            }\n            else {\n                console.warn('Cannot jump to specified world coordinates for a viewport that is not a VolumeViewport');\n            }\n        });\n    }\n}\nMIPJumpToClickTool.toolName = 'MIPJumpToClickTool';\nexport default MIPJumpToClickTool;\n","import { vec2, vec3 } from 'gl-matrix';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport vtkMatrixBuilder from '@kitware/vtk.js/Common/Core/MatrixBuilder';\nimport { AnnotationTool } from './base';\nimport { getEnabledElementByIds, getEnabledElement, utilities as csUtils, Enums, CONSTANTS, } from '@cornerstonejs/core';\nimport { getToolGroup, getToolGroupForViewport, } from '../store/ToolGroupManager';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLine as drawLineSvg, } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport liangBarksyClip from '../utilities/math/vec2/liangBarksyClip';\nimport * as lineSegment from '../utilities/math/line';\nimport { isAnnotationLocked } from '../stateManagement/annotation/annotationLocking';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nconst { RENDERING_DEFAULTS } = CONSTANTS;\nfunction defaultReferenceLineColor() {\n    return 'rgb(0, 200, 0)';\n}\nfunction defaultReferenceLineControllable() {\n    return true;\n}\nfunction defaultReferenceLineDraggableRotatable() {\n    return true;\n}\nfunction defaultReferenceLineSlabThicknessControlsOn() {\n    return true;\n}\nconst OPERATION = {\n    DRAG: 1,\n    ROTATE: 2,\n    SLAB: 3,\n};\nconst EPSILON = 1e-3;\nclass CrosshairsTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse'],\n        configuration: {\n            shadow: true,\n            viewportIndicators: false,\n            viewportIndicatorsConfig: {\n                radius: 5,\n                x: null,\n                y: null,\n            },\n            autoPan: {\n                enabled: false,\n                panSize: 10,\n            },\n            referenceLinesCenterGapRadius: 20,\n            filterActorUIDsToSetSlabThickness: [],\n            slabThicknessBlendMode: Enums.BlendModes.MAXIMUM_INTENSITY_BLEND,\n            mobile: {\n                enabled: false,\n                opacity: 0.8,\n                handleRadius: 9,\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.toolCenter = [0, 0, 0];\n        this.initializeViewport = ({ renderingEngineId, viewportId, }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { FrameOfReferenceUID, viewport } = enabledElement;\n            const { element } = viewport;\n            const { position, focalPoint, viewPlaneNormal } = viewport.getCamera();\n            let annotations = this._getAnnotations(enabledElement);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (annotations.length) {\n                removeAnnotation(annotations[0].annotationUID);\n            }\n            const annotation = {\n                highlighted: false,\n                metadata: {\n                    cameraPosition: [...position],\n                    cameraFocalPoint: [...focalPoint],\n                    FrameOfReferenceUID,\n                    toolName: this.getToolName(),\n                },\n                data: {\n                    handles: {\n                        rotationPoints: [],\n                        slabThicknessPoints: [],\n                        toolCenter: this.toolCenter,\n                    },\n                    activeOperation: null,\n                    activeViewportIds: [],\n                    viewportId,\n                },\n            };\n            addAnnotation(annotation, element);\n            return {\n                normal: viewPlaneNormal,\n                point: viewport.canvasToWorld([\n                    viewport.canvas.clientWidth / 2,\n                    viewport.canvas.clientHeight / 2,\n                ]),\n            };\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.resetCrosshairs = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            for (const viewportInfo of viewportsInfo) {\n                const { viewportId, renderingEngineId } = viewportInfo;\n                const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n                const viewport = enabledElement.viewport;\n                const resetPan = true;\n                const resetZoom = true;\n                const resetToCenter = true;\n                const resetRotation = true;\n                const suppressEvents = true;\n                viewport.resetCamera({\n                    resetPan,\n                    resetZoom,\n                    resetToCenter,\n                    resetRotation,\n                    suppressEvents,\n                });\n                viewport.resetSlabThickness();\n                const { element } = viewport;\n                let annotations = this._getAnnotations(enabledElement);\n                annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n                if (annotations.length) {\n                    removeAnnotation(annotations[0].annotationUID);\n                }\n                viewport.render();\n            }\n            this._computeToolCenter(viewportsInfo);\n        };\n        this.computeToolCenter = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            this._computeToolCenter(viewportsInfo);\n        };\n        this._computeToolCenter = (viewportsInfo) => {\n            if (!viewportsInfo.length || viewportsInfo.length === 1) {\n                console.warn('For crosshairs to operate, at least two viewports must be given.');\n                return;\n            }\n            const [firstViewport, secondViewport, thirdViewport] = viewportsInfo;\n            const { normal: normal1, point: point1 } = this.initializeViewport(firstViewport);\n            const { normal: normal2, point: point2 } = this.initializeViewport(secondViewport);\n            let normal3 = [0, 0, 0];\n            let point3 = vec3.create();\n            if (thirdViewport) {\n                ({ normal: normal3, point: point3 } =\n                    this.initializeViewport(thirdViewport));\n            }\n            else {\n                vec3.add(point3, point1, point2);\n                vec3.scale(point3, point3, 0.5);\n                vec3.cross(normal3, normal1, normal2);\n            }\n            const firstPlane = csUtils.planar.planeEquation(normal1, point1);\n            const secondPlane = csUtils.planar.planeEquation(normal2, point2);\n            const thirdPlane = csUtils.planar.planeEquation(normal3, point3);\n            this.toolCenter = csUtils.planar.threePlaneIntersection(firstPlane, secondPlane, thirdPlane);\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const jumpWorld = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this._jump(enabledElement, jumpWorld);\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredAnnotations = this.filterInteractableAnnotationsForElement(viewport.element, annotations);\n            const { data } = filteredAnnotations[0];\n            const { rotationPoints } = data.handles;\n            const viewportIdArray = [];\n            for (let i = 0; i < rotationPoints.length - 1; ++i) {\n                const otherViewport = rotationPoints[i][1];\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                if (!viewportControllable || !viewportDraggableRotatable) {\n                    continue;\n                }\n                viewportIdArray.push(otherViewport.id);\n                i++;\n            }\n            data.activeViewportIds = [...viewportIdArray];\n            data.handles.activeOperation = OPERATION.DRAG;\n            evt.preventDefault();\n            hideElementCursor(element);\n            this._activateModify(element);\n            return filteredAnnotations[0];\n        };\n        this.cancel = () => {\n            console.log('Not implemented yet');\n        };\n        this.handleSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            if (this._pointNearTool(element, annotation, canvasCoords, 6)) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.onCameraModified = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const viewport = enabledElement.viewport;\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!viewportAnnotation) {\n                return;\n            }\n            const currentCamera = viewport.getCamera();\n            const oldCameraPosition = viewportAnnotation.metadata.cameraPosition;\n            const deltaCameraPosition = [0, 0, 0];\n            vtkMath.subtract(currentCamera.position, oldCameraPosition, deltaCameraPosition);\n            const oldCameraFocalPoint = viewportAnnotation.metadata.cameraFocalPoint;\n            const deltaCameraFocalPoint = [0, 0, 0];\n            vtkMath.subtract(currentCamera.focalPoint, oldCameraFocalPoint, deltaCameraFocalPoint);\n            viewportAnnotation.metadata.cameraPosition = [...currentCamera.position];\n            viewportAnnotation.metadata.cameraFocalPoint = [\n                ...currentCamera.focalPoint,\n            ];\n            const viewportControllable = this._getReferenceLineControllable(viewport.id);\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(viewport.id);\n            if (!csUtils.isEqual(currentCamera.position, oldCameraPosition, 1e-3) &&\n                viewportControllable &&\n                viewportDraggableRotatable) {\n                let isRotation = false;\n                const cameraModifiedSameForPosAndFocalPoint = csUtils.isEqual(deltaCameraPosition, deltaCameraFocalPoint, 1e-3);\n                if (!cameraModifiedSameForPosAndFocalPoint) {\n                    isRotation = true;\n                }\n                const cameraModifiedInPlane = Math.abs(vtkMath.dot(deltaCameraPosition, currentCamera.viewPlaneNormal)) < 1e-2;\n                if (!isRotation && !cameraModifiedInPlane) {\n                    this.toolCenter[0] += deltaCameraPosition[0];\n                    this.toolCenter[1] += deltaCameraPosition[1];\n                    this.toolCenter[2] += deltaCameraPosition[2];\n                }\n            }\n            if (this.configuration.autoPan?.enabled) {\n                const toolGroup = getToolGroupForViewport(viewport.id, renderingEngine.id);\n                const otherViewportIds = toolGroup\n                    .getViewportIds()\n                    .filter((id) => id !== viewport.id);\n                otherViewportIds.forEach((viewportId) => {\n                    this._autoPanViewportIfNecessary(viewportId, renderingEngine);\n                });\n            }\n            const requireSameOrientation = false;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), requireSameOrientation);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.onResetCamera = (evt) => {\n            this.resetCrosshairs();\n        };\n        this.mouseMoveCallback = (evt, filteredToolAnnotations) => {\n            const { element, currentPoints } = evt.detail;\n            const canvasCoords = currentPoints.canvas;\n            let imageNeedsUpdate = false;\n            for (let i = 0; i < filteredToolAnnotations.length; i++) {\n                const annotation = filteredToolAnnotations[i];\n                if (isAnnotationLocked(annotation.annotationUID)) {\n                    continue;\n                }\n                const { data, highlighted } = annotation;\n                if (!data.handles) {\n                    continue;\n                }\n                const previousActiveOperation = data.handles.activeOperation;\n                const previousActiveViewportIds = data.activeViewportIds && data.activeViewportIds.length > 0\n                    ? [...data.activeViewportIds]\n                    : [];\n                data.activeViewportIds = [];\n                data.handles.activeOperation = null;\n                const handleNearImagePoint = this.getHandleNearImagePoint(element, annotation, canvasCoords, 6);\n                let near = false;\n                if (handleNearImagePoint) {\n                    near = true;\n                }\n                else {\n                    near = this._pointNearTool(element, annotation, canvasCoords, 6);\n                }\n                const nearToolAndNotMarkedActive = near && !highlighted;\n                const notNearToolAndMarkedActive = !near && highlighted;\n                if (nearToolAndNotMarkedActive || notNearToolAndMarkedActive) {\n                    annotation.highlighted = !highlighted;\n                    imageNeedsUpdate = true;\n                }\n                else if (data.handles.activeOperation !== previousActiveOperation ||\n                    !this._areViewportIdArraysEqual(data.activeViewportIds, previousActiveViewportIds)) {\n                    imageNeedsUpdate = true;\n                }\n            }\n            return imageNeedsUpdate;\n        };\n        this.filterInteractableAnnotationsForElement = (element, annotations) => {\n            if (!annotations || !annotations.length) {\n                return [];\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewportId } = enabledElement;\n            const viewportUIDSpecificCrosshairs = annotations.filter((annotation) => annotation.data.viewportId === viewportId);\n            return viewportUIDSpecificCrosshairs;\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport, renderingEngine } = enabledElement;\n            const { element } = viewport;\n            const annotations = this._getAnnotations(enabledElement);\n            const camera = viewport.getCamera();\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!annotations?.length || !viewportAnnotation?.data) {\n                return renderStatus;\n            }\n            const annotationUID = viewportAnnotation.annotationUID;\n            const { clientWidth, clientHeight } = viewport.canvas;\n            const canvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n            const canvasMinDimensionLength = Math.min(clientWidth, clientHeight);\n            const data = viewportAnnotation.data;\n            const crosshairCenterCanvas = viewport.worldToCanvas(this.toolCenter);\n            const otherViewportAnnotations = this._filterAnnotationsByUniqueViewportOrientations(enabledElement, annotations);\n            const referenceLines = [];\n            const canvasBox = [0, 0, clientWidth, clientHeight];\n            otherViewportAnnotations.forEach((annotation) => {\n                const { data } = annotation;\n                data.handles.toolCenter = this.toolCenter;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                const otherViewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n                const { clientWidth, clientHeight } = otherViewport.canvas;\n                const otherCanvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n                const otherCanvasCenter = [\n                    clientWidth * 0.5,\n                    clientHeight * 0.5,\n                ];\n                const otherViewportCenterWorld = otherViewport.canvasToWorld(otherCanvasCenter);\n                const direction = [0, 0, 0];\n                vtkMath.cross(camera.viewPlaneNormal, otherCamera.viewPlaneNormal, direction);\n                vtkMath.normalize(direction);\n                vtkMath.multiplyScalar(direction, otherCanvasDiagonalLength);\n                const pointWorld0 = [0, 0, 0];\n                vtkMath.add(otherViewportCenterWorld, direction, pointWorld0);\n                const pointWorld1 = [0, 0, 0];\n                vtkMath.subtract(otherViewportCenterWorld, direction, pointWorld1);\n                const pointCanvas0 = viewport.worldToCanvas(pointWorld0);\n                const otherViewportCenterCanvas = viewport.worldToCanvas(otherViewportCenterWorld);\n                const canvasUnitVectorFromCenter = vec2.create();\n                vec2.subtract(canvasUnitVectorFromCenter, pointCanvas0, otherViewportCenterCanvas);\n                vec2.normalize(canvasUnitVectorFromCenter, canvasUnitVectorFromCenter);\n                const canvasVectorFromCenterLong = vec2.create();\n                vec2.scale(canvasVectorFromCenterLong, canvasUnitVectorFromCenter, canvasDiagonalLength * 100);\n                const canvasVectorFromCenterMid = vec2.create();\n                vec2.scale(canvasVectorFromCenterMid, canvasUnitVectorFromCenter, canvasMinDimensionLength * 0.4);\n                const canvasVectorFromCenterShort = vec2.create();\n                vec2.scale(canvasVectorFromCenterShort, canvasUnitVectorFromCenter, canvasMinDimensionLength * 0.2);\n                const canvasVectorFromCenterStart = vec2.create();\n                const centerGap = this.configuration.referenceLinesCenterGapRadius;\n                vec2.scale(canvasVectorFromCenterStart, canvasUnitVectorFromCenter, otherViewportAnnotations.length === 2 ? centerGap : 0);\n                const refLinePointOne = vec2.create();\n                const refLinePointTwo = vec2.create();\n                const refLinePointThree = vec2.create();\n                const refLinePointFour = vec2.create();\n                let refLinesCenter = vec2.clone(crosshairCenterCanvas);\n                if (!otherViewportDraggableRotatable || !otherViewportControllable) {\n                    refLinesCenter = vec2.clone(otherViewportCenterCanvas);\n                }\n                vec2.add(refLinePointOne, refLinesCenter, canvasVectorFromCenterStart);\n                vec2.add(refLinePointTwo, refLinesCenter, canvasVectorFromCenterLong);\n                vec2.subtract(refLinePointThree, refLinesCenter, canvasVectorFromCenterStart);\n                vec2.subtract(refLinePointFour, refLinesCenter, canvasVectorFromCenterLong);\n                liangBarksyClip(refLinePointOne, refLinePointTwo, canvasBox);\n                liangBarksyClip(refLinePointThree, refLinePointFour, canvasBox);\n                const rotHandleOne = vec2.create();\n                vec2.subtract(rotHandleOne, crosshairCenterCanvas, canvasVectorFromCenterMid);\n                const rotHandleTwo = vec2.create();\n                vec2.add(rotHandleTwo, crosshairCenterCanvas, canvasVectorFromCenterMid);\n                let stHandlesCenterCanvas = vec2.clone(crosshairCenterCanvas);\n                if (!otherViewportDraggableRotatable &&\n                    otherViewportSlabThicknessControlsOn) {\n                    stHandlesCenterCanvas = vec2.clone(otherViewportCenterCanvas);\n                }\n                let stHandlesCenterWorld = [...this.toolCenter];\n                if (!otherViewportDraggableRotatable &&\n                    otherViewportSlabThicknessControlsOn) {\n                    stHandlesCenterWorld = [...otherViewportCenterWorld];\n                }\n                const worldUnitVectorFromCenter = [0, 0, 0];\n                vtkMath.subtract(pointWorld0, pointWorld1, worldUnitVectorFromCenter);\n                vtkMath.normalize(worldUnitVectorFromCenter);\n                const { viewPlaneNormal } = camera;\n                const { matrix } = vtkMatrixBuilder\n                    .buildFromDegree()\n                    .rotate(90, viewPlaneNormal);\n                const worldUnitOrthoVectorFromCenter = [0, 0, 0];\n                vec3.transformMat4(worldUnitOrthoVectorFromCenter, worldUnitVectorFromCenter, matrix);\n                const slabThicknessValue = otherViewport.getSlabThickness();\n                const worldOrthoVectorFromCenter = [\n                    ...worldUnitOrthoVectorFromCenter,\n                ];\n                vtkMath.multiplyScalar(worldOrthoVectorFromCenter, slabThicknessValue);\n                const worldVerticalRefPoint = [0, 0, 0];\n                vtkMath.add(stHandlesCenterWorld, worldOrthoVectorFromCenter, worldVerticalRefPoint);\n                const canvasVerticalRefPoint = viewport.worldToCanvas(worldVerticalRefPoint);\n                const canvasOrthoVectorFromCenter = vec2.create();\n                vec2.subtract(canvasOrthoVectorFromCenter, stHandlesCenterCanvas, canvasVerticalRefPoint);\n                const stLinePointOne = vec2.create();\n                vec2.subtract(stLinePointOne, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.add(stLinePointOne, stLinePointOne, canvasOrthoVectorFromCenter);\n                const stLinePointTwo = vec2.create();\n                vec2.add(stLinePointTwo, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.add(stLinePointTwo, stLinePointTwo, canvasOrthoVectorFromCenter);\n                liangBarksyClip(stLinePointOne, stLinePointTwo, canvasBox);\n                const stLinePointThree = vec2.create();\n                vec2.add(stLinePointThree, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.subtract(stLinePointThree, stLinePointThree, canvasOrthoVectorFromCenter);\n                const stLinePointFour = vec2.create();\n                vec2.subtract(stLinePointFour, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.subtract(stLinePointFour, stLinePointFour, canvasOrthoVectorFromCenter);\n                liangBarksyClip(stLinePointThree, stLinePointFour, canvasBox);\n                const stHandleOne = vec2.create();\n                const stHandleTwo = vec2.create();\n                const stHandleThree = vec2.create();\n                const stHandleFour = vec2.create();\n                vec2.subtract(stHandleOne, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.add(stHandleOne, stHandleOne, canvasOrthoVectorFromCenter);\n                vec2.add(stHandleTwo, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.add(stHandleTwo, stHandleTwo, canvasOrthoVectorFromCenter);\n                vec2.subtract(stHandleThree, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.subtract(stHandleThree, stHandleThree, canvasOrthoVectorFromCenter);\n                vec2.add(stHandleFour, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.subtract(stHandleFour, stHandleFour, canvasOrthoVectorFromCenter);\n                referenceLines.push([\n                    otherViewport,\n                    refLinePointOne,\n                    refLinePointTwo,\n                    refLinePointThree,\n                    refLinePointFour,\n                    stLinePointOne,\n                    stLinePointTwo,\n                    stLinePointThree,\n                    stLinePointFour,\n                    rotHandleOne,\n                    rotHandleTwo,\n                    stHandleOne,\n                    stHandleTwo,\n                    stHandleThree,\n                    stHandleFour,\n                ]);\n            });\n            const newRtpoints = [];\n            const newStpoints = [];\n            const viewportColor = this._getReferenceLineColor(viewport.id);\n            const color = viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n            referenceLines.forEach((line, lineIndex) => {\n                const otherViewport = line[0];\n                const viewportColor = this._getReferenceLineColor(otherViewport.id);\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id) ||\n                    this.configuration.mobile?.enabled;\n                const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id) ||\n                    this.configuration.mobile?.enabled;\n                const selectedViewportId = data.activeViewportIds.find((id) => id === otherViewport.id);\n                let color = viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n                let lineWidth = 1;\n                const lineActive = data.handles.activeOperation !== null &&\n                    data.handles.activeOperation === OPERATION.DRAG &&\n                    selectedViewportId;\n                if (lineActive) {\n                    lineWidth = 2.5;\n                }\n                let lineUID = `${lineIndex}`;\n                if (viewportControllable && viewportDraggableRotatable) {\n                    lineUID = `${lineIndex}One`;\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[1], line[2], {\n                        color,\n                        lineWidth,\n                    });\n                    lineUID = `${lineIndex}Two`;\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[3], line[4], {\n                        color,\n                        lineWidth,\n                    });\n                }\n                else {\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[2], line[4], {\n                        color,\n                        lineWidth,\n                    });\n                }\n                if (viewportControllable) {\n                    color =\n                        viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n                    const rotHandlesActive = data.handles.activeOperation === OPERATION.ROTATE;\n                    const rotationHandles = [line[9], line[10]];\n                    const rotHandleWorldOne = [\n                        viewport.canvasToWorld(line[9]),\n                        otherViewport,\n                        line[1],\n                        line[2],\n                    ];\n                    const rotHandleWorldTwo = [\n                        viewport.canvasToWorld(line[10]),\n                        otherViewport,\n                        line[3],\n                        line[4],\n                    ];\n                    newRtpoints.push(rotHandleWorldOne, rotHandleWorldTwo);\n                    const slabThicknessHandlesActive = data.handles.activeOperation === OPERATION.SLAB;\n                    const slabThicknessHandles = [line[11], line[12], line[13], line[14]];\n                    const slabThicknessHandleWorldOne = [\n                        viewport.canvasToWorld(line[11]),\n                        otherViewport,\n                        line[5],\n                        line[6],\n                    ];\n                    const slabThicknessHandleWorldTwo = [\n                        viewport.canvasToWorld(line[12]),\n                        otherViewport,\n                        line[5],\n                        line[6],\n                    ];\n                    const slabThicknessHandleWorldThree = [\n                        viewport.canvasToWorld(line[13]),\n                        otherViewport,\n                        line[7],\n                        line[8],\n                    ];\n                    const slabThicknessHandleWorldFour = [\n                        viewport.canvasToWorld(line[14]),\n                        otherViewport,\n                        line[7],\n                        line[8],\n                    ];\n                    newStpoints.push(slabThicknessHandleWorldOne, slabThicknessHandleWorldTwo, slabThicknessHandleWorldThree, slabThicknessHandleWorldFour);\n                    if ((lineActive || this.configuration.mobile?.enabled) &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportDraggableRotatable &&\n                        viewportSlabThicknessControlsOn) {\n                        let handleUID = `${lineIndex}One`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'circle',\n                        });\n                        handleUID = `${lineIndex}Two`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, slabThicknessHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'rect',\n                        });\n                    }\n                    else if (lineActive &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportDraggableRotatable) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'circle',\n                        });\n                    }\n                    else if (selectedViewportId &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportSlabThicknessControlsOn) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, slabThicknessHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'rect',\n                        });\n                    }\n                    else if (rotHandlesActive && viewportDraggableRotatable) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius: 2,\n                            fill: color,\n                            type: 'circle',\n                        });\n                    }\n                    else if (slabThicknessHandlesActive &&\n                        selectedViewportId &&\n                        viewportSlabThicknessControlsOn) {\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, lineUID, slabThicknessHandles, {\n                            color,\n                            handleRadius: 2,\n                            fill: color,\n                            type: 'rect',\n                        });\n                    }\n                    const slabThicknessValue = otherViewport.getSlabThickness();\n                    if (slabThicknessValue > 0.5 && viewportSlabThicknessControlsOn) {\n                        lineUID = `${lineIndex}STOne`;\n                        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[5], line[6], {\n                            color,\n                            width: 1,\n                            lineDash: [2, 3],\n                        });\n                        lineUID = `${lineIndex}STTwo`;\n                        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[7], line[8], {\n                            color,\n                            width: line,\n                            lineDash: [2, 3],\n                        });\n                    }\n                }\n            });\n            renderStatus = true;\n            data.handles.rotationPoints = newRtpoints;\n            data.handles.slabThicknessPoints = newStpoints;\n            if (this.configuration.viewportIndicators) {\n                const { viewportIndicatorsConfig } = this.configuration;\n                const xOffset = viewportIndicatorsConfig?.xOffset || 0.95;\n                const yOffset = viewportIndicatorsConfig?.yOffset || 0.05;\n                const referenceColorCoordinates = [\n                    clientWidth * xOffset,\n                    clientHeight * yOffset,\n                ];\n                const circleRadius = viewportIndicatorsConfig?.circleRadius || canvasDiagonalLength * 0.01;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, referenceColorCoordinates, circleRadius, { color, fill: color });\n            }\n            return renderStatus;\n        };\n        this._getAnnotations = (enabledElement) => {\n            const { viewport } = enabledElement;\n            const annotations = getAnnotations(this.getToolName(), viewport.element) || [];\n            const viewportIds = this._getViewportsInfo().map(({ viewportId }) => viewportId);\n            const toolGroupAnnotations = annotations.filter((annotation) => {\n                const { data } = annotation;\n                return viewportIds.includes(data.viewportId);\n            });\n            return toolGroupAnnotations;\n        };\n        this._onNewVolume = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            this._computeToolCenter(viewportsInfo);\n        };\n        this._areViewportIdArraysEqual = (viewportIdArrayOne, viewportIdArrayTwo) => {\n            if (viewportIdArrayOne.length !== viewportIdArrayTwo.length) {\n                return false;\n            }\n            viewportIdArrayOne.forEach((id) => {\n                let itemFound = false;\n                for (let i = 0; i < viewportIdArrayTwo.length; ++i) {\n                    if (id === viewportIdArrayTwo[i]) {\n                        itemFound = true;\n                        break;\n                    }\n                }\n                if (itemFound === false) {\n                    return false;\n                }\n            });\n            return true;\n        };\n        this._getAnnotationsForViewportsWithDifferentCameras = (enabledElement, annotations) => {\n            const { viewportId, renderingEngine, viewport } = enabledElement;\n            const otherViewportAnnotations = annotations.filter((annotation) => annotation.data.viewportId !== viewportId);\n            if (!otherViewportAnnotations || !otherViewportAnnotations.length) {\n                return [];\n            }\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, position } = camera;\n            const viewportsWithDifferentCameras = otherViewportAnnotations.filter((annotation) => {\n                const { viewportId } = annotation.data;\n                const targetViewport = renderingEngine.getViewport(viewportId);\n                const cameraOfTarget = targetViewport.getCamera();\n                return !(csUtils.isEqual(cameraOfTarget.viewPlaneNormal, viewPlaneNormal, 1e-2) && csUtils.isEqual(cameraOfTarget.position, position, 1));\n            });\n            return viewportsWithDifferentCameras;\n        };\n        this._filterViewportWithSameOrientation = (enabledElement, referenceAnnotation, annotations) => {\n            const { renderingEngine } = enabledElement;\n            const { data } = referenceAnnotation;\n            const viewport = renderingEngine.getViewport(data.viewportId);\n            const linkedViewportAnnotations = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return otherViewportControllable === true;\n            });\n            if (!linkedViewportAnnotations || !linkedViewportAnnotations.length) {\n                return [];\n            }\n            const camera = viewport.getCamera();\n            const viewPlaneNormal = camera.viewPlaneNormal;\n            vtkMath.normalize(viewPlaneNormal);\n            const otherViewportsAnnotationsWithSameCameraDirection = linkedViewportAnnotations.filter((annotation) => {\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                return (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) &&\n                    csUtils.isEqual(camera.viewUp, otherCamera.viewUp, 1e-2));\n            });\n            return otherViewportsAnnotationsWithSameCameraDirection;\n        };\n        this._filterAnnotationsByUniqueViewportOrientations = (enabledElement, annotations) => {\n            const { renderingEngine, viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const viewPlaneNormal = camera.viewPlaneNormal;\n            vtkMath.normalize(viewPlaneNormal);\n            const otherLinkedViewportAnnotationsFromSameScene = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return (viewport !== otherViewport &&\n                    otherViewportControllable === true);\n            });\n            const otherViewportsAnnotationsWithUniqueCameras = [];\n            for (let i = 0; i < otherLinkedViewportAnnotationsFromSameScene.length; ++i) {\n                const annotation = otherLinkedViewportAnnotationsFromSameScene[i];\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            const otherNonLinkedViewportAnnotationsFromSameScene = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return (viewport !== otherViewport &&\n                    otherViewportControllable !== true);\n            });\n            for (let i = 0; i < otherNonLinkedViewportAnnotationsFromSameScene.length; ++i) {\n                const annotation = otherNonLinkedViewportAnnotationsFromSameScene[i];\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n            for (let i = 0; i < otherViewportAnnotations.length; ++i) {\n                const annotation = otherViewportAnnotations[i];\n                if (otherViewportsAnnotationsWithUniqueCameras.some((element) => element === annotation)) {\n                    continue;\n                }\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            return otherViewportsAnnotationsWithUniqueCameras;\n        };\n        this._checkIfViewportsRenderingSameScene = (viewport, otherViewport) => {\n            const volumeIds = viewport.getAllVolumeIds();\n            const otherVolumeIds = otherViewport.getAllVolumeIds();\n            return (volumeIds.length === otherVolumeIds.length &&\n                volumeIds.every((id) => otherVolumeIds.includes(id)));\n        };\n        this._jump = (enabledElement, jumpWorld) => {\n            state.isInteractingWithTool = true;\n            const { viewport, renderingEngine } = enabledElement;\n            const annotations = this._getAnnotations(enabledElement);\n            const delta = [0, 0, 0];\n            vtkMath.subtract(jumpWorld, this.toolCenter, delta);\n            const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n            const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const sameScene = this._checkIfViewportsRenderingSameScene(viewport, otherViewport);\n                return (this._getReferenceLineControllable(otherViewport.id) &&\n                    this._getReferenceLineDraggableRotatable(otherViewport.id) &&\n                    sameScene);\n            });\n            if (viewportsAnnotationsToUpdate.length === 0) {\n                state.isInteractingWithTool = false;\n                return false;\n            }\n            this._applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta);\n            state.isInteractingWithTool = false;\n            return true;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = !this.configuration.mobile?.enabled;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            this.editData.annotation.data.handles.activeOperation = null;\n            this.editData.annotation.data.activeViewportIds = [];\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            const requireSameOrientation = false;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), requireSameOrientation);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const delta = eventDetail.deltaPoints.world;\n            if (Math.abs(delta[0]) < 1e-3 &&\n                Math.abs(delta[1]) < 1e-3 &&\n                Math.abs(delta[2]) < 1e-3) {\n                return;\n            }\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!viewportAnnotation) {\n                return;\n            }\n            const { handles } = viewportAnnotation.data;\n            const { currentPoints } = evt.detail;\n            const canvasCoords = currentPoints.canvas;\n            if (handles.activeOperation === OPERATION.DRAG) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportDraggableRotatable === true &&\n                        viewportAnnotation.data.activeViewportIds.find((id) => id === otherViewport.id));\n                });\n                this._applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta);\n            }\n            else if (handles.activeOperation === OPERATION.ROTATE) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportDraggableRotatable === true);\n                });\n                const dir1 = vec2.create();\n                const dir2 = vec2.create();\n                const center = [\n                    this.toolCenter[0],\n                    this.toolCenter[1],\n                    this.toolCenter[2],\n                ];\n                const centerCanvas = viewport.worldToCanvas(center);\n                const finalPointCanvas = eventDetail.currentPoints.canvas;\n                const originalPointCanvas = vec2.create();\n                vec2.sub(originalPointCanvas, finalPointCanvas, eventDetail.deltaPoints.canvas);\n                vec2.sub(dir1, originalPointCanvas, centerCanvas);\n                vec2.sub(dir2, finalPointCanvas, centerCanvas);\n                let angle = vec2.angle(dir1, dir2);\n                if (this._isClockWise(centerCanvas, originalPointCanvas, finalPointCanvas)) {\n                    angle *= -1;\n                }\n                angle = Math.round(angle * 100) / 100;\n                const rotationAxis = viewport.getCamera().viewPlaneNormal;\n                const { matrix } = vtkMatrixBuilder\n                    .buildFromRadian()\n                    .translate(center[0], center[1], center[2])\n                    .rotate(angle, rotationAxis)\n                    .translate(-center[0], -center[1], -center[2]);\n                const otherViewportsIds = [];\n                viewportsAnnotationsToUpdate.forEach((annotation) => {\n                    const { data } = annotation;\n                    data.handles.toolCenter = center;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const camera = otherViewport.getCamera();\n                    const { viewUp, position, focalPoint } = camera;\n                    viewUp[0] += position[0];\n                    viewUp[1] += position[1];\n                    viewUp[2] += position[2];\n                    vec3.transformMat4(focalPoint, focalPoint, matrix);\n                    vec3.transformMat4(position, position, matrix);\n                    vec3.transformMat4(viewUp, viewUp, matrix);\n                    viewUp[0] -= position[0];\n                    viewUp[1] -= position[1];\n                    viewUp[2] -= position[2];\n                    otherViewport.setCamera({\n                        position,\n                        viewUp,\n                        focalPoint,\n                    });\n                    otherViewportsIds.push(otherViewport.id);\n                });\n                renderingEngine.renderViewports(otherViewportsIds);\n            }\n            else if (handles.activeOperation === OPERATION.SLAB) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const referenceAnnotations = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportSlabThicknessControlsOn === true &&\n                        viewportAnnotation.data.activeViewportIds.find((id) => id === otherViewport.id));\n                });\n                if (referenceAnnotations.length === 0) {\n                    return;\n                }\n                const viewportsAnnotationsToUpdate = this._filterViewportWithSameOrientation(enabledElement, referenceAnnotations[0], annotations);\n                const viewportsIds = [];\n                viewportsIds.push(viewport.id);\n                viewportsAnnotationsToUpdate.forEach((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const camera = otherViewport.getCamera();\n                    const normal = camera.viewPlaneNormal;\n                    const dotProd = vtkMath.dot(delta, normal);\n                    const projectedDelta = [...normal];\n                    vtkMath.multiplyScalar(projectedDelta, dotProd);\n                    if (Math.abs(projectedDelta[0]) > 1e-3 ||\n                        Math.abs(projectedDelta[1]) > 1e-3 ||\n                        Math.abs(projectedDelta[2]) > 1e-3) {\n                        const mod = Math.sqrt(projectedDelta[0] * projectedDelta[0] +\n                            projectedDelta[1] * projectedDelta[1] +\n                            projectedDelta[2] * projectedDelta[2]);\n                        const currentPoint = eventDetail.lastPoints.world;\n                        const direction = [0, 0, 0];\n                        const currentCenter = [\n                            this.toolCenter[0],\n                            this.toolCenter[1],\n                            this.toolCenter[2],\n                        ];\n                        const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                        if (!viewportDraggableRotatable) {\n                            const { rotationPoints } = this.editData.annotation.data.handles;\n                            const otherViewportRotationPoints = rotationPoints.filter((point) => point[1].uid === otherViewport.id);\n                            if (otherViewportRotationPoints.length === 2) {\n                                const point1 = viewport.canvasToWorld(otherViewportRotationPoints[0][3]);\n                                const point2 = viewport.canvasToWorld(otherViewportRotationPoints[1][3]);\n                                vtkMath.add(point1, point2, currentCenter);\n                                vtkMath.multiplyScalar(currentCenter, 0.5);\n                            }\n                        }\n                        vtkMath.subtract(currentPoint, currentCenter, direction);\n                        const dotProdDirection = vtkMath.dot(direction, normal);\n                        const projectedDirection = [...normal];\n                        vtkMath.multiplyScalar(projectedDirection, dotProdDirection);\n                        const normalizedProjectedDirection = [\n                            projectedDirection[0],\n                            projectedDirection[1],\n                            projectedDirection[2],\n                        ];\n                        vec3.normalize(normalizedProjectedDirection, normalizedProjectedDirection);\n                        const normalizedProjectedDelta = [\n                            projectedDelta[0],\n                            projectedDelta[1],\n                            projectedDelta[2],\n                        ];\n                        vec3.normalize(normalizedProjectedDelta, normalizedProjectedDelta);\n                        let slabThicknessValue = otherViewport.getSlabThickness();\n                        if (csUtils.isOpposite(normalizedProjectedDirection, normalizedProjectedDelta, 1e-3)) {\n                            slabThicknessValue -= mod;\n                        }\n                        else {\n                            slabThicknessValue += mod;\n                        }\n                        slabThicknessValue = Math.abs(slabThicknessValue);\n                        slabThicknessValue = Math.max(RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS, slabThicknessValue);\n                        const near = this._pointNearReferenceLine(viewportAnnotation, canvasCoords, 6, otherViewport);\n                        if (near) {\n                            slabThicknessValue = RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS;\n                        }\n                        const toolGroup = getToolGroupForViewport(otherViewport.id, renderingEngine.id);\n                        const crosshairsInstance = toolGroup.getToolInstance(this.getToolName());\n                        crosshairsInstance.setSlabThickness(otherViewport, slabThicknessValue);\n                        viewportsIds.push(otherViewport.id);\n                    }\n                });\n                renderingEngine.renderViewports(viewportsIds);\n            }\n        };\n        this._pointNearReferenceLine = (annotation, canvasCoords, proximity, lineViewport) => {\n            const { data } = annotation;\n            const { rotationPoints } = data.handles;\n            for (let i = 0; i < rotationPoints.length - 1; ++i) {\n                const otherViewport = rotationPoints[i][1];\n                if (otherViewport.id !== lineViewport.id) {\n                    continue;\n                }\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                if (!viewportControllable) {\n                    continue;\n                }\n                const lineSegment1 = {\n                    start: {\n                        x: rotationPoints[i][2][0],\n                        y: rotationPoints[i][2][1],\n                    },\n                    end: {\n                        x: rotationPoints[i][3][0],\n                        y: rotationPoints[i][3][1],\n                    },\n                };\n                const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n                const lineSegment2 = {\n                    start: {\n                        x: rotationPoints[i + 1][2][0],\n                        y: rotationPoints[i + 1][2][1],\n                    },\n                    end: {\n                        x: rotationPoints[i + 1][3][0],\n                        y: rotationPoints[i + 1][3][1],\n                    },\n                };\n                const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n                if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                    return true;\n                }\n                i++;\n            }\n            return false;\n        };\n        this._getReferenceLineColor =\n            toolProps.configuration?.getReferenceLineColor ||\n                defaultReferenceLineColor;\n        this._getReferenceLineControllable =\n            toolProps.configuration?.getReferenceLineControllable ||\n                defaultReferenceLineControllable;\n        this._getReferenceLineDraggableRotatable =\n            toolProps.configuration?.getReferenceLineDraggableRotatable ||\n                defaultReferenceLineDraggableRotatable;\n        this._getReferenceLineSlabThicknessControlsOn =\n            toolProps.configuration?.getReferenceLineSlabThicknessControlsOn ||\n                defaultReferenceLineSlabThicknessControlsOn;\n    }\n    onSetToolActive() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._unsubscribeToViewportNewVolumeSet(viewportsInfo);\n        this._subscribeToViewportNewVolumeSet(viewportsInfo);\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolPassive() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolEnabled() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolDisabled() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._unsubscribeToViewportNewVolumeSet(viewportsInfo);\n        viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (!enabledElement) {\n                return;\n            }\n            const annotations = this._getAnnotations(enabledElement);\n            if (annotations?.length) {\n                annotations.forEach((annotation) => {\n                    removeAnnotation(annotation.annotationUID);\n                });\n            }\n        });\n    }\n    getHandleNearImagePoint(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let point = this._getRotationHandleNearImagePoint(viewport, annotation, canvasCoords, proximity);\n        if (point !== null) {\n            return point;\n        }\n        point = this._getSlabThicknessHandleNearImagePoint(viewport, annotation, canvasCoords, proximity);\n        if (point !== null) {\n            return point;\n        }\n    }\n    _unsubscribeToViewportNewVolumeSet(viewportsInfo) {\n        viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n            const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { element } = viewport;\n            element.removeEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this._onNewVolume);\n        });\n    }\n    _subscribeToViewportNewVolumeSet(viewports) {\n        viewports.forEach(({ viewportId, renderingEngineId }) => {\n            const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { element } = viewport;\n            element.addEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this._onNewVolume);\n        });\n    }\n    _autoPanViewportIfNecessary(viewportId, renderingEngine) {\n        const viewport = renderingEngine.getViewport(viewportId);\n        const { clientWidth, clientHeight } = viewport.canvas;\n        const toolCenterCanvas = viewport.worldToCanvas(this.toolCenter);\n        const pan = this.configuration.autoPan.panSize;\n        const visiblePointCanvas = [\n            toolCenterCanvas[0],\n            toolCenterCanvas[1],\n        ];\n        if (toolCenterCanvas[0] < 0) {\n            visiblePointCanvas[0] = pan;\n        }\n        else if (toolCenterCanvas[0] > clientWidth) {\n            visiblePointCanvas[0] = clientWidth - pan;\n        }\n        if (toolCenterCanvas[1] < 0) {\n            visiblePointCanvas[1] = pan;\n        }\n        else if (toolCenterCanvas[1] > clientHeight) {\n            visiblePointCanvas[1] = clientHeight - pan;\n        }\n        if (visiblePointCanvas[0] === toolCenterCanvas[0] &&\n            visiblePointCanvas[1] === toolCenterCanvas[1]) {\n            return;\n        }\n        const visiblePointWorld = viewport.canvasToWorld(visiblePointCanvas);\n        const deltaPointsWorld = [\n            visiblePointWorld[0] - this.toolCenter[0],\n            visiblePointWorld[1] - this.toolCenter[1],\n            visiblePointWorld[2] - this.toolCenter[2],\n        ];\n        const camera = viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        viewport.render();\n    }\n    setSlabThickness(viewport, slabThickness) {\n        let actorUIDs;\n        const { filterActorUIDsToSetSlabThickness } = this.configuration;\n        if (filterActorUIDsToSetSlabThickness &&\n            filterActorUIDsToSetSlabThickness.length > 0) {\n            actorUIDs = filterActorUIDsToSetSlabThickness;\n        }\n        let blendModeToUse = this.configuration.slabThicknessBlendMode;\n        if (slabThickness === RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS) {\n            blendModeToUse = Enums.BlendModes.COMPOSITE;\n        }\n        const immediate = false;\n        viewport.setBlendMode(blendModeToUse, actorUIDs, immediate);\n        viewport.setSlabThickness(slabThickness, actorUIDs);\n    }\n    _isClockWise(a, b, c) {\n        return (b[0] - a[0]) * (c[1] - a[1]) - (b[1] - a[1]) * (c[0] - a[0]) > 0;\n    }\n    _applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta) {\n        viewportsAnnotationsToUpdate.forEach((annotation) => {\n            this._applyDeltaShiftToViewportCamera(renderingEngine, annotation, delta);\n        });\n    }\n    _applyDeltaShiftToViewportCamera(renderingEngine, annotation, delta) {\n        const { data } = annotation;\n        const viewport = renderingEngine.getViewport(data.viewportId);\n        const camera = viewport.getCamera();\n        const normal = camera.viewPlaneNormal;\n        const dotProd = vtkMath.dot(delta, normal);\n        const projectedDelta = [...normal];\n        vtkMath.multiplyScalar(projectedDelta, dotProd);\n        if (Math.abs(projectedDelta[0]) > 1e-3 ||\n            Math.abs(projectedDelta[1]) > 1e-3 ||\n            Math.abs(projectedDelta[2]) > 1e-3) {\n            const newFocalPoint = [0, 0, 0];\n            const newPosition = [0, 0, 0];\n            vtkMath.add(camera.focalPoint, projectedDelta, newFocalPoint);\n            vtkMath.add(camera.position, projectedDelta, newPosition);\n            viewport.setCamera({\n                focalPoint: newFocalPoint,\n                position: newPosition,\n            });\n            viewport.render();\n        }\n    }\n    _getRotationHandleNearImagePoint(viewport, annotation, canvasCoords, proximity) {\n        const { data } = annotation;\n        const { rotationPoints } = data.handles;\n        for (let i = 0; i < rotationPoints.length; i++) {\n            const point = rotationPoints[i][0];\n            const otherViewport = rotationPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            if (!viewportControllable) {\n                continue;\n            }\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n            if (!viewportDraggableRotatable) {\n                continue;\n            }\n            const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n            if (vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity) {\n                data.handles.activeOperation = OPERATION.ROTATE;\n                this.editData = {\n                    annotation,\n                };\n                return point;\n            }\n        }\n        return null;\n    }\n    _getSlabThicknessHandleNearImagePoint(viewport, annotation, canvasCoords, proximity) {\n        const { data } = annotation;\n        const { slabThicknessPoints } = data.handles;\n        for (let i = 0; i < slabThicknessPoints.length; i++) {\n            const point = slabThicknessPoints[i][0];\n            const otherViewport = slabThicknessPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            if (!viewportControllable) {\n                continue;\n            }\n            const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n            if (!viewportSlabThicknessControlsOn) {\n                continue;\n            }\n            const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n            if (vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity) {\n                data.handles.activeOperation = OPERATION.SLAB;\n                data.activeViewportIds = [otherViewport.id];\n                this.editData = {\n                    annotation,\n                };\n                return point;\n            }\n        }\n        return null;\n    }\n    _pointNearTool(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { clientWidth, clientHeight } = viewport.canvas;\n        const canvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n        const { data } = annotation;\n        const { rotationPoints } = data.handles;\n        const { slabThicknessPoints } = data.handles;\n        const viewportIdArray = [];\n        for (let i = 0; i < rotationPoints.length - 1; ++i) {\n            const otherViewport = rotationPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n            if (!viewportControllable || !viewportDraggableRotatable) {\n                continue;\n            }\n            const lineSegment1 = {\n                start: {\n                    x: rotationPoints[i][2][0],\n                    y: rotationPoints[i][2][1],\n                },\n                end: {\n                    x: rotationPoints[i][3][0],\n                    y: rotationPoints[i][3][1],\n                },\n            };\n            const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const lineSegment2 = {\n                start: {\n                    x: rotationPoints[i + 1][2][0],\n                    y: rotationPoints[i + 1][2][1],\n                },\n                end: {\n                    x: rotationPoints[i + 1][3][0],\n                    y: rotationPoints[i + 1][3][1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                viewportIdArray.push(otherViewport.id);\n                data.handles.activeOperation = OPERATION.DRAG;\n            }\n            i++;\n        }\n        for (let i = 0; i < slabThicknessPoints.length - 1; ++i) {\n            const otherViewport = slabThicknessPoints[i][1];\n            if (viewportIdArray.find((id) => id === otherViewport.id)) {\n                continue;\n            }\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n            if (!viewportControllable || !viewportSlabThicknessControlsOn) {\n                continue;\n            }\n            const stPointLineCanvas1 = slabThicknessPoints[i][2];\n            const stPointLineCanvas2 = slabThicknessPoints[i][3];\n            const centerCanvas = vec2.create();\n            vec2.add(centerCanvas, stPointLineCanvas1, stPointLineCanvas2);\n            vec2.scale(centerCanvas, centerCanvas, 0.5);\n            const canvasUnitVectorFromCenter = vec2.create();\n            vec2.subtract(canvasUnitVectorFromCenter, stPointLineCanvas1, centerCanvas);\n            vec2.normalize(canvasUnitVectorFromCenter, canvasUnitVectorFromCenter);\n            const canvasVectorFromCenterStart = vec2.create();\n            vec2.scale(canvasVectorFromCenterStart, canvasUnitVectorFromCenter, canvasDiagonalLength * 0.05);\n            const stPointLineCanvas1Start = vec2.create();\n            const stPointLineCanvas2Start = vec2.create();\n            vec2.add(stPointLineCanvas1Start, centerCanvas, canvasVectorFromCenterStart);\n            vec2.subtract(stPointLineCanvas2Start, centerCanvas, canvasVectorFromCenterStart);\n            const lineSegment1 = {\n                start: {\n                    x: stPointLineCanvas1Start[0],\n                    y: stPointLineCanvas1Start[1],\n                },\n                end: {\n                    x: stPointLineCanvas1[0],\n                    y: stPointLineCanvas1[1],\n                },\n            };\n            const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const lineSegment2 = {\n                start: {\n                    x: stPointLineCanvas2Start[0],\n                    y: stPointLineCanvas2Start[1],\n                },\n                end: {\n                    x: stPointLineCanvas2[0],\n                    y: stPointLineCanvas2[1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                viewportIdArray.push(otherViewport.id);\n                data.handles.activeOperation = null;\n            }\n            i++;\n        }\n        data.activeViewportIds = [...viewportIdArray];\n        this.editData = {\n            annotation,\n        };\n        return data.handles.activeOperation === OPERATION.DRAG ? true : false;\n    }\n}\nCrosshairsTool.toolName = 'Crosshairs';\nexport default CrosshairsTool;\n","import { BaseTool } from './base';\nimport { Events } from '../enums';\nimport { getEnabledElement, StackViewport } from '@cornerstonejs/core';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { state } from '../store/state';\nimport { Enums } from '@cornerstonejs/core';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nconst MAGNIFY_VIEWPORT_ID = 'magnify-viewport';\nclass MagnifyTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            magnifySize: 10,\n            magnifyWidth: 250,\n            magnifyHeight: 250,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._hasBeenRemoved = false;\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            if (!(viewport instanceof StackViewport)) {\n                throw new Error('MagnifyTool only works on StackViewports');\n            }\n            const referencedImageId = this._getReferencedImageId(viewport);\n            if (!referencedImageId) {\n                throw new Error('MagnifyTool: No referenced image id found, reconstructed planes not supported yet');\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                referencedImageId,\n                viewportIdsToRender,\n                enabledElement,\n                renderingEngine,\n                currentPoints,\n            };\n            this._createMagnificationViewport();\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this.preTouchStartCallback = (evt) => {\n            this.preMouseDownCallback(evt);\n        };\n        this._createMagnificationViewport = () => {\n            const { enabledElement, referencedImageId, viewportIdsToRender, renderingEngine, currentPoints, } = this.editData;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            const viewportProperties = viewport.getProperties();\n            const { canvas: canvasPos, world: worldPos } = currentPoints;\n            let magnifyToolElement;\n            magnifyToolElement = element.querySelector('.magnifyTool');\n            if (magnifyToolElement === null) {\n                const magnifyElement = document.createElement('div');\n                magnifyElement.classList.add('magnifyTool');\n                magnifyElement.style.display = 'block';\n                magnifyElement.style.width = `${this.configuration.magnifyWidth}px`;\n                magnifyElement.style.height = `${this.configuration.magnifyHeight}px`;\n                magnifyElement.style.position = 'absolute';\n                magnifyToolElement = magnifyElement;\n                const viewportElement = element.querySelector('.viewport-element');\n                viewportElement.appendChild(magnifyElement);\n                const viewportInput = {\n                    viewportId: MAGNIFY_VIEWPORT_ID,\n                    type: Enums.ViewportType.STACK,\n                    element: magnifyToolElement,\n                };\n                renderingEngine.enableElement(viewportInput);\n            }\n            magnifyToolElement.style.top = `${canvasPos[1] - this.configuration.magnifyHeight / 2}px`;\n            magnifyToolElement.style.left = `${canvasPos[0] - this.configuration.magnifyWidth / 2}px`;\n            const magnifyViewport = renderingEngine.getViewport(MAGNIFY_VIEWPORT_ID);\n            magnifyViewport.setStack([referencedImageId]).then(() => {\n                if (this._hasBeenRemoved) {\n                    return;\n                }\n                magnifyViewport.setProperties(viewportProperties);\n                const { parallelScale } = viewport.getCamera();\n                const { focalPoint, position, viewPlaneNormal } = magnifyViewport.getCamera();\n                const distance = Math.sqrt(Math.pow(focalPoint[0] - position[0], 2) +\n                    Math.pow(focalPoint[1] - position[1], 2) +\n                    Math.pow(focalPoint[2] - position[2], 2));\n                const updatedFocalPoint = [\n                    worldPos[0],\n                    worldPos[1],\n                    worldPos[2],\n                ];\n                const updatedPosition = [\n                    updatedFocalPoint[0] + distance * viewPlaneNormal[0],\n                    updatedFocalPoint[1] + distance * viewPlaneNormal[1],\n                    updatedFocalPoint[2] + distance * viewPlaneNormal[2],\n                ];\n                magnifyViewport.setCamera({\n                    parallelScale: parallelScale * (1 / this.configuration.magnifySize),\n                    focalPoint: updatedFocalPoint,\n                    position: updatedPosition,\n                });\n                magnifyViewport.render();\n            });\n            magnifyToolElement.style.display = 'block';\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { deltaPoints, element, currentPoints } = eventDetail;\n            const deltaPointsWorld = deltaPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const magnifyViewport = renderingEngine.getViewport(MAGNIFY_VIEWPORT_ID);\n            const magnifyElement = element.querySelector('.magnifyTool');\n            if (!magnifyElement) {\n                return;\n            }\n            magnifyElement.style.top = `${canvasPos[1] - this.configuration.magnifyHeight / 2}px`;\n            magnifyElement.style.left = `${canvasPos[0] - this.configuration.magnifyWidth / 2}px`;\n            const { focalPoint, position } = magnifyViewport.getCamera();\n            const updatedPosition = [\n                position[0] + deltaPointsWorld[0],\n                position[1] + deltaPointsWorld[1],\n                position[2] + deltaPointsWorld[2],\n            ];\n            const updatedFocalPoint = [\n                focalPoint[0] + deltaPointsWorld[0],\n                focalPoint[1] + deltaPointsWorld[1],\n                focalPoint[2] + deltaPointsWorld[2],\n            ];\n            magnifyViewport.setCamera({\n                focalPoint: updatedFocalPoint,\n                position: updatedPosition,\n            });\n            magnifyViewport.render();\n        };\n        this._dragEndCallback = (evt) => {\n            const { element } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            renderingEngine.disableElement(MAGNIFY_VIEWPORT_ID);\n            const viewportElement = element.querySelector('.viewport-element');\n            const magnifyToolElement = viewportElement.querySelector('.magnifyTool');\n            viewportElement.removeChild(magnifyToolElement);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this._hasBeenRemoved = true;\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            this._hasBeenRemoved = false;\n            element.addEventListener(Events.MOUSE_UP, this._dragEndCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._dragEndCallback);\n            element.addEventListener(Events.TOUCH_END, this._dragEndCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._dragEndCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._dragEndCallback);\n            element.removeEventListener(Events.TOUCH_END, this._dragEndCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n    }\n    _getReferencedImageId(viewport) {\n        const targetId = this.getTargetId(viewport);\n        let referencedImageId;\n        if (viewport instanceof StackViewport) {\n            referencedImageId = targetId.split('imageId:')[1];\n        }\n        return referencedImageId;\n    }\n}\nMagnifyTool.toolName = 'Magnify';\nexport default MagnifyTool;\n","import { AnnotationTool } from './base';\nimport { getEnabledElement, utilities as csUtils, eventTarget, Enums, getRenderingEngine, CONSTANTS, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { addAnnotation, getAllAnnotations, getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted } from '../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events, MouseBindings, KeyboardBindings, Events as cstEvents, SegmentationRepresentations, ToolModes, } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCanvasCircleRadius } from '../utilities/math/circle';\nimport { vec2, vec3 } from 'gl-matrix';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nimport debounce from '../utilities/debounce';\nimport { distanceToPoint } from '../utilities/math/point';\nimport { addSegmentationRepresentations } from '../stateManagement/segmentation';\nconst MAGNIFY_CLASSNAME = 'advancedMagnifyTool';\nconst MAGNIFY_VIEWPORT_INITIAL_RADIUS = 125;\nconst { Events: csEvents } = Enums;\nconst isSegmentation = (actor) => actor.uid !== actor.referencedId;\nvar AdvancedMagnifyToolActions;\n(function (AdvancedMagnifyToolActions) {\n    AdvancedMagnifyToolActions[\"ShowZoomFactorsList\"] = \"showZoomFactorsList\";\n})(AdvancedMagnifyToolActions || (AdvancedMagnifyToolActions = {}));\nconst ADVANCED_MAGNIFY_TOOL_NAME = 'AdvancedMagnify';\nconst PARALLEL_THRESHOLD = 1 - CONSTANTS.EPSILON;\nclass AdvancedMagnifyTool extends AnnotationTool {\n    static { this.Actions = AdvancedMagnifyToolActions; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            magnifyingGlass: {\n                radius: 125,\n                zoomFactor: 3,\n                zoomFactorList: [1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5],\n                autoPan: {\n                    enabled: true,\n                    padding: 10,\n                },\n            },\n            actions: {\n                showZoomFactorsList: {\n                    method: 'showZoomFactorsList',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Secondary,\n                            modifierKey: KeyboardBindings.Shift,\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const { magnifyingGlass: config } = this.configuration;\n            const { radius, zoomFactor, autoPan } = config;\n            const canvasHandlePoints = this._getCanvasHandlePoints(canvasPos, radius);\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotationUID = csUtils.uuidv4();\n            const magnifyViewportId = csUtils.uuidv4();\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                annotationUID,\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    sourceViewportId: viewport.id,\n                    magnifyViewportId,\n                    zoomFactor,\n                    isCanvasAnnotation: true,\n                    handles: {\n                        points: canvasHandlePoints,\n                        activeHandleIndex: null,\n                    },\n                },\n            };\n            this.magnifyViewportManager.createViewport(annotation, {\n                magnifyViewportId,\n                sourceEnabledElement: enabledElement,\n                position: canvasPos,\n                radius,\n                zoomFactor,\n                autoPan: {\n                    enabled: autoPan.enabled,\n                    padding: autoPan.padding,\n                    callback: (data) => {\n                        const annotationPoints = annotation.data.handles.points;\n                        const { canvas: canvasDelta } = data.delta;\n                        for (let i = 0, len = annotationPoints.length; i < len; i++) {\n                            const point = annotationPoints[i];\n                            point[0] += canvasDelta[0];\n                            point[1] += canvasDelta[1];\n                            annotation.invalidated = true;\n                        }\n                    },\n                },\n            });\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.onSetToolDisabled = () => {\n            this.magnifyViewportManager.dispose();\n            const annotations = getAllAnnotations();\n            annotations.forEach((annotation) => {\n                if (annotation.metadata.toolName === this.getToolName()) {\n                    removeAnnotation(annotation.annotationUID);\n                }\n            });\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points;\n            const canvasTop = canvasCoordinates[0];\n            const canvasBottom = canvasCoordinates[2];\n            const canvasLeft = canvasCoordinates[3];\n            const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n            const center = [\n                canvasLeft[0] + radius,\n                canvasTop[1] + radius,\n            ];\n            const radiusPoint = getCanvasCircleRadius([center, canvasCoords]);\n            if (Math.abs(radiusPoint - radius) < proximity * 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            const { points } = data.handles;\n            const handleIndex = points.findIndex((p) => p === handle);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { deltaPoints } = eventDetail;\n            const canvasDelta = deltaPoints?.canvas ?? [0, 0, 0];\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { points } = annotation.data.handles;\n            points.forEach((point) => {\n                point[0] += canvasDelta[0];\n                point[1] += canvasDelta[1];\n            });\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const canvasDelta = deltaPoints.canvas;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += canvasDelta[0];\n                    point[1] += canvasDelta[1];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points;\n            const canvasTop = canvasCoordinates[0];\n            const canvasBottom = canvasCoordinates[2];\n            const canvasLeft = canvasCoordinates[3];\n            const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n            const canvasCenter = [\n                canvasLeft[0] + radius,\n                canvasTop[1] + radius,\n            ];\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const newRadius = getCanvasCircleRadius([\n                canvasCenter,\n                currentCanvasPoints,\n            ]);\n            const newCanvasHandlePoints = this._getCanvasHandlePoints(canvasCenter, newRadius);\n            points[0] = newCanvasHandlePoints[0];\n            points[1] = newCanvasHandlePoints[1];\n            points[2] = newCanvasHandlePoints[2];\n            points[3] = newCanvasHandlePoints[3];\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = annotations?.filter((annotation) => annotation.data.sourceViewportId ===\n                viewport.id);\n            const filteredAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!filteredAnnotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < filteredAnnotations.length; i++) {\n                const annotation = filteredAnnotations[i];\n                const { annotationUID, data } = annotation;\n                const { magnifyViewportId, zoomFactor, handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points;\n                const canvasTop = canvasCoordinates[0];\n                const canvasBottom = canvasCoordinates[2];\n                const canvasLeft = canvasCoordinates[3];\n                const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n                const center = [\n                    canvasLeft[0] + radius,\n                    canvasTop[1] + radius,\n                ];\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-advancedMagnify`;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineWidth: 5,\n                }, dataId);\n                const magnifyViewport = this.magnifyViewportManager.getViewport(magnifyViewportId);\n                magnifyViewport.position = center;\n                magnifyViewport.radius = radius;\n                magnifyViewport.zoomFactor = zoomFactor;\n                magnifyViewport.update();\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this._getCanvasHandlePoints = (canvasCenterPos, canvasRadius) => {\n            return [\n                [canvasCenterPos[0], canvasCenterPos[1] - canvasRadius, 0],\n                [canvasCenterPos[0] + canvasRadius, canvasCenterPos[1], 0],\n                [canvasCenterPos[0], canvasCenterPos[1] + canvasRadius, 0],\n                [canvasCenterPos[0] - canvasRadius, canvasCenterPos[1], 0],\n            ];\n        };\n        this.magnifyViewportManager = AdvancedMagnifyViewportManager.getInstance();\n    }\n    showZoomFactorsList(evt, annotation) {\n        const { element, currentPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { canvas: canvasPoint } = currentPoints;\n        const viewportElement = element.querySelector(':scope .viewport-element');\n        const currentZoomFactor = annotation.data.zoomFactor;\n        const remove = () => dropdown.parentElement.removeChild(dropdown);\n        const dropdown = this._getZoomFactorsListDropdown(currentZoomFactor, (newZoomFactor) => {\n            if (newZoomFactor !== undefined) {\n                annotation.data.zoomFactor = Number.parseFloat(newZoomFactor);\n                annotation.invalidated = true;\n            }\n            remove();\n            viewport.render();\n        });\n        Object.assign(dropdown.style, {\n            left: `${canvasPoint[0]}px`,\n            top: `${canvasPoint[1]}px`,\n        });\n        viewportElement.appendChild(dropdown);\n        dropdown.focus();\n    }\n    _getZoomFactorsListDropdown(currentZoomFactor, onChangeCallback) {\n        const { zoomFactorList } = this.configuration.magnifyingGlass;\n        const dropdown = document.createElement('select');\n        dropdown.size = 5;\n        Object.assign(dropdown.style, {\n            width: '50px',\n            position: 'absolute',\n        });\n        ['mousedown', 'mouseup', 'mousemove', 'click'].forEach((eventName) => {\n            dropdown.addEventListener(eventName, (evt) => evt.stopPropagation());\n        });\n        dropdown.addEventListener('change', (evt) => {\n            evt.stopPropagation();\n            onChangeCallback(dropdown.value);\n        });\n        dropdown.addEventListener('keydown', (evt) => {\n            const shouldCancel = (evt.keyCode ?? evt.which === 27) ||\n                evt.key?.toLowerCase() === 'escape';\n            if (shouldCancel) {\n                evt.stopPropagation();\n                onChangeCallback();\n            }\n        });\n        zoomFactorList.forEach((zoomFactor) => {\n            const option = document.createElement('option');\n            option.label = zoomFactor;\n            option.title = `Zoom factor ${zoomFactor.toFixed(1)}`;\n            option.value = zoomFactor;\n            option.defaultSelected = zoomFactor === currentZoomFactor;\n            dropdown.add(option);\n        });\n        return dropdown;\n    }\n}\nclass AdvancedMagnifyViewportManager {\n    constructor() {\n        this.createViewport = (annotation, viewportInfo) => {\n            const { magnifyViewportId, sourceEnabledElement, position, radius, zoomFactor, autoPan, } = viewportInfo;\n            const { viewport: sourceViewport } = sourceEnabledElement;\n            const { element: sourceElement } = sourceViewport;\n            const magnifyViewport = new AdvancedMagnifyViewport({\n                magnifyViewportId,\n                sourceEnabledElement,\n                radius,\n                position,\n                zoomFactor,\n                autoPan,\n            });\n            this._addSourceElementEventListener(sourceElement);\n            this._magnifyViewportsMap.set(magnifyViewport.viewportId, {\n                annotation,\n                magnifyViewport,\n                magnifyViewportInfo: viewportInfo,\n            });\n            return magnifyViewport;\n        };\n        this._annotationRemovedCallback = (evt) => {\n            const { annotation } = evt.detail;\n            if (annotation.metadata.toolName !== ADVANCED_MAGNIFY_TOOL_NAME) {\n                return;\n            }\n            this.destroyViewport(annotation.data.magnifyViewportId);\n        };\n        this._newStackImageCallback = (evt) => {\n            const { viewportId: sourceViewportId, imageId } = evt.detail;\n            const magnifyViewportsMapEntries = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n            const { viewport } = getEnabledElementByViewportId(sourceViewportId);\n            if (viewport.stackActorReInitialized) {\n                this._reset(sourceViewportId);\n            }\n            magnifyViewportsMapEntries.forEach(({ annotation }) => {\n                annotation.metadata.referencedImageId = imageId;\n                annotation.invalidated = true;\n            });\n        };\n        this._newVolumeImageCallback = (evt) => {\n            const { renderingEngineId, viewportId: sourceViewportId } = evt.detail;\n            const renderingEngine = getRenderingEngine(renderingEngineId);\n            const sourceViewport = renderingEngine.getViewport(sourceViewportId);\n            const { viewPlaneNormal: currentViewPlaneNormal } = sourceViewport.getCamera();\n            const magnifyViewportsMapEntries = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n            magnifyViewportsMapEntries.forEach(({ annotation }) => {\n                const { viewPlaneNormal } = annotation.metadata;\n                const isParallel = Math.abs(vec3.dot(viewPlaneNormal, currentViewPlaneNormal)) >\n                    PARALLEL_THRESHOLD;\n                if (!isParallel) {\n                    return;\n                }\n                const { handles } = annotation.data;\n                const worldImagePlanePoint = sourceViewport.canvasToWorld([0, 0]);\n                const vecHandleToImagePlane = vec3.sub(vec3.create(), worldImagePlanePoint, handles.points[0]);\n                const worldDist = vec3.dot(vecHandleToImagePlane, currentViewPlaneNormal);\n                const worldDelta = vec3.scale(vec3.create(), currentViewPlaneNormal, worldDist);\n                for (let i = 0, len = handles.points.length; i < len; i++) {\n                    const point = handles.points[i];\n                    point[0] += worldDelta[0];\n                    point[1] += worldDelta[1];\n                    point[2] += worldDelta[2];\n                }\n                annotation.invalidated = true;\n            });\n        };\n        this._magnifyViewportsMap = new Map();\n        this._initialize();\n    }\n    static getInstance() {\n        AdvancedMagnifyViewportManager._singleton =\n            AdvancedMagnifyViewportManager._singleton ??\n                new AdvancedMagnifyViewportManager();\n        return AdvancedMagnifyViewportManager._singleton;\n    }\n    getViewport(magnifyViewportId) {\n        return this._magnifyViewportsMap.get(magnifyViewportId)?.magnifyViewport;\n    }\n    dispose() {\n        this._removeEventListeners();\n        this._destroyViewports();\n    }\n    destroyViewport(magnifyViewportId) {\n        const magnifyViewportMapEntry = this._magnifyViewportsMap.get(magnifyViewportId);\n        if (magnifyViewportMapEntry) {\n            const { magnifyViewport } = magnifyViewportMapEntry;\n            const { viewport: sourceViewport } = magnifyViewport.sourceEnabledElement;\n            const { element: sourceElement } = sourceViewport;\n            this._removeSourceElementEventListener(sourceElement);\n            magnifyViewport.dispose();\n            this._magnifyViewportsMap.delete(magnifyViewportId);\n        }\n    }\n    _destroyViewports() {\n        const magnifyViewportIds = Array.from(this._magnifyViewportsMap.keys());\n        magnifyViewportIds.forEach((magnifyViewportId) => this.destroyViewport(magnifyViewportId));\n    }\n    _getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId) {\n        const magnifyViewportsMapEntries = Array.from(this._magnifyViewportsMap.values());\n        return magnifyViewportsMapEntries.filter(({ magnifyViewport }) => {\n            const { viewport } = magnifyViewport.sourceEnabledElement;\n            return viewport.id === sourceViewportId;\n        });\n    }\n    _reset(sourceViewportId) {\n        const magnifyViewports = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n        magnifyViewports.forEach(({ magnifyViewport, annotation, magnifyViewportInfo }) => {\n            this.destroyViewport(magnifyViewport.viewportId);\n            const newEnabledElement = getEnabledElementByViewportId(sourceViewportId);\n            this.createViewport(annotation, {\n                ...magnifyViewportInfo,\n                sourceEnabledElement: {\n                    ...newEnabledElement,\n                },\n            });\n        });\n    }\n    _addEventListeners() {\n        eventTarget.addEventListener(cstEvents.ANNOTATION_REMOVED, this._annotationRemovedCallback);\n    }\n    _removeEventListeners() {\n        eventTarget.removeEventListener(cstEvents.ANNOTATION_REMOVED, this._annotationRemovedCallback);\n    }\n    _addSourceElementEventListener(element) {\n        element.addEventListener(csEvents.STACK_NEW_IMAGE, this._newStackImageCallback);\n        const newStackHandler = (evt) => {\n            const { viewportId: sourceViewportId } = evt.detail;\n            this._reset(sourceViewportId);\n        };\n        element.addEventListener(csEvents.VIEWPORT_NEW_IMAGE_SET, newStackHandler);\n        const newVolumeHandler = (evt) => {\n            const { viewportId: sourceViewportId } = evt.detail;\n            this._reset(sourceViewportId);\n        };\n        element.addEventListener(csEvents.VOLUME_VIEWPORT_NEW_VOLUME, newVolumeHandler);\n        element.addEventListener(csEvents.VOLUME_NEW_IMAGE, this._newVolumeImageCallback);\n        element.newStackHandler = newStackHandler;\n        element.newVolumeHandler = newVolumeHandler;\n    }\n    _removeSourceElementEventListener(element) {\n        element.removeEventListener(csEvents.STACK_NEW_IMAGE, this._newStackImageCallback);\n        element.removeEventListener(csEvents.VOLUME_NEW_IMAGE, this._newVolumeImageCallback);\n        element.removeEventListener(csEvents.VIEWPORT_NEW_IMAGE_SET, element.newStackHandler);\n        element.removeEventListener(csEvents.VOLUME_VIEWPORT_NEW_VOLUME, element.newVolumeHandler);\n        delete element.newStackHandler;\n        delete element.newVolumeHandler;\n    }\n    _initialize() {\n        this._addEventListeners();\n    }\n}\nclass AdvancedMagnifyViewport {\n    constructor({ magnifyViewportId, sourceEnabledElement, radius = MAGNIFY_VIEWPORT_INITIAL_RADIUS, position = [0, 0], zoomFactor, autoPan, }) {\n        this._enabledElement = null;\n        this._sourceToolGroup = null;\n        this._magnifyToolGroup = null;\n        this._isViewportReady = false;\n        this._radius = 0;\n        this._resized = false;\n        this._canAutoPan = false;\n        this._viewportId = magnifyViewportId ?? csUtils.uuidv4();\n        this._sourceEnabledElement = sourceEnabledElement;\n        this._autoPan = autoPan;\n        this.radius = radius;\n        this.position = position;\n        this.zoomFactor = zoomFactor;\n        this.visible = true;\n        this._browserMouseDownCallback = this._browserMouseDownCallback.bind(this);\n        this._browserMouseUpCallback = this._browserMouseUpCallback.bind(this);\n        this._handleToolModeChanged = this._handleToolModeChanged.bind(this);\n        this._mouseDragCallback = this._mouseDragCallback.bind(this);\n        this._resizeViewportAsync = (debounce(this._resizeViewport.bind(this), 1));\n        this._initialize();\n    }\n    get sourceEnabledElement() {\n        return this._sourceEnabledElement;\n    }\n    get viewportId() {\n        return this._viewportId;\n    }\n    get radius() {\n        return this._radius;\n    }\n    set radius(radius) {\n        if (Math.abs(this._radius - radius) > 0.00001) {\n            this._radius = radius;\n            this._resized = true;\n        }\n    }\n    update() {\n        const { radius, position, visible } = this;\n        const { viewport } = this._enabledElement;\n        const { element } = viewport;\n        const size = 2 * radius;\n        const [x, y] = position;\n        if (this._resized) {\n            this._resizeViewportAsync();\n            this._resized = false;\n        }\n        Object.assign(element.style, {\n            display: visible ? 'block' : 'hidden',\n            width: `${size}px`,\n            height: `${size}px`,\n            left: `${-radius}px`,\n            top: `${-radius}px`,\n            transform: `translate(${x}px, ${y}px)`,\n        });\n        if (this._isViewportReady) {\n            this._syncViewports();\n            viewport.render();\n        }\n    }\n    dispose() {\n        const { viewport } = this._enabledElement;\n        const { element } = viewport;\n        const renderingEngine = viewport.getRenderingEngine();\n        this._removeEventListeners(element);\n        renderingEngine.disableElement(viewport.id);\n        if (element.parentNode) {\n            element.parentNode.removeChild(element);\n        }\n    }\n    _handleToolModeChanged(evt) {\n        const { _magnifyToolGroup: magnifyToolGroup } = this;\n        const { toolGroupId, toolName, mode, toolBindingsOptions } = evt.detail;\n        if (this._sourceToolGroup?.id !== toolGroupId) {\n            return;\n        }\n        switch (mode) {\n            case ToolModes.Active:\n                magnifyToolGroup.setToolActive(toolName, toolBindingsOptions);\n                break;\n            case ToolModes.Passive:\n                magnifyToolGroup.setToolPassive(toolName);\n                break;\n            case ToolModes.Enabled:\n                magnifyToolGroup.setToolEnabled(toolName);\n                break;\n            case ToolModes.Disabled:\n                magnifyToolGroup.setToolDisabled(toolName);\n                break;\n            default:\n                throw new Error(`Unknow tool mode (${mode})`);\n        }\n    }\n    _inheritBorderRadius(magnifyElement) {\n        const viewport = magnifyElement.querySelector('.viewport-element');\n        const canvas = magnifyElement.querySelector('.cornerstone-canvas');\n        viewport.style.borderRadius = 'inherit';\n        canvas.style.borderRadius = 'inherit';\n    }\n    _createViewportNode() {\n        const magnifyElement = document.createElement('div');\n        const { radius } = this;\n        const size = radius * 2;\n        magnifyElement.classList.add(MAGNIFY_CLASSNAME);\n        Object.assign(magnifyElement.style, {\n            display: 'block',\n            width: `${size}px`,\n            height: `${size}px`,\n            position: 'absolute',\n            overflow: 'hidden',\n            borderRadius: '50%',\n            boxSizing: 'border-box',\n            left: `${-radius}px`,\n            top: `${-radius}px`,\n            transform: `translate(-1000px, -1000px)`,\n        });\n        return magnifyElement;\n    }\n    _convertZoomFactorToParallelScale(viewport, magnifyViewport, zoomFactor) {\n        const { parallelScale } = viewport.getCamera();\n        const canvasRatio = magnifyViewport.canvas.offsetWidth / viewport.canvas.offsetWidth;\n        return parallelScale * (1 / zoomFactor) * canvasRatio;\n    }\n    _isStackViewport(viewport) {\n        return 'setStack' in viewport;\n    }\n    _isVolumeViewport(viewport) {\n        return 'addVolumes' in viewport;\n    }\n    _cloneToolGroups(sourceViewport, magnifyViewport) {\n        const sourceActors = sourceViewport.getActors();\n        const magnifyToolGroupId = `${magnifyViewport.id}-toolGroup`;\n        const sourceToolGroup = getToolGroupForViewport(sourceViewport.id, sourceViewport.renderingEngineId);\n        const magnifyToolGroup = sourceToolGroup.clone(magnifyToolGroupId, (toolName) => {\n            const toolInstance = sourceToolGroup.getToolInstance(toolName);\n            const isAnnotationTool = toolInstance instanceof AnnotationTool &&\n                !(toolInstance instanceof AdvancedMagnifyTool);\n            return isAnnotationTool;\n        });\n        magnifyToolGroup.addViewport(magnifyViewport.id, magnifyViewport.renderingEngineId);\n        sourceActors.filter(isSegmentation).forEach((actor) => {\n            addSegmentationRepresentations(this.viewportId, [\n                {\n                    segmentationId: actor.referencedId,\n                    type: SegmentationRepresentations.Labelmap,\n                },\n            ]);\n        });\n        return { sourceToolGroup, magnifyToolGroup };\n    }\n    _cloneStack(sourceViewport, magnifyViewport) {\n        const imageIds = sourceViewport.getImageIds();\n        magnifyViewport.setStack(imageIds).then(() => {\n            this._isViewportReady = true;\n            this.update();\n        });\n    }\n    _cloneVolumes(sourceViewport, magnifyViewport) {\n        const actors = sourceViewport.getActors();\n        const volumeInputArray = actors\n            .filter((actor) => !isSegmentation(actor))\n            .map((actor) => ({ volumeId: actor.uid }));\n        magnifyViewport.setVolumes(volumeInputArray).then(() => {\n            this._isViewportReady = true;\n            this.update();\n        });\n        return magnifyViewport;\n    }\n    _cloneViewport(sourceViewport, magnifyElement) {\n        const { viewportId: magnifyViewportId } = this;\n        const renderingEngine = sourceViewport.getRenderingEngine();\n        const { options: sourceViewportOptions } = sourceViewport;\n        const viewportInput = {\n            element: magnifyElement,\n            viewportId: magnifyViewportId,\n            type: sourceViewport.type,\n            defaultOptions: { ...sourceViewportOptions },\n        };\n        renderingEngine.enableElement(viewportInput);\n        const magnifyViewport = (renderingEngine.getViewport(magnifyViewportId));\n        if (this._isStackViewport(sourceViewport)) {\n            this._cloneStack(sourceViewport, magnifyViewport);\n        }\n        else if (this._isVolumeViewport(sourceViewport)) {\n            this._cloneVolumes(sourceViewport, magnifyViewport);\n        }\n        this._inheritBorderRadius(magnifyElement);\n        const toolGroups = this._cloneToolGroups(sourceViewport, magnifyViewport);\n        this._sourceToolGroup = toolGroups.sourceToolGroup;\n        this._magnifyToolGroup = toolGroups.magnifyToolGroup;\n    }\n    _cancelMouseEventCallback(evt) {\n        evt.stopPropagation();\n        evt.preventDefault();\n    }\n    _browserMouseUpCallback(evt) {\n        const { element } = this._enabledElement.viewport;\n        document.removeEventListener('mouseup', this._browserMouseUpCallback);\n        element.addEventListener('mouseup', this._cancelMouseEventCallback);\n        element.addEventListener('mousemove', this._cancelMouseEventCallback);\n    }\n    _browserMouseDownCallback(evt) {\n        const { element } = this._enabledElement.viewport;\n        this._canAutoPan = !!evt.target?.closest('.advancedMagnifyTool');\n        document.addEventListener('mouseup', this._browserMouseUpCallback);\n        element.removeEventListener('mouseup', this._cancelMouseEventCallback);\n        element.removeEventListener('mousemove', this._cancelMouseEventCallback);\n    }\n    _mouseDragCallback(evt) {\n        if (!state.isInteractingWithTool) {\n            return;\n        }\n        const { _autoPan: autoPan } = this;\n        if (!autoPan.enabled || !this._canAutoPan) {\n            return;\n        }\n        const { currentPoints } = evt.detail;\n        const { viewport } = this._enabledElement;\n        const { canvasToWorld } = viewport;\n        const { canvas: canvasCurrent } = currentPoints;\n        const { radius: magnifyRadius } = this;\n        const canvasCenter = [magnifyRadius, magnifyRadius];\n        const dist = distanceToPoint(canvasCenter, canvasCurrent);\n        const maxDist = magnifyRadius - autoPan.padding;\n        if (dist <= maxDist) {\n            return;\n        }\n        const panDist = dist - maxDist;\n        const canvasDeltaPos = vec2.sub(vec2.create(), canvasCurrent, canvasCenter);\n        vec2.normalize(canvasDeltaPos, canvasDeltaPos);\n        vec2.scale(canvasDeltaPos, canvasDeltaPos, panDist);\n        const newCanvasPosition = vec2.add(vec2.create(), this.position, canvasDeltaPos);\n        const currentWorldPos = canvasToWorld(this.position);\n        const newWorldPos = canvasToWorld(newCanvasPosition);\n        const worldDeltaPos = vec3.sub(vec3.create(), newWorldPos, currentWorldPos);\n        const autoPanCallbackData = {\n            points: {\n                currentPosition: {\n                    canvas: this.position,\n                    world: currentWorldPos,\n                },\n                newPosition: {\n                    canvas: newCanvasPosition,\n                    world: newWorldPos,\n                },\n            },\n            delta: {\n                canvas: canvasDeltaPos,\n                world: worldDeltaPos,\n            },\n        };\n        autoPan.callback(autoPanCallbackData);\n    }\n    _addBrowserEventListeners(element) {\n        document.addEventListener('mousedown', this._browserMouseDownCallback, true);\n        element.addEventListener('mousedown', this._cancelMouseEventCallback);\n        element.addEventListener('mouseup', this._cancelMouseEventCallback);\n        element.addEventListener('mousemove', this._cancelMouseEventCallback);\n        element.addEventListener('dblclick', this._cancelMouseEventCallback);\n    }\n    _removeBrowserEventListeners(element) {\n        document.removeEventListener('mousedown', this._browserMouseDownCallback, true);\n        document.removeEventListener('mouseup', this._browserMouseUpCallback);\n        element.removeEventListener('mousedown', this._cancelMouseEventCallback);\n        element.removeEventListener('mouseup', this._cancelMouseEventCallback);\n        element.removeEventListener('mousemove', this._cancelMouseEventCallback);\n        element.removeEventListener('dblclick', this._cancelMouseEventCallback);\n    }\n    _addEventListeners(element) {\n        eventTarget.addEventListener(cstEvents.TOOL_MODE_CHANGED, this._handleToolModeChanged);\n        element.addEventListener(cstEvents.MOUSE_MOVE, this._mouseDragCallback);\n        element.addEventListener(cstEvents.MOUSE_DRAG, this._mouseDragCallback);\n        this._addBrowserEventListeners(element);\n    }\n    _removeEventListeners(element) {\n        eventTarget.removeEventListener(cstEvents.TOOL_MODE_CHANGED, this._handleToolModeChanged);\n        element.addEventListener(cstEvents.MOUSE_MOVE, this._mouseDragCallback);\n        element.addEventListener(cstEvents.MOUSE_DRAG, this._mouseDragCallback);\n        this._removeBrowserEventListeners(element);\n    }\n    _initialize() {\n        const { _sourceEnabledElement: sourceEnabledElement } = this;\n        const { viewport: sourceViewport } = sourceEnabledElement;\n        const { canvas: sourceCanvas } = sourceViewport;\n        const magnifyElement = this._createViewportNode();\n        sourceCanvas.parentNode.appendChild(magnifyElement);\n        this._addEventListeners(magnifyElement);\n        this._cloneViewport(sourceViewport, magnifyElement);\n        this._enabledElement = getEnabledElement(magnifyElement);\n    }\n    _syncViewportsCameras(sourceViewport, magnifyViewport) {\n        const worldPos = sourceViewport.canvasToWorld(this.position);\n        const parallelScale = this._convertZoomFactorToParallelScale(sourceViewport, magnifyViewport, this.zoomFactor);\n        const { focalPoint, position, viewPlaneNormal } = magnifyViewport.getCamera();\n        const distance = Math.sqrt(Math.pow(focalPoint[0] - position[0], 2) +\n            Math.pow(focalPoint[1] - position[1], 2) +\n            Math.pow(focalPoint[2] - position[2], 2));\n        const updatedFocalPoint = [\n            worldPos[0],\n            worldPos[1],\n            worldPos[2],\n        ];\n        const updatedPosition = [\n            updatedFocalPoint[0] + distance * viewPlaneNormal[0],\n            updatedFocalPoint[1] + distance * viewPlaneNormal[1],\n            updatedFocalPoint[2] + distance * viewPlaneNormal[2],\n        ];\n        magnifyViewport.setCamera({\n            parallelScale,\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n    }\n    _syncStackViewports(sourceViewport, magnifyViewport) {\n        magnifyViewport.setImageIdIndex(sourceViewport.getCurrentImageIdIndex());\n    }\n    _syncViewports() {\n        const { viewport: sourceViewport } = this._sourceEnabledElement;\n        const { viewport: magnifyViewport } = this._enabledElement;\n        const sourceProperties = sourceViewport.getProperties();\n        const imageData = magnifyViewport.getImageData();\n        if (!imageData) {\n            return;\n        }\n        magnifyViewport.setProperties(sourceProperties);\n        this._syncViewportsCameras(sourceViewport, magnifyViewport);\n        if (this._isStackViewport(sourceViewport)) {\n            this._syncStackViewports(sourceViewport, magnifyViewport);\n        }\n        this._syncViewportsCameras(sourceViewport, magnifyViewport);\n        magnifyViewport.render();\n    }\n    _resizeViewport() {\n        const { viewport } = this._enabledElement;\n        const renderingEngine = viewport.getRenderingEngine();\n        renderingEngine.resize();\n    }\n}\nAdvancedMagnifyTool.toolName = 'AdvancedMagnify';\nexport { AdvancedMagnifyTool as default };\n","import { vec3 } from 'gl-matrix';\nimport { getRenderingEngines, CONSTANTS, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport { addAnnotation } from '../stateManagement/annotation/annotationState';\nimport { drawLine as drawLineSvg } from '../drawingSvg';\nimport { filterViewportsWithToolEnabled } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nconst { EPSILON } = CONSTANTS;\nclass ReferenceLines extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            sourceViewportId: '',\n            enforceSameFrameOfReference: true,\n            showFullDimension: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.editData = null;\n        this._init = () => {\n            const renderingEngines = getRenderingEngines();\n            const renderingEngine = renderingEngines[0];\n            if (!renderingEngine) {\n                return;\n            }\n            let viewports = renderingEngine.getViewports();\n            viewports = filterViewportsWithToolEnabled(viewports, this.getToolName());\n            const sourceViewport = renderingEngine.getViewport(this.configuration.sourceViewportId);\n            if (!sourceViewport?.getImageData()) {\n                return;\n            }\n            const { element } = sourceViewport;\n            const { viewUp, viewPlaneNormal } = sourceViewport.getCamera();\n            const sourceViewportCanvasCornersInWorld = csUtils.getViewportImageCornersInWorld(sourceViewport);\n            let annotation = this.editData?.annotation;\n            const FrameOfReferenceUID = sourceViewport.getFrameOfReferenceUID();\n            if (!annotation) {\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        viewPlaneNormal: [...viewPlaneNormal],\n                        viewUp: [...viewUp],\n                        FrameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        handles: {\n                            points: sourceViewportCanvasCornersInWorld,\n                        },\n                    },\n                };\n                addAnnotation(newAnnotation, element);\n                annotation = newAnnotation;\n            }\n            else {\n                this.editData.annotation.data.handles.points =\n                    sourceViewportCanvasCornersInWorld;\n            }\n            this.editData = {\n                sourceViewportId: sourceViewport.id,\n                renderingEngine,\n                annotation,\n            };\n            triggerAnnotationRenderForViewportIds(viewports\n                .filter((viewport) => viewport.id !== sourceViewport.id)\n                .map((viewport) => viewport.id));\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onSetToolConfiguration = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this._init();\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const { viewport: targetViewport } = enabledElement;\n            if (!this.editData) {\n                return false;\n            }\n            const { annotation, sourceViewportId } = this.editData;\n            let renderStatus = false;\n            const { viewport: sourceViewport } = getEnabledElementByViewportId(sourceViewportId) || {};\n            if (!sourceViewport) {\n                return renderStatus;\n            }\n            if (sourceViewport.id === targetViewport.id) {\n                return renderStatus;\n            }\n            if (!annotation || !annotation?.data?.handles?.points) {\n                return renderStatus;\n            }\n            if (this.configuration.enforceSameFrameOfReference &&\n                sourceViewport.getFrameOfReferenceUID() !==\n                    targetViewport.getFrameOfReferenceUID()) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const topLeft = annotation.data.handles.points[0];\n            const topRight = annotation.data.handles.points[1];\n            const bottomLeft = annotation.data.handles.points[2];\n            const bottomRight = annotation.data.handles.points[3];\n            const { focalPoint, viewPlaneNormal, viewUp } = targetViewport.getCamera();\n            const { viewPlaneNormal: sourceViewPlaneNormal } = sourceViewport.getCamera();\n            if (this.isParallel(viewPlaneNormal, sourceViewPlaneNormal)) {\n                return renderStatus;\n            }\n            const targetViewportPlane = csUtils.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n            const pointSet2 = [topLeft, topRight, bottomLeft, bottomRight];\n            let pointSetToUse = pointSet1;\n            let topBottomVec = vec3.subtract(vec3.create(), pointSet1[0], pointSet1[1]);\n            topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n            let topRightVec = vec3.subtract(vec3.create(), pointSet1[2], pointSet1[0]);\n            topRightVec = vec3.normalize(vec3.create(), topRightVec);\n            const newNormal = vec3.cross(vec3.create(), topBottomVec, topRightVec);\n            if (this.isParallel(newNormal, viewPlaneNormal)) {\n                return renderStatus;\n            }\n            if (this.isPerpendicular(topBottomVec, viewPlaneNormal)) {\n                pointSetToUse = pointSet2;\n            }\n            const lineStartWorld = csUtils.planar.linePlaneIntersection(pointSetToUse[0], pointSetToUse[1], targetViewportPlane);\n            const lineEndWorld = csUtils.planar.linePlaneIntersection(pointSetToUse[2], pointSetToUse[3], targetViewportPlane);\n            const { annotationUID } = annotation;\n            styleSpecifier.annotationUID = annotationUID;\n            const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n            const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n            const color = this.getStyle('color', styleSpecifier, annotation);\n            const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n            let canvasCoordinates = [lineStartWorld, lineEndWorld].map((world) => targetViewport.worldToCanvas(world));\n            if (this.configuration.showFullDimension) {\n                canvasCoordinates = this.handleFullDimension(targetViewport, lineStartWorld, viewPlaneNormal, viewUp, lineEndWorld, canvasCoordinates);\n            }\n            if (canvasCoordinates.length < 2) {\n                return renderStatus;\n            }\n            const dataId = `${annotationUID}-line`;\n            const lineUID = '1';\n            drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                color,\n                width: lineWidth,\n                lineDash,\n                shadow,\n            }, dataId);\n            renderStatus = true;\n            return renderStatus;\n        };\n        this.isPerpendicular = (vec1, vec2) => {\n            const dot = vec3.dot(vec1, vec2);\n            return Math.abs(dot) < EPSILON;\n        };\n    }\n    handleFullDimension(targetViewport, lineStartWorld, viewPlaneNormal, viewUp, lineEndWorld, canvasCoordinates) {\n        const renderingEngine = targetViewport.getRenderingEngine();\n        const targetId = this.getTargetId(targetViewport);\n        const targetImage = this.getTargetImageData(targetId);\n        const referencedImageId = this.getReferencedImageId(targetViewport, lineStartWorld, viewPlaneNormal, viewUp);\n        if (referencedImageId && targetImage) {\n            try {\n                const { imageData, dimensions } = targetImage;\n                const [topLeftImageCoord, topRightImageCoord, bottomRightImageCoord, bottomLeftImageCoord,] = [\n                    imageData.indexToWorld([0, 0, 0]),\n                    imageData.indexToWorld([dimensions[0] - 1, 0, 0]),\n                    imageData.indexToWorld([\n                        dimensions[0] - 1,\n                        dimensions[1] - 1,\n                        0,\n                    ]),\n                    imageData.indexToWorld([0, dimensions[1] - 1, 0]),\n                ].map((world) => csUtils.worldToImageCoords(referencedImageId, world));\n                const [lineStartImageCoord, lineEndImageCoord] = [\n                    lineStartWorld,\n                    lineEndWorld,\n                ].map((world) => csUtils.worldToImageCoords(referencedImageId, world));\n                canvasCoordinates = [\n                    [topLeftImageCoord, topRightImageCoord],\n                    [topRightImageCoord, bottomRightImageCoord],\n                    [bottomLeftImageCoord, bottomRightImageCoord],\n                    [topLeftImageCoord, bottomLeftImageCoord],\n                ]\n                    .map(([start, end]) => this.intersectInfiniteLines(start, end, lineStartImageCoord, lineEndImageCoord))\n                    .filter((point) => point && this.isInBound(point, dimensions))\n                    .map((point) => {\n                    const world = csUtils.imageToWorldCoords(referencedImageId, point);\n                    return targetViewport.worldToCanvas(world);\n                });\n            }\n            catch (err) {\n                console.log(err);\n            }\n        }\n        return canvasCoordinates;\n    }\n    intersectInfiniteLines(line1Start, line1End, line2Start, line2End) {\n        const [x1, y1] = line1Start;\n        const [x2, y2] = line1End;\n        const [x3, y3] = line2Start;\n        const [x4, y4] = line2End;\n        const a1 = y2 - y1;\n        const b1 = x1 - x2;\n        const c1 = x2 * y1 - x1 * y2;\n        const a2 = y4 - y3;\n        const b2 = x3 - x4;\n        const c2 = x4 * y3 - x3 * y4;\n        if (Math.abs(a1 * b2 - a2 * b1) < EPSILON) {\n            return;\n        }\n        const x = (b1 * c2 - b2 * c1) / (a1 * b2 - a2 * b1);\n        const y = (a2 * c1 - a1 * c2) / (a1 * b2 - a2 * b1);\n        return [x, y];\n    }\n    isParallel(vec1, vec2) {\n        return Math.abs(vec3.dot(vec1, vec2)) > 1 - EPSILON;\n    }\n    isInBound(point, dimensions) {\n        return (point[0] >= 0 &&\n            point[0] <= dimensions[0] &&\n            point[1] >= 0 &&\n            point[1] <= dimensions[1]);\n    }\n}\nReferenceLines.toolName = 'ReferenceLines';\nexport default ReferenceLines;\n","import { vec3 } from 'gl-matrix';\nimport { metaData, CONSTANTS, getRenderingEngine, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport { drawLine as drawLineSvg } from '../drawingSvg';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nconst { EPSILON } = CONSTANTS;\nclass OverlayGridTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            sourceImageIds: [],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onSetToolActive = () => {\n            this._init();\n        };\n        this._init = () => {\n            const sourceImageIds = this.configuration.sourceImageIds;\n            if (!sourceImageIds?.length) {\n                console.warn('OverlayGridTool: No sourceImageIds provided in configuration');\n                return;\n            }\n            const imagePlaneModule = metaData.get('imagePlaneModule', sourceImageIds[0]);\n            if (!imagePlaneModule) {\n                console.warn('OverlayGridTool: No imagePlaneModule found for sourceImageIds');\n                return;\n            }\n            const { frameOfReferenceUID } = imagePlaneModule;\n            const viewportsInfo = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportsInfo?.length) {\n                console.warn('OverlayGridTool: No viewports found');\n                return;\n            }\n            const annotations = getAnnotations(this.getToolName(), frameOfReferenceUID);\n            if (!annotations?.length) {\n                const pointSets = sourceImageIds.map((id) => {\n                    return this.calculateImageIdPointSets(id);\n                });\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        FrameOfReferenceUID: frameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        viewportData: new Map(),\n                        pointSets,\n                    },\n                };\n                addAnnotation(newAnnotation, frameOfReferenceUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.calculateImageIdPointSets = (imageId) => {\n            const { imagePositionPatient, rows, columns, rowCosines, columnCosines, rowPixelSpacing, columnPixelSpacing, } = metaData.get('imagePlaneModule', imageId);\n            const topLeft = [...imagePositionPatient];\n            const topRight = [...imagePositionPatient];\n            const bottomLeft = [...imagePositionPatient];\n            const bottomRight = [...imagePositionPatient];\n            vec3.scaleAndAdd(topRight, imagePositionPatient, columnCosines, columns * columnPixelSpacing);\n            vec3.scaleAndAdd(bottomLeft, imagePositionPatient, rowCosines, rows * rowPixelSpacing);\n            vec3.scaleAndAdd(bottomRight, bottomLeft, columnCosines, columns * columnPixelSpacing);\n            const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n            const pointSet2 = [topLeft, topRight, bottomLeft, bottomRight];\n            return { pointSet1, pointSet2 };\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const sourceImageIds = this.configuration.sourceImageIds;\n            let renderStatus = false;\n            if (!sourceImageIds?.length) {\n                return renderStatus;\n            }\n            const { viewport: targetViewport, FrameOfReferenceUID } = enabledElement;\n            const targetImageIds = targetViewport.getImageIds();\n            if (targetImageIds.length < 2) {\n                return renderStatus;\n            }\n            const annotations = getAnnotations(this.getToolName(), FrameOfReferenceUID);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const annotation = annotations[0];\n            const { annotationUID } = annotation;\n            const { focalPoint, viewPlaneNormal } = targetViewport.getCamera();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const imageIdNormal = (this.getImageIdNormal(sourceImageIds[0]));\n            if (this.isParallel(viewPlaneNormal, imageIdNormal)) {\n                return renderStatus;\n            }\n            const targetViewportPlane = csUtils.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const pointSets = annotation.data.pointSets;\n            const viewportData = annotation.data.viewportData;\n            for (let i = 0; i < sourceImageIds.length; i++) {\n                const { pointSet1, pointSet2 } = pointSets[i];\n                const targetData = viewportData.get(targetViewport.id) ||\n                    this.initializeViewportData(viewportData, targetViewport.id);\n                if (!targetData.pointSetsToUse[i]) {\n                    let pointSetToUse = pointSet1;\n                    let topBottomVec = vec3.subtract(vec3.create(), pointSet1[0], pointSet1[1]);\n                    topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n                    if (this.isPerpendicular(topBottomVec, viewPlaneNormal)) {\n                        pointSetToUse = pointSet2;\n                    }\n                    targetData.pointSetsToUse[i] = pointSetToUse;\n                    targetData.lineStartsWorld[i] = csUtils.planar.linePlaneIntersection(pointSetToUse[0], pointSetToUse[1], targetViewportPlane);\n                    targetData.lineEndsWorld[i] = csUtils.planar.linePlaneIntersection(pointSetToUse[2], pointSetToUse[3], targetViewportPlane);\n                }\n                const lineStartWorld = targetData.lineStartsWorld[i];\n                const lineEndWorld = targetData.lineEndsWorld[i];\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n                const canvasCoordinates = [lineStartWorld, lineEndWorld].map((world) => targetViewport.worldToCanvas(world));\n                const dataId = `${annotationUID}-line`;\n                const lineUID = `${i}`;\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId);\n            }\n            renderStatus = true;\n            return renderStatus;\n        };\n        this.initializeViewportData = (viewportData, id) => {\n            viewportData.set(id, {\n                pointSetsToUse: [],\n                lineStartsWorld: [],\n                lineEndsWorld: [],\n            });\n            return viewportData.get(id);\n        };\n        this.isPerpendicular = (vec1, vec2) => {\n            const dot = vec3.dot(vec1, vec2);\n            return Math.abs(dot) < EPSILON;\n        };\n    }\n    isParallel(vec1, vec2) {\n        return Math.abs(vec3.dot(vec1, vec2)) > 1 - EPSILON;\n    }\n    getImageIdNormal(imageId) {\n        const { imageOrientationPatient } = metaData.get('imagePlaneModule', imageId);\n        const rowCosineVec = vec3.fromValues(imageOrientationPatient[0], imageOrientationPatient[1], imageOrientationPatient[2]);\n        const colCosineVec = vec3.fromValues(imageOrientationPatient[3], imageOrientationPatient[4], imageOrientationPatient[5]);\n        return vec3.cross(vec3.create(), rowCosineVec, colCosineVec);\n    }\n}\nOverlayGridTool.toolName = 'OverlayGrid';\nexport default OverlayGridTool;\n","import { getRenderingEngine } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { drawPath } from '../drawingSvg';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport { distanceToPoint } from '../utilities/math/point';\nimport { pointToString } from '../utilities/pointToString';\nimport { polyDataUtils } from '../utilities';\nclass SegmentationIntersectionTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            opacity: 0.5,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._init = () => {\n            const viewportsInfo = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportsInfo?.length) {\n                console.warn(this.getToolName() + 'Tool: No viewports found');\n                return;\n            }\n            const firstViewport = getRenderingEngine(viewportsInfo[0].renderingEngineId)?.getViewport(viewportsInfo[0].viewportId);\n            if (!firstViewport) {\n                return;\n            }\n            const frameOfReferenceUID = firstViewport.getFrameOfReferenceUID();\n            const annotations = getAnnotations(this.getToolName(), frameOfReferenceUID);\n            if (!annotations?.length) {\n                const actorsWorldPointsMap = new Map();\n                calculateSurfaceSegmentationIntersections(actorsWorldPointsMap, viewportsInfo);\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        FrameOfReferenceUID: frameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        actorsWorldPointsMap,\n                    },\n                };\n                addAnnotation(newAnnotation, frameOfReferenceUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this._init();\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const { viewport, FrameOfReferenceUID } = enabledElement;\n            let renderStatus = false;\n            const annotations = getAnnotations(this.getToolName(), FrameOfReferenceUID);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const annotation = annotations[0];\n            const { annotationUID } = annotation;\n            const actorsWorldPointsMap = annotation.data.actorsWorldPointsMap;\n            calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport);\n            const actorEntries = viewport.getActors();\n            const cacheId = getCacheId(viewport);\n            actorEntries.forEach((actorEntry) => {\n                if (!actorEntry?.clippingFilter) {\n                    return;\n                }\n                const actorWorldPointMap = actorsWorldPointsMap.get(actorEntry.uid);\n                if (!actorWorldPointMap) {\n                    return;\n                }\n                if (!actorWorldPointMap.get(cacheId)) {\n                    return;\n                }\n                let polyLineIdx = 1;\n                const { worldPointsSet, color } = actorWorldPointMap.get(cacheId);\n                for (let i = 0; i < worldPointsSet.length; i++) {\n                    const worldPoints = worldPointsSet[i];\n                    const canvasPoints = worldPoints.map((point) => viewport.worldToCanvas(point));\n                    const options = {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: this.configuration.opacity,\n                        closePath: true,\n                        lineWidth: 2,\n                    };\n                    const polyLineUID = actorEntry.uid + '#' + polyLineIdx;\n                    drawPath(svgDrawingHelper, annotationUID, polyLineUID, canvasPoints, options);\n                    polyLineIdx++;\n                }\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nfunction calculateSurfaceSegmentationIntersections(actorsWorldPointsMap, viewportsInfo) {\n    viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n        const viewport = getRenderingEngine(renderingEngineId)?.getViewport(viewportId);\n        calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport);\n    });\n}\nfunction calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport) {\n    const actorEntries = viewport.getActors();\n    const cacheId = getCacheId(viewport);\n    actorEntries.forEach((actorEntry) => {\n        if (!actorEntry?.clippingFilter) {\n            return;\n        }\n        let actorWorldPointsMap = actorsWorldPointsMap.get(actorEntry.uid);\n        if (!actorWorldPointsMap) {\n            actorWorldPointsMap = new Map();\n            actorsWorldPointsMap.set(actorEntry.uid, actorWorldPointsMap);\n        }\n        if (!actorWorldPointsMap.get(cacheId)) {\n            const polyData = actorEntry.clippingFilter.getOutputData();\n            const worldPointsSet = polyDataUtils.getPolyDataPoints(polyData);\n            if (!worldPointsSet) {\n                return;\n            }\n            const colorArray = actorEntry.actor.getProperty().getColor();\n            const color = colorToString(colorArray);\n            actorWorldPointsMap.set(cacheId, { worldPointsSet, color });\n        }\n    });\n}\nfunction getCacheId(viewport) {\n    const { viewPlaneNormal } = viewport.getCamera();\n    const imageIndex = viewport.getCurrentImageIdIndex();\n    return `${viewport.id}-${pointToString(viewPlaneNormal)}-${imageIndex}`;\n}\nfunction colorToString(colorArray) {\n    function colorComponentToString(component) {\n        let componentString = Math.floor(component * 255).toString(16);\n        if (componentString.length === 1) {\n            componentString = '0' + componentString;\n        }\n        return componentString;\n    }\n    return ('#' +\n        colorComponentToString(colorArray[0]) +\n        colorComponentToString(colorArray[1]) +\n        colorComponentToString(colorArray[2]));\n}\nfunction removeExtraPoints(viewport, worldPointsSet) {\n    return worldPointsSet.map((worldPoints) => {\n        const canvasPoints = worldPoints.map((point) => {\n            const canvasPoint = viewport.worldToCanvas(point);\n            return [Math.floor(canvasPoint[0]), Math.floor(canvasPoint[1])];\n        });\n        let lastPoint;\n        const newWorldPoints = [];\n        let newCanvasPoints = [];\n        for (let i = 0; i < worldPoints.length; i++) {\n            if (lastPoint) {\n                if (distanceToPoint(lastPoint, canvasPoints[i]) > 0) {\n                    newWorldPoints.push(worldPoints[i]);\n                    newCanvasPoints.push(canvasPoints[i]);\n                }\n            }\n            lastPoint = canvasPoints[i];\n        }\n        const firstPoint = newCanvasPoints[0];\n        for (let j = Math.min(30, newCanvasPoints.length); j < newCanvasPoints.length; j++) {\n            if (distanceToPoint(firstPoint, newCanvasPoints[j]) < 0.5) {\n                newCanvasPoints = newCanvasPoints.slice(0, j);\n                return newWorldPoints.slice(0, j);\n            }\n        }\n        return newWorldPoints;\n    });\n}\nSegmentationIntersectionTool.toolName = 'SegmentationIntersection';\nexport default SegmentationIntersectionTool;\n","import { getEnabledElement, StackViewport, VolumeViewport, utilities, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { isAnnotationVisible } from '../stateManagement/annotation/annotationVisibility';\nimport { drawLine } from '../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { vec3 } from 'gl-matrix';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nimport { getToolGroup } from '../store/ToolGroupManager';\nclass ReferenceCursors extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            displayThreshold: 5,\n            positionSync: true,\n            disableCursor: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isDrawing = false;\n        this.isHandleOutsideImage = false;\n        this._elementWithCursor = null;\n        this._currentCursorWorldPosition = null;\n        this._currentCanvasPosition = null;\n        this._disableCursorEnabled = false;\n        this.mouseMoveCallback = (evt) => {\n            const { detail } = evt;\n            const { element, currentPoints } = detail;\n            this._currentCursorWorldPosition = currentPoints.world;\n            this._currentCanvasPosition = currentPoints.canvas;\n            this._elementWithCursor = element;\n            const annotation = this.getActiveAnnotation(element);\n            if (annotation === null) {\n                this.createInitialAnnotation(currentPoints.world, element);\n                return false;\n            }\n            this.updateAnnotationPosition(element, annotation);\n            return false;\n        };\n        this.createInitialAnnotation = (worldPos, element) => {\n            const enabledElement = getEnabledElement(element);\n            if (!enabledElement) {\n                throw new Error('No enabled element found');\n            }\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            if (!viewPlaneNormal || !viewUp) {\n                throw new Error('Camera not found');\n            }\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [[...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                },\n            };\n            const annotations = getAnnotations(this.getToolName(), element);\n            if (annotations.length > 0) {\n                return null;\n            }\n            const annotationId = addAnnotation(annotation, element);\n            if (annotationId === null) {\n                return;\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.onCameraModified = (evt) => {\n            const eventDetail = evt.detail;\n            const { element, previousCamera, camera } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const viewport = enabledElement.viewport;\n            if (element !== this._elementWithCursor) {\n                return;\n            }\n            const oldFocalPoint = previousCamera.focalPoint;\n            const cameraNormal = camera.viewPlaneNormal;\n            const newFocalPoint = camera.focalPoint;\n            const deltaCameraFocalPoint = [0, 0, 0];\n            vtkMath.subtract(newFocalPoint, oldFocalPoint, deltaCameraFocalPoint);\n            if (deltaCameraFocalPoint.reduce((a, b) => a + b, 0) === 0) {\n                return;\n            }\n            const dotProduct = vtkMath.dot(deltaCameraFocalPoint, cameraNormal);\n            if (Math.abs(dotProduct) < 1e-2) {\n                return;\n            }\n            if (!this._currentCanvasPosition) {\n                return;\n            }\n            const newWorldPos = viewport.canvasToWorld(this._currentCanvasPosition);\n            this._currentCursorWorldPosition = newWorldPos;\n            this.updateAnnotationPosition(element, this.getActiveAnnotation(element));\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport, FrameOfReferenceUID } = enabledElement;\n            const isElementWithCursor = this._elementWithCursor === viewport.element;\n            if (this.configuration.positionSync && !isElementWithCursor) {\n                this.updateViewportImage(viewport);\n            }\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points } = handles;\n                if (!annotationUID) {\n                    return renderStatus;\n                }\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidthBase = parseFloat(this.getStyle('lineWidth', styleSpecifier, annotation));\n                const lineWidth = typeof lineWidthBase === 'number' && isElementWithCursor\n                    ? lineWidthBase\n                    : lineWidthBase;\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (points[0].some((e) => isNaN(e))) {\n                    return renderStatus;\n                }\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                const crosshairUIDs = {\n                    upper: 'upper',\n                    right: 'right',\n                    lower: 'lower',\n                    left: 'left',\n                };\n                const [x, y] = canvasCoordinates[0];\n                const centerSpace = isElementWithCursor ? 20 : 7;\n                const lineLength = isElementWithCursor ? 5 : 7;\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.upper, [x, y - (centerSpace / 2 + lineLength)], [x, y - centerSpace / 2], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.lower, [x, y + (centerSpace / 2 + lineLength)], [x, y + centerSpace / 2], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.right, [x + (centerSpace / 2 + lineLength), y], [x + centerSpace / 2, y], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.left, [x - (centerSpace / 2 + lineLength), y], [x - centerSpace / 2, y], { color, lineDash, lineWidth });\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this._disableCursorEnabled = this.configuration.disableCursor;\n    }\n    onSetToolActive() {\n        this._disableCursorEnabled = this.configuration.disableCursor;\n        if (!this._disableCursorEnabled) {\n            return;\n        }\n        const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n        if (!viewportIds) {\n            return;\n        }\n        const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n        enabledElements.forEach((element) => {\n            if (element) {\n                hideElementCursor(element.viewport.element);\n            }\n        });\n    }\n    onSetToolDisabled() {\n        if (!this._disableCursorEnabled) {\n            return;\n        }\n        const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n        if (!viewportIds) {\n            return;\n        }\n        const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n        enabledElements.forEach((element) => {\n            if (element) {\n                resetElementCursor(element.viewport.element);\n            }\n        });\n    }\n    getActiveAnnotation(element) {\n        const annotations = getAnnotations(this.getToolName(), element);\n        if (!annotations.length) {\n            return null;\n        }\n        const targetAnnotation = annotations[0];\n        return targetAnnotation;\n    }\n    updateAnnotationPosition(element, annotation) {\n        const worldPos = this._currentCursorWorldPosition;\n        if (!worldPos) {\n            return;\n        }\n        if (!annotation.data?.handles?.points) {\n            return;\n        }\n        annotation.data.handles.points = [[...worldPos]];\n        annotation.invalidated = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!(annotations instanceof Array) || annotations.length === 0) {\n            return [];\n        }\n        const annotation = annotations[0];\n        const viewport = getEnabledElement(element)?.viewport;\n        if (!viewport) {\n            return [];\n        }\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, focalPoint } = camera;\n        if (!viewPlaneNormal || !focalPoint) {\n            return [];\n        }\n        const points = annotation.data?.handles?.points;\n        if (!(points instanceof Array) || points.length !== 1) {\n            return [];\n        }\n        const worldPos = points[0];\n        const plane = utilities.planar.planeEquation(viewPlaneNormal, focalPoint);\n        const distance = utilities.planar.planeDistanceToPoint(plane, worldPos);\n        return distance < this.configuration.displayThreshold ? [annotation] : [];\n    }\n    updateViewportImage(viewport) {\n        const currentMousePosition = this._currentCursorWorldPosition;\n        if (!currentMousePosition || currentMousePosition.some((e) => isNaN(e))) {\n            return;\n        }\n        if (viewport instanceof StackViewport) {\n            const closestIndex = utilities.getClosestStackImageIndexForPoint(currentMousePosition, viewport);\n            if (closestIndex === null) {\n                return;\n            }\n            if (closestIndex !== viewport.getCurrentImageIdIndex()) {\n                viewport.setImageIdIndex(closestIndex);\n            }\n        }\n        else if (viewport instanceof VolumeViewport) {\n            const { focalPoint, viewPlaneNormal } = viewport.getCamera();\n            if (!focalPoint || !viewPlaneNormal) {\n                return;\n            }\n            const plane = utilities.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const currentDistance = utilities.planar.planeDistanceToPoint(plane, currentMousePosition, true);\n            if (Math.abs(currentDistance) < 0.5) {\n                return;\n            }\n            const normalizedViewPlane = vec3.normalize(vec3.create(), vec3.fromValues(...viewPlaneNormal));\n            const scaledPlaneNormal = vec3.scale(vec3.create(), normalizedViewPlane, currentDistance);\n            const newFocalPoint = vec3.add(vec3.create(), vec3.fromValues(...focalPoint), scaledPlaneNormal);\n            const isInBounds = true;\n            if (isInBounds) {\n                viewport.setCamera({ focalPoint: newFocalPoint });\n                const renderingEngine = viewport.getRenderingEngine();\n                if (renderingEngine) {\n                    renderingEngine.renderViewport(viewport.id);\n                }\n            }\n        }\n    }\n}\nReferenceCursors.toolName = 'ReferenceCursors';\nexport default ReferenceCursors;\n","import AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport { vec3 } from 'gl-matrix';\nimport { getEnabledElementByIds, getRenderingEngines, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { drawLine as drawLineSvg, drawTextBox as drawTextBoxSvg, } from '../drawingSvg';\nimport { getToolGroup } from '../store/ToolGroupManager';\nconst viewportsWithAnnotations = [];\nclass ScaleOverlayTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            viewportId: '',\n            scaleLocation: 'bottom',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.editData = null;\n        this._init = () => {\n            const renderingEngines = getRenderingEngines();\n            const renderingEngine = renderingEngines[0];\n            if (!renderingEngine) {\n                return;\n            }\n            const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportIds) {\n                return;\n            }\n            const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n            let { viewport } = enabledElements[0];\n            const { FrameOfReferenceUID } = enabledElements[0];\n            if (this.configuration.viewportId) {\n                enabledElements.forEach((element) => {\n                    if (element.viewport.id == this.configuration.viewportId) {\n                        viewport = element.viewport;\n                    }\n                });\n            }\n            if (!viewport) {\n                return;\n            }\n            const { viewUp, viewPlaneNormal } = viewport.getCamera();\n            const viewportCanvasCornersInWorld = csUtils.getViewportImageCornersInWorld(viewport);\n            let annotation = this.editData?.annotation;\n            const annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (annotations.length) {\n                annotation = annotations.filter((thisAnnotation) => thisAnnotation.data.viewportId == viewport.id)[0];\n            }\n            enabledElements.forEach((element) => {\n                const { viewport } = element;\n                if (!viewportsWithAnnotations.includes(viewport.id)) {\n                    const newAnnotation = {\n                        metadata: {\n                            toolName: this.getToolName(),\n                            viewPlaneNormal: [...viewPlaneNormal],\n                            viewUp: [...viewUp],\n                            FrameOfReferenceUID,\n                            referencedImageId: null,\n                        },\n                        data: {\n                            handles: {\n                                points: csUtils.getViewportImageCornersInWorld(viewport),\n                            },\n                            viewportId: viewport.id,\n                        },\n                    };\n                    viewportsWithAnnotations.push(viewport.id);\n                    addAnnotation(newAnnotation, viewport.element);\n                    annotation = newAnnotation;\n                }\n            });\n            if (this.editData?.annotation &&\n                this.editData.annotation.data.viewportId == viewport.id) {\n                this.editData.annotation.data.handles.points =\n                    viewportCanvasCornersInWorld;\n                this.editData.annotation.data.viewportId = viewport.id;\n            }\n            this.editData = {\n                viewport,\n                renderingEngine,\n                annotation,\n            };\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this.configuration.viewportId = evt.detail.viewportId;\n            this._init();\n        };\n        this.computeScaleSize = (worldWidthViewport, worldHeightViewport, location) => {\n            const scaleSizes = [\n                16000, 8000, 4000, 2000, 1000, 500, 250, 100, 50, 25, 10, 5, 2,\n            ];\n            let currentScaleSize;\n            if (location == 'top' || location == 'bottom') {\n                currentScaleSize = scaleSizes.filter((scaleSize) => scaleSize < worldWidthViewport * 0.6 &&\n                    scaleSize > worldWidthViewport * 0.2);\n            }\n            else {\n                currentScaleSize = scaleSizes.filter((scaleSize) => scaleSize < worldHeightViewport * 0.6 &&\n                    scaleSize > worldHeightViewport * 0.2);\n            }\n            return currentScaleSize[0];\n        };\n        this.computeEndScaleTicks = (canvasCoordinates, location) => {\n            const locationTickOffset = {\n                bottom: [\n                    [0, -10],\n                    [0, -10],\n                ],\n                top: [\n                    [0, 10],\n                    [0, 10],\n                ],\n                left: [\n                    [0, 0],\n                    [10, 0],\n                ],\n                right: [\n                    [0, 0],\n                    [-10, 0],\n                ],\n            };\n            const endTick1 = [\n                [\n                    canvasCoordinates[1][0] + locationTickOffset[location][0][0],\n                    canvasCoordinates[1][1] + locationTickOffset[location][0][0],\n                ],\n                [\n                    canvasCoordinates[1][0] + locationTickOffset[location][1][0],\n                    canvasCoordinates[1][1] + locationTickOffset[location][1][1],\n                ],\n            ];\n            const endTick2 = [\n                [\n                    canvasCoordinates[0][0] + locationTickOffset[location][0][0],\n                    canvasCoordinates[0][1] + locationTickOffset[location][0][0],\n                ],\n                [\n                    canvasCoordinates[0][0] + locationTickOffset[location][1][0],\n                    canvasCoordinates[0][1] + locationTickOffset[location][1][1],\n                ],\n            ];\n            return {\n                endTick1: endTick1,\n                endTick2: endTick2,\n            };\n        };\n        this.computeInnerScaleTicks = (scaleSize, location, annotationUID, leftTick, rightTick) => {\n            let canvasScaleSize;\n            if (location == 'bottom' || location == 'top') {\n                canvasScaleSize = rightTick[0][0] - leftTick[0][0];\n            }\n            else if (location == 'left' || location == 'right') {\n                canvasScaleSize = rightTick[0][1] - leftTick[0][1];\n            }\n            const tickIds = [];\n            const tickUIDs = [];\n            const tickCoordinates = [];\n            let numberSmallTicks = scaleSize;\n            if (scaleSize >= 50) {\n                numberSmallTicks = scaleSize / 10;\n            }\n            const tickSpacing = canvasScaleSize / numberSmallTicks;\n            for (let i = 0; i < numberSmallTicks - 1; i++) {\n                const locationOffset = {\n                    bottom: [\n                        [tickSpacing * (i + 1), 0],\n                        [tickSpacing * (i + 1), 5],\n                    ],\n                    top: [\n                        [tickSpacing * (i + 1), 0],\n                        [tickSpacing * (i + 1), -5],\n                    ],\n                    left: [\n                        [0, tickSpacing * (i + 1)],\n                        [-5, tickSpacing * (i + 1)],\n                    ],\n                    right: [\n                        [0, tickSpacing * (i + 1)],\n                        [5, tickSpacing * (i + 1)],\n                    ],\n                };\n                tickIds.push(`${annotationUID}-tick${i}`);\n                tickUIDs.push(`tick${i}`);\n                if ((i + 1) % 5 == 0) {\n                    tickCoordinates.push([\n                        [\n                            leftTick[0][0] + locationOffset[location][0][0],\n                            leftTick[0][1] + locationOffset[location][0][1],\n                        ],\n                        [\n                            leftTick[1][0] + locationOffset[location][0][0],\n                            leftTick[1][1] + locationOffset[location][0][1],\n                        ],\n                    ]);\n                }\n                else {\n                    tickCoordinates.push([\n                        [\n                            leftTick[0][0] + locationOffset[location][0][0],\n                            leftTick[0][1] + locationOffset[location][0][1],\n                        ],\n                        [\n                            leftTick[1][0] + locationOffset[location][1][0],\n                            leftTick[1][1] + locationOffset[location][1][1],\n                        ],\n                    ]);\n                }\n            }\n            return { tickIds, tickUIDs, tickCoordinates };\n        };\n        this.computeWorldScaleCoordinates = (scaleSize, location, pointSet) => {\n            let worldCoordinates;\n            let topBottomVec = vec3.subtract(vec3.create(), pointSet[0], pointSet[1]);\n            topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n            let topRightVec = vec3.subtract(vec3.create(), pointSet[2], pointSet[0]);\n            topRightVec = vec3.normalize(vec3.create(), topRightVec);\n            const midpointLocation = {\n                bottom: [pointSet[1], pointSet[2]],\n                top: [pointSet[0], pointSet[3]],\n                right: [pointSet[2], pointSet[3]],\n                left: [pointSet[0], pointSet[1]],\n            };\n            const midpoint = vec3\n                .add(vec3.create(), midpointLocation[location][0], midpointLocation[location][0])\n                .map((i) => i / 2);\n            const offset = scaleSize /\n                2 /\n                Math.sqrt(Math.pow(topBottomVec[0], 2) +\n                    Math.pow(topBottomVec[1], 2) +\n                    Math.pow(topBottomVec[2], 2));\n            if (location == 'top' || location == 'bottom') {\n                worldCoordinates = [\n                    vec3.subtract(vec3.create(), midpoint, topRightVec.map((i) => i * offset)),\n                    vec3.add(vec3.create(), midpoint, topRightVec.map((i) => i * offset)),\n                ];\n            }\n            else if (location == 'left' || location == 'right') {\n                worldCoordinates = [\n                    vec3.add(vec3.create(), midpoint, topBottomVec.map((i) => i * offset)),\n                    vec3.subtract(vec3.create(), midpoint, topBottomVec.map((i) => i * offset)),\n                ];\n            }\n            return worldCoordinates;\n        };\n        this.computeCanvasScaleCoordinates = (canvasSize, canvasCoordinates, vscaleBounds, hscaleBounds, location) => {\n            let scaleCanvasCoordinates;\n            if (location == 'top' || location == 'bottom') {\n                const worldDistanceOnCanvas = canvasCoordinates[0][0] - canvasCoordinates[1][0];\n                scaleCanvasCoordinates = [\n                    [canvasSize.width / 2 - worldDistanceOnCanvas / 2, vscaleBounds.height],\n                    [canvasSize.width / 2 + worldDistanceOnCanvas / 2, vscaleBounds.height],\n                ];\n            }\n            else if (location == 'left' || location == 'right') {\n                const worldDistanceOnCanvas = canvasCoordinates[0][1] - canvasCoordinates[1][1];\n                scaleCanvasCoordinates = [\n                    [hscaleBounds.width, canvasSize.height / 2 - worldDistanceOnCanvas / 2],\n                    [hscaleBounds.width, canvasSize.height / 2 + worldDistanceOnCanvas / 2],\n                ];\n            }\n            return scaleCanvasCoordinates;\n        };\n        this.computeScaleBounds = (canvasSize, horizontalReduction, verticalReduction, location) => {\n            const hReduction = horizontalReduction * Math.min(1000, canvasSize.width);\n            const vReduction = verticalReduction * Math.min(1000, canvasSize.height);\n            const locationBounds = {\n                bottom: [-vReduction, -hReduction],\n                top: [vReduction, hReduction],\n                left: [vReduction, hReduction],\n                right: [-vReduction, -hReduction],\n            };\n            const canvasBounds = {\n                bottom: [canvasSize.height, canvasSize.width],\n                top: [0, canvasSize.width],\n                left: [canvasSize.height, 0],\n                right: [canvasSize.height, canvasSize.width],\n            };\n            return {\n                height: canvasBounds[location][0] + locationBounds[location][0],\n                width: canvasBounds[location][1] + locationBounds[location][1],\n            };\n        };\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this.editData || !this.editData.viewport) {\n            return;\n        }\n        const location = this.configuration.scaleLocation;\n        const { viewport } = enabledElement;\n        const annotations = getAnnotations(this.getToolName(), viewport.element);\n        const annotation = annotations.filter((thisAnnotation) => thisAnnotation.data.viewportId == viewport.id)[0];\n        const canvas = enabledElement.viewport.canvas;\n        const renderStatus = false;\n        if (!viewport) {\n            return renderStatus;\n        }\n        const styleSpecifier = {\n            toolGroupId: this.toolGroupId,\n            toolName: this.getToolName(),\n            viewportId: enabledElement.viewport.id,\n        };\n        const canvasSize = {\n            width: canvas.width / window.devicePixelRatio || 1,\n            height: canvas.height / window.devicePixelRatio || 1,\n        };\n        const topLeft = annotation.data.handles.points[0];\n        const topRight = annotation.data.handles.points[1];\n        const bottomLeft = annotation.data.handles.points[2];\n        const bottomRight = annotation.data.handles.points[3];\n        const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n        const worldWidthViewport = vec3.distance(bottomLeft, bottomRight);\n        const worldHeightViewport = vec3.distance(topLeft, bottomLeft);\n        const hscaleBounds = this.computeScaleBounds(canvasSize, 0.05, 0.05, location);\n        const vscaleBounds = this.computeScaleBounds(canvasSize, 0.05, 0.05, location);\n        const scaleSize = this.computeScaleSize(worldWidthViewport, worldHeightViewport, location);\n        const canvasCoordinates = this.computeWorldScaleCoordinates(scaleSize, location, pointSet1).map((world) => viewport.worldToCanvas(world));\n        const scaleCanvasCoordinates = this.computeCanvasScaleCoordinates(canvasSize, canvasCoordinates, vscaleBounds, hscaleBounds, location);\n        const scaleTicks = this.computeEndScaleTicks(scaleCanvasCoordinates, location);\n        const { annotationUID } = annotation;\n        styleSpecifier.annotationUID = annotationUID;\n        const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n        const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n        const color = this.getStyle('color', styleSpecifier, annotation);\n        const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n        const scaleId = `${annotationUID}-scaleline`;\n        const scaleLineUID = '1';\n        drawLineSvg(svgDrawingHelper, annotationUID, scaleLineUID, scaleCanvasCoordinates[0], scaleCanvasCoordinates[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, scaleId);\n        const leftTickId = `${annotationUID}-left`;\n        const leftTickUID = '2';\n        drawLineSvg(svgDrawingHelper, annotationUID, leftTickUID, scaleTicks.endTick1[0], scaleTicks.endTick1[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, leftTickId);\n        const rightTickId = `${annotationUID}-right`;\n        const rightTickUID = '3';\n        drawLineSvg(svgDrawingHelper, annotationUID, rightTickUID, scaleTicks.endTick2[0], scaleTicks.endTick2[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, rightTickId);\n        const locationTextOffest = {\n            bottom: [-10, -42],\n            top: [-12, -35],\n            left: [-40, -20],\n            right: [-50, -20],\n        };\n        const textCanvasCoordinates = [\n            scaleCanvasCoordinates[0][0] + locationTextOffest[location][0],\n            scaleCanvasCoordinates[0][1] + locationTextOffest[location][1],\n        ];\n        const textBoxLines = this._getTextLines(scaleSize);\n        const { tickIds, tickUIDs, tickCoordinates } = this.computeInnerScaleTicks(scaleSize, location, annotationUID, scaleTicks.endTick1, scaleTicks.endTick2);\n        for (let i = 0; i < tickUIDs.length; i++) {\n            drawLineSvg(svgDrawingHelper, annotationUID, tickUIDs[i], tickCoordinates[i][0], tickCoordinates[i][1], {\n                color,\n                width: lineWidth,\n                lineDash,\n                shadow,\n            }, tickIds[i]);\n        }\n        const textUID = 'text0';\n        drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textBoxLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], {\n            fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n            fontSize: '14px',\n            lineDash: '2,3',\n            lineWidth: '1',\n            shadow: true,\n            color: color,\n        });\n        return renderStatus;\n    }\n    _getTextLines(scaleSize) {\n        let scaleSizeDisplayValue;\n        let scaleSizeUnits;\n        if (scaleSize >= 50) {\n            scaleSizeDisplayValue = scaleSize / 10;\n            scaleSizeUnits = ' cm';\n        }\n        else {\n            scaleSizeDisplayValue = scaleSize;\n            scaleSizeUnits = ' mm';\n        }\n        const textLines = [scaleSizeDisplayValue.toString().concat(scaleSizeUnits)];\n        return textLines;\n    }\n}\nScaleOverlayTool.toolName = 'ScaleOverlay';\nexport default ScaleOverlayTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nimport { getAnnotations } from '../stateManagement';\nimport { point } from '../utilities/math';\nimport { Events, ToolModes, AnnotationStyleStates } from '../enums';\nimport { triggerAnnotationRenderForViewportIds } from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nimport { getStyleProperty } from '../stateManagement/annotation/config/helpers';\nimport { triggerAnnotationModified } from '../stateManagement/annotation/helpers/state';\nimport CircleSculptCursor from './SculptorTool/CircleSculptCursor';\nimport { distancePointToContour } from './distancePointToContour';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass SculptorTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            minSpacing: 1,\n            referencedToolNames: [\n                'PlanarFreehandROI',\n                'PlanarFreehandContourSegmentationTool',\n            ],\n            toolShape: 'circle',\n            referencedToolName: 'PlanarFreehandROI',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.registeredShapes = new Map();\n        this.isActive = false;\n        this.commonData = {\n            activeAnnotationUID: null,\n            viewportIdsToRender: [],\n            isEditingOpenContour: false,\n            canvasLocation: undefined,\n        };\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const element = eventData.element;\n            this.configureToolSize(evt);\n            this.selectFreehandTool(eventData);\n            if (this.commonData.activeAnnotationUID === null) {\n                return;\n            }\n            this.isActive = true;\n            hideElementCursor(element);\n            this.activateModify(element);\n            return true;\n        };\n        this.mouseMoveCallback = (evt) => {\n            if (this.mode === ToolModes.Active) {\n                this.configureToolSize(evt);\n                this.updateCursor(evt);\n            }\n            else {\n                this.commonData.canvasLocation = undefined;\n            }\n        };\n        this.endCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const config = this.configuration;\n            const enabledElement = getEnabledElement(element);\n            this.isActive = false;\n            this.deactivateModify(element);\n            resetElementCursor(element);\n            const { renderingEngineId, viewportId } = enabledElement;\n            const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n            const toolInstance = toolGroup.getToolInstance(config.referencedToolName);\n            const annotations = this.filterSculptableAnnotationsForElement(element);\n            const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n            if (toolInstance.configuration.calculateStats) {\n                activeAnnotation.invalidated = true;\n            }\n            triggerAnnotationModified(activeAnnotation, element);\n        };\n        this.dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const element = eventData.element;\n            this.updateCursor(evt);\n            const annotations = this.filterSculptableAnnotationsForElement(element);\n            const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n            if (!annotations?.length || !this.isActive) {\n                return;\n            }\n            const points = activeAnnotation.data.contour.polyline;\n            this.sculpt(eventData, points);\n        };\n        this.registerShapes(CircleSculptCursor.shapeName, CircleSculptCursor);\n        this.setToolShape(this.configuration.toolShape);\n    }\n    registerShapes(shapeName, shapeClass) {\n        const shape = new shapeClass();\n        this.registeredShapes.set(shapeName, shape);\n    }\n    sculpt(eventData, points) {\n        const config = this.configuration;\n        const element = eventData.element;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        this.sculptData = {\n            mousePoint: eventData.currentPoints.world,\n            mouseCanvasPoint: eventData.currentPoints.canvas,\n            points,\n            maxSpacing: cursorShape.getMaxSpacing(config.minSpacing),\n            element: element,\n        };\n        const pushedHandles = cursorShape.pushHandles(viewport, this.sculptData);\n        if (pushedHandles.first !== undefined) {\n            this.insertNewHandles(pushedHandles);\n        }\n    }\n    interpolatePointsWithinMaxSpacing(i, points, indicesToInsertAfter, maxSpacing) {\n        const { element } = this.sculptData;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const nextHandleIndex = contourIndex(i + 1, points.length);\n        const currentCanvasPoint = viewport.worldToCanvas(points[i]);\n        const nextCanvasPoint = viewport.worldToCanvas(points[nextHandleIndex]);\n        const distanceToNextHandle = point.distanceToPoint(currentCanvasPoint, nextCanvasPoint);\n        if (distanceToNextHandle > maxSpacing) {\n            indicesToInsertAfter.push(i);\n        }\n    }\n    updateCursor(evt) {\n        const eventData = evt.detail;\n        const element = eventData.element;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine, viewport } = enabledElement;\n        this.commonData.viewportIdsToRender = [viewport.id];\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n        this.commonData.canvasLocation = eventData.currentPoints.canvas;\n        if (this.isActive) {\n            activeAnnotation.highlighted = true;\n        }\n        else {\n            const cursorShape = this.registeredShapes.get(this.selectedShape);\n            const canvasCoords = eventData.currentPoints.canvas;\n            cursorShape.updateToolSize(canvasCoords, viewport, activeAnnotation);\n        }\n        triggerAnnotationRenderForViewportIds(this.commonData.viewportIdsToRender);\n    }\n    filterSculptableAnnotationsForElement(element) {\n        const config = this.configuration;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngineId, viewportId } = enabledElement;\n        const sculptableAnnotations = [];\n        const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n        const toolInstance = toolGroup.getToolInstance(config.referencedToolName);\n        config.referencedToolNames.forEach((referencedToolName) => {\n            const annotations = getAnnotations(referencedToolName, element);\n            if (annotations) {\n                sculptableAnnotations.push(...annotations);\n            }\n        });\n        return toolInstance.filterInteractableAnnotationsForElement(element, sculptableAnnotations);\n    }\n    configureToolSize(evt) {\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        cursorShape.configureToolSize(evt);\n    }\n    insertNewHandles(pushedHandles) {\n        const indicesToInsertAfter = this.findNewHandleIndices(pushedHandles);\n        let newIndexModifier = 0;\n        for (let i = 0; i < indicesToInsertAfter?.length; i++) {\n            const insertIndex = indicesToInsertAfter[i] + 1 + newIndexModifier;\n            this.insertHandleRadially(insertIndex);\n            newIndexModifier++;\n        }\n    }\n    findNewHandleIndices(pushedHandles) {\n        const { points, maxSpacing } = this.sculptData;\n        const indicesToInsertAfter = [];\n        for (let i = pushedHandles.first; i <= pushedHandles.last; i++) {\n            this.interpolatePointsWithinMaxSpacing(i, points, indicesToInsertAfter, maxSpacing);\n        }\n        return indicesToInsertAfter;\n    }\n    insertHandleRadially(insertIndex) {\n        const { points } = this.sculptData;\n        if (insertIndex > points.length - 1 &&\n            this.commonData.isEditingOpenContour) {\n            return;\n        }\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        const previousIndex = insertIndex - 1;\n        const nextIndex = contourIndex(insertIndex, points.length);\n        const insertPosition = cursorShape.getInsertPosition(previousIndex, nextIndex, this.sculptData);\n        const handleData = insertPosition;\n        points.splice(insertIndex, 0, handleData);\n    }\n    selectFreehandTool(eventData) {\n        const closestAnnotationUID = this.getClosestFreehandToolOnElement(eventData);\n        if (closestAnnotationUID === undefined) {\n            return;\n        }\n        this.commonData.activeAnnotationUID = closestAnnotationUID;\n    }\n    getClosestFreehandToolOnElement(eventData) {\n        const { element } = eventData;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const config = this.configuration;\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const canvasPoints = eventData.currentPoints.canvas;\n        const closest = {\n            distance: Infinity,\n            toolIndex: undefined,\n            annotationUID: undefined,\n        };\n        for (let i = 0; i < annotations?.length; i++) {\n            if (annotations[i].isLocked || !annotations[i].isVisible) {\n                continue;\n            }\n            const distanceFromTool = distancePointToContour(viewport, annotations[i], canvasPoints);\n            if (distanceFromTool === -1) {\n                continue;\n            }\n            if (distanceFromTool < closest.distance) {\n                closest.distance = distanceFromTool;\n                closest.toolIndex = i;\n                closest.annotationUID = annotations[i].annotationUID;\n            }\n        }\n        this.commonData.isEditingOpenContour =\n            !annotations[closest.toolIndex].data.contour.closed;\n        config.referencedToolName =\n            annotations[closest.toolIndex].metadata.toolName;\n        return closest.annotationUID;\n    }\n    activateModify(element) {\n        element.addEventListener(Events.MOUSE_UP, this.endCallback);\n        element.addEventListener(Events.MOUSE_CLICK, this.endCallback);\n        element.addEventListener(Events.MOUSE_DRAG, this.dragCallback);\n        element.addEventListener(Events.TOUCH_TAP, this.endCallback);\n        element.addEventListener(Events.TOUCH_END, this.endCallback);\n        element.addEventListener(Events.TOUCH_DRAG, this.dragCallback);\n    }\n    deactivateModify(element) {\n        element.removeEventListener(Events.MOUSE_UP, this.endCallback);\n        element.removeEventListener(Events.MOUSE_CLICK, this.endCallback);\n        element.removeEventListener(Events.MOUSE_DRAG, this.dragCallback);\n        element.removeEventListener(Events.TOUCH_TAP, this.endCallback);\n        element.removeEventListener(Events.TOUCH_END, this.endCallback);\n        element.removeEventListener(Events.TOUCH_DRAG, this.dragCallback);\n    }\n    setToolShape(toolShape) {\n        this.selectedShape =\n            this.registeredShapes.get(toolShape) ?? CircleSculptCursor.shapeName;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const viewportIdsToRender = this.commonData.viewportIdsToRender;\n        if (!this.commonData.canvasLocation ||\n            this.mode !== ToolModes.Active ||\n            !viewportIdsToRender.includes(viewport.id)) {\n            return;\n        }\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const styleSpecifier = {\n            toolGroupId: this.toolGroupId,\n            toolName: this.getToolName(),\n            viewportId: enabledElement.viewport.id,\n        };\n        let color = getStyleProperty('color', styleSpecifier, AnnotationStyleStates.Default, this.mode);\n        if (this.isActive) {\n            color = getStyleProperty('color', styleSpecifier, AnnotationStyleStates.Highlighted, this.mode);\n        }\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        cursorShape.renderShape(svgDrawingHelper, this.commonData.canvasLocation, {\n            color,\n        });\n    }\n}\nexport const contourIndex = (i, length) => {\n    return (i + length) % length;\n};\nSculptorTool.toolName = 'SculptorTool';\nexport default SculptorTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nconst DIRECTIONS = {\n    X: [1, 0, 0],\n    Y: [0, 1, 0],\n    Z: [0, 0, 1],\n    CUSTOM: [],\n};\nclass VolumeRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            direction: DIRECTIONS.Z,\n            rotateIncrementDegrees: 30,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    mouseWheelCallback(evt) {\n        const { element, wheel } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { direction, rotateIncrementDegrees } = this.configuration;\n        const camera = viewport.getCamera();\n        const { viewUp, position, focalPoint } = camera;\n        const { direction: deltaY } = wheel;\n        const [cx, cy, cz] = focalPoint;\n        const [ax, ay, az] = direction;\n        const angle = (deltaY * (rotateIncrementDegrees * Math.PI)) / 180;\n        const newPosition = [0, 0, 0];\n        const newFocalPoint = [0, 0, 0];\n        const newViewUp = [0, 0, 0];\n        const transform = mat4.identity(new Float32Array(16));\n        mat4.translate(transform, transform, [cx, cy, cz]);\n        mat4.rotate(transform, transform, angle, [ax, ay, az]);\n        mat4.translate(transform, transform, [-cx, -cy, -cz]);\n        vec3.transformMat4(newPosition, position, transform);\n        vec3.transformMat4(newFocalPoint, focalPoint, transform);\n        mat4.identity(transform);\n        mat4.rotate(transform, transform, angle, [ax, ay, az]);\n        vec3.transformMat4(newViewUp, viewUp, transform);\n        viewport.setCamera({\n            position: newPosition,\n            viewUp: newViewUp,\n            focalPoint: newFocalPoint,\n        });\n        viewport.render();\n    }\n}\nVolumeRotateTool.toolName = 'VolumeRotateMouseWheel';\nexport default VolumeRotateTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, utilities, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nconst { transformWorldToIndex } = csUtils;\nclass LengthTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const { viewPlaneNormal, viewUp, position: cameraPosition, } = viewport.getCamera();\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                    toolName: this.getToolName(),\n                    referencedImageId,\n                    viewUp,\n                    cameraPosition,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const dataId = `${annotationUID}-line`;\n                const lineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId);\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const annotation = {\n            annotationUID: options?.annotationUID || utilities.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateLength(pos1, pos2) {\n        const dx = pos1[0] - pos2[0];\n        const dy = pos1[1] - pos2[1];\n        const dz = pos1[2] - pos2[2];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData, dimensions } = image;\n            const index1 = transformWorldToIndex(imageData, worldPos1);\n            const index2 = transformWorldToIndex(imageData, worldPos2);\n            const handles = [index1, index2];\n            const { scale, unit } = getCalibratedLengthUnitsAndScale(image, handles);\n            const length = this._calculateLength(worldPos1, worldPos2) / scale;\n            this._isInsideVolume(index1, index2, dimensions)\n                ? (this.isHandleOutsideImage = false)\n                : (this.isHandleOutsideImage = true);\n            cachedStats[targetId] = {\n                length,\n                unit,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { length, unit } = cachedVolumeStats;\n    if (length === undefined || length === null || isNaN(length)) {\n        return;\n    }\n    const textLines = [`${csUtils.roundNumber(length)} ${unit}`];\n    return textLines;\n}\nLengthTool.toolName = 'Length';\nexport default LengthTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawHeight as drawHeightSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nconst { transformWorldToIndex } = csUtils;\nclass HeightTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const { viewPlaneNormal, viewUp, position: cameraPosition, } = viewport.getCamera();\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                    toolName: this.getToolName(),\n                    referencedImageId,\n                    viewUp,\n                    cameraPosition,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                const enabledElement = getEnabledElement(element);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                let activeHandleCanvasCoords;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const heightUID = '0';\n                drawHeightSvg(svgDrawingHelper, annotationUID, heightUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash: lineDash,\n                });\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateHeight(pos1, pos2) {\n        const dx = pos2[0] - pos1[0];\n        const dy = pos2[1] - pos1[1];\n        const dz = pos2[2] - pos1[2];\n        if (dx == 0) {\n            if (dy != 0) {\n                return Math.abs(dz);\n            }\n            else {\n                return 0;\n            }\n        }\n        else if (dy == 0) {\n            return Math.abs(dz);\n        }\n        else if (dz == 0) {\n            return Math.abs(dy);\n        }\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData, dimensions } = image;\n            const index1 = transformWorldToIndex(imageData, worldPos1);\n            const index2 = transformWorldToIndex(imageData, worldPos2);\n            const handles = [index1, index2];\n            const { scale, unit } = getCalibratedLengthUnitsAndScale(image, handles);\n            const height = this._calculateHeight(worldPos1, worldPos2) / scale;\n            const outside = this._isInsideVolume(index1, index2, dimensions);\n            this.isHandleOutsideImage = outside;\n            cachedStats[targetId] = {\n                height,\n                unit,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { height, unit } = cachedVolumeStats;\n    if (height === undefined || height === null || isNaN(height)) {\n        return;\n    }\n    const textLines = [`${csUtils.roundNumber(height)} ${unit}`];\n    return textLines;\n}\nHeightTool.toolName = 'Height';\nexport default HeightTool;\n","import { vec2, vec3 } from 'gl-matrix';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { getCalibratedProbeUnitsAndValue } from '../../utilities/getCalibratedUnits';\nimport { drawHandles as drawHandlesSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nconst { transformWorldToIndex } = csUtils;\nclass ProbeTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: { points: [[...worldPos]] },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                newAnnotation: true,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { viewportId, renderingEngine } = getEnabledElement(element);\n            this.eventDispatchDetail = {\n                viewportId,\n                renderingEngineId: renderingEngine.id,\n            };\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points[0] = [...worldPos];\n            annotation.invalidated = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const annotationUID = annotation.annotationUID;\n                const data = annotation.data;\n                const point = data.handles.points[0];\n                const canvasCoordinates = viewport.worldToCanvas(point);\n                styleSpecifier.annotationUID = annotationUID;\n                const { color } = this.getAnnotationStyle({ annotation, styleSpecifier });\n                if (!data.cachedStats) {\n                    data.cachedStats = {};\n                }\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].value == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        index: null,\n                        value: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const handleGroupUID = '0';\n                drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, [canvasCoordinates], { color });\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (textLines) {\n                    const textCanvasCoordinates = [\n                        canvasCoordinates[0] + 6,\n                        canvasCoordinates[1] - 6,\n                    ];\n                    const textUID = '0';\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], options);\n                }\n            }\n            return renderStatus;\n        };\n    }\n    isPointNearTool() {\n        return false;\n    }\n    toolSelectedCallback() { }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n    getHandleNearImagePoint(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { data } = annotation;\n        const point = data.handles.points[0];\n        const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n        const near = vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity;\n        if (near === true) {\n            return point;\n        }\n    }\n    handleSelectedCallback(evt, annotation) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        annotation.highlighted = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { renderingEngineId, viewport } = enabledElement;\n        const { element } = viewport;\n        const worldPos = data.handles.points[0];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const pixelUnitsOptions = {\n                isPreScaled: isViewportPreScaled(viewport, targetId),\n                isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n            };\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { dimensions, imageData, metadata, voxelManager } = image;\n            const modality = metadata.Modality;\n            let ijk = transformWorldToIndex(imageData, worldPos);\n            ijk = vec3.round(ijk, ijk);\n            if (csUtils.indexWithinDimensions(ijk, dimensions)) {\n                this.isHandleOutsideImage = false;\n                let value = voxelManager.getAtIJKPoint(ijk);\n                if (targetId.startsWith('imageId:')) {\n                    const imageId = targetId.split('imageId:')[1];\n                    const imageURI = csUtils.imageIdToURI(imageId);\n                    const viewports = csUtils.getViewportsWithImageURI(imageURI);\n                    const viewport = viewports[0];\n                    ijk[2] = viewport.getCurrentImageIdIndex();\n                }\n                let modalityUnit;\n                if (modality === 'US') {\n                    const calibratedResults = getCalibratedProbeUnitsAndValue(image, [\n                        ijk,\n                    ]);\n                    const hasEnhancedRegionValues = calibratedResults.values.every((value) => value !== null);\n                    value = (hasEnhancedRegionValues ? calibratedResults.values : value);\n                    modalityUnit = hasEnhancedRegionValues\n                        ? calibratedResults.units\n                        : 'raw';\n                }\n                else {\n                    modalityUnit = getPixelValueUnits(modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                }\n                cachedStats[targetId] = {\n                    index: ijk,\n                    value,\n                    Modality: modality,\n                    modalityUnit,\n                };\n            }\n            else {\n                this.isHandleOutsideImage = true;\n                cachedStats[targetId] = {\n                    index: ijk,\n                    Modality: modality,\n                };\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n        }\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { index, value, modalityUnit } = cachedVolumeStats;\n    if (value === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`(${index[0]}, ${index[1]}, ${index[2]})`);\n    if (value instanceof Array && modalityUnit instanceof Array) {\n        for (let i = 0; i < value.length; i++) {\n            textLines.push(`${csUtils.roundNumber(value[i])} ${modalityUnit[i]}`);\n        }\n    }\n    else {\n        textLines.push(`${csUtils.roundNumber(value)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nProbeTool.toolName = 'Probe';\nexport default ProbeTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { drawHandles as drawHandlesSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { hideElementCursor } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport ProbeTool from './ProbeTool';\nclass DragProbeTool extends ProbeTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.postMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                isVisible: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: { points: [[...worldPos]] },\n                    cachedStats: {},\n                },\n            };\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                newAnnotation: true,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.postTouchStartCallback = (evt) => {\n            return this.postMouseDownCallback(evt);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const annotations = this.filterInteractableAnnotationsForElement(viewport.element, [this.editData.annotation]);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const annotation = this.editData.annotation;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const point = data.handles.points[0];\n            const canvasCoordinates = viewport.worldToCanvas(point);\n            styleSpecifier.annotationUID = annotationUID;\n            const { color } = this.getAnnotationStyle({\n                annotation,\n                styleSpecifier,\n            });\n            if (!data.cachedStats[targetId] ||\n                data.cachedStats[targetId].value == null) {\n                data.cachedStats[targetId] = {\n                    Modality: null,\n                    index: null,\n                    value: null,\n                };\n                this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n            }\n            else if (annotation.invalidated) {\n                this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n            }\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const handleGroupUID = '0';\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, [canvasCoordinates], { color });\n            renderStatus = true;\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (textLines) {\n                const textCanvasCoordinates = [\n                    canvasCoordinates[0] + 6,\n                    canvasCoordinates[1] - 6,\n                ];\n                const textUID = '0';\n                drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], this.getLinkedTextBoxStyle(styleSpecifier, annotation));\n            }\n            return renderStatus;\n        };\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { index, value, modalityUnit } = cachedVolumeStats;\n    if (value === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`(${index[0]}, ${index[1]}, ${index[2]})`);\n    textLines.push(`${value.toFixed(2)} ${modalityUnit}`);\n    return textLines;\n}\nDragProbeTool.toolName = 'DragProbe';\nexport default DragProbeTool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawEllipseByCoordinates as drawEllipseSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { pointInEllipse, getCanvasEllipseCorners, } from '../../utilities/math/ellipse';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass EllipticalROITool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            storePointData: false,\n            centerPointRadius: 0,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    initialRotation: viewport.getRotation(),\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                centerWorld: worldPos,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const canvasCorners = getCanvasEllipseCorners(canvasCoordinates);\n            const [canvasPoint1, canvasPoint2] = canvasCorners;\n            const minorEllipse = {\n                left: Math.min(canvasPoint1[0], canvasPoint2[0]) + proximity / 2,\n                top: Math.min(canvasPoint1[1], canvasPoint2[1]) + proximity / 2,\n                width: Math.abs(canvasPoint1[0] - canvasPoint2[0]) - proximity,\n                height: Math.abs(canvasPoint1[1] - canvasPoint2[1]) - proximity,\n            };\n            const majorEllipse = {\n                left: Math.min(canvasPoint1[0], canvasPoint2[0]) - proximity / 2,\n                top: Math.min(canvasPoint1[1], canvasPoint2[1]) - proximity / 2,\n                width: Math.abs(canvasPoint1[0] - canvasPoint2[0]) + proximity,\n                height: Math.abs(canvasPoint1[1] - canvasPoint2[1]) + proximity,\n            };\n            const pointInMinorEllipse = this._pointInEllipseCanvas(minorEllipse, canvasCoords);\n            const pointInMajorEllipse = this._pointInEllipseCanvas(majorEllipse, canvasCoords);\n            if (pointInMajorEllipse && !pointInMinorEllipse) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            let centerCanvas;\n            let centerWorld;\n            let canvasWidth;\n            let canvasHeight;\n            let originalHandleCanvas;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                const { viewport } = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = viewport;\n                handleIndex = points.findIndex((p) => p === handle);\n                const pointsCanvas = points.map(worldToCanvas);\n                originalHandleCanvas = pointsCanvas[handleIndex];\n                canvasWidth = Math.abs(pointsCanvas[2][0] - pointsCanvas[3][0]);\n                canvasHeight = Math.abs(pointsCanvas[0][1] - pointsCanvas[1][1]);\n                centerCanvas = [\n                    (pointsCanvas[2][0] + pointsCanvas[3][0]) / 2,\n                    (pointsCanvas[0][1] + pointsCanvas[1][1]) / 2,\n                ];\n                centerWorld = canvasToWorld(centerCanvas);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                canvasWidth,\n                canvasHeight,\n                centerWorld,\n                originalHandleCanvas,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerWorld } = this.editData;\n            const centerCanvas = viewport.worldToCanvas(centerWorld);\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const bottomCanvas = [centerCanvas[0], centerCanvas[1] - dY];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] + dY];\n            const leftCanvas = [centerCanvas[0] - dX, centerCanvas[1]];\n            const rightCanvas = [centerCanvas[0] + dX, centerCanvas[1]];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { viewport } = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = viewport;\n            const { annotation, canvasWidth, canvasHeight, handleIndex, centerWorld, originalHandleCanvas, } = this.editData;\n            const centerCanvas = viewport.worldToCanvas(centerWorld);\n            const { data } = annotation;\n            const { points } = data.handles;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            if (handleIndex === 0 || handleIndex === 1) {\n                const dYCanvas = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n                const canvasBottom = [\n                    centerCanvas[0],\n                    centerCanvas[1] - dYCanvas,\n                ];\n                const canvasTop = [\n                    centerCanvas[0],\n                    centerCanvas[1] + dYCanvas,\n                ];\n                points[0] = canvasToWorld(canvasBottom);\n                points[1] = canvasToWorld(canvasTop);\n                const dXCanvas = currentCanvasPoints[0] - originalHandleCanvas[0];\n                const newHalfCanvasWidth = canvasWidth / 2 + dXCanvas;\n                const canvasLeft = [\n                    centerCanvas[0] - newHalfCanvasWidth,\n                    centerCanvas[1],\n                ];\n                const canvasRight = [\n                    centerCanvas[0] + newHalfCanvasWidth,\n                    centerCanvas[1],\n                ];\n                points[2] = canvasToWorld(canvasLeft);\n                points[3] = canvasToWorld(canvasRight);\n            }\n            else {\n                const dXCanvas = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n                const canvasLeft = [\n                    centerCanvas[0] - dXCanvas,\n                    centerCanvas[1],\n                ];\n                const canvasRight = [\n                    centerCanvas[0] + dXCanvas,\n                    centerCanvas[1],\n                ];\n                points[2] = canvasToWorld(canvasLeft);\n                points[3] = canvasToWorld(canvasRight);\n                const dYCanvas = currentCanvasPoints[1] - originalHandleCanvas[1];\n                const newHalfCanvasHeight = canvasHeight / 2 + dYCanvas;\n                const canvasBottom = [\n                    centerCanvas[0],\n                    centerCanvas[1] - newHalfCanvasHeight,\n                ];\n                const canvasTop = [\n                    centerCanvas[0],\n                    centerCanvas[1] + newHalfCanvasHeight,\n                ];\n                points[0] = canvasToWorld(canvasBottom);\n                points[1] = canvasToWorld(canvasTop);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasCorners = (getCanvasEllipseCorners(canvasCoordinates));\n                const { centerPointRadius } = this.configuration;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                    };\n                    this._calculateCachedStats(annotation, viewport, renderingEngine);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-ellipse`;\n                const ellipseUID = '0';\n                drawEllipseSvg(svgDrawingHelper, annotationUID, ellipseUID, canvasCoordinates, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                if (centerPointRadius > 0) {\n                    const minRadius = Math.min(Math.abs(canvasCorners[0][0] - canvasCorners[1][0]) / 2, Math.abs(canvasCorners[0][1] - canvasCorners[1][1]) / 2);\n                    if (minRadius > 3 * centerPointRadius) {\n                        const centerPoint = this._getCanvasEllipseCenter(canvasCoordinates);\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${ellipseUID}-center`, centerPoint, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine) => {\n            const data = annotation.data;\n            const { element } = viewport;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasEllipseCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const post2Index = transformWorldToIndex(imageData, worldPos2);\n                post2Index[0] = Math.floor(post2Index[0]);\n                post2Index[1] = Math.floor(post2Index[1]);\n                post2Index[2] = Math.floor(post2Index[2]);\n                this.isHandleOutsideImage = !this._isInsideVolume(pos1Index, post2Index, dimensions);\n                const iMin = Math.min(pos1Index[0], post2Index[0]);\n                const iMax = Math.max(pos1Index[0], post2Index[0]);\n                const jMin = Math.min(pos1Index[1], post2Index[1]);\n                const jMax = Math.max(pos1Index[1], post2Index[1]);\n                const kMin = Math.min(pos1Index[2], post2Index[2]);\n                const kMax = Math.max(pos1Index[2], post2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const center = [\n                    (topLeftWorld[0] + bottomRightWorld[0]) / 2,\n                    (topLeftWorld[1] + bottomRightWorld[1]) / 2,\n                    (topLeftWorld[2] + bottomRightWorld[2]) / 2,\n                ];\n                const ellipseObj = {\n                    center,\n                    xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                    yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                    zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                };\n                const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                const isEmptyArea = worldWidth === 0 && worldHeight === 0;\n                const handles = [pos1Index, post2Index];\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                const area = Math.abs(Math.PI * (worldWidth / 2) * (worldHeight / 2)) /\n                    scale /\n                    scale;\n                const pixelUnitsOptions = {\n                    isPreScaled: isViewportPreScaled(viewport, targetId),\n                    isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                };\n                const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    boundsIJK,\n                    imageData,\n                    isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS, { fast: true }),\n                    returnPoints: this.configuration.storePointData,\n                });\n                const stats = this.configuration.statsCalculator.getStatistics();\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    mean: stats.mean?.value,\n                    max: stats.max?.value,\n                    stdDev: stats.stdDev?.value,\n                    statsArray: stats.array,\n                    pointsInShape,\n                    isEmptyArea,\n                    areaUnit,\n                    modalityUnit,\n                };\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    _pointInEllipseCanvas(ellipse, location) {\n        const xRadius = ellipse.width / 2;\n        const yRadius = ellipse.height / 2;\n        if (xRadius <= 0.0 || yRadius <= 0.0) {\n            return false;\n        }\n        const center = [ellipse.left + xRadius, ellipse.top + yRadius];\n        const normalized = [location[0] - center[0], location[1] - center[1]];\n        const inEllipse = (normalized[0] * normalized[0]) / (xRadius * xRadius) +\n            (normalized[1] * normalized[1]) / (yRadius * yRadius) <=\n            1.0;\n        return inEllipse;\n    }\n    _getCanvasEllipseCenter(ellipseCanvasPoints) {\n        const [bottom, top, left, right] = ellipseCanvasPoints;\n        const topLeft = [left[0], top[1]];\n        const bottomRight = [right[0], bottom[1]];\n        return [\n            (topLeft[0] + bottomRight[0]) / 2,\n            (topLeft[1] + bottomRight[1]) / 2,\n        ];\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, stdDev, max, isEmptyArea, areaUnit, modalityUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (max) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nEllipticalROITool.toolName = 'EllipticalROI';\nexport default EllipticalROITool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { getCalibratedAspect, getCalibratedLengthUnitsAndScale, } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { getCanvasCircleCorners, getCanvasCircleRadius, } from '../../utilities/math/circle';\nimport { pointInEllipse } from '../../utilities/math/ellipse';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass CircleROITool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            storePointData: false,\n            centerPointRadius: 0,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const radius = getCanvasCircleRadius(canvasCoordinates);\n            const radiusPoint = getCanvasCircleRadius([\n                canvasCoordinates[0],\n                canvasCoords,\n            ]);\n            if (Math.abs(radiusPoint - radius) < proximity / 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points = [\n                data.handles.points[0],\n                canvasToWorld(currentCanvasPoints),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = enabledElement.viewport;\n            const { annotation, handleIndex } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => worldToCanvas(p));\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            if (handleIndex === 0) {\n                const dXCanvas = currentCanvasPoints[0] - canvasCoordinates[0][0];\n                const dYCanvas = currentCanvasPoints[1] - canvasCoordinates[0][1];\n                const canvasCenter = currentCanvasPoints;\n                const canvasEnd = [\n                    canvasCoordinates[1][0] + dXCanvas,\n                    canvasCoordinates[1][1] + dYCanvas,\n                ];\n                points[0] = canvasToWorld(canvasCenter);\n                points[1] = canvasToWorld(canvasEnd);\n            }\n            else {\n                points[1] = canvasToWorld(currentCanvasPoints);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                const radius = getCanvasCircleRadius(canvasCoordinates);\n                const canvasCorners = getCanvasCircleCorners(canvasCoordinates);\n                const { centerPointRadius } = this.configuration;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                        radius: null,\n                        radiusUnit: null,\n                        perimeter: null,\n                    };\n                    this._calculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-circle`;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                if (centerPointRadius > 0) {\n                    if (radius > 3 * centerPointRadius) {\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${circleUID}-center`, center, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine, enabledElement) => {\n            const data = annotation.data;\n            const { element } = viewport;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const pos2Index = transformWorldToIndex(imageData, worldPos2);\n                pos2Index[0] = Math.floor(pos2Index[0]);\n                pos2Index[1] = Math.floor(pos2Index[1]);\n                pos2Index[2] = Math.floor(pos2Index[2]);\n                if (this._isInsideVolume(pos1Index, pos2Index, dimensions)) {\n                    const iMin = Math.min(pos1Index[0], pos2Index[0]);\n                    const iMax = Math.max(pos1Index[0], pos2Index[0]);\n                    const jMin = Math.min(pos1Index[1], pos2Index[1]);\n                    const jMax = Math.max(pos1Index[1], pos2Index[1]);\n                    const kMin = Math.min(pos1Index[2], pos2Index[2]);\n                    const kMax = Math.max(pos1Index[2], pos2Index[2]);\n                    const boundsIJK = [\n                        [iMin, iMax],\n                        [jMin, jMax],\n                        [kMin, kMax],\n                    ];\n                    const center = [\n                        (topLeftWorld[0] + bottomRightWorld[0]) / 2,\n                        (topLeftWorld[1] + bottomRightWorld[1]) / 2,\n                        (topLeftWorld[2] + bottomRightWorld[2]) / 2,\n                    ];\n                    const ellipseObj = {\n                        center,\n                        xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                        yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                        zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                    };\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const isEmptyArea = worldWidth === 0 && worldHeight === 0;\n                    const handles = [pos1Index, pos2Index];\n                    const { scale, unit, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                    const aspect = getCalibratedAspect(image);\n                    const area = Math.abs(Math.PI *\n                        (worldWidth / scale / 2) *\n                        (worldHeight / aspect / scale / 2));\n                    const pixelUnitsOptions = {\n                        isPreScaled: isViewportPreScaled(viewport, targetId),\n                        isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                    };\n                    const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                    const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                        isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS, { fast: true }),\n                        boundsIJK,\n                        imageData,\n                        returnPoints: this.configuration.storePointData,\n                    });\n                    const stats = this.configuration.statsCalculator.getStatistics();\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean: stats.mean?.value,\n                        max: stats.max?.value,\n                        stdDev: stats.stdDev?.value,\n                        statsArray: stats.array,\n                        pointsInShape: pointsInShape,\n                        isEmptyArea,\n                        areaUnit,\n                        radius: worldWidth / 2 / scale,\n                        radiusUnit: unit,\n                        perimeter: (2 * Math.PI * (worldWidth / 2)) / scale,\n                        modalityUnit,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { radius, radiusUnit, area, mean, stdDev, max, isEmptyArea, areaUnit, modalityUnit, } = cachedVolumeStats;\n    const textLines = [];\n    if (radius) {\n        const radiusLine = isEmptyArea\n            ? `Radius: Oblique not supported`\n            : `Radius: ${csUtils.roundNumber(radius)} ${radiusUnit}`;\n        textLines.push(radiusLine);\n    }\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (max) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nCircleROITool.toolName = 'CircleROI';\nexport default CircleROITool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawLine } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCanvasCircleRadius } from '../../utilities/math/circle';\nimport { vec3 } from 'gl-matrix';\nconst CROSSHAIR_SIZE = 5;\nclass ETDRSGridTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            degrees: [45, 135, 225, 315],\n            diameters: [10, 30, 60],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [[...worldPos]],\n                    },\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const center = viewport.worldToCanvas(points[0]);\n            const radius = getCanvasCircleRadius([center, canvasCoords]);\n            if (Math.abs(radius) < proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points = [\n                canvasToWorld(currentCanvasPoints),\n                canvasToWorld(currentCanvasPoints),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            const { deltaPoints } = eventDetail;\n            const worldPosDelta = deltaPoints.world;\n            const points = data.handles.points;\n            points.forEach((point) => {\n                point[0] += worldPosDelta[0];\n                point[1] += worldPosDelta[1];\n                point[2] += worldPosDelta[2];\n            });\n            annotation.invalidated = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = enabledElement.viewport;\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => worldToCanvas(p));\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const dXCanvas = currentCanvasPoints[0] - canvasCoordinates[0][0];\n            const dYCanvas = currentCanvasPoints[1] - canvasCoordinates[0][1];\n            const canvasCenter = currentCanvasPoints;\n            const canvasEnd = [\n                canvasCoordinates[1][0] + dXCanvas,\n                canvasCoordinates[1][1] + dYCanvas,\n            ];\n            points[0] = canvasToWorld(canvasCenter);\n            points[1] = canvasToWorld(canvasEnd);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                const { renderingEngine } = getEnabledElement(element);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                let lineUID = `${annotationUID}-crosshair-vertical`;\n                let start = [center[0], center[1] + CROSSHAIR_SIZE];\n                let end = [center[0], center[1] - CROSSHAIR_SIZE];\n                drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                lineUID = `${annotationUID}-crosshair-horizontal`;\n                start = [center[0] + CROSSHAIR_SIZE, center[1]];\n                end = [center[0] - CROSSHAIR_SIZE, center[1]];\n                drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                const diametersCanvas = this.configuration.diameters.map((diameter) => this.worldMeasureToCanvas(diameter, viewport));\n                for (let i = 0; i < diametersCanvas.length; i++) {\n                    const dataId = `${annotationUID}-circle-${i}`;\n                    const circleUID = `${annotationUID}-circle-${i}`;\n                    drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, diametersCanvas[i] / 2, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    }, dataId);\n                }\n                const degreesRad = (x) => (x * Math.PI) / 180;\n                const angleRadians = this.configuration.degrees.map((degree) => degreesRad(degree));\n                for (let i = 0; i < angleRadians.length; i++) {\n                    const lineUID = `${annotationUID}-line-${i}`;\n                    const start = [\n                        (Math.cos(angleRadians[i]) * diametersCanvas[0]) / 2 + center[0],\n                        (Math.sin(angleRadians[i]) * diametersCanvas[0]) / 2 + center[1],\n                    ];\n                    const end = [\n                        (Math.cos(angleRadians[i]) * diametersCanvas[2]) / 2 + center[0],\n                        (Math.sin(angleRadians[i]) * diametersCanvas[2]) / 2 + center[1],\n                    ];\n                    drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n    }\n    worldMeasureToCanvas(measurement, viewport) {\n        const p1 = viewport.canvasToWorld([\n            viewport.canvas.width / 2,\n            viewport.canvas.height / 2,\n        ]);\n        const { viewUp } = viewport.getCamera();\n        const p2 = vec3.scaleAndAdd(vec3.create(), p1, viewUp, measurement);\n        const p1Canvas = viewport.worldToCanvas(p1);\n        const p2Canvas = viewport.worldToCanvas(p2);\n        const distance = Math.sqrt(Math.pow(p2Canvas[0] - p1Canvas[0], 2) +\n            Math.pow(p2Canvas[1] - p1Canvas[1], 2));\n        return distance;\n    }\n}\nETDRSGridTool.toolName = 'ETDRSGrid';\nexport default ETDRSGridTool;\n","import { getEnabledElement, eventTarget, triggerEvent, utilities, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, getChildAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { drawHandles as drawHandlesSvg, drawPolyline as drawPolylineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events, MouseBindings, KeyboardBindings, ChangeTypes, } from '../../enums';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nimport * as math from '../../utilities/math';\nimport throttle from '../../utilities/throttle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport getMouseModifierKey from '../../eventDispatchers/shared/getMouseModifier';\nimport { ContourWindingDirection } from '../../types/ContourAnnotation';\nimport { CardinalSpline } from './splines/CardinalSpline';\nimport { LinearSpline } from './splines/LinearSpline';\nimport { CatmullRomSpline } from './splines/CatmullRomSpline';\nimport { BSpline } from './splines/BSpline';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities';\nconst SPLINE_MIN_POINTS = 3;\nconst SPLINE_CLICK_CLOSE_CURVE_DIST = 10;\nconst DEFAULT_SPLINE_CONFIG = {\n    resolution: 20,\n    controlPointAdditionDistance: 6,\n    controlPointDeletionDistance: 6,\n    showControlPointsConnectors: false,\n    controlPointAdditionEnabled: true,\n    controlPointDeletionEnabled: true,\n};\nvar SplineTypesEnum;\n(function (SplineTypesEnum) {\n    SplineTypesEnum[\"Cardinal\"] = \"CARDINAL\";\n    SplineTypesEnum[\"Linear\"] = \"LINEAR\";\n    SplineTypesEnum[\"CatmullRom\"] = \"CATMULLROM\";\n    SplineTypesEnum[\"BSpline\"] = \"BSPLINE\";\n})(SplineTypesEnum || (SplineTypesEnum = {}));\nvar SplineToolActions;\n(function (SplineToolActions) {\n    SplineToolActions[\"AddControlPoint\"] = \"addControlPoint\";\n    SplineToolActions[\"DeleteControlPoint\"] = \"deleteControlPoint\";\n})(SplineToolActions || (SplineToolActions = {}));\nclass SplineROITool extends ContourSegmentationBaseTool {\n    static { this.SplineTypes = SplineTypesEnum; }\n    static { this.Actions = SplineToolActions; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            calculateStats: true,\n            getTextLines: defaultGetTextLines,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            spline: {\n                configuration: {\n                    [SplineTypesEnum.Cardinal]: {\n                        Class: CardinalSpline,\n                        scale: 0.5,\n                    },\n                    [SplineTypesEnum.CatmullRom]: {\n                        Class: CatmullRomSpline,\n                    },\n                    [SplineTypesEnum.Linear]: {\n                        Class: LinearSpline,\n                    },\n                    [SplineTypesEnum.BSpline]: {\n                        Class: BSpline,\n                        controlPointAdditionEnabled: false,\n                        controlPointDeletionEnabled: false,\n                        showControlPointsConnectors: true,\n                    },\n                },\n                type: SplineTypesEnum.CatmullRom,\n                drawPreviewEnabled: true,\n                lastControlPointDeletionKeys: ['Backspace', 'Delete'],\n            },\n            actions: {\n                [SplineToolActions.AddControlPoint]: {\n                    method: 'addControlPointCallback',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Primary,\n                            modifierKey: KeyboardBindings.Shift,\n                        },\n                    ],\n                },\n                [SplineToolActions.DeleteControlPoint]: {\n                    method: 'deleteControlPointCallback',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Primary,\n                            modifierKey: KeyboardBindings.Ctrl,\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.fireChangeOnUpdate = null;\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const { instance: spline } = annotation.data.spline;\n            return spline.isPointNearCurve(canvasCoords, proximity);\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, contourHoleProcessingEnabled, } = this.editData;\n            const { data } = annotation;\n            annotation.autoGenerated = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const image = this.getTargetImageData(this.getTargetId(enabledElement.viewport));\n            const { imageData, dimensions } = image;\n            this.isHandleOutsideImage = data.handles.points\n                .map((p) => utilities.transformWorldToIndex(imageData, p))\n                .some((index) => !utilities.indexWithinDimensions(index, dimensions));\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const changeType = newAnnotation\n                ? ChangeTypes.Completed\n                : ChangeTypes.HandlesUpdated;\n            if (!this.fireChangeOnUpdate) {\n                this.fireChangeOnUpdate = {\n                    annotationUID: annotation.annotationUID,\n                    changeType,\n                    contourHoleProcessingEnabled,\n                };\n            }\n            else {\n                this.fireChangeOnUpdate.annotationUID = annotation.annotationUID;\n                this.fireChangeOnUpdate.changeType = changeType;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._keyDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const key = eventDetail.key ?? '';\n            const { lastControlPointDeletionKeys } = this.configuration.spline;\n            const deleteLastPoint = lastControlPointDeletionKeys.includes(key);\n            if (!deleteLastPoint) {\n                return;\n            }\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            if (data.handles.points.length === SPLINE_MIN_POINTS) {\n                this.cancel(element);\n                return;\n            }\n            else {\n                const controlPointIndex = data.handles.points.length - 1;\n                this._deleteControlPointByIndex(element, annotation, controlPointIndex);\n            }\n            evt.preventDefault();\n        };\n        this._mouseMoveCallback = (evt) => {\n            const { drawPreviewEnabled } = this.configuration.spline;\n            if (!drawPreviewEnabled) {\n                return;\n            }\n            const { element } = evt.detail;\n            const { renderingEngine } = getEnabledElement(element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData.lastCanvasPoint = evt.detail.currentPoints.canvas;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._mouseDownCallback = (evt) => {\n            const doubleClick = evt.type === Events.MOUSE_DOUBLE_CLICK;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            if (data.contour.closed) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const { canvas: canvasPoint, world: worldPoint } = currentPoints;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            let closeContour = data.handles.points.length >= 2 && doubleClick;\n            let addNewPoint = true;\n            if (data.handles.points.length >= 3) {\n                const { instance: spline } = data.spline;\n                const closestControlPoint = spline.getClosestControlPointWithinDistance(canvasPoint, SPLINE_CLICK_CLOSE_CURVE_DIST);\n                if (closestControlPoint?.index === 0) {\n                    addNewPoint = false;\n                    closeContour = true;\n                }\n            }\n            if (addNewPoint) {\n                data.handles.points.push(worldPoint);\n            }\n            data.contour.closed = data.contour.closed || closeContour;\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (data.contour.closed) {\n                this._endCallback(evt);\n            }\n            evt.preventDefault();\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                this.moveAnnotation(annotation, worldPosDelta);\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.triggerAnnotationCompleted = (annotation, contourHoleProcessingEnabled) => {\n            const eventType = Events.ANNOTATION_COMPLETED;\n            const eventDetail = {\n                annotation,\n                changeType: ChangeTypes.Completed,\n                contourHoleProcessingEnabled,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this.triggerAnnotationModified = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated) => {\n            const { viewportId, renderingEngineId } = enabledElement;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportId,\n                renderingEngineId,\n                changeType,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this.triggerChangeEvent = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated, contourHoleProcessingEnabled) => {\n            if (changeType === ChangeTypes.Completed) {\n                this.triggerAnnotationCompleted(annotation, contourHoleProcessingEnabled);\n            }\n            else {\n                this.triggerAnnotationModified(annotation, enabledElement, changeType);\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.KEY_DOWN, this._keyDownCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.addEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.KEY_DOWN, this._keyDownCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._renderStats = (annotation, viewport, svgDrawingHelper, textboxStyle) => {\n            const data = annotation.data;\n            const targetId = this.getTargetId(viewport);\n            if (!data.spline.instance.closed || !textboxStyle.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = 'textBox';\n            const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, textboxStyle);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        this.addControlPointCallback = (evt, annotation) => {\n            const { data } = annotation;\n            const splineType = data.spline.type;\n            const splineConfig = this._getSplineConfig(splineType);\n            const maxDist = splineConfig.controlPointAdditionDistance;\n            if (splineConfig.controlPointAdditionEnabled === false) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { instance: spline } = data.spline;\n            const canvasPos = evt.detail.currentPoints.canvas;\n            const closestPointInfo = spline.getClosestPoint(canvasPos);\n            if (closestPointInfo.distance > maxDist) {\n                return;\n            }\n            const { index, point: canvasPoint } = spline.addControlPointAtU(closestPointInfo.uValue);\n            data.handles.points.splice(index, 0, canvasToWorld(canvasPoint));\n            annotation.invalidated = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.deleteControlPointCallback = (evt, annotation) => {\n            const splineType = annotation.data.spline.type;\n            const splineConfig = this._getSplineConfig(splineType);\n            const maxDist = splineConfig.controlPointDeletionDistance;\n            if (splineConfig.controlPointDeletionEnabled === false) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const { canvas: canvasPos } = currentPoints;\n            const { instance: spline } = annotation.data.spline;\n            const closestControlPoint = spline.getClosestControlPointWithinDistance(canvasPos, maxDist);\n            if (!closestControlPoint) {\n                return;\n            }\n            this._deleteControlPointByIndex(element, annotation, closestControlPoint.index);\n        };\n        this._calculateCachedStats = (annotation, element) => {\n            if (!this.configuration.calculateStats) {\n                return;\n            }\n            const data = annotation.data;\n            if (!data.contour.closed) {\n                return;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { cachedStats } = data;\n            const { polyline: points } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasPoint = canvasCoordinates[0];\n                const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n                const deltaXPoint = viewport.canvasToWorld([\n                    canvasPoint[0] + 1,\n                    canvasPoint[1],\n                ]);\n                const deltaYPoint = viewport.canvasToWorld([\n                    canvasPoint[0],\n                    canvasPoint[1] + 1,\n                ]);\n                const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n                const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n                const { imageData } = image;\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, () => {\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(canvasCoordinates);\n                    const topLeftBBWorld = viewport.canvasToWorld([\n                        canvasMinX,\n                        canvasMinY,\n                    ]);\n                    const topLeftBBIndex = utilities.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = utilities.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                let area = math.polyline.getArea(canvasCoordinates) / scale / scale;\n                area *= deltaInX * deltaInY;\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    areaUnit,\n                };\n            }\n            this.triggerAnnotationModified(annotation, enabledElement, ChangeTypes.StatsUpdated);\n            return cachedStats;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const { canvas: canvasPos } = currentPoints;\n        const contourHoleProcessingEnabled = getMouseModifierKey(evt.detail.event) ===\n            this.configuration.contourHoleAdditionModifierKey;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        const annotation = this.createAnnotation(evt);\n        this.isDrawing = true;\n        this.addAnnotation(annotation, element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            movingTextBox: false,\n            newAnnotation: true,\n            hasMoved: false,\n            lastCanvasPoint: canvasPos,\n            contourHoleProcessingEnabled,\n        };\n        this._activateDraw(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        return annotation;\n    }\n    cancel(element) {\n        if (!this.isDrawing) {\n            return;\n        }\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n        if (newAnnotation) {\n            removeAnnotation(annotation.annotationUID);\n        }\n        super.cancelAnnotation(annotation);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        this.editData = null;\n        return annotation.annotationUID;\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, targetId, svgDrawingHelper, annotationStyle } = renderContext;\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { element } = viewport;\n        const annotation = renderContext.annotation;\n        const { annotationUID, data, highlighted } = annotation;\n        const { handles } = data;\n        const { points: controlPoints, activeHandleIndex } = handles;\n        const newAnnotation = this.editData?.newAnnotation;\n        const { lineWidth, lineDash, color, locked: annotationLocked, } = annotationStyle;\n        const canvasCoordinates = controlPoints.map((p) => worldToCanvas(p));\n        const { drawPreviewEnabled } = this.configuration.spline;\n        const splineType = annotation.data.spline.type;\n        const splineConfig = this._getSplineConfig(splineType);\n        const spline = annotation.data.spline.instance;\n        const childAnnotations = getChildAnnotations(annotation);\n        const missingAnnotation = childAnnotations.findIndex((it) => !it);\n        if (missingAnnotation !== -1) {\n            throw new Error(`Can't find annotation for child ${annotation.childAnnotationUIDs.join()}`);\n        }\n        const splineAnnotationsGroup = [annotation, ...childAnnotations].filter((annotation) => this._isSplineROIAnnotation(annotation));\n        splineAnnotationsGroup.forEach((annotation) => {\n            const spline = this._updateSplineInstance(element, annotation);\n            const splinePolylineCanvas = spline.getPolylinePoints();\n            this.updateContourPolyline(annotation, {\n                points: splinePolylineCanvas,\n                closed: data.contour.closed,\n                targetWindingDirection: ContourWindingDirection.Clockwise,\n            }, viewport, { updateWindingDirection: data.contour.closed });\n        });\n        super.renderAnnotationInstance(renderContext);\n        if (!data.cachedStats[targetId] ||\n            data.cachedStats[targetId].areaUnit == null) {\n            data.cachedStats[targetId] = {\n                Modality: null,\n                area: null,\n                areaUnit: null,\n            };\n            this._calculateCachedStats(annotation, element);\n        }\n        else if (annotation.invalidated) {\n            this._throttledCalculateCachedStats(annotation, element);\n        }\n        let activeHandleCanvasCoords;\n        if (!annotationLocked && !this.editData && activeHandleIndex !== null) {\n            activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n        }\n        if (activeHandleCanvasCoords || newAnnotation || highlighted) {\n            const handleGroupUID = '0';\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                color,\n                lineWidth,\n                handleRadius: '3',\n            });\n        }\n        if (drawPreviewEnabled &&\n            spline.numControlPoints > 1 &&\n            this.editData?.lastCanvasPoint &&\n            !spline.closed) {\n            const { lastCanvasPoint } = this.editData;\n            const previewPolylinePoints = spline.getPreviewPolylinePoints(lastCanvasPoint, SPLINE_CLICK_CLOSE_CURVE_DIST);\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'previewSplineChange', previewPolylinePoints, {\n                color: '#9EA0CA',\n                lineDash: lineDash,\n                lineWidth: 1,\n            });\n        }\n        if (splineConfig.showControlPointsConnectors) {\n            const controlPointsConnectors = [...canvasCoordinates];\n            if (spline.closed) {\n                controlPointsConnectors.push(canvasCoordinates[0]);\n            }\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'controlPointsConnectors', controlPointsConnectors, {\n                color: 'rgba(255, 255, 255, 0.5)',\n                lineWidth: 1,\n            });\n        }\n        this._renderStats(annotation, viewport, svgDrawingHelper, annotationStyle.textbox);\n        if (this.fireChangeOnUpdate?.annotationUID === annotationUID) {\n            this.triggerChangeEvent(annotation, enabledElement, this.fireChangeOnUpdate.changeType, this.fireChangeOnUpdate.contourHoleProcessingEnabled);\n            this.fireChangeOnUpdate = null;\n        }\n        annotation.invalidated = false;\n        return true;\n    }\n    createInterpolatedSplineControl(annotation) {\n        if (annotation.data.handles.points?.length) {\n            return;\n        }\n        const { polyline } = annotation.data.contour;\n        if (!polyline || !polyline.length) {\n            return;\n        }\n        annotation.data.handles.points = [];\n        const { points } = annotation.data.handles;\n        const increment = Math.max(10, Math.floor(polyline.length / 20));\n        for (let i = 0; i < polyline.length - increment; i += increment) {\n            points.push(polyline[i]);\n        }\n        points.push(polyline[polyline.length - 1]);\n    }\n    createAnnotation(evt) {\n        const contourAnnotation = super.createAnnotation(evt);\n        const { world: worldPos } = evt.detail.currentPoints;\n        const { type: splineType } = this.configuration.spline;\n        const splineConfig = this._getSplineConfig(splineType);\n        const spline = new splineConfig.Class();\n        const createSpline = () => ({\n            type: splineConfig.type,\n            instance: spline,\n            resolution: splineConfig.resolution,\n        });\n        let onInterpolationComplete;\n        if (this.configuration.interpolation?.enabled) {\n            onInterpolationComplete = (annotation) => {\n                annotation.data.spline ||= createSpline();\n                this.createInterpolatedSplineControl(annotation);\n            };\n        }\n        return utilities.deepMerge(contourAnnotation, {\n            data: {\n                handles: {\n                    points: [[...worldPos]],\n                },\n                spline: createSpline(),\n                cachedStats: {},\n            },\n            onInterpolationComplete,\n        });\n    }\n    _deleteControlPointByIndex(element, annotation, controlPointIndex) {\n        const enabledElement = getEnabledElement(element);\n        const { points: controlPoints } = annotation.data.handles;\n        if (controlPoints.length === 3) {\n            removeAnnotation(annotation.annotationUID);\n        }\n        else {\n            controlPoints.splice(controlPointIndex, 1);\n        }\n        const { renderingEngine } = enabledElement;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        annotation.invalidated = true;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    _isSplineROIAnnotation(annotation) {\n        return !!annotation.data?.spline;\n    }\n    _getSplineConfig(type) {\n        const { configuration: config } = this;\n        const splineConfigs = config.spline.configuration;\n        return Object.assign({ type }, DEFAULT_SPLINE_CONFIG, splineConfigs[type]);\n    }\n    _updateSplineInstance(element, annotation) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { data } = annotation;\n        const { type: splineType, instance: spline } = annotation.data.spline;\n        const splineConfig = this._getSplineConfig(splineType);\n        const worldPoints = data.handles.points;\n        const canvasPoints = worldPoints.map(worldToCanvas);\n        const resolution = splineConfig.resolution !== undefined\n            ? parseInt(splineConfig.resolution)\n            : undefined;\n        const scale = splineConfig.scale !== undefined\n            ? parseFloat(splineConfig.scale)\n            : undefined;\n        spline.setControlPoints(canvasPoints);\n        spline.closed = !!data.contour.closed;\n        if (!spline.fixedResolution &&\n            resolution !== undefined &&\n            spline.resolution !== resolution) {\n            spline.resolution = resolution;\n            annotation.invalidated = true;\n        }\n        if (spline instanceof CardinalSpline &&\n            !spline.fixedScale &&\n            scale !== undefined &&\n            spline.scale !== scale) {\n            spline.scale = scale;\n            annotation.invalidated = true;\n        }\n        return spline;\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        if (points.length < SPLINE_MIN_POINTS) {\n            console.warn('Spline requires at least 3 control points');\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const splineType = options?.splineType || SplineTypesEnum.CatmullRom;\n        const splineConfig = instance._getSplineConfig(splineType);\n        const SplineClass = splineConfig.Class;\n        const splineInstance = new SplineClass();\n        const canvasPoints = points.map((point) => viewport.worldToCanvas(point));\n        splineInstance.setControlPoints(canvasPoints);\n        const splinePolylineCanvas = splineInstance.getPolylinePoints();\n        const splinePolylineWorld = splinePolylineCanvas.map((point) => viewport.canvasToWorld(point));\n        const annotation = {\n            annotationUID: options?.annotationUID || utilities.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                },\n                label: '',\n                cachedStats: {},\n                spline: {\n                    type: splineType,\n                    instance: splineInstance,\n                },\n                contour: {\n                    closed: true,\n                    polyline: splinePolylineWorld,\n                },\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: true,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, isEmptyArea, areaUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${utilities.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    return textLines;\n}\nSplineROITool.toolName = 'SplineROI';\nexport default SplineROITool;\n","import { utilities } from '@cornerstonejs/core';\nimport SplineROITool from './SplineROITool';\nclass SplineContourSegmentationTool extends SplineROITool {\n    constructor(toolProps) {\n        const initialProps = utilities.deepMerge({\n            configuration: {\n                calculateStats: false,\n            },\n        }, toolProps);\n        super(initialProps);\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n}\nSplineContourSegmentationTool.toolName = 'SplineContourSegmentationTool';\nexport default SplineContourSegmentationTool;\n","import { vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils, VolumeViewport, utilities, triggerEvent, eventTarget, } from '@cornerstonejs/core';\nimport { removeAnnotation } from '../../stateManagement/annotation/annotationState';\nimport { drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events, KeyboardBindings, ChangeTypes } from '../../enums';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nimport getMouseModifierKey from '../../eventDispatchers/shared/getMouseModifier';\nimport * as math from '../../utilities/math';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport findHandlePolylineIndex from '../../utilities/contours/findHandlePolylineIndex';\nimport { ContourWindingDirection } from '../../types/ContourAnnotation';\nimport { triggerAnnotationModified, triggerContourAnnotationCompleted, } from '../../stateManagement/annotation/helpers/state';\nimport { LivewireScissors } from '../../utilities/livewire/LivewireScissors';\nimport { LivewirePath } from '../../utilities/livewire/LiveWirePath';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getCalibratedLengthUnitsAndScale, throttle } from '../../utilities';\nconst CLICK_CLOSE_CURVE_SQR_DIST = 10 ** 2;\nclass LivewireContourTool extends ContourSegmentationBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            getTextLines: defaultGetTextLines,\n            calculateStats: true,\n            preventHandleOutsideImage: false,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            snapHandleNearby: 2,\n            interpolation: {\n                enabled: false,\n                nearestEdge: 2,\n                showInterpolationPolyline: false,\n            },\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            actions: {\n                undo: {\n                    method: 'undo',\n                    bindings: [\n                        {\n                            key: 'Escape',\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const proximitySquared = proximity * proximity;\n            const canvasPoints = annotation.data.contour.polyline.map((p) => viewport.worldToCanvas(p));\n            let startPoint = canvasPoints[canvasPoints.length - 1];\n            for (let i = 0; i < canvasPoints.length; i++) {\n                const endPoint = canvasPoints[i];\n                const distanceToPointSquared = math.lineSegment.distanceToPointSquared(startPoint, endPoint, canvasCoords);\n                if (distanceToPointSquared <= proximitySquared) {\n                    return true;\n                }\n                startPoint = endPoint;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt, clearAnnotation = false) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, contourHoleProcessingEnabled, } = this.editData;\n            const { data } = annotation;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            if ((this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) ||\n                clearAnnotation) {\n                removeAnnotation(annotation.annotationUID);\n                this.clearEditData();\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                return;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            const changeType = newAnnotation\n                ? ChangeTypes.Completed\n                : ChangeTypes.HandlesUpdated;\n            this.triggerChangeEvent(annotation, enabledElement, changeType, contourHoleProcessingEnabled);\n            this.clearEditData();\n        };\n        this.triggerChangeEvent = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated, contourHoleProcessingEnabled = false) => {\n            if (changeType === ChangeTypes.Completed) {\n                triggerContourAnnotationCompleted(annotation, contourHoleProcessingEnabled);\n            }\n            else {\n                triggerAnnotationModified(annotation, enabledElement.viewport.element, changeType);\n            }\n        };\n        this._mouseDownCallback = (evt) => {\n            const doubleClick = evt.type === Events.MOUSE_DOUBLE_CLICK;\n            const { annotation, viewportIdsToRender, worldToSlice, sliceToWorld } = this.editData;\n            if (this.editData.closed) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const { canvas: canvasPos, world: worldPosOriginal } = currentPoints;\n            let worldPos = worldPosOriginal;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const controlPoints = this.editData.currentPath.getControlPoints();\n            let closePath = controlPoints.length >= 2 && doubleClick;\n            if (controlPoints.length >= 2) {\n                const closestHandlePoint = {\n                    index: -1,\n                    distSquared: Infinity,\n                };\n                for (let i = 0, len = controlPoints.length; i < len; i++) {\n                    const controlPoint = controlPoints[i];\n                    const worldControlPoint = sliceToWorld(controlPoint);\n                    const canvasControlPoint = viewport.worldToCanvas(worldControlPoint);\n                    const distSquared = math.point.distanceToPointSquared(canvasPos, canvasControlPoint);\n                    if (distSquared <= CLICK_CLOSE_CURVE_SQR_DIST &&\n                        distSquared < closestHandlePoint.distSquared) {\n                        closestHandlePoint.distSquared = distSquared;\n                        closestHandlePoint.index = i;\n                    }\n                }\n                if (closestHandlePoint.index === 0) {\n                    closePath = true;\n                }\n            }\n            const { snapHandleNearby } = this.configuration;\n            if (snapHandleNearby && !this.editData.closed) {\n                const currentPath = new LivewirePath();\n                const snapPoint = this.scissors.findMinNearby(worldToSlice(worldPosOriginal), 1);\n                const pathPoints = this.scissors.findPathToPoint(snapPoint);\n                currentPath.addPoints(pathPoints);\n                currentPath.prependPath(this.editData.confirmedPath);\n                worldPos = sliceToWorld(snapPoint);\n                this.editData.currentPath = currentPath;\n            }\n            this.editData.closed = this.editData.closed || closePath;\n            this.editData.confirmedPath = this.editData.currentPath;\n            const lastPoint = this.editData.currentPath.getLastPoint();\n            this.editData.confirmedPath.addControlPoint(lastPoint);\n            annotation.data.handles.points.push(sliceToWorld(lastPoint));\n            this.scissors.startSearch(worldToSlice(worldPos));\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (this.editData.closed) {\n                this.updateAnnotation(this.editData.confirmedPath);\n                this._endCallback(evt);\n            }\n            evt.preventDefault();\n        };\n        this._mouseMoveCallback = (evt) => {\n            const { element, currentPoints } = evt.detail;\n            const { world: worldPos, canvas: canvasPos } = currentPoints;\n            const { renderingEngine } = getEnabledElement(element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData.lastCanvasPoint = canvasPos;\n            const { width: imgWidth, height: imgHeight } = this.scissors;\n            const { worldToSlice } = this.editData;\n            const slicePoint = worldToSlice(worldPos);\n            if (slicePoint[0] < 0 ||\n                slicePoint[1] < 0 ||\n                slicePoint[0] >= imgWidth ||\n                slicePoint[1] >= imgHeight) {\n                return;\n            }\n            const pathPoints = this.scissors.findPathToPoint(slicePoint);\n            const currentPath = new LivewirePath();\n            currentPath.addPoints(pathPoints);\n            currentPath.prependPath(this.editData.confirmedPath);\n            this.editData.currentPath = currentPath;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                console.warn('Drag annotation not implemented');\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                this.editHandle(worldPos, element, annotation, handleIndex);\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateDraw(element);\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            if (newAnnotation) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.editData = null;\n            this.scissors = null;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.addEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._calculateCachedStats = (annotation, element) => {\n            if (!this.configuration.calculateStats) {\n                return;\n            }\n            const data = annotation.data;\n            if (!data.contour.closed) {\n                return;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const { cachedStats } = data;\n            const { polyline: points } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasPoint = canvasCoordinates[0];\n                const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n                const deltaXPoint = viewport.canvasToWorld([\n                    canvasPoint[0] + 1,\n                    canvasPoint[1],\n                ]);\n                const deltaYPoint = viewport.canvasToWorld([\n                    canvasPoint[0],\n                    canvasPoint[1] + 1,\n                ]);\n                const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n                const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n                const { imageData } = image;\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, () => {\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(canvasCoordinates);\n                    const topLeftBBWorld = viewport.canvasToWorld([\n                        canvasMinX,\n                        canvasMinY,\n                    ]);\n                    const topLeftBBIndex = utilities.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = utilities.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                let area = math.polyline.getArea(canvasCoordinates) / scale / scale;\n                area *= deltaInX * deltaInY;\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    areaUnit: areaUnit,\n                };\n            }\n            this.triggerAnnotationModified(annotation, enabledElement, ChangeTypes.StatsUpdated);\n            return cachedStats;\n        };\n        this._renderStats = (annotation, viewport, svgDrawingHelper, textboxStyle) => {\n            const data = annotation.data;\n            const targetId = this.getTargetId(viewport);\n            if (!data.contour.closed || !textboxStyle.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = 'textBox';\n            const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, textboxStyle);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        this.triggerAnnotationModified = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated) => {\n            const { viewportId, renderingEngineId } = enabledElement;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportId,\n                renderingEngineId,\n                changeType,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    setupBaseEditData(worldPos, element, annotation, nextPos, contourHoleProcessingEnabled) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        this.isDrawing = true;\n        const viewportImageData = viewport.getImageData();\n        const { imageData: vtkImageData } = viewportImageData;\n        let worldToSlice;\n        let sliceToWorld;\n        let width;\n        let height;\n        let scalarData;\n        if (!(viewport instanceof VolumeViewport)) {\n            width = viewportImageData.dimensions[0];\n            height = viewportImageData.dimensions[1];\n            worldToSlice = (point) => {\n                const ijkPoint = csUtils.transformWorldToIndex(vtkImageData, point);\n                return [ijkPoint[0], ijkPoint[1]];\n            };\n            sliceToWorld = (point) => csUtils.transformIndexToWorld(vtkImageData, [point[0], point[1], 0]);\n            scalarData = viewportImageData.scalarData;\n        }\n        else if (viewport instanceof VolumeViewport) {\n            const sliceImageData = csUtils.getCurrentVolumeViewportSlice(viewport);\n            const { sliceToIndexMatrix, indexToSliceMatrix } = sliceImageData;\n            worldToSlice = (point) => {\n                const ijkPoint = csUtils.transformWorldToIndex(vtkImageData, point);\n                const slicePoint = vec3.transformMat4([0, 0, 0], ijkPoint, indexToSliceMatrix);\n                return [slicePoint[0], slicePoint[1]];\n            };\n            sliceToWorld = (point) => {\n                const ijkPoint = vec3.transformMat4([0, 0, 0], [point[0], point[1], 0], sliceToIndexMatrix);\n                return csUtils.transformIndexToWorld(vtkImageData, ijkPoint);\n            };\n            scalarData = sliceImageData.scalarData;\n            width = sliceImageData.width;\n            height = sliceImageData.height;\n        }\n        else {\n            throw new Error('Viewport not supported');\n        }\n        scalarData = csUtils.convertToGrayscale(scalarData, width, height);\n        const { voiRange } = viewport.getProperties();\n        const startPos = worldToSlice(worldPos);\n        this.scissors = LivewireScissors.createInstanceFromRawPixelData(scalarData, width, height, voiRange);\n        if (nextPos) {\n            this.scissorsNext = LivewireScissors.createInstanceFromRawPixelData(scalarData, width, height, voiRange);\n            this.scissorsNext.startSearch(worldToSlice(nextPos));\n        }\n        this.scissors.startSearch(startPos);\n        const newAnnotation = !nextPos;\n        const confirmedPath = new LivewirePath();\n        const currentPath = new LivewirePath();\n        const currentPathNext = newAnnotation ? undefined : new LivewirePath();\n        confirmedPath.addPoint(startPos);\n        confirmedPath.addControlPoint(startPos);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        const lastCanvasPoint = viewport.worldToCanvas(worldPos);\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            newAnnotation,\n            hasMoved: false,\n            lastCanvasPoint,\n            confirmedPath,\n            currentPath,\n            confirmedPathNext: currentPathNext,\n            closed: false,\n            handleIndex: this.editData?.handleIndex ?? annotation.handles?.activeHandleIndex,\n            worldToSlice,\n            sliceToWorld,\n            contourHoleProcessingEnabled,\n        };\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const { world: worldPos } = currentPoints;\n        const annotation = this.createAnnotation(evt);\n        const contourHoleProcessingEnabled = getMouseModifierKey(evt.detail.event) ===\n            this.configuration.contourHoleAdditionModifierKey;\n        this.setupBaseEditData(worldPos, element, annotation, undefined, contourHoleProcessingEnabled);\n        this.addAnnotation(annotation, element);\n        this._activateDraw(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(this.editData.viewportIdsToRender);\n        return annotation;\n    }\n    clearEditData() {\n        this.editData = null;\n        this.scissors = null;\n        this.scissorsNext = null;\n        this.isDrawing = false;\n    }\n    editHandle(worldPos, element, annotation, handleIndex) {\n        const { data } = annotation;\n        const { points: handlePoints } = data.handles;\n        const { length: numHandles } = handlePoints;\n        const previousHandle = handlePoints[(handleIndex - 1 + numHandles) % numHandles];\n        const nextHandle = handlePoints[(handleIndex + 1) % numHandles];\n        if (!this.editData?.confirmedPathNext) {\n            this.setupBaseEditData(previousHandle, element, annotation, nextHandle);\n            const { polyline } = data.contour;\n            const confirmedPath = new LivewirePath();\n            const confirmedPathNext = new LivewirePath();\n            const { worldToSlice } = this.editData;\n            const previousIndex = findHandlePolylineIndex(annotation, handleIndex - 1);\n            const nextIndex = findHandlePolylineIndex(annotation, handleIndex + 1);\n            if (nextIndex === -1 || previousIndex === -1) {\n                throw new Error(`Can't find handle index ${nextIndex === -1 && nextHandle} ${previousIndex === -1 && previousHandle}`);\n            }\n            if (handleIndex === 0) {\n                confirmedPathNext.addPoints(polyline.slice(nextIndex + 1, previousIndex).map(worldToSlice));\n            }\n            else {\n                confirmedPath.addPoints(polyline.slice(0, previousIndex + 1).map(worldToSlice));\n                confirmedPathNext.addPoints(polyline.slice(nextIndex, polyline.length).map(worldToSlice));\n            }\n            this.editData.confirmedPath = confirmedPath;\n            this.editData.confirmedPathNext = confirmedPathNext;\n        }\n        const { editData, scissors } = this;\n        const { worldToSlice, sliceToWorld } = editData;\n        const { activeHandleIndex } = data.handles;\n        if (activeHandleIndex === null || activeHandleIndex === undefined) {\n            data.handles.activeHandleIndex = handleIndex;\n        }\n        else if (activeHandleIndex !== handleIndex) {\n            throw new Error(`Trying to edit a different handle than the one currently being edited ${handleIndex}!==${data.handles.activeHandleIndex}`);\n        }\n        const slicePos = worldToSlice(worldPos);\n        if (slicePos[0] < 0 ||\n            slicePos[0] >= scissors.width ||\n            slicePos[1] < 0 ||\n            slicePos[1] >= scissors.height) {\n            return;\n        }\n        handlePoints[handleIndex] = sliceToWorld(slicePos);\n        const pathPointsLeft = scissors.findPathToPoint(slicePos);\n        const pathPointsRight = this.scissorsNext.findPathToPoint(slicePos);\n        const currentPath = new LivewirePath();\n        currentPath.prependPath(editData.confirmedPath);\n        if (handleIndex !== 0) {\n            currentPath.addPoints(pathPointsLeft);\n        }\n        currentPath.addPoints(pathPointsRight.reverse());\n        currentPath.appendPath(editData.confirmedPathNext);\n        if (handleIndex === 0) {\n            currentPath.addPoints(pathPointsLeft);\n        }\n        editData.currentPath = currentPath;\n        annotation.invalidated = true;\n        editData.hasMoved = true;\n        editData.closed = true;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        this.updateAnnotation(this.editData?.currentPath);\n        return super.renderAnnotation(enabledElement, svgDrawingHelper);\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    createAnnotation(evt) {\n        const contourSegmentationAnnotation = super.createAnnotation(evt);\n        const { world: worldPos } = evt.detail.currentPoints;\n        const annotation = csUtils.deepMerge(contourSegmentationAnnotation, {\n            data: {\n                handles: {\n                    points: [[...worldPos]],\n                },\n            },\n        });\n        return annotation;\n    }\n    undo(element, config, evt) {\n        if (!this.editData) {\n            return;\n        }\n        this._endCallback(evt, true);\n    }\n    renderAnnotationInstance(renderContext) {\n        const { annotation, enabledElement, svgDrawingHelper, annotationStyle, targetId, } = renderContext;\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const { worldToCanvas } = viewport;\n        const { annotationUID, data, highlighted } = annotation;\n        const { handles } = data;\n        const newAnnotation = this.editData?.newAnnotation;\n        const { lineWidth, lineDash, color } = annotationStyle;\n        if (highlighted ||\n            (newAnnotation &&\n                annotation.annotationUID === this.editData?.annotation?.annotationUID)) {\n            const handleGroupUID = '0';\n            const canvasHandles = handles.points.map(worldToCanvas);\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasHandles, {\n                color,\n                lineDash,\n                lineWidth,\n            });\n        }\n        super.renderAnnotationInstance(renderContext);\n        if (!data.cachedStats[targetId] ||\n            data.cachedStats[targetId].areaUnit == null) {\n            data.cachedStats[targetId] = {\n                Modality: null,\n                area: null,\n                areaUnit: null,\n            };\n            this._calculateCachedStats(annotation, element);\n        }\n        else if (annotation.invalidated) {\n            this._throttledCalculateCachedStats(annotation, element);\n        }\n        this._renderStats(annotation, viewport, svgDrawingHelper, annotationStyle.textbox);\n        return true;\n    }\n    updateAnnotation(livewirePath) {\n        if (!this.editData || !livewirePath) {\n            return;\n        }\n        const { annotation, sliceToWorld, worldToSlice, closed, newAnnotation } = this.editData;\n        let { pointArray: imagePoints } = livewirePath;\n        if (imagePoints.length > 1) {\n            imagePoints = [...imagePoints, imagePoints[0]];\n        }\n        const targetWindingDirection = newAnnotation && closed ? ContourWindingDirection.Clockwise : undefined;\n        this.updateContourPolyline(annotation, {\n            points: imagePoints,\n            closed,\n            targetWindingDirection,\n        }, {\n            canvasToWorld: sliceToWorld,\n            worldToCanvas: worldToSlice,\n        });\n    }\n}\nLivewireContourTool.toolName = 'LivewireContour';\nexport default LivewireContourTool;\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, areaUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    return textLines;\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport LivewireContourTool from './LivewireContourTool';\nimport { LivewirePath } from '../../utilities/livewire/LiveWirePath';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport { ChangeTypes } from '../../enums';\nimport { drawPolyline as drawPolylineSvg } from '../../drawingSvg';\nclass LivewireContourSegmentationTool extends LivewireContourTool {\n    updateInterpolatedAnnotation(annotation, enabledElement) {\n        if (this.editData ||\n            !annotation.invalidated ||\n            !annotation.data.handles.interpolationSources) {\n            return;\n        }\n        annotation.data.contour.originalPolyline = annotation.data.contour.polyline;\n        queueMicrotask(() => {\n            if (!annotation.data.handles.interpolationSources) {\n                return;\n            }\n            const { points } = annotation.data.handles;\n            const { element } = enabledElement.viewport;\n            this.setupBaseEditData(points[0], element, annotation);\n            const { length: count } = points;\n            const { scissors } = this;\n            const { nearestEdge, repeatInterpolation } = this.configuration.interpolation;\n            annotation.data.handles.originalPoints = points;\n            const { worldToSlice, sliceToWorld } = this.editData;\n            const handleSmoothing = [];\n            if (nearestEdge) {\n                let lastPoint = worldToSlice(points[points.length - 1]);\n                points.forEach((point, hIndex) => {\n                    const testPoint = worldToSlice(point);\n                    lastPoint = testPoint;\n                    handleSmoothing.push(testPoint);\n                    scissors.startSearch(lastPoint);\n                    scissors.findPathToPoint(testPoint);\n                    scissors.findPathToPoint(worldToSlice(points[(hIndex + 3) % points.length]));\n                    const minPoint = scissors.findMinNearby(testPoint, nearestEdge);\n                    if (!csUtils.isEqual(testPoint, minPoint)) {\n                        handleSmoothing[hIndex] = minPoint;\n                        lastPoint = minPoint;\n                        points[hIndex] = sliceToWorld(minPoint);\n                    }\n                });\n            }\n            const acceptedPath = new LivewirePath();\n            for (let i = 0; i < count; i++) {\n                scissors.startSearch(worldToSlice(points[i]));\n                const path = scissors.findPathToPoint(worldToSlice(points[(i + 1) % count]));\n                acceptedPath.addPoints(path);\n            }\n            this.updateAnnotation(acceptedPath);\n            this.scissors = null;\n            this.scissorsNext = null;\n            this.editData = null;\n            annotation.data.handles.interpolationSources = null;\n            if (repeatInterpolation) {\n                triggerAnnotationModified(annotation, enabledElement.viewport.element, ChangeTypes.InterpolationUpdated);\n            }\n        });\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, svgDrawingHelper } = renderContext;\n        const annotation = renderContext.annotation;\n        const { annotationUID } = annotation;\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { showInterpolationPolyline } = this.configuration.interpolation || {};\n        this.updateInterpolatedAnnotation?.(annotation, enabledElement);\n        const { originalPolyline } = annotation.data.contour;\n        const rendered = super.renderAnnotationInstance(renderContext);\n        if (showInterpolationPolyline &&\n            originalPolyline &&\n            annotation.autoGenerated) {\n            const polylineCanvasPoints = originalPolyline.map(worldToCanvas);\n            polylineCanvasPoints.push(polylineCanvasPoints[0]);\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'interpolationContour-0', polylineCanvasPoints, {\n                color: '#70ffff',\n                lineWidth: 1,\n                fillOpacity: 0,\n            });\n        }\n        return rendered;\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n}\nLivewireContourSegmentationTool.toolName = 'LivewireContourSegmentationTool';\nexport default LivewireContourSegmentationTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawArrow as drawArrowSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass ArrowAnnotateTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            getTextCallback,\n            changeTextCallback,\n            preventHandleOutsideImage: false,\n            arrowFirst: true,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const { arrowFirst } = this.configuration;\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    text: '',\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        arrowFirst,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            if (newAnnotation) {\n                this.configuration.getTextCallback((text) => {\n                    if (!text) {\n                        removeAnnotation(annotation.annotationUID);\n                        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                        this.editData = null;\n                        this.isDrawing = false;\n                        return;\n                    }\n                    annotation.data.text = text;\n                    triggerAnnotationCompleted(annotation);\n                    triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                });\n            }\n            else {\n                triggerAnnotationModified(annotation, element);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.touchTapCallback = (evt) => {\n            if (evt.detail.taps == 2) {\n                this.doubleClickCallback(evt);\n            }\n        };\n        this.doubleClickCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            let annotations = getAnnotations(this.getToolName(), element);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return;\n            }\n            const clickedAnnotation = annotations.find((annotation) => this.isPointNearTool(element, annotation, eventDetail.currentPoints.canvas, 6));\n            if (!clickedAnnotation) {\n                return;\n            }\n            const annotation = clickedAnnotation;\n            this.configuration.changeTextCallback(clickedAnnotation, evt.detail, this._doneChangingTextCallback.bind(this, element, annotation));\n            this.editData = null;\n            this.isDrawing = false;\n            evt.stopImmediatePropagation();\n            evt.preventDefault();\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles, text } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineWidth,\n                    });\n                }\n                const arrowUID = '1';\n                if (this.configuration.arrowFirst) {\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasCoordinates[1], canvasCoordinates[0], {\n                        color,\n                        width: lineWidth,\n                        lineDash: lineDash,\n                    });\n                }\n                else {\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasCoordinates[0], canvasCoordinates[1], {\n                        color,\n                        width: lineWidth,\n                        lineDash: lineDash,\n                    });\n                }\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!text) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, [text], textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _doneChangingTextCallback(element, annotation, updatedText) {\n        annotation.data.text = updatedText;\n        const enabledElement = getEnabledElement(element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        triggerAnnotationModified(annotation, element);\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction getTextCallback(doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nfunction changeTextCallback(data, eventData, doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nArrowAnnotateTool.toolName = 'ArrowAnnotate';\nexport default ArrowAnnotateTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport * as lineSegment from '../../utilities/math/line';\nimport angleBetweenLines from '../../utilities/math/angle/angleBetweenLines';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass AngleTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.angleStartedNotYetCompleted) {\n                return;\n            }\n            this.angleStartedNotYetCompleted = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2, point3] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line1 = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line1.start.x, line1.start.y], [line1.end.x, line1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            if (!point3) {\n                return false;\n            }\n            const canvasPoint3 = viewport.worldToCanvas(point3);\n            const line2 = {\n                start: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n                end: {\n                    x: canvasPoint3[0],\n                    y: canvasPoint3[1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([line2.start.x, line2.start.y], [line2.end.x, line2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint2 <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.angleStartedNotYetCompleted && data.handles.points.length === 2) {\n                this.editData.handleIndex = 2;\n                return;\n            }\n            this.angleStartedNotYetCompleted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                this.angleStartedNotYetCompleted = false;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].angle == null) {\n                    data.cachedStats[targetId] = {\n                        angle: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotation.annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                let lineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                renderStatus = true;\n                if (canvasCoordinates.length !== 3) {\n                    return renderStatus;\n                }\n                lineUID = '2';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], canvasCoordinates[2], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                if (!data.cachedStats[targetId]?.angle) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        if (data.handles.points.length !== 3) {\n            return;\n        }\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const worldPos3 = data.handles.points[2];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const angle = angleBetweenLines([worldPos1, worldPos2], [worldPos2, worldPos3]);\n            const { dimensions, imageData } = this.getTargetImageData(targetId);\n            this.isHandleOutsideImage = [worldPos1, worldPos2, worldPos3]\n                .map((worldPos) => csUtils.transformWorldToIndex(imageData, worldPos))\n                .some((index) => !csUtils.indexWithinDimensions(index, dimensions));\n            cachedStats[targetId] = {\n                angle: isNaN(angle) ? 'Incomplete Angle' : angle,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { angle } = cachedVolumeStats;\n    if (angle === undefined) {\n        return;\n    }\n    if (isNaN(angle)) {\n        return [`${angle}`];\n    }\n    const textLines = [\n        `${csUtils.roundNumber(angle)} ${String.fromCharCode(176)}`,\n    ];\n    return textLines;\n}\nAngleTool.toolName = 'Angle';\nexport default AngleTool;\n","import { vec3 } from 'gl-matrix';\nimport { Events } from '../../enums';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport angleBetweenLines from '../../utilities/math/angle/angleBetweenLines';\nimport { midPoint2 } from '../../utilities/math/midPoint';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass CobbAngleTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            showArcLines: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.angleStartedNotYetCompleted) {\n                return;\n            }\n            this.angleStartedNotYetCompleted = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { distanceToPoint, distanceToPoint2 } = this.distanceToLines({\n                viewport,\n                points: data.handles.points,\n                canvasCoords,\n                proximity,\n            });\n            if (distanceToPoint <= proximity || distanceToPoint2 <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType, canvasCoords, proximity = 6) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { isNearFirstLine, isNearSecondLine } = this.distanceToLines({\n                viewport,\n                points: annotation.data.handles.points,\n                canvasCoords,\n                proximity,\n            });\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n                isNearFirstLine,\n                isNearSecondLine,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._mouseUpCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.angleStartedNotYetCompleted && data.handles.points.length < 4) {\n                resetElementCursor(element);\n                this.editData.handleIndex = data.handles.points.length;\n                return;\n            }\n            this.angleStartedNotYetCompleted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._mouseDownCallback = (evt) => {\n            const { annotation, handleIndex } = this.editData;\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { data } = annotation;\n            if (handleIndex === 1) {\n                data.handles.points[1] = worldPos;\n                this.editData.hasMoved =\n                    data.handles.points[1][0] !== data.handles.points[0][0] ||\n                        data.handles.points[1][1] !== data.handles.points[0][0];\n                return;\n            }\n            if (handleIndex === 3) {\n                data.handles.points[3] = worldPos;\n                this.editData.hasMoved =\n                    data.handles.points[3][0] !== data.handles.points[2][0] ||\n                        data.handles.points[3][1] !== data.handles.points[2][0];\n                this.angleStartedNotYetCompleted = false;\n                return;\n            }\n            this.editData.hasMoved = false;\n            hideElementCursor(element);\n            data.handles.points[2] = data.handles.points[3] = worldPos;\n            this.editData.handleIndex = data.handles.points.length - 1;\n        };\n        this._mouseDragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, isNearFirstLine, isNearSecondLine, } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined &&\n                (isNearFirstLine || isNearSecondLine)) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                if (isNearFirstLine) {\n                    const firstLinePoints = [points[0], points[1]];\n                    firstLinePoints.forEach((point) => {\n                        point[0] += worldPosDelta[0];\n                        point[1] += worldPosDelta[1];\n                        point[2] += worldPosDelta[2];\n                    });\n                }\n                else if (isNearSecondLine) {\n                    const secondLinePoints = [points[2], points[3]];\n                    secondLinePoints.forEach((point) => {\n                        point[0] += worldPosDelta[0];\n                        point[1] += worldPosDelta[1];\n                        point[2] += worldPosDelta[2];\n                    });\n                }\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateDraw(element);\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            if (data.handles.points.length < 4) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.angleStartedNotYetCompleted = false;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].angle == null) {\n                    data.cachedStats[targetId] = {\n                        angle: null,\n                        arc1Angle: null,\n                        arc2Angle: null,\n                        points: {\n                            world: {\n                                arc1Start: null,\n                                arc1End: null,\n                                arc2Start: null,\n                                arc2End: null,\n                                arc1Angle: null,\n                                arc2Angle: null,\n                            },\n                            canvas: {\n                                arc1Start: null,\n                                arc1End: null,\n                                arc2Start: null,\n                                arc2End: null,\n                                arc1Angle: null,\n                                arc2Angle: null,\n                            },\n                        },\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const firstLine = [canvasCoordinates[0], canvasCoordinates[1]];\n                const secondLine = [canvasCoordinates[2], canvasCoordinates[3]];\n                let lineUID = 'line1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, firstLine[0], firstLine[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                renderStatus = true;\n                if (canvasCoordinates.length < 4) {\n                    return renderStatus;\n                }\n                lineUID = 'line2';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, secondLine[0], secondLine[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                lineUID = 'linkLine';\n                const mid1 = midPoint2(firstLine[0], firstLine[1]);\n                const mid2 = midPoint2(secondLine[0], secondLine[1]);\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, mid1, mid2, {\n                    color,\n                    lineWidth: '1',\n                    lineDash: '1,4',\n                });\n                const { arc1Start, arc1End, arc2End, arc2Start } = data.cachedStats[targetId].points.canvas;\n                const { arc1Angle, arc2Angle } = data.cachedStats[targetId];\n                if (this.configuration.showArcLines) {\n                    lineUID = 'arc1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, arc1Start, arc1End, {\n                        color,\n                        lineWidth: '1',\n                    });\n                    lineUID = 'arc2';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, arc2Start, arc2End, {\n                        color,\n                        lineWidth: '1',\n                    });\n                }\n                if (!data.cachedStats[targetId]?.angle) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = 'cobbAngleText';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n                if (this.configuration.showArcLines) {\n                    const arc1TextBoxUID = 'arcAngle1';\n                    const arc1TextLine = [\n                        `${arc1Angle.toFixed(2)} ${String.fromCharCode(176)}`,\n                    ];\n                    const arch1TextPosCanvas = midPoint2(arc1Start, arc1End);\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, arc1TextBoxUID, arc1TextLine, arch1TextPosCanvas, {\n                        ...options,\n                        padding: 3,\n                    });\n                    const arc2TextBoxUID = 'arcAngle2';\n                    const arc2TextLine = [\n                        `${arc2Angle.toFixed(2)} ${String.fromCharCode(176)}`,\n                    ];\n                    const arch2TextPosCanvas = midPoint2(arc2Start, arc2End);\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, arc2TextBoxUID, arc2TextLine, arch2TextPosCanvas, {\n                        ...options,\n                        padding: 3,\n                    });\n                }\n            }\n            return renderStatus;\n        };\n        this.distanceToLines = ({ viewport, points, canvasCoords, proximity }) => {\n            const [point1, point2, point3, point4] = points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const canvasPoint3 = viewport.worldToCanvas(point3);\n            const canvasPoint4 = viewport.worldToCanvas(point4);\n            const line1 = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const line2 = {\n                start: {\n                    x: canvasPoint3[0],\n                    y: canvasPoint3[1],\n                },\n                end: {\n                    x: canvasPoint4[0],\n                    y: canvasPoint4[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line1.start.x, line1.start.y], [line1.end.x, line1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const distanceToPoint2 = lineSegment.distanceToPoint([line2.start.x, line2.start.y], [line2.end.x, line2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            let isNearFirstLine = false;\n            let isNearSecondLine = false;\n            if (distanceToPoint <= proximity) {\n                isNearFirstLine = true;\n            }\n            else if (distanceToPoint2 <= proximity) {\n                isNearSecondLine = true;\n            }\n            return {\n                distanceToPoint,\n                distanceToPoint2,\n                isNearFirstLine,\n                isNearSecondLine,\n            };\n        };\n        this.getArcsStartEndPoints = ({ firstLine, secondLine, mid1, mid2, }) => {\n            const linkLine = [mid1, mid2];\n            const arc1Angle = angleBetweenLines(firstLine, linkLine);\n            const arc2Angle = angleBetweenLines(secondLine, linkLine);\n            const arc1Side = arc1Angle > 90 ? 1 : 0;\n            const arc2Side = arc2Angle > 90 ? 0 : 1;\n            const midLinkLine = midPoint2(linkLine[0], linkLine[1]);\n            const linkLineLength = Math.sqrt((linkLine[1][0] - linkLine[0][0]) ** 2 +\n                (linkLine[1][1] - linkLine[0][1]) ** 2);\n            const ratio = 0.1;\n            const midFirstLine = midPoint2(firstLine[0], firstLine[1]);\n            const midSecondLine = midPoint2(secondLine[0], secondLine[1]);\n            const directionVectorStartArc1 = [\n                firstLine[arc1Side][0] - midFirstLine[0],\n                firstLine[arc1Side][1] - midFirstLine[1],\n            ];\n            const magnitudeStartArc1 = Math.sqrt(directionVectorStartArc1[0] ** 2 + directionVectorStartArc1[1] ** 2);\n            const normalizedDirectionStartArc1 = [\n                directionVectorStartArc1[0] / magnitudeStartArc1,\n                directionVectorStartArc1[1] / magnitudeStartArc1,\n            ];\n            const arc1Start = [\n                midFirstLine[0] +\n                    normalizedDirectionStartArc1[0] * linkLineLength * ratio,\n                midFirstLine[1] +\n                    normalizedDirectionStartArc1[1] * linkLineLength * ratio,\n            ];\n            const directionVectorEndArc1 = [\n                midLinkLine[0] - mid1[0],\n                midLinkLine[1] - mid1[1],\n            ];\n            const magnitudeEndArc1 = Math.sqrt(directionVectorEndArc1[0] ** 2 + directionVectorEndArc1[1] ** 2);\n            const normalizedDirectionEndArc1 = [\n                directionVectorEndArc1[0] / magnitudeEndArc1,\n                directionVectorEndArc1[1] / magnitudeEndArc1,\n            ];\n            const arc1End = [\n                mid1[0] + normalizedDirectionEndArc1[0] * linkLineLength * ratio,\n                mid1[1] + normalizedDirectionEndArc1[1] * linkLineLength * ratio,\n            ];\n            const directionVectorStartArc2 = [\n                secondLine[arc2Side][0] - midSecondLine[0],\n                secondLine[arc2Side][1] - midSecondLine[1],\n            ];\n            const magnitudeStartArc2 = Math.sqrt(directionVectorStartArc2[0] ** 2 + directionVectorStartArc2[1] ** 2);\n            const normalizedDirectionStartArc2 = [\n                directionVectorStartArc2[0] / magnitudeStartArc2,\n                directionVectorStartArc2[1] / magnitudeStartArc2,\n            ];\n            const arc2Start = [\n                midSecondLine[0] +\n                    normalizedDirectionStartArc2[0] * linkLineLength * ratio,\n                midSecondLine[1] +\n                    normalizedDirectionStartArc2[1] * linkLineLength * ratio,\n            ];\n            const directionVectorEndArc2 = [\n                midLinkLine[0] - mid2[0],\n                midLinkLine[1] - mid2[1],\n            ];\n            const magnitudeEndArc2 = Math.sqrt(directionVectorEndArc2[0] ** 2 + directionVectorEndArc2[1] ** 2);\n            const normalizedDirectionEndArc2 = [\n                directionVectorEndArc2[0] / magnitudeEndArc2,\n                directionVectorEndArc2[1] / magnitudeEndArc2,\n            ];\n            const arc2End = [\n                mid2[0] + normalizedDirectionEndArc2[0] * linkLineLength * ratio,\n                mid2[1] + normalizedDirectionEndArc2[1] * linkLineLength * ratio,\n            ];\n            return {\n                arc1Start,\n                arc1End,\n                arc2Start,\n                arc2End,\n                arc1Angle: arc1Angle > 90 ? 180 - arc1Angle : arc1Angle,\n                arc2Angle: arc2Angle > 90 ? 180 - arc2Angle : arc2Angle,\n            };\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 25, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle, interactionType = 'mouse') {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        if (data.handles.points.length !== 4) {\n            return;\n        }\n        const seg1 = [null, null];\n        const seg2 = [null, null];\n        let minDist = Number.MAX_VALUE;\n        for (let i = 0; i < 2; i += 1) {\n            for (let j = 2; j < 4; j += 1) {\n                const dist = vec3.distance(data.handles.points[i], data.handles.points[j]);\n                if (dist < minDist) {\n                    minDist = dist;\n                    seg1[1] = data.handles.points[i];\n                    seg1[0] = data.handles.points[(i + 1) % 2];\n                    seg2[0] = data.handles.points[j];\n                    seg2[1] = data.handles.points[2 + ((j - 1) % 2)];\n                }\n            }\n        }\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const canvasPoints = data.handles.points.map((p) => viewport.worldToCanvas(p));\n        const firstLine = [canvasPoints[0], canvasPoints[1]];\n        const secondLine = [canvasPoints[2], canvasPoints[3]];\n        const mid1 = midPoint2(firstLine[0], firstLine[1]);\n        const mid2 = midPoint2(secondLine[0], secondLine[1]);\n        const { arc1Start, arc1End, arc2End, arc2Start, arc1Angle, arc2Angle } = this.getArcsStartEndPoints({\n            firstLine,\n            secondLine,\n            mid1,\n            mid2,\n        });\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            cachedStats[targetId] = {\n                angle: angleBetweenLines(seg1, seg2),\n                arc1Angle,\n                arc2Angle,\n                points: {\n                    canvas: {\n                        arc1Start,\n                        arc1End,\n                        arc2End,\n                        arc2Start,\n                    },\n                    world: {\n                        arc1Start: viewport.canvasToWorld(arc1Start),\n                        arc1End: viewport.canvasToWorld(arc1End),\n                        arc2End: viewport.canvasToWorld(arc2End),\n                        arc2Start: viewport.canvasToWorld(arc2Start),\n                    },\n                },\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { angle } = cachedVolumeStats;\n    if (angle === undefined) {\n        return;\n    }\n    const textLines = [`${angle.toFixed(2)} ${String.fromCharCode(176)}`];\n    return textLines;\n}\nCobbAngleTool.toolName = 'CobbAngle';\nexport default CobbAngleTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, StackViewport, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawHandle as drawHandleSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { distanceToPoint } from '../../utilities/math/point';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { getCalibratedProbeUnitsAndValue } from '../../utilities/getCalibratedUnits';\nconst { transformWorldToIndex } = csUtils;\nclass UltrasoundDirectionalTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            displayBothAxesDistances: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.startedDrawing) {\n                return;\n            }\n            this.startedDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            if (!(viewport instanceof StackViewport)) {\n                throw new Error('UltrasoundDirectionalTool can only be used on a StackViewport');\n            }\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            return false;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.startedDrawing && data.handles.points.length === 1) {\n                this.editData.handleIndex = 1;\n                return;\n            }\n            this.startedDrawing = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                this.startedDrawing = false;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].xValues == null) {\n                    data.cachedStats[targetId] = {\n                        xValues: [0, 0],\n                        yValues: [0, 0],\n                        isHorizontal: false,\n                        units: [''],\n                        isUnitless: false,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let handleGroupUID = '0';\n                drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[0], {\n                    color,\n                }, 0);\n                renderStatus = true;\n                if (canvasCoordinates.length !== 2) {\n                    return renderStatus;\n                }\n                handleGroupUID = '1';\n                drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[1], {\n                    color,\n                }, 1);\n                const isUnitless = data.cachedStats[targetId].isUnitless;\n                if (!isUnitless) {\n                    const canvasPoint1 = canvasCoordinates[0];\n                    const canvasPoint2 = canvasCoordinates[1];\n                    const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n                    const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n                    const isHorizontal = data.cachedStats[targetId].isHorizontal;\n                    let projectedPointCanvas = [0, 0];\n                    if (isHorizontal) {\n                        projectedPointCanvas = [\n                            canvasPoint1[0] + canvasDeltaX,\n                            canvasPoint1[1],\n                        ];\n                    }\n                    else {\n                        projectedPointCanvas = [\n                            canvasPoint1[0],\n                            canvasPoint1[1] + canvasDeltaY,\n                        ];\n                    }\n                    let dataId = `${annotationUID}-line-1`;\n                    let lineUID = '1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], projectedPointCanvas, {\n                        color,\n                        width: 1,\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                    dataId = `${annotationUID}-line-2`;\n                    lineUID = '2';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], projectedPointCanvas, {\n                        color,\n                        width: 1,\n                        lineDash: [1, 1],\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                }\n                else {\n                    const dataId = `${annotationUID}-line-1`;\n                    const lineUID = '1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                        color,\n                        width: 1,\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId, this.configuration);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    toolSelectedCallback(evt, annotation, interactionType, canvasCoords) {\n        return;\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        this.editData = {\n            handleIndex,\n            annotation,\n            viewportIdsToRender,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        if (data.handles.points.length !== 2) {\n            return;\n        }\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData } = image;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[1];\n            const imageIndex1 = transformWorldToIndex(imageData, worldPos1);\n            const imageIndex2 = transformWorldToIndex(imageData, worldPos2);\n            const { values: values1, units: units1 } = getCalibratedProbeUnitsAndValue(image, [imageIndex1]);\n            const { values: values2, units: units2 } = getCalibratedProbeUnitsAndValue(image, [imageIndex2]);\n            let xValues, yValues, units, isHorizontal;\n            let isUnitless = false;\n            if (units1[0] !== units2[0] ||\n                units1[1] !== units2[1] ||\n                (units1[0] === 'raw' && units2[0] === 'raw')) {\n                const value = distanceToPoint(worldPos1, worldPos2);\n                xValues = [value, 0];\n                yValues = [value, 0];\n                units = ['px'];\n                isUnitless = true;\n            }\n            else {\n                const canvasPoint1 = enabledElement.viewport.worldToCanvas(worldPos1);\n                const canvasPoint2 = enabledElement.viewport.worldToCanvas(worldPos2);\n                const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n                const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n                isHorizontal = Math.abs(canvasDeltaX) > Math.abs(canvasDeltaY);\n                xValues = [values1[0], values2[0]];\n                yValues = [values1[1], values2[1]];\n                units = [units1[0], units1[1]];\n            }\n            cachedStats[targetId] = {\n                xValues,\n                yValues,\n                isHorizontal,\n                units,\n                isUnitless,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId, configuration) {\n    const cachedStats = data.cachedStats[targetId];\n    const { xValues, yValues, units, isUnitless, isHorizontal } = cachedStats;\n    if (isUnitless) {\n        return [`${csUtils.roundNumber(xValues[0])} px`];\n    }\n    if (configuration.displayBothAxesDistances) {\n        const dist1 = Math.abs(xValues[1] - xValues[0]);\n        const dist2 = Math.abs(yValues[1] - yValues[0]);\n        return [\n            `${csUtils.roundNumber(dist1)} ${units[0]}`,\n            `${csUtils.roundNumber(dist2)} ${units[1]}`,\n        ];\n    }\n    if (isHorizontal) {\n        const dist = Math.abs(xValues[1] - xValues[0]);\n        return [`${csUtils.roundNumber(dist)} ${units[0]}`];\n    }\n    else {\n        const dist = Math.abs(yValues[1] - yValues[0]);\n        return [`${csUtils.roundNumber(dist)} ${units[1]}`];\n    }\n}\nUltrasoundDirectionalTool.toolName = 'UltrasoundDirectionalTool';\nexport default UltrasoundDirectionalTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawArrow as drawArrowSvg } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nclass KeyImageTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            getTextCallback,\n            changeTextCallback,\n            canvasPosition: [10, 10],\n            canvasSize: 10,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = KeyImageTool.createAnnotation({\n                metadata: { ...viewport.getViewReference(), referencedImageId },\n            });\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.configuration.getTextCallback((text) => {\n                if (!text) {\n                    removeAnnotation(annotation.annotationUID);\n                    triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                    this.isDrawing = false;\n                    return;\n                }\n                annotation.data.text = text;\n                triggerAnnotationCompleted(annotation);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            });\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { canvasPosition, canvasSize } = this.configuration;\n            if (!canvasPosition?.length) {\n                return false;\n            }\n            if (Math.abs(canvasCoords[0] - canvasPosition[0] + canvasSize / 2) <=\n                canvasSize / 2 &&\n                Math.abs(canvasCoords[1] - canvasPosition[1] + canvasSize / 2) <=\n                    canvasSize / 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            annotation.highlighted = true;\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n        };\n        this.doubleClickCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            let annotations = getAnnotations(this.getToolName(), element);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return;\n            }\n            const clickedAnnotation = annotations.find((annotation) => this.isPointNearTool(element, annotation, eventDetail.currentPoints.canvas, 6));\n            if (!clickedAnnotation) {\n                return;\n            }\n            const annotation = clickedAnnotation;\n            this.configuration.changeTextCallback(clickedAnnotation, evt.detail, this._doneChangingTextCallback.bind(this, element, annotation));\n            this.isDrawing = false;\n            evt.stopImmediatePropagation();\n            evt.preventDefault();\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID } = annotation;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const { canvasPosition, canvasSize } = this.configuration;\n                if (canvasPosition?.length) {\n                    const arrowUID = '1';\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasPosition.map((it) => it + canvasSize), canvasPosition, {\n                        color,\n                        width: 1,\n                    });\n                }\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n            }\n            return renderStatus;\n        };\n    }\n    cancel() {\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n    }\n    _doneChangingTextCallback(element, annotation, updatedText) {\n        annotation.data.text = updatedText;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        triggerAnnotationModified(annotation, element);\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction getTextCallback(doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nfunction changeTextCallback(data, eventData, doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nKeyImageTool.toolName = 'KeyImage';\nexport default KeyImageTool;\n","import { BaseTool } from './base';\nimport { getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { setAnnotationSelected } from '../stateManagement/annotation/annotationSelection';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass AnnotationEraserTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            return this._deleteNearbyAnnotations(evt, 'mouse');\n        };\n        this.preTouchStartCallback = (evt) => {\n            return this._deleteNearbyAnnotations(evt, 'touch');\n        };\n    }\n    _deleteNearbyAnnotations(evt, interactionType) {\n        const { renderingEngineId, viewportId, element, currentPoints } = evt.detail;\n        const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n        if (!toolGroup) {\n            return false;\n        }\n        const tools = toolGroup._toolInstances;\n        const annotationsToRemove = [];\n        for (const toolName in tools) {\n            const toolInstance = tools[toolName];\n            if (typeof toolInstance.isPointNearTool !== 'function' ||\n                typeof toolInstance.filterInteractableAnnotationsForElement !==\n                    'function') {\n                continue;\n            }\n            const annotations = getAnnotations(toolName, element);\n            if (!annotations.length) {\n                continue;\n            }\n            const interactableAnnotations = toolInstance.filterInteractableAnnotationsForElement(element, annotations) || [];\n            for (const annotation of interactableAnnotations) {\n                if (toolInstance.isPointNearTool(element, annotation, currentPoints.canvas, 10, interactionType)) {\n                    annotationsToRemove.push(annotation.annotationUID);\n                }\n            }\n        }\n        for (const annotationUID of annotationsToRemove) {\n            setAnnotationSelected(annotationUID);\n            removeAnnotation(annotationUID);\n        }\n        evt.preventDefault();\n        return true;\n    }\n}\nAnnotationEraserTool.toolName = 'Eraser';\nexport default AnnotationEraserTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideRectangle } from './strategies/fillRectangle';\nimport { eraseInsideRectangle } from './strategies/eraseRectangle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { Events, SegmentationRepresentations } from '../../enums';\nimport { drawRect as drawRectSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { config as segmentationConfig, segmentLocking, segmentIndex as segmentIndexController, activeSegmentation, } from '../../stateManagement/segmentation';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, getStackSegmentationImageIdsForViewport, } from '../../stateManagement/segmentation/segmentationState';\nclass RectangleScissorsTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideRectangle,\n                ERASE_INSIDE: eraseInsideRectangle,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeLabelmapSegmentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeLabelmapSegmentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeLabelmapSegmentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData[SegmentationRepresentations.Labelmap];\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                },\n            };\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                this.editData = {\n                    ...this.editData,\n                    imageId: segmentationImageId,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            const { currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n            const worldPos = currentPoints.world;\n            const { points } = data.handles;\n            points[handleIndex] = [...worldPos];\n            let bottomLeftCanvas;\n            let bottomRightCanvas;\n            let topLeftCanvas;\n            let topRightCanvas;\n            let bottomLeftWorld;\n            let bottomRightWorld;\n            let topLeftWorld;\n            let topRightWorld;\n            switch (handleIndex) {\n                case 0:\n                case 3:\n                    bottomLeftCanvas = worldToCanvas(points[0]);\n                    topRightCanvas = worldToCanvas(points[3]);\n                    bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                    topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                    bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                    topLeftWorld = canvasToWorld(topLeftCanvas);\n                    points[1] = bottomRightWorld;\n                    points[2] = topLeftWorld;\n                    break;\n                case 1:\n                case 2:\n                    bottomRightCanvas = worldToCanvas(points[1]);\n                    topLeftCanvas = worldToCanvas(points[2]);\n                    bottomLeftCanvas = [\n                        topLeftCanvas[0],\n                        bottomRightCanvas[1],\n                    ];\n                    topRightCanvas = [bottomRightCanvas[0], topLeftCanvas[1]];\n                    bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                    topRightWorld = canvasToWorld(topRightCanvas);\n                    points[0] = bottomLeftWorld;\n                    points[3] = topRightWorld;\n                    break;\n            }\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const rectangleUID = '0';\n            drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nRectangleScissorsTool.toolName = 'RectangleScissor';\nexport default RectangleScissorsTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideCircle } from './strategies/fillCircle';\nimport { eraseInsideCircle } from './strategies/eraseCircle';\nimport { Events } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { segmentLocking, activeSegmentation, segmentIndex as segmentIndexController, config as segmentationConfig, } from '../../stateManagement/segmentation';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, } from '../../stateManagement/segmentation/segmentationState';\nclass CircleScissorsTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideCircle,\n                ERASE_INSIDE: eraseInsideCircle,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeLabelmapSegmentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeLabelmapSegmentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeLabelmapSegmentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData.Labelmap;\n            if (!labelmapData) {\n                throw new Error('No labelmap data found for the active segmentation, create one before using scissors tool');\n            }\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    isDrawing: true,\n                    cachedStats: {},\n                },\n            };\n            const viewportIdsToRender = [viewport.id];\n            this.editData = {\n                annotation,\n                centerCanvas: canvasPos,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                this.editData = {\n                    ...this.editData,\n                    imageId: segmentationImageId,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerCanvas } = this.editData;\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const radius = Math.sqrt(dX * dX + dY * dY);\n            const bottomCanvas = [\n                centerCanvas[0],\n                centerCanvas[1] + radius,\n            ];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] - radius];\n            const leftCanvas = [\n                centerCanvas[0] - radius,\n                centerCanvas[1],\n            ];\n            const rightCanvas = [\n                centerCanvas[0] + radius,\n                centerCanvas[1],\n            ];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            const { viewPlaneNormal, viewUp } = annotation.metadata;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n                viewPlaneNormal,\n                viewUp,\n                strategySpecificConfiguration: {},\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { viewportIdsToRender } = this.editData;\n            if (!viewportIdsToRender.includes(viewport.id)) {\n                return renderStatus;\n            }\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const bottom = canvasCoordinates[0];\n            const top = canvasCoordinates[1];\n            const center = [\n                Math.floor((bottom[0] + top[0]) / 2),\n                Math.floor((bottom[1] + top[1]) / 2),\n            ];\n            const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const circleUID = '0';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nCircleScissorsTool.toolName = 'CircleScissor';\nexport default CircleScissorsTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideSphere } from './strategies/fillSphere';\nimport { eraseInsideSphere } from './strategies/eraseSphere';\nimport { Events, SegmentationRepresentations } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { config as segmentationConfig, segmentLocking, segmentIndex as segmentIndexController, activeSegmentation, } from '../../stateManagement/segmentation';\nimport { getSegmentation } from '../../stateManagement/segmentation/segmentationState';\nclass SphereScissorsTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideSphere,\n                ERASE_INSIDE: eraseInsideSphere,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeSegmentationRepresentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeSegmentationRepresentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeSegmentationRepresentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            this.isDrawing = true;\n            const annotation = {\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    invalidated: true,\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    highlighted: true,\n                },\n            };\n            const viewportIdsToRender = [viewport.id];\n            this.editData = {\n                annotation,\n                centerCanvas: canvasPos,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                toolGroupId: this.toolGroupId,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData[SegmentationRepresentations.Labelmap];\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                this.editData = {\n                    ...this.editData,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerCanvas } = this.editData;\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const radius = Math.sqrt(dX * dX + dY * dY);\n            const bottomCanvas = [\n                centerCanvas[0],\n                centerCanvas[1] + radius,\n            ];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] - radius];\n            const leftCanvas = [\n                centerCanvas[0] - radius,\n                centerCanvas[1],\n            ];\n            const rightCanvas = [\n                centerCanvas[0] + radius,\n                centerCanvas[1],\n            ];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved, segmentIndex, segmentsLocked, } = this.editData;\n            const { data } = annotation;\n            const { viewPlaneNormal, viewUp } = annotation.metadata;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n                segmentIndex,\n                segmentsLocked,\n                viewPlaneNormal,\n                viewUp,\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { viewportIdsToRender } = this.editData;\n            if (!viewportIdsToRender.includes(viewport.id)) {\n                return renderStatus;\n            }\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const bottom = canvasCoordinates[0];\n            const top = canvasCoordinates[1];\n            const center = [\n                Math.floor((bottom[0] + top[0]) / 2),\n                Math.floor((bottom[1] + top[1]) / 2),\n            ];\n            const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const circleUID = '0';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nSphereScissorsTool.toolName = 'SphereScissor';\nexport default SphereScissorsTool;\n","import { StackViewport, cache, getEnabledElement, utilities as csUtils, utilities as coreUtils, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, removeAnnotation, getAnnotations, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport throttle from '../../utilities/throttle';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { hideElementCursor, resetElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport CircleROITool from '../annotation/CircleROITool';\nimport { getCanvasCircleCorners, getCanvasCircleRadius, } from '../../utilities/math/circle';\nimport { getCalibratedLengthUnitsAndScale, getCalibratedAspect, } from '../../utilities/getCalibratedUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { pointInEllipse } from '../../utilities/math/ellipse';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport { filterAnnotationsWithinSamePlane } from '../../utilities/planar';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { transformWorldToIndex } = csUtils;\nclass CircleROIStartEndThresholdTool extends CircleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            numSlicesToPropagate: 10,\n            calculatePointsInsideVolume: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n            showTextBox: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            let referencedImageId, imageVolume, volumeId;\n            if (viewport instanceof StackViewport) {\n                throw new Error('Stack Viewport Not implemented');\n            }\n            else {\n                const targetId = this.getTargetId(viewport);\n                volumeId = csUtils.getVolumeId(targetId);\n                imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const spacingInNormal = csUtils.getSpacingInNormalDirection(imageVolume, viewPlaneNormal);\n            const startCoord = this._getStartCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const endCoord = this._getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    volumeId,\n                    spacingInNormal,\n                    enabledElement,\n                },\n                data: {\n                    label: '',\n                    startCoordinate: startCoord,\n                    endCoordinate: endCoord,\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {\n                        pointsInVolume: [],\n                        projectionPoints: [],\n                        statistics: [],\n                    },\n                    labelmapUID: null,\n                },\n            };\n            this._computeProjectionPoints(annotation, imageVolume);\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const targetId = this.getTargetId(enabledElement.viewport);\n            const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n            if (this.configuration.calculatePointsInsideVolume) {\n                this._computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            let annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = filterAnnotationsWithinSamePlane(annotations, viewport.getCamera());\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { startCoordinate, endCoordinate } = data;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                const radius = getCanvasCircleRadius(canvasCoordinates);\n                const { centerPointRadius } = this.configuration;\n                const canvasCorners = getCanvasCircleCorners(canvasCoordinates);\n                const focalPoint = viewport.getCamera().focalPoint;\n                const viewplaneNormal = viewport.getCamera().viewPlaneNormal;\n                let tempStartCoordinate = startCoordinate;\n                let tempEndCoordinate = endCoordinate;\n                if (Array.isArray(startCoordinate)) {\n                    tempStartCoordinate = this._getCoordinateForViewplaneNormal(tempStartCoordinate, viewplaneNormal);\n                    data.startCoordinate = tempStartCoordinate;\n                }\n                if (Array.isArray(endCoordinate)) {\n                    tempEndCoordinate = this._getCoordinateForViewplaneNormal(tempEndCoordinate, viewplaneNormal);\n                    data.endCoordinate = tempEndCoordinate;\n                }\n                const roundedStartCoordinate = coreUtils.roundToPrecision(data.startCoordinate);\n                const roundedEndCoordinate = coreUtils.roundToPrecision(data.endCoordinate);\n                const cameraCoordinate = this._getCoordinateForViewplaneNormal(focalPoint, viewplaneNormal);\n                const roundedCameraCoordinate = coreUtils.roundToPrecision(cameraCoordinate);\n                if (roundedCameraCoordinate <\n                    Math.min(roundedStartCoordinate, roundedEndCoordinate) ||\n                    roundedCameraCoordinate >\n                        Math.max(roundedStartCoordinate, roundedEndCoordinate)) {\n                    continue;\n                }\n                const middleCoordinate = coreUtils.roundToPrecision((data.startCoordinate + data.endCoordinate) / 2);\n                let isMiddleSlice = false;\n                if (roundedCameraCoordinate === middleCoordinate) {\n                    isMiddleSlice = true;\n                }\n                data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = middleCoordinate;\n                if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null &&\n                    isMiddleSlice) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                let lineWidthToUse = lineWidth;\n                let lineDashToUse = lineDash;\n                if (isMiddleSlice) {\n                    lineWidthToUse = lineWidth;\n                    lineDashToUse = [];\n                }\n                else {\n                    lineDashToUse = [5, 5];\n                }\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineDash: lineDashToUse,\n                    lineWidth: lineWidthToUse,\n                });\n                if (centerPointRadius > 0) {\n                    if (radius > 3 * centerPointRadius) {\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${circleUID}-center`, center, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                if (this.configuration.showTextBox == true &&\n                    this.configuration.calculatePointsInsideVolume == true) {\n                    const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                    if (!options.visibility) {\n                        data.handles.textBox = {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        };\n                        continue;\n                    }\n                    const textLines = this.configuration.getTextLines(data);\n                    if (!textLines || textLines.length === 0) {\n                        continue;\n                    }\n                    let canvasTextBoxCoords;\n                    if (!data.handles.textBox.hasMoved) {\n                        canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                        data.handles.textBox.worldPosition =\n                            viewport.canvasToWorld(canvasTextBoxCoords);\n                    }\n                    const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                    const textBoxUID = '1';\n                    const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                    const { x: left, y: top, width, height } = boundingBox;\n                    data.handles.textBox.worldBoundingBox = {\n                        topLeft: viewport.canvasToWorld([left, top]),\n                        topRight: viewport.canvasToWorld([left + width, top]),\n                        bottomLeft: viewport.canvasToWorld([left, top + height]),\n                        bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                    };\n                }\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStatsTool, 100, { trailing: true });\n    }\n    _computeProjectionPoints(annotation, imageVolume) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, spacingInNormal } = metadata;\n        const { imageData } = imageVolume;\n        const { startCoordinate, endCoordinate } = data;\n        const { points } = data.handles;\n        const startIJK = transformWorldToIndex(imageData, points[0]);\n        const endIJK = transformWorldToIndex(imageData, points[0]);\n        const handlesToStart = csUtils.deepClone(points);\n        const startWorld = vec3.create();\n        imageData.indexToWorldVec3(startIJK, startWorld);\n        const endWorld = vec3.create();\n        imageData.indexToWorldVec3(endIJK, endWorld);\n        if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 2) {\n            startWorld[2] = startCoordinate;\n            endWorld[2] = endCoordinate;\n            handlesToStart[0][2] = startCoordinate;\n            handlesToStart[1][2] = startCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 0) {\n            startWorld[0] = startCoordinate;\n            endWorld[0] = endCoordinate;\n            handlesToStart[0][0] = startCoordinate;\n            handlesToStart[1][0] = startCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 1) {\n            startWorld[1] = startCoordinate;\n            endWorld[1] = endCoordinate;\n            handlesToStart[0][1] = startCoordinate;\n            handlesToStart[1][1] = startCoordinate;\n        }\n        const distance = vec3.distance(startWorld, endWorld);\n        const newProjectionPoints = [];\n        for (let dist = 0; dist < distance; dist += spacingInNormal) {\n            newProjectionPoints.push(handlesToStart.map((point) => {\n                const newPoint = vec3.create();\n                vec3.scaleAndAdd(newPoint, point, viewPlaneNormal, dist);\n                return Array.from(newPoint);\n            }));\n        }\n        data.cachedStats.projectionPoints = newProjectionPoints;\n    }\n    _computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, viewUp } = metadata;\n        const { viewport } = enabledElement;\n        const projectionPoints = data.cachedStats.projectionPoints;\n        const pointsInsideVolume = [[]];\n        const image = this.getTargetImageData(targetId);\n        const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n        const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n        const pos1 = viewport.canvasToWorld(topLeftCanvas);\n        const pos2 = viewport.canvasToWorld(bottomRightCanvas);\n        const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, pos1, pos2);\n        const measureInfo = getCalibratedLengthUnitsAndScale(image, data.handles);\n        const aspect = getCalibratedAspect(image);\n        const area = Math.abs(Math.PI *\n            (worldWidth / measureInfo.scale / 2) *\n            (worldHeight / aspect / measureInfo.scale / 2));\n        const modalityUnitOptions = {\n            isPreScaled: isViewportPreScaled(viewport, targetId),\n            isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n        };\n        const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n        for (let i = 0; i < projectionPoints.length; i++) {\n            if (!imageVolume) {\n                continue;\n            }\n            const centerWorld = projectionPoints[i][0];\n            const canvasCoordinates = projectionPoints[i].map((p) => viewport.worldToCanvas(p));\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            const { dimensions, imageData, voxelManager } = imageVolume;\n            const worldPos1Index = transformWorldToIndex(imageData, worldPos1);\n            const worldProjectionPointIndex = transformWorldToIndex(imageData, centerWorld);\n            const indexOfProjection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n            worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n            worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n            worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n            worldPos1Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            const worldPos2Index = transformWorldToIndex(imageData, worldPos2);\n            worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n            worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n            worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n            worldPos2Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const center = centerWorld;\n                const ellipseObj = {\n                    center,\n                    xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                    yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                    zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                };\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS),\n                    boundsIJK,\n                    imageData,\n                    returnPoints: this.configuration.storePointData,\n                });\n                pointsInsideVolume.push(pointsInShape);\n            }\n        }\n        const stats = this.configuration.statsCalculator.getStatistics();\n        data.cachedStats.pointsInVolume = pointsInsideVolume;\n        data.cachedStats.statistics = {\n            Modality: metadata.Modality,\n            area,\n            mean: stats.mean?.value,\n            stdDev: stats.stdDev?.value,\n            max: stats.max?.value,\n            statsArray: stats.array,\n            areaUnit: measureInfo.areaUnit,\n            modalityUnit,\n        };\n    }\n    _calculateCachedStatsTool(annotation, enabledElement) {\n        const data = annotation.data;\n        const { viewport } = enabledElement;\n        const { cachedStats } = data;\n        const targetId = this.getTargetId(viewport);\n        const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n        this._computeProjectionPoints(annotation, imageVolume);\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement);\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, viewport.element);\n        return cachedStats;\n    }\n    _getStartCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const numSlicesToPropagateFromStart = Math.round(numSlicesToPropagate / 2);\n        const startPos = vec3.create();\n        vec3.scaleAndAdd(startPos, worldPos, viewPlaneNormal, numSlicesToPropagateFromStart * -spacingInNormal);\n        const startCoord = this._getCoordinateForViewplaneNormal(startPos, viewPlaneNormal);\n        return startCoord;\n    }\n    _getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const numSlicesToPropagateToEnd = numSlicesToPropagate - Math.round(numSlicesToPropagate / 2);\n        const endPos = vec3.create();\n        vec3.scaleAndAdd(endPos, worldPos, viewPlaneNormal, numSlicesToPropagateToEnd * spacingInNormal);\n        const endCoord = this._getCoordinateForViewplaneNormal(endPos, viewPlaneNormal);\n        return endCoord;\n    }\n    _getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) {\n        const viewplaneNormalAbs = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const indexOfDirection = viewplaneNormalAbs.indexOf(Math.max(...viewplaneNormalAbs));\n        return indexOfDirection;\n    }\n    _getCoordinateForViewplaneNormal(pos, viewPlaneNormal) {\n        const indexOfDirection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n        return pos[indexOfDirection];\n    }\n}\nfunction defaultGetTextLines(data) {\n    const cachedVolumeStats = data.cachedStats.statistics;\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nCircleROIStartEndThresholdTool.toolName = 'CircleROIStartEndThreshold';\nexport default CircleROIStartEndThresholdTool;\n","import { cache, getEnabledElement, utilities as csUtils, BaseVolumeViewport, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { SegmentationRepresentations } from '../../enums';\nimport { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport { segmentLocking, activeSegmentation, segmentIndex as segmentIndexController, } from '../../stateManagement/segmentation';\nimport floodFill from '../../utilities/segmentation/floodFill';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, } from '../../stateManagement/segmentation/segmentationState';\nconst { transformWorldToIndex, isEqual } = csUtils;\nclass PaintFillTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal } = camera;\n            const activeSegmentationRepresentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeSegmentationRepresentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeSegmentationRepresentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const { representationData } = getSegmentation(segmentationId);\n            let dimensions;\n            let direction;\n            let scalarData;\n            let index;\n            let voxelManager;\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = representationData[SegmentationRepresentations.Labelmap];\n                const segmentation = cache.getVolume(volumeId);\n                ({ dimensions, direction } = segmentation);\n                voxelManager = segmentation.voxelManager;\n                index = transformWorldToIndex(segmentation.imageData, worldPos);\n            }\n            else {\n                const currentSegmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                if (!currentSegmentationImageId) {\n                    throw new Error('No active segmentation imageId detected, create one before using scissors tool');\n                }\n                const { imageData } = viewport.getImageData();\n                dimensions = imageData.getDimensions();\n                direction = imageData.getDirection();\n                const image = cache.getImage(currentSegmentationImageId);\n                voxelManager = image.voxelManager;\n                index = transformWorldToIndex(imageData, worldPos);\n            }\n            const fixedDimension = this.getFixedDimension(viewPlaneNormal, direction);\n            if (fixedDimension === undefined) {\n                console.warn('Oblique paint fill not yet supported');\n                return;\n            }\n            const { floodFillGetter, getLabelValue, getScalarDataPositionFromPlane, inPlaneSeedPoint, fixedDimensionValue, } = this.generateHelpers(voxelManager, dimensions, index, fixedDimension);\n            if (index[0] < 0 ||\n                index[0] >= dimensions[0] ||\n                index[1] < 0 ||\n                index[1] >= dimensions[1] ||\n                index[2] < 0 ||\n                index[2] >= dimensions[2]) {\n                return;\n            }\n            const clickedLabelValue = getLabelValue(index[0], index[1], index[2]);\n            if (segmentsLocked.includes(clickedLabelValue)) {\n                return;\n            }\n            const floodFillResult = floodFill(floodFillGetter, inPlaneSeedPoint);\n            const { flooded } = floodFillResult;\n            flooded.forEach((index) => {\n                const scalarDataIndex = getScalarDataPositionFromPlane(index[0], index[1]);\n                voxelManager.setAtIndex(scalarDataIndex, segmentIndex);\n            });\n            const framesModified = this.getFramesModified(fixedDimension, fixedDimensionValue, floodFillResult);\n            triggerSegmentationDataModified(segmentationId, framesModified);\n            return true;\n        };\n        this.getFramesModified = (fixedDimension, fixedDimensionValue, floodFillResult) => {\n            const { boundaries } = floodFillResult;\n            if (fixedDimension === 2) {\n                return [fixedDimensionValue];\n            }\n            let minJ = Infinity;\n            let maxJ = -Infinity;\n            for (let b = 0; b < boundaries.length; b++) {\n                const j = boundaries[b][1];\n                if (j < minJ) {\n                    minJ = j;\n                }\n                if (j > maxJ) {\n                    maxJ = j;\n                }\n            }\n            const framesModified = [];\n            for (let frame = minJ; frame <= maxJ; frame++) {\n                framesModified.push(frame);\n            }\n            return framesModified;\n        };\n        this.generateHelpers = (voxelManager, dimensions, seedIndex3D, fixedDimension = 2) => {\n            let fixedDimensionValue;\n            let inPlaneSeedPoint;\n            switch (fixedDimension) {\n                case 0:\n                    fixedDimensionValue = seedIndex3D[0];\n                    inPlaneSeedPoint = [seedIndex3D[1], seedIndex3D[2]];\n                    break;\n                case 1:\n                    fixedDimensionValue = seedIndex3D[1];\n                    inPlaneSeedPoint = [seedIndex3D[0], seedIndex3D[2]];\n                    break;\n                case 2:\n                    fixedDimensionValue = seedIndex3D[2];\n                    inPlaneSeedPoint = [seedIndex3D[0], seedIndex3D[1]];\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            const getScalarDataPosition = (x, y, z) => {\n                return voxelManager.toIndex([x, y, z]);\n            };\n            const getLabelValue = (x, y, z) => {\n                return voxelManager.getAtIJK(x, y, z);\n            };\n            const floodFillGetter = this.generateFloodFillGetter(dimensions, fixedDimension, fixedDimensionValue, getLabelValue);\n            const getScalarDataPositionFromPlane = this.generateGetScalarDataPositionFromPlane(getScalarDataPosition, fixedDimension, fixedDimensionValue);\n            return {\n                getScalarDataPositionFromPlane,\n                getLabelValue,\n                floodFillGetter,\n                inPlaneSeedPoint,\n                fixedDimensionValue,\n            };\n        };\n        this.generateFloodFillGetter = (dimensions, fixedDimension, fixedDimensionValue, getLabelValue) => {\n            let floodFillGetter;\n            switch (fixedDimension) {\n                case 0:\n                    floodFillGetter = (y, z) => {\n                        if (y >= dimensions[1] || y < 0 || z >= dimensions[2] || z < 0) {\n                            return;\n                        }\n                        return getLabelValue(fixedDimensionValue, y, z);\n                    };\n                    break;\n                case 1:\n                    floodFillGetter = (x, z) => {\n                        if (x >= dimensions[0] || x < 0 || z >= dimensions[2] || z < 0) {\n                            return;\n                        }\n                        return getLabelValue(x, fixedDimensionValue, z);\n                    };\n                    break;\n                case 2:\n                    floodFillGetter = (x, y) => {\n                        if (x >= dimensions[0] || x < 0 || y >= dimensions[1] || y < 0) {\n                            return;\n                        }\n                        return getLabelValue(x, y, fixedDimensionValue);\n                    };\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            return floodFillGetter;\n        };\n        this.generateGetScalarDataPositionFromPlane = (getScalarDataPosition, fixedDimension, fixedDimensionValue) => {\n            let getScalarDataPositionFromPlane;\n            switch (fixedDimension) {\n                case 0:\n                    getScalarDataPositionFromPlane = (y, z) => {\n                        return getScalarDataPosition(fixedDimensionValue, y, z);\n                    };\n                    break;\n                case 1:\n                    getScalarDataPositionFromPlane = (x, z) => {\n                        return getScalarDataPosition(x, fixedDimensionValue, z);\n                    };\n                    break;\n                case 2:\n                    getScalarDataPositionFromPlane = (x, y) => {\n                        return getScalarDataPosition(x, y, fixedDimensionValue);\n                    };\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            return getScalarDataPositionFromPlane;\n        };\n    }\n    getFixedDimension(viewPlaneNormal, direction) {\n        const xDirection = direction.slice(0, 3);\n        const yDirection = direction.slice(3, 6);\n        const zDirection = direction.slice(6, 9);\n        const absoluteOfViewPlaneNormal = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const absoluteOfXDirection = [\n            Math.abs(xDirection[0]),\n            Math.abs(xDirection[1]),\n            Math.abs(xDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfXDirection)) {\n            return 0;\n        }\n        const absoluteOfYDirection = [\n            Math.abs(yDirection[0]),\n            Math.abs(yDirection[1]),\n            Math.abs(yDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfYDirection)) {\n            return 1;\n        }\n        const absoluteOfZDirection = [\n            Math.abs(zDirection[0]),\n            Math.abs(zDirection[1]),\n            Math.abs(zDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfZDirection)) {\n            return 2;\n        }\n    }\n}\nPaintFillTool.toolName = 'PaintFill';\nexport default PaintFillTool;\n","import vtkOrientationMarkerWidget from '@kitware/vtk.js/Interaction/Widgets/OrientationMarkerWidget';\nimport vtkAnnotatedCubeActor from '@kitware/vtk.js/Rendering/Core/AnnotatedCubeActor';\nimport vtkAxesActor from '@kitware/vtk.js/Rendering/Core/AxesActor';\nimport vtkActor from '@kitware/vtk.js/Rendering/Core/Actor';\nimport vtkMapper from '@kitware/vtk.js/Rendering/Core/Mapper';\nimport vtkXMLPolyDataReader from '@kitware/vtk.js/IO/XML/XMLPolyDataReader';\nimport vtkPolyData from '@kitware/vtk.js/Common/DataModel/PolyData';\nimport { BaseTool } from './base';\nimport { Enums, eventTarget, getEnabledElementByIds, getRenderingEngines, } from '@cornerstonejs/core';\nimport { filterViewportsWithToolEnabled } from '../utilities/viewportFilters';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport { Events } from '../enums';\nvar OverlayMarkerType;\n(function (OverlayMarkerType) {\n    OverlayMarkerType[OverlayMarkerType[\"ANNOTATED_CUBE\"] = 1] = \"ANNOTATED_CUBE\";\n    OverlayMarkerType[OverlayMarkerType[\"AXES\"] = 2] = \"AXES\";\n    OverlayMarkerType[OverlayMarkerType[\"CUSTOM\"] = 3] = \"CUSTOM\";\n})(OverlayMarkerType || (OverlayMarkerType = {}));\nclass OrientationMarkerTool extends BaseTool {\n    static { this.CUBE = 1; }\n    static { this.AXIS = 2; }\n    static { this.VTPFILE = 3; }\n    static { this.OVERLAY_MARKER_TYPES = OverlayMarkerType; }\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            orientationWidget: {\n                enabled: true,\n                viewportCorner: vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT,\n                viewportSize: 0.15,\n                minPixelSize: 100,\n                maxPixelSize: 300,\n            },\n            overlayMarkerType: OrientationMarkerTool.OVERLAY_MARKER_TYPES.ANNOTATED_CUBE,\n            overlayConfiguration: {\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.ANNOTATED_CUBE]: {\n                    faceProperties: {\n                        xPlus: { text: 'L', faceColor: '#ffff00', faceRotation: 90 },\n                        xMinus: { text: 'R', faceColor: '#ffff00', faceRotation: 270 },\n                        yPlus: {\n                            text: 'P',\n                            faceColor: '#00ffff',\n                            fontColor: 'white',\n                            faceRotation: 180,\n                        },\n                        yMinus: { text: 'A', faceColor: '#00ffff', fontColor: 'white' },\n                        zPlus: { text: 'S' },\n                        zMinus: { text: 'I' },\n                    },\n                    defaultStyle: {\n                        fontStyle: 'bold',\n                        fontFamily: 'Arial',\n                        fontColor: 'black',\n                        fontSizeScale: (res) => res / 2,\n                        faceColor: '#0000ff',\n                        edgeThickness: 0.1,\n                        edgeColor: 'black',\n                        resolution: 400,\n                    },\n                },\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.AXES]: {},\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.CUSTOM]: {\n                    polyDataURL: 'https://raw.githubusercontent.com/Slicer/Slicer/80ad0a04dacf134754459557bf2638c63f3d1d1b/Base/Logic/Resources/OrientationMarkers/Human.vtp',\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._resizeObservers = new Map();\n        this.onSetToolEnabled = () => {\n            this.initViewports();\n            this._subscribeToViewportEvents();\n        };\n        this.onSetToolActive = () => {\n            this.initViewports();\n            this._subscribeToViewportEvents();\n        };\n        this.onSetToolDisabled = () => {\n            this.cleanUpData();\n            this._unsubscribeToViewportNewVolumeSet();\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.resize = (viewportId) => {\n            const orientationMarker = this.orientationMarkers[viewportId];\n            if (!orientationMarker) {\n                return;\n            }\n            const { orientationWidget } = orientationMarker;\n            orientationWidget.updateViewport();\n        };\n        this.orientationMarkers = {};\n        this.updatingOrientationMarker = {};\n    }\n    _unsubscribeToViewportNewVolumeSet() {\n        const unsubscribe = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n                const { element } = viewport;\n                element.removeEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this.initViewports.bind(this));\n                const resizeObserver = this._resizeObservers.get(viewportId);\n                resizeObserver.unobserve(element);\n            });\n        };\n        eventTarget.removeEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, (evt) => {\n            if (evt.detail.toolGroupId !== this.toolGroupId) {\n                return;\n            }\n            unsubscribe();\n            this.initViewports();\n        });\n    }\n    _subscribeToViewportEvents() {\n        const subscribeToElementResize = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n                const { element } = viewport;\n                this.initViewports();\n                element.addEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this.initViewports.bind(this));\n                const resizeObserver = new ResizeObserver(() => {\n                    setTimeout(() => {\n                        const element = getEnabledElementByIds(viewportId, renderingEngineId);\n                        if (!element) {\n                            return;\n                        }\n                        const { viewport } = element;\n                        this.resize(viewportId);\n                        viewport.render();\n                    }, 100);\n                });\n                resizeObserver.observe(element);\n                this._resizeObservers.set(viewportId, resizeObserver);\n            });\n        };\n        subscribeToElementResize();\n        eventTarget.addEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, (evt) => {\n            if (evt.detail.toolGroupId !== this.toolGroupId) {\n                return;\n            }\n            subscribeToElementResize();\n            this.initViewports();\n        });\n    }\n    cleanUpData() {\n        const renderingEngines = getRenderingEngines();\n        const renderingEngine = renderingEngines[0];\n        const viewports = renderingEngine.getViewports();\n        viewports.forEach((viewport) => {\n            const orientationMarker = this.orientationMarkers[viewport.id];\n            if (!orientationMarker) {\n                return;\n            }\n            const { actor, orientationWidget } = orientationMarker;\n            orientationWidget?.setEnabled(false);\n            orientationWidget?.delete();\n            actor?.delete();\n            const renderWindow = viewport\n                .getRenderingEngine()\n                .offscreenMultiRenderWindow.getRenderWindow();\n            renderWindow.render();\n            viewport.getRenderingEngine().render();\n            delete this.orientationMarkers[viewport.id];\n        });\n    }\n    initViewports() {\n        const renderingEngines = getRenderingEngines();\n        const renderingEngine = renderingEngines[0];\n        if (!renderingEngine) {\n            return;\n        }\n        let viewports = renderingEngine.getViewports();\n        viewports = filterViewportsWithToolEnabled(viewports, this.getToolName());\n        viewports.forEach((viewport) => {\n            const widget = viewport.getWidget(this.getToolName());\n            if (!widget || widget.isDeleted()) {\n                this.addAxisActorInViewport(viewport);\n            }\n        });\n    }\n    async addAxisActorInViewport(viewport) {\n        const viewportId = viewport.id;\n        if (!this.updatingOrientationMarker[viewportId]) {\n            this.updatingOrientationMarker[viewportId] = true;\n            const type = this.configuration.overlayMarkerType;\n            const overlayConfiguration = this.configuration.overlayConfiguration[type];\n            if (this.orientationMarkers[viewportId]) {\n                const { actor, orientationWidget } = this.orientationMarkers[viewportId];\n                viewport.getRenderer().removeActor(actor);\n                orientationWidget.setEnabled(false);\n            }\n            let actor;\n            if (type === 1) {\n                actor = this.createAnnotationCube(overlayConfiguration);\n            }\n            else if (type === 2) {\n                actor = vtkAxesActor.newInstance();\n            }\n            else if (type === 3) {\n                actor = await this.createCustomActor();\n            }\n            const renderer = viewport.getRenderer();\n            const renderWindow = viewport\n                .getRenderingEngine()\n                .offscreenMultiRenderWindow.getRenderWindow();\n            const { enabled, viewportCorner, viewportSize, minPixelSize, maxPixelSize, } = this.configuration.orientationWidget;\n            const orientationWidget = vtkOrientationMarkerWidget.newInstance({\n                actor,\n                interactor: renderWindow.getInteractor(),\n                parentRenderer: renderer,\n            });\n            orientationWidget.setEnabled(enabled);\n            orientationWidget.setViewportCorner(viewportCorner);\n            orientationWidget.setViewportSize(viewportSize);\n            orientationWidget.setMinPixelSize(minPixelSize);\n            orientationWidget.setMaxPixelSize(maxPixelSize);\n            orientationWidget.updateMarkerOrientation();\n            this.orientationMarkers[viewportId] = {\n                orientationWidget,\n                actor,\n            };\n            viewport.addWidget(this.getToolName(), orientationWidget);\n            renderWindow.render();\n            viewport.getRenderingEngine().render();\n            this.updatingOrientationMarker[viewportId] = false;\n        }\n    }\n    async createCustomActor() {\n        const url = this.configuration.overlayConfiguration[OverlayMarkerType.CUSTOM]\n            .polyDataURL;\n        const response = await fetch(url);\n        const arrayBuffer = await response.arrayBuffer();\n        const vtpReader = vtkXMLPolyDataReader.newInstance();\n        vtpReader.parseAsArrayBuffer(arrayBuffer);\n        vtpReader.update();\n        const polyData = vtkPolyData.newInstance();\n        polyData.shallowCopy(vtpReader.getOutputData());\n        polyData.getPointData().setActiveScalars('Color');\n        const mapper = vtkMapper.newInstance();\n        mapper.setInputData(polyData);\n        mapper.setColorModeToDirectScalars();\n        const actor = vtkActor.newInstance();\n        actor.setMapper(mapper);\n        actor.rotateZ(180);\n        return actor;\n    }\n    createAnnotationCube(overlayConfiguration) {\n        const actor = vtkAnnotatedCubeActor.newInstance();\n        actor.setDefaultStyle({ ...overlayConfiguration.defaultStyle });\n        actor.setXPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.xPlus,\n        });\n        actor.setXMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.xMinus,\n        });\n        actor.setYPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.yPlus,\n        });\n        actor.setYMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.yMinus,\n        });\n        actor.setZPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.zPlus,\n        });\n        actor.setZMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.zMinus,\n        });\n        return actor;\n    }\n    async createAnnotatedCubeActor() {\n        const axes = vtkAnnotatedCubeActor.newInstance();\n        const { faceProperties, defaultStyle } = this.configuration.annotatedCube;\n        axes.setDefaultStyle(defaultStyle);\n        Object.keys(faceProperties).forEach((key) => {\n            const methodName = `set${key.charAt(0).toUpperCase() + key.slice(1)}FaceProperty`;\n            axes[methodName](faceProperties[key]);\n        });\n        return axes;\n    }\n}\nOrientationMarkerTool.toolName = 'OrientationMarker';\nexport default OrientationMarkerTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { triggerSegmentationModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getActiveSegmentation } from '../../stateManagement/segmentation/activeSegmentation';\nimport RepresentationTypes from '../../enums/SegmentationRepresentations';\nimport { setActiveSegmentIndex } from '../../stateManagement/segmentation/segmentIndex';\nimport { getHoveredContourSegmentationAnnotation, getSegmentIndexAtLabelmapBorder, getSegmentIndexAtWorldPoint, } from '../../utilities/segmentation';\nimport { state } from '../../store/state';\nimport SegmentationRepresentations from '../../enums/SegmentationRepresentations';\nclass SegmentSelectTool extends BaseTool {\n    static { this.SelectMode = {\n        Inside: 'Inside',\n        Border: 'Border',\n    }; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            hoverTimeout: 100,\n            mode: SegmentSelectTool.SelectMode.Border,\n            searchRadius: 6,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.mouseMoveCallback = (evt) => {\n            if (this.hoverTimer) {\n                clearTimeout(this.hoverTimer);\n            }\n            this.hoverTimer = setTimeout(() => {\n                this._setActiveSegment(evt);\n                this.hoverTimer = null;\n            }, this.configuration.hoverTimeout);\n            return true;\n        };\n        this.onSetToolEnabled = () => {\n            this.onSetToolActive();\n        };\n        this.onSetToolActive = () => {\n            this.hoverTimer = null;\n        };\n        this.onSetToolDisabled = () => {\n            this.hoverTimer = null;\n        };\n        this.hoverTimer = null;\n    }\n    _setActiveSegment(evt = {}) {\n        if (state.isInteractingWithTool) {\n            return;\n        }\n        const { element, currentPoints } = evt.detail;\n        const worldPoint = currentPoints.world;\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const activeSegmentation = getActiveSegmentation(viewport.id);\n        if (!activeSegmentation) {\n            return;\n        }\n        this._setActiveSegmentForType(activeSegmentation, worldPoint, viewport);\n    }\n    _setActiveSegmentForType(activeSegmentation, worldPoint, viewport) {\n        const imageDataInfo = viewport.getImageData();\n        if (!imageDataInfo) {\n            return;\n        }\n        const { segmentationId, representationData } = activeSegmentation;\n        let hoveredSegmentIndex;\n        if (this.configuration.mode === SegmentSelectTool.SelectMode.Inside) {\n            hoveredSegmentIndex = getSegmentIndexAtWorldPoint(segmentationId, worldPoint, {\n                viewport,\n            });\n        }\n        else {\n            if (representationData.Labelmap) {\n                hoveredSegmentIndex = getSegmentIndexAtLabelmapBorder(segmentationId, worldPoint, {\n                    viewport,\n                    searchRadius: this.configuration.searchRadius,\n                });\n            }\n            else if (representationData.Contour) {\n                hoveredSegmentIndex =\n                    getHoveredContourSegmentationAnnotation(segmentationId);\n            }\n            else if (representationData.Surface) {\n            }\n        }\n        if (!hoveredSegmentIndex || hoveredSegmentIndex === 0) {\n            return;\n        }\n        setActiveSegmentIndex(segmentationId, hoveredSegmentIndex);\n        const renderingEngine = viewport.getRenderingEngine();\n        const viewportIds = renderingEngine.getViewports().map((v) => v.id);\n        triggerSegmentationModified(segmentationId);\n        triggerAnnotationRenderForViewportIds(viewportIds);\n    }\n}\nSegmentSelectTool.toolName = 'SegmentSelectTool';\nexport default SegmentSelectTool;\n","import { vec3, vec2 } from 'gl-matrix';\nimport { getEnabledElement, triggerEvent, eventTarget, utilities as csUtils, cache, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { drawHandles as drawHandlesSvg, drawRedactionRect as drawRedactionRectSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as rectangle from '../../utilities/math/rectangle';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nclass VideoRedactionTool extends AnnotationTool {\n    constructor(toolConfiguration = {}) {\n        super(toolConfiguration, {\n            supportedInteractionTypes: ['Mouse', 'Touch'],\n            configuration: { shadow: true, preventHandleOutsideImage: false },\n        });\n        this.addNewAnnotation = (evt) => {\n            const eventData = evt.detail;\n            const { currentPoints, element } = eventData;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                metadata: {\n                    viewPlaneNormal: [0, 0, 1],\n                    viewUp: [0, 1, 0],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                },\n                data: {\n                    invalidated: true,\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    active: true,\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            return annotation;\n        };\n        this.getHandleNearImagePoint = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            for (let i = 0; i < points.length; i++) {\n                const point = points[i];\n                const toolDataCanvasCoordinate = viewport.worldToCanvas(point);\n                const near = vec2.distance(canvasCoords, toolDataCanvasCoordinate) < proximity;\n                if (near === true) {\n                    data.handles.activeHandleIndex = i;\n                    return point;\n                }\n            }\n            data.handles.activeHandleIndex = null;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasPoint1 = viewport.worldToCanvas(points[0]);\n            const canvasPoint2 = viewport.worldToCanvas(points[3]);\n            const rect = this._getRectangleImageCoordinates([\n                canvasPoint1,\n                canvasPoint2,\n            ]);\n            const point = [canvasCoords[0], canvasCoords[1]];\n            const { left, top, width, height } = rect;\n            const distanceToPoint = rectangle.distanceToPoint([left, top, width, height], point);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType = 'mouse') => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { data } = annotation;\n            data.active = true;\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle, interactionType = 'mouse') => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { data } = annotation;\n            data.active = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n                handleIndex,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            evt.preventDefault();\n        };\n        this._mouseUpCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { annotation, viewportUIDsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.active = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        };\n        this._mouseDragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { annotation, viewportUIDsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            if (handleIndex === undefined) {\n                const { deltaPoints } = eventData;\n                const worldPosDelta = deltaPoints.world;\n                const { points } = data.handles;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                data.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventData;\n                const enabledElement = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n                const worldPos = currentPoints.world;\n                const { points } = data.handles;\n                points[handleIndex] = [...worldPos];\n                let bottomLeftCanvas;\n                let bottomRightCanvas;\n                let topLeftCanvas;\n                let topRightCanvas;\n                let bottomLeftWorld;\n                let bottomRightWorld;\n                let topLeftWorld;\n                let topRightWorld;\n                switch (handleIndex) {\n                    case 0:\n                    case 3:\n                        bottomLeftCanvas = worldToCanvas(points[0]);\n                        topRightCanvas = worldToCanvas(points[3]);\n                        bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                        topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                        bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                        topLeftWorld = canvasToWorld(topLeftCanvas);\n                        points[1] = bottomRightWorld;\n                        points[2] = topLeftWorld;\n                        break;\n                    case 1:\n                    case 2:\n                        bottomRightCanvas = worldToCanvas(points[1]);\n                        topLeftCanvas = worldToCanvas(points[2]);\n                        bottomLeftCanvas = [\n                            topLeftCanvas[0],\n                            bottomRightCanvas[1],\n                        ];\n                        topRightCanvas = [\n                            bottomRightCanvas[0],\n                            topLeftCanvas[1],\n                        ];\n                        bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                        topRightWorld = canvasToWorld(topRightCanvas);\n                        points[0] = bottomLeftWorld;\n                        points[3] = topRightWorld;\n                        break;\n                }\n                data.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID } = annotation;\n                const toolMetadata = annotation.metadata;\n                const data = annotation.data;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return;\n                }\n                let activeHandleCanvasCoords;\n                if (!this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const rectangleUID = '0';\n                drawRedactionRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color: 'black',\n                    lineDash,\n                    lineWidth,\n                });\n            }\n        };\n        this._getRectangleImageCoordinates = (points) => {\n            const [point0, point1] = points;\n            return {\n                left: Math.min(point0[0], point1[0]),\n                top: Math.min(point0[1], point1[1]),\n                width: Math.abs(point0[0] - point1[0]),\n                height: Math.abs(point0[1] - point1[1]),\n            };\n        };\n        this._calculateCachedStats = (annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { viewportUID, renderingEngineUID, sceneUID } = enabledElement;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetUIDs = Object.keys(cachedStats);\n            for (let i = 0; i < targetUIDs.length; i++) {\n                const targetUID = targetUIDs[i];\n                const { imageVolume } = this._getImageVolumeFromTargetUID(targetUID, renderingEngine);\n                const { dimensions, scalarData, vtkImageData: imageData, metadata, } = imageVolume;\n                const worldPos1Index = vec3.fromValues(0, 0, 0);\n                const worldPos2Index = vec3.fromValues(0, 0, 0);\n                imageData.worldToIndexVec3(worldPos1, worldPos1Index);\n                worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n                worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n                worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n                imageData.worldToIndexVec3(worldPos2, worldPos2Index);\n                worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n                worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n                worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n                if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                    this.isHandleOutsideImage = false;\n                    const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                    const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                    const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                    const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                    const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                    const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const area = worldWidth * worldHeight;\n                    let count = 0;\n                    let mean = 0;\n                    let stdDev = 0;\n                    const yMultiple = dimensions[0];\n                    const zMultiple = dimensions[0] * dimensions[1];\n                    for (let k = kMin; k <= kMax; k++) {\n                        for (let j = jMin; j <= jMax; j++) {\n                            for (let i = iMin; i <= iMax; i++) {\n                                const value = scalarData[k * zMultiple + j * yMultiple + i];\n                                count++;\n                                mean += value;\n                            }\n                        }\n                    }\n                    mean /= count;\n                    for (let k = kMin; k <= kMax; k++) {\n                        for (let j = jMin; j <= jMax; j++) {\n                            for (let i = iMin; i <= iMax; i++) {\n                                const value = scalarData[k * zMultiple + j * yMultiple + i];\n                                const valueMinusMean = value - mean;\n                                stdDev += valueMinusMean * valueMinusMean;\n                            }\n                        }\n                    }\n                    stdDev /= count;\n                    stdDev = Math.sqrt(stdDev);\n                    cachedStats[targetUID] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean,\n                        stdDev,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetUID] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            data.invalidated = false;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportUID,\n                renderingEngineUID,\n                sceneUID: sceneUID,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._getTargetVolumeUID = (scene) => {\n            if (this.configuration.volumeUID) {\n                return this.configuration.volumeUID;\n            }\n            const volumeActors = scene.getVolumeActors();\n            if (!volumeActors && !volumeActors.length) {\n                return;\n            }\n            return volumeActors[0].uid;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    cancel(element) {\n        if (!this.isDrawing) {\n            return;\n        }\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const { annotation, viewportUIDsToRender } = this.editData;\n        const { data } = annotation;\n        data.active = false;\n        data.handles.activeHandleIndex = null;\n        triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        this.editData = null;\n        return annotation.metadata.annotationUID;\n    }\n    _getImageVolumeFromTargetUID(targetUID, renderingEngine) {\n        let imageVolume, viewport;\n        if (targetUID.startsWith('stackTarget')) {\n            const coloneIndex = targetUID.indexOf(':');\n            const viewportUID = targetUID.substring(coloneIndex + 1);\n            const viewport = renderingEngine.getViewport(viewportUID);\n            imageVolume = viewport.getImageData();\n        }\n        else {\n            imageVolume = cache.getVolume(targetUID);\n        }\n        return { imageVolume, viewport };\n    }\n    _getTargetStackUID(viewport) {\n        return `stackTarget:${viewport.uid}`;\n    }\n}\nVideoRedactionTool.toolName = 'VideoRedaction';\nexport default VideoRedactionTool;\n","import { getEnabledElement, triggerEvent, getRenderingEngine, } from '@cornerstonejs/core';\nimport { Events, ToolModes } from '../../enums';\nimport { draw as drawSvg } from '../../drawingSvg';\nimport getToolsWithModesForElement from '../../utilities/getToolsWithModesForElement';\nconst { Active, Passive, Enabled } = ToolModes;\nclass AnnotationRenderingEngine {\n    constructor() {\n        this._needsRender = new Set();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._renderFlaggedViewports = () => {\n            this._throwIfDestroyed();\n            const elements = Array.from(this._viewportElements.values());\n            for (let i = 0; i < elements.length; i++) {\n                const element = elements[i];\n                if (this._needsRender.has(element)) {\n                    this._triggerRender(element);\n                    this._needsRender.delete(element);\n                    if (this._needsRender.size === 0) {\n                        break;\n                    }\n                }\n            }\n            this._animationFrameSet = false;\n            this._animationFrameHandle = null;\n            this._render();\n        };\n        this._viewportElements = new Map();\n    }\n    addViewportElement(viewportId, element) {\n        this._viewportElements.set(viewportId, element);\n    }\n    removeViewportElement(viewportId, element) {\n        this._viewportElements.delete(viewportId);\n        this._needsRender.delete(element);\n        this._reset();\n    }\n    renderViewport(element) {\n        this._setViewportsToBeRenderedNextFrame([element]);\n    }\n    _throwIfDestroyed() {\n        if (this.hasBeenDestroyed) {\n            throw new Error('this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.');\n        }\n    }\n    _setAllViewportsToBeRenderedNextFrame() {\n        const elements = [...this._viewportElements.values()];\n        elements.forEach((element) => {\n            this._needsRender.add(element);\n        });\n        this._renderFlaggedViewports();\n    }\n    _setViewportsToBeRenderedNextFrame(elements) {\n        const elementsEnabled = [...this._viewportElements.values()];\n        elements.forEach((element) => {\n            if (elementsEnabled.indexOf(element) !== -1) {\n                this._needsRender.add(element);\n            }\n        });\n        this._render();\n    }\n    _render() {\n        if (this._needsRender.size > 0 && this._animationFrameSet === false) {\n            this._animationFrameHandle = window.requestAnimationFrame(this._renderFlaggedViewports);\n            this._animationFrameSet = true;\n        }\n    }\n    _triggerRender(element) {\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        const renderingEngine = getRenderingEngine(enabledElement.renderingEngineId);\n        if (!renderingEngine) {\n            console.warn('rendering Engine has been destroyed');\n            return;\n        }\n        const enabledTools = getToolsWithModesForElement(element, [\n            Active,\n            Passive,\n            Enabled,\n        ]);\n        const { renderingEngineId, viewportId } = enabledElement;\n        const eventDetail = {\n            element,\n            renderingEngineId,\n            viewportId,\n        };\n        drawSvg(element, (svgDrawingHelper) => {\n            let anyRendered = false;\n            const handleDrawSvg = (tool) => {\n                if (tool.renderAnnotation) {\n                    const rendered = tool.renderAnnotation(enabledElement, svgDrawingHelper);\n                    anyRendered = anyRendered || rendered;\n                }\n            };\n            enabledTools.forEach(handleDrawSvg);\n            if (anyRendered) {\n                triggerEvent(element, Events.ANNOTATION_RENDERED, { ...eventDetail });\n            }\n        });\n    }\n    _reset() {\n        window.cancelAnimationFrame(this._animationFrameHandle);\n        this._needsRender.clear();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._setAllViewportsToBeRenderedNextFrame();\n    }\n}\nconst annotationRenderingEngine = new AnnotationRenderingEngine();\nexport { annotationRenderingEngine };\n","import { Enums, eventTarget, getEnabledElement, utilities, } from '@cornerstonejs/core';\nclass FrameOfReferenceSpecificAnnotationManager {\n    constructor(uid) {\n        this.getGroupKey = (annotationGroupSelector) => {\n            if (typeof annotationGroupSelector === 'string') {\n                return annotationGroupSelector;\n            }\n            const element = annotationGroupSelector;\n            const enabledElement = getEnabledElement(element);\n            if (!enabledElement) {\n                throw new Error('Element not enabled, you must have an enabled element if you are not providing a FrameOfReferenceUID');\n            }\n            return enabledElement.FrameOfReferenceUID;\n        };\n        this._imageVolumeModifiedHandler = (evt) => {\n            const eventDetail = evt.detail;\n            const { FrameOfReferenceUID } = eventDetail;\n            const annotations = this.annotations;\n            const frameOfReferenceSpecificAnnotations = annotations[FrameOfReferenceUID];\n            if (!frameOfReferenceSpecificAnnotations) {\n                return;\n            }\n            Object.keys(frameOfReferenceSpecificAnnotations).forEach((toolName) => {\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                toolSpecificAnnotations.forEach((annotation) => {\n                    const invalidated = annotation.invalidated;\n                    if (invalidated !== undefined) {\n                        annotation.invalidated = true;\n                    }\n                });\n            });\n        };\n        this.getFramesOfReference = () => {\n            return Object.keys(this.annotations);\n        };\n        this.getAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (!annotations[groupKey]) {\n                return [];\n            }\n            if (toolName) {\n                return annotations[groupKey][toolName]\n                    ? annotations[groupKey][toolName]\n                    : [];\n            }\n            return annotations[groupKey];\n        };\n        this.getAnnotation = (annotationUID) => {\n            const annotations = this.annotations;\n            for (const frameOfReferenceUID in annotations) {\n                const frameOfReferenceAnnotations = annotations[frameOfReferenceUID];\n                for (const toolName in frameOfReferenceAnnotations) {\n                    const toolSpecificAnnotations = frameOfReferenceAnnotations[toolName];\n                    for (const annotation of toolSpecificAnnotations) {\n                        if (annotationUID === annotation.annotationUID) {\n                            return annotation;\n                        }\n                    }\n                }\n            }\n        };\n        this.getNumberOfAnnotations = (groupKey, toolName) => {\n            const annotations = this.getAnnotations(groupKey, toolName);\n            if (!annotations.length) {\n                return 0;\n            }\n            if (toolName) {\n                return annotations.length;\n            }\n            let total = 0;\n            for (const toolName in annotations) {\n                total += annotations[toolName].length;\n            }\n            return total;\n        };\n        this.addAnnotation = (annotation, groupKey) => {\n            const { metadata } = annotation;\n            const { FrameOfReferenceUID, toolName } = metadata;\n            groupKey = groupKey || FrameOfReferenceUID;\n            const annotations = this.annotations;\n            let frameOfReferenceSpecificAnnotations = annotations[groupKey];\n            if (!frameOfReferenceSpecificAnnotations) {\n                annotations[groupKey] = {};\n                frameOfReferenceSpecificAnnotations = annotations[groupKey];\n            }\n            let toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n            if (!toolSpecificAnnotations) {\n                frameOfReferenceSpecificAnnotations[toolName] = [];\n                toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n            }\n            if (this.preprocessingFn) {\n                annotation = this.preprocessingFn(annotation);\n            }\n            toolSpecificAnnotations.push(annotation);\n        };\n        this.removeAnnotation = (annotationUID) => {\n            const { annotations } = this;\n            for (const groupKey in annotations) {\n                const groupAnnotations = annotations[groupKey];\n                for (const toolName in groupAnnotations) {\n                    const toolAnnotations = groupAnnotations[toolName];\n                    const index = toolAnnotations.findIndex((annotation) => annotation.annotationUID === annotationUID);\n                    if (index !== -1) {\n                        toolAnnotations.splice(index, 1);\n                        if (toolAnnotations.length === 0) {\n                            delete groupAnnotations[toolName];\n                        }\n                    }\n                }\n                if (Object.keys(groupAnnotations).length === 0) {\n                    delete annotations[groupKey];\n                }\n            }\n        };\n        this.removeAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            const removedAnnotations = [];\n            if (!annotations[groupKey]) {\n                return removedAnnotations;\n            }\n            if (toolName) {\n                const annotationsForTool = annotations[groupKey][toolName];\n                for (const annotation of annotationsForTool) {\n                    this.removeAnnotation(annotation.annotationUID);\n                    removedAnnotations.push(annotation);\n                }\n            }\n            else {\n                for (const toolName in annotations[groupKey]) {\n                    const annotationsForTool = annotations[groupKey][toolName];\n                    for (const annotation of annotationsForTool) {\n                        this.removeAnnotation(annotation.annotationUID);\n                        removedAnnotations.push(annotation);\n                    }\n                }\n            }\n            return removedAnnotations;\n        };\n        this.saveAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (groupKey && toolName) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                if (!frameOfReferenceSpecificAnnotations) {\n                    return;\n                }\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                return structuredClone(toolSpecificAnnotations);\n            }\n            else if (groupKey) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                return structuredClone(frameOfReferenceSpecificAnnotations);\n            }\n            return structuredClone(annotations);\n        };\n        this.restoreAnnotations = (state, groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (groupKey && toolName) {\n                let frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                if (!frameOfReferenceSpecificAnnotations) {\n                    annotations[groupKey] = {};\n                    frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                }\n                frameOfReferenceSpecificAnnotations[toolName] = state;\n            }\n            else if (groupKey) {\n                annotations[groupKey] = state;\n            }\n            else {\n                this.annotations = structuredClone(state);\n            }\n        };\n        this.getAllAnnotations = () => {\n            return Object.values(this.annotations)\n                .map((frameOfReferenceSpecificAnnotations) => Object.values(frameOfReferenceSpecificAnnotations))\n                .flat(2);\n        };\n        this.getNumberOfAllAnnotations = () => {\n            let count = 0;\n            const annotations = this.annotations;\n            for (const groupKey in annotations) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                for (const toolName in frameOfReferenceSpecificAnnotations) {\n                    const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                    count += toolSpecificAnnotations.length;\n                }\n            }\n            return count;\n        };\n        this.removeAllAnnotations = () => {\n            const removedAnnotations = [];\n            for (const annotation of this.getAllAnnotations()) {\n                this.removeAnnotation(annotation.annotationUID);\n                removedAnnotations.push(annotation);\n            }\n            return removedAnnotations;\n        };\n        if (!uid) {\n            uid = utilities.uuidv4();\n        }\n        this.annotations = {};\n        this.uid = uid;\n        eventTarget.addEventListener(Enums.Events.IMAGE_VOLUME_MODIFIED, this._imageVolumeModifiedHandler);\n    }\n    setPreprocessingFn(preprocessingFn) {\n        this.preprocessingFn = preprocessingFn;\n    }\n}\nconst defaultFrameOfReferenceSpecificAnnotationManager = new FrameOfReferenceSpecificAnnotationManager('DEFAULT');\nexport { defaultFrameOfReferenceSpecificAnnotationManager };\nexport default FrameOfReferenceSpecificAnnotationManager;\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { getAnnotation } from './getAnnotation';\nconst globalLockedAnnotationUIDsSet = new Set();\nfunction setAnnotationLocked(annotationUID, locked = true) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (locked) {\n            lock(annotationUID, globalLockedAnnotationUIDsSet, detail);\n        }\n        else {\n            unlock(annotationUID, globalLockedAnnotationUIDsSet, detail);\n        }\n    }\n    publish(detail, globalLockedAnnotationUIDsSet);\n}\nfunction unlockAllAnnotations() {\n    const detail = makeEventDetail();\n    clearLockedAnnotationsSet(globalLockedAnnotationUIDsSet, detail);\n    publish(detail, globalLockedAnnotationUIDsSet);\n}\nfunction getAnnotationsLocked() {\n    return Array.from(globalLockedAnnotationUIDsSet);\n}\nfunction isAnnotationLocked(annotationUID) {\n    return globalLockedAnnotationUIDsSet.has(annotationUID);\n}\nfunction getAnnotationsLockedCount() {\n    return globalLockedAnnotationUIDsSet.size;\n}\nfunction checkAndSetAnnotationLocked(annotationUID) {\n    const isLocked = isAnnotationLocked(annotationUID);\n    setAnnotationLocked(annotationUID, isLocked);\n    return isLocked;\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        added: [],\n        removed: [],\n        locked: [],\n    });\n}\nfunction lock(annotationUID, lockedAnnotationUIDsSet, detail) {\n    if (!lockedAnnotationUIDsSet.has(annotationUID)) {\n        lockedAnnotationUIDsSet.add(annotationUID);\n        detail.added.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isLocked = true;\n        }\n    }\n}\nfunction unlock(annotationUID, lockedAnnotationUIDsSet, detail) {\n    if (lockedAnnotationUIDsSet.delete(annotationUID)) {\n        detail.removed.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isLocked = false;\n        }\n    }\n}\nfunction clearLockedAnnotationsSet(lockedAnnotationUIDsSet, detail) {\n    lockedAnnotationUIDsSet.forEach((annotationUID) => {\n        unlock(annotationUID, lockedAnnotationUIDsSet, detail);\n    });\n}\nfunction publish(detail, lockedAnnotationUIDsSet) {\n    if (detail.added.length > 0 || detail.removed.length > 0) {\n        lockedAnnotationUIDsSet.forEach((item) => void detail.locked.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_LOCK_CHANGE, detail);\n    }\n}\nexport { setAnnotationLocked, getAnnotationsLocked, getAnnotationsLockedCount, unlockAllAnnotations, isAnnotationLocked, checkAndSetAnnotationLocked, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { getAnnotation } from './getAnnotation';\nconst selectedAnnotationUIDs = new Set();\nfunction setAnnotationSelected(annotationUID, selected = true, preserveSelected = false) {\n    if (selected) {\n        selectAnnotation(annotationUID, preserveSelected);\n    }\n    else {\n        deselectAnnotation(annotationUID);\n    }\n}\nfunction selectAnnotation(annotationUID, preserveSelected = false) {\n    const detail = makeEventDetail();\n    if (!preserveSelected) {\n        clearSelectionSet(selectedAnnotationUIDs, detail);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isSelected = true;\n        }\n    }\n    if (annotationUID && !selectedAnnotationUIDs.has(annotationUID)) {\n        selectedAnnotationUIDs.add(annotationUID);\n        detail.added.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isSelected = true;\n        }\n    }\n    publish(detail, selectedAnnotationUIDs);\n}\nfunction deselectAnnotation(annotationUID) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (selectedAnnotationUIDs.delete(annotationUID)) {\n            detail.removed.push(annotationUID);\n            const annotation = getAnnotation(annotationUID);\n            annotation.isSelected = false;\n        }\n    }\n    else {\n        clearSelectionSet(selectedAnnotationUIDs, detail);\n    }\n    publish(detail, selectedAnnotationUIDs);\n}\nfunction getAnnotationsSelected() {\n    return Array.from(selectedAnnotationUIDs);\n}\nfunction getAnnotationsSelectedByToolName(toolName) {\n    return getAnnotationsSelected().filter((annotationUID) => {\n        const annotation = getAnnotation(annotationUID);\n        return annotation?.metadata?.toolName === toolName;\n    });\n}\nfunction isAnnotationSelected(annotationUID) {\n    return selectedAnnotationUIDs.has(annotationUID);\n}\nfunction getAnnotationsSelectedCount() {\n    return selectedAnnotationUIDs.size;\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        added: [],\n        removed: [],\n        selection: [],\n    });\n}\nfunction clearSelectionSet(selectionSet, detail) {\n    selectionSet.forEach((value) => {\n        if (selectionSet.delete(value)) {\n            detail.removed.push(value);\n            const annotation = getAnnotation(value);\n            if (annotation) {\n                annotation.isSelected = false;\n            }\n        }\n    });\n}\nfunction publish(detail, selectionSet) {\n    if (detail.added.length > 0 || detail.removed.length > 0) {\n        selectionSet.forEach((item) => void detail.selection.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_SELECTION_CHANGE, detail);\n    }\n}\nexport { setAnnotationSelected, getAnnotationsSelected, getAnnotationsSelectedByToolName, getAnnotationsSelectedCount, deselectAnnotation, isAnnotationSelected, };\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { defaultFrameOfReferenceSpecificAnnotationManager } from './FrameOfReferenceSpecificAnnotationManager';\nimport { getAnnotation } from './getAnnotation';\nimport { triggerAnnotationAddedForElement, triggerAnnotationAddedForFOR, triggerAnnotationRemoved, } from './helpers/state';\nimport { checkAndSetAnnotationLocked } from './annotationLocking';\nimport { checkAndDefineCachedStatsProperty, checkAndDefineTextBoxProperty, } from './utilities/defineProperties';\nimport { checkAndSetAnnotationVisibility } from './annotationVisibility';\nlet defaultManager = defaultFrameOfReferenceSpecificAnnotationManager;\nconst preprocessingFn = (annotation) => {\n    annotation = checkAndDefineTextBoxProperty(annotation);\n    annotation = checkAndDefineCachedStatsProperty(annotation);\n    const uid = annotation.annotationUID;\n    const isLocked = checkAndSetAnnotationLocked(uid);\n    annotation.isLocked = isLocked;\n    const isVisible = checkAndSetAnnotationVisibility(uid);\n    annotation.isVisible = isVisible;\n    return annotation;\n};\ndefaultManager.setPreprocessingFn(preprocessingFn);\nfunction getAnnotationManager() {\n    return defaultManager;\n}\nfunction setAnnotationManager(annotationManager) {\n    defaultManager = annotationManager;\n}\nfunction resetAnnotationManager() {\n    defaultManager = defaultFrameOfReferenceSpecificAnnotationManager;\n}\nfunction getAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    return manager.getAnnotations(groupKey, toolName);\n}\nfunction getAllAnnotations() {\n    const manager = getAnnotationManager();\n    return manager.getAllAnnotations();\n}\nfunction clearParentAnnotation(annotation) {\n    const { annotationUID: childUID, parentAnnotationUID } = annotation;\n    if (!parentAnnotationUID) {\n        return;\n    }\n    const parentAnnotation = getAnnotation(parentAnnotationUID);\n    const childUIDIndex = parentAnnotation.childAnnotationUIDs.indexOf(childUID);\n    parentAnnotation.childAnnotationUIDs.splice(childUIDIndex, 1);\n    annotation.parentAnnotationUID = undefined;\n}\nfunction addChildAnnotation(parentAnnotation, childAnnotation) {\n    const { annotationUID: parentUID } = parentAnnotation;\n    const { annotationUID: childUID } = childAnnotation;\n    clearParentAnnotation(childAnnotation);\n    if (!parentAnnotation.childAnnotationUIDs) {\n        parentAnnotation.childAnnotationUIDs = [];\n    }\n    if (parentAnnotation.childAnnotationUIDs.includes(childUID)) {\n        return;\n    }\n    parentAnnotation.childAnnotationUIDs.push(childUID);\n    childAnnotation.parentAnnotationUID = parentUID;\n}\nfunction getParentAnnotation(annotation) {\n    return annotation.parentAnnotationUID\n        ? getAnnotation(annotation.parentAnnotationUID)\n        : undefined;\n}\nfunction getChildAnnotations(annotation) {\n    return (annotation.childAnnotationUIDs?.map((childAnnotationUID) => getAnnotation(childAnnotationUID)) ?? []);\n}\nfunction addAnnotation(annotation, annotationGroupSelector) {\n    if (!annotation.annotationUID) {\n        annotation.annotationUID = csUtils.uuidv4();\n    }\n    const manager = getAnnotationManager();\n    if (annotationGroupSelector instanceof HTMLDivElement) {\n        const groupKey = manager.getGroupKey(annotationGroupSelector);\n        manager.addAnnotation(annotation, groupKey);\n        triggerAnnotationAddedForElement(annotation, annotationGroupSelector);\n    }\n    else {\n        manager.addAnnotation(annotation, undefined);\n        triggerAnnotationAddedForFOR(annotation);\n    }\n    return annotation.annotationUID;\n}\nfunction getNumberOfAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    return manager.getNumberOfAnnotations(groupKey, toolName);\n}\nfunction removeAnnotation(annotationUID) {\n    if (!annotationUID) {\n        return;\n    }\n    const manager = getAnnotationManager();\n    const annotation = manager.getAnnotation(annotationUID);\n    if (!annotation) {\n        return;\n    }\n    annotation.childAnnotationUIDs?.forEach((childAnnotationUID) => removeAnnotation(childAnnotationUID));\n    manager.removeAnnotation(annotationUID);\n    triggerAnnotationRemoved({ annotation, annotationManagerUID: manager.uid });\n}\nfunction removeAllAnnotations() {\n    const manager = getAnnotationManager();\n    const removedAnnotations = manager.removeAllAnnotations();\n    for (const annotation of removedAnnotations) {\n        triggerAnnotationRemoved({\n            annotation,\n            annotationManagerUID: manager.uid,\n        });\n    }\n}\nfunction removeAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    const removedAnnotations = manager.removeAnnotations(groupKey, toolName);\n    for (const annotation of removedAnnotations) {\n        triggerAnnotationRemoved({\n            annotation,\n            annotationManagerUID: manager.uid,\n        });\n    }\n}\nfunction invalidateAnnotation(annotation) {\n    let currAnnotation = annotation;\n    while (currAnnotation) {\n        currAnnotation.invalidated = true;\n        currAnnotation = currAnnotation.parentAnnotationUID\n            ? getAnnotation(currAnnotation.parentAnnotationUID)\n            : undefined;\n    }\n}\nexport { getAllAnnotations, getAnnotations, getParentAnnotation, getChildAnnotations, clearParentAnnotation, addChildAnnotation, getNumberOfAnnotations, addAnnotation, removeAnnotation, removeAnnotations, removeAllAnnotations, setAnnotationManager, getAnnotationManager, resetAnnotationManager, invalidateAnnotation, getAnnotation, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { isAnnotationSelected, deselectAnnotation, } from './annotationSelection';\nimport { getAnnotation } from './getAnnotation';\nconst globalHiddenAnnotationUIDsSet = new Set();\nfunction setAnnotationVisibility(annotationUID, visible = true) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (visible) {\n            show(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n        }\n        else {\n            hide(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n        }\n    }\n    publish(detail);\n}\nfunction showAllAnnotations() {\n    const detail = makeEventDetail();\n    globalHiddenAnnotationUIDsSet.forEach((annotationUID) => {\n        show(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n    });\n    publish(detail);\n}\nfunction isAnnotationVisible(annotationUID) {\n    const annotation = getAnnotation(annotationUID);\n    if (annotation) {\n        return !globalHiddenAnnotationUIDsSet.has(annotationUID);\n    }\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        lastVisible: [],\n        lastHidden: [],\n        hidden: [],\n    });\n}\nfunction show(annotationUID, annotationUIDsSet, detail) {\n    if (annotationUIDsSet.delete(annotationUID)) {\n        detail.lastVisible.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        annotation.isVisible = true;\n    }\n}\nfunction hide(annotationUID, annotationUIDsSet, detail) {\n    if (!annotationUIDsSet.has(annotationUID)) {\n        annotationUIDsSet.add(annotationUID);\n        if (isAnnotationSelected(annotationUID)) {\n            deselectAnnotation(annotationUID);\n        }\n        detail.lastHidden.push(annotationUID);\n    }\n}\nfunction publish(detail) {\n    if (detail.lastHidden.length > 0 || detail.lastVisible.length > 0) {\n        globalHiddenAnnotationUIDsSet.forEach((item) => void detail.hidden.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_VISIBILITY_CHANGE, detail);\n    }\n}\nfunction checkAndSetAnnotationVisibility(annotationUID) {\n    const isVisible = !globalHiddenAnnotationUIDsSet.has(annotationUID);\n    setAnnotationVisibility(annotationUID, isVisible);\n    return isVisible;\n}\nexport { setAnnotationVisibility, showAllAnnotations, isAnnotationVisible, checkAndSetAnnotationVisibility, };\n","class ToolStyle {\n    constructor() {\n        const defaultConfig = {\n            color: 'rgb(255, 255, 0)',\n            colorHighlighted: 'rgb(0, 255, 0)',\n            colorSelected: 'rgb(0, 220, 0)',\n            colorLocked: 'rgb(209, 193, 90)',\n            lineWidth: '1',\n            lineDash: '',\n            shadow: true,\n            textBoxVisibility: true,\n            textBoxFontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n            textBoxFontSize: '14px',\n            textBoxColor: 'rgb(255, 255, 0)',\n            textBoxColorHighlighted: 'rgb(0, 255, 0)',\n            textBoxColorSelected: 'rgb(0, 255, 0)',\n            textBoxColorLocked: 'rgb(209, 193, 90)',\n            textBoxBackground: '',\n            textBoxLinkLineWidth: '1',\n            textBoxLinkLineDash: '2,3',\n            textBoxShadow: true,\n        };\n        this._initializeConfig(defaultConfig);\n    }\n    getAnnotationToolStyles(annotationUID) {\n        return this.config.annotations && this.config.annotations[annotationUID];\n    }\n    getViewportToolStyles(viewportId) {\n        return this.config.viewports && this.config.viewports[viewportId];\n    }\n    getToolGroupToolStyles(toolGroupId) {\n        return this.config.toolGroups && this.config.toolGroups[toolGroupId];\n    }\n    getDefaultToolStyles() {\n        return this.config.default;\n    }\n    setAnnotationStyles(annotationUID, styles) {\n        let annotationSpecificStyles = this.config.annotations;\n        if (!annotationSpecificStyles) {\n            this.config = {\n                ...this.config,\n                annotations: {},\n            };\n            annotationSpecificStyles = this.config.annotations;\n        }\n        annotationSpecificStyles[annotationUID] = styles;\n    }\n    setViewportToolStyles(viewportId, styles) {\n        let viewportSpecificStyles = this.config.viewports;\n        if (!viewportSpecificStyles) {\n            this.config = {\n                ...this.config,\n                viewports: {},\n            };\n            viewportSpecificStyles = this.config.viewports;\n        }\n        viewportSpecificStyles[viewportId] = styles;\n    }\n    setToolGroupToolStyles(toolGroupId, styles) {\n        let toolGroupSpecificStyles = this.config.toolGroups;\n        if (!toolGroupSpecificStyles) {\n            this.config = {\n                ...this.config,\n                toolGroups: {},\n            };\n            toolGroupSpecificStyles = this.config.toolGroups;\n        }\n        toolGroupSpecificStyles[toolGroupId] = styles;\n    }\n    setDefaultToolStyles(styles) {\n        this.config.default = styles;\n    }\n    getStyleProperty(toolStyle, specifications) {\n        const { annotationUID, viewportId, toolGroupId, toolName } = specifications;\n        return this._getToolStyle(toolStyle, annotationUID, viewportId, toolGroupId, toolName);\n    }\n    _getToolStyle(property, annotationUID, viewportId, toolGroupId, toolName) {\n        if (annotationUID) {\n            const annotationToolStyles = this.getAnnotationToolStyles(annotationUID);\n            if (annotationToolStyles) {\n                if (annotationToolStyles[property] !== undefined) {\n                    return annotationToolStyles[property];\n                }\n            }\n        }\n        if (viewportId) {\n            const viewportToolStyles = this.getViewportToolStyles(viewportId);\n            if (viewportToolStyles) {\n                if (viewportToolStyles[toolName] &&\n                    viewportToolStyles[toolName][property] !== undefined) {\n                    return viewportToolStyles[toolName][property];\n                }\n                if (viewportToolStyles.global &&\n                    viewportToolStyles.global[property] !== undefined) {\n                    return viewportToolStyles.global[property];\n                }\n            }\n        }\n        if (toolGroupId) {\n            const toolGroupToolStyles = this.getToolGroupToolStyles(toolGroupId);\n            if (toolGroupToolStyles) {\n                if (toolGroupToolStyles[toolName] &&\n                    toolGroupToolStyles[toolName][property] !== undefined) {\n                    return toolGroupToolStyles[toolName][property];\n                }\n                if (toolGroupToolStyles.global &&\n                    toolGroupToolStyles.global[property] !== undefined) {\n                    return toolGroupToolStyles.global[property];\n                }\n            }\n        }\n        const globalStyles = this.getDefaultToolStyles();\n        if (globalStyles[toolName] &&\n            globalStyles[toolName][property] !== undefined) {\n            return globalStyles[toolName][property];\n        }\n        if (globalStyles.global && globalStyles.global[property] !== undefined) {\n            return globalStyles.global[property];\n        }\n    }\n    _initializeConfig(config) {\n        const toolStyles = {};\n        for (const name in config) {\n            toolStyles[name] = config[name];\n        }\n        this.config = {\n            default: {\n                global: toolStyles,\n            },\n        };\n    }\n}\nconst toolStyle = new ToolStyle();\nexport default toolStyle;\n","import toolStyle from './ToolStyle';\nfunction getHierarchalPropertyStyles(property, state, mode) {\n    const list = [`${property}`];\n    if (state) {\n        list.push(`${list[0]}${state}`);\n    }\n    if (mode) {\n        list.push(`${list[list.length - 1]}${mode}`);\n    }\n    return list;\n}\nfunction getStyleProperty(property, styleSpecifier, state, mode) {\n    const alternatives = getHierarchalPropertyStyles(property, state, mode);\n    for (let i = alternatives.length - 1; i >= 0; --i) {\n        const style = toolStyle.getStyleProperty(alternatives[i], styleSpecifier);\n        if (style !== undefined) {\n            return style;\n        }\n    }\n}\nexport { getStyleProperty };\n","import { isAnnotationLocked } from '../annotationLocking';\nimport { isAnnotationSelected } from '../annotationSelection';\nimport { AnnotationStyleStates } from '../../../enums';\nfunction getState(annotation) {\n    if (annotation) {\n        if (annotation.data && annotation.highlighted) {\n            return AnnotationStyleStates.Highlighted;\n        }\n        if (isAnnotationSelected(annotation.annotationUID)) {\n            return AnnotationStyleStates.Selected;\n        }\n        if (isAnnotationLocked(annotation.annotationUID)) {\n            return AnnotationStyleStates.Locked;\n        }\n        if (annotation.data && annotation.autoGenerated) {\n            return AnnotationStyleStates.AutoGenerated;\n        }\n    }\n    return AnnotationStyleStates.Default;\n}\nexport default getState;\n","import { getStyleProperty } from './helpers';\nfunction getFont(styleSpecifier, state, mode) {\n    const fontSize = getStyleProperty('textBoxFontSize', styleSpecifier, state, mode);\n    const fontFamily = getStyleProperty('textBoxFontFamily', styleSpecifier, state, mode);\n    return `${fontSize}px ${fontFamily}`;\n}\nexport default getFont;\n","import { defaultFrameOfReferenceSpecificAnnotationManager } from './FrameOfReferenceSpecificAnnotationManager';\nexport function getAnnotation(annotationUID) {\n    const manager = defaultFrameOfReferenceSpecificAnnotationManager;\n    const annotation = manager.getAnnotation(annotationUID);\n    return annotation;\n}\n","import { getEnabledElement, triggerEvent, eventTarget, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { Events, ChangeTypes } from '../../../enums';\nimport { getToolGroupsWithToolName } from '../../../store/ToolGroupManager';\nfunction triggerAnnotationAddedForElement(annotation, element) {\n    const enabledElement = getEnabledElement(element);\n    const { renderingEngine, viewportId } = enabledElement;\n    const eventType = Events.ANNOTATION_ADDED;\n    const eventDetail = {\n        annotation,\n        viewportId,\n        renderingEngineId: renderingEngine.id,\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationAddedForFOR(annotation) {\n    const { toolName } = annotation.metadata;\n    const toolGroups = getToolGroupsWithToolName(toolName);\n    if (!toolGroups.length) {\n        return;\n    }\n    const viewportsToRender = [];\n    toolGroups.forEach((toolGroup) => {\n        toolGroup.viewportsInfo.forEach((viewportInfo) => {\n            const { renderingEngineId, viewportId } = viewportInfo;\n            const { FrameOfReferenceUID } = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (annotation.metadata.FrameOfReferenceUID === FrameOfReferenceUID) {\n                viewportsToRender.push(viewportInfo);\n            }\n        });\n    });\n    const eventType = Events.ANNOTATION_ADDED;\n    const eventDetail = { annotation };\n    if (!viewportsToRender.length) {\n        triggerEvent(eventTarget, eventType, eventDetail);\n        return;\n    }\n    viewportsToRender.forEach(({ renderingEngineId, viewportId }) => {\n        eventDetail.viewportId = viewportId;\n        eventDetail.renderingEngineId = renderingEngineId;\n        triggerEvent(eventTarget, eventType, eventDetail);\n    });\n}\nfunction triggerAnnotationRemoved(eventDetail) {\n    const eventType = Events.ANNOTATION_REMOVED;\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationModified(annotation, element, changeType = ChangeTypes.HandlesUpdated) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId, renderingEngineId } = enabledElement;\n    const eventType = Events.ANNOTATION_MODIFIED;\n    const eventDetail = {\n        annotation,\n        viewportId,\n        renderingEngineId,\n        changeType,\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationCompleted(annotation) {\n    const eventDetail = {\n        annotation,\n    };\n    _triggerAnnotationCompleted(eventDetail);\n}\nfunction triggerContourAnnotationCompleted(annotation, contourHoleProcessingEnabled = false) {\n    const eventDetail = {\n        annotation,\n        contourHoleProcessingEnabled,\n    };\n    _triggerAnnotationCompleted(eventDetail);\n}\nfunction _triggerAnnotationCompleted(eventDetail) {\n    const eventType = Events.ANNOTATION_COMPLETED;\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nexport { triggerAnnotationAddedForElement, triggerAnnotationAddedForFOR, triggerAnnotationRemoved, triggerAnnotationModified, triggerAnnotationCompleted, triggerContourAnnotationCompleted, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport Events from '../../enums/Events';\nimport { getAnnotation } from './annotationState';\nexport default class AnnotationGroup {\n    constructor() {\n        this.annotationUIDs = new Set();\n        this._isVisible = true;\n        this.visibleFilter = this.unboundVisibleFilter.bind(this);\n    }\n    unboundVisibleFilter(uid) {\n        return !this._isVisible || !this.annotationUIDs.has(uid);\n    }\n    has(uid) {\n        return this.annotationUIDs.has(uid);\n    }\n    setVisible(isVisible = true, baseEvent, filter) {\n        if (this._isVisible === isVisible) {\n            return;\n        }\n        this._isVisible = isVisible;\n        this.annotationUIDs.forEach((uid) => {\n            const annotation = getAnnotation(uid);\n            if (!annotation) {\n                this.annotationUIDs.delete(uid);\n                return;\n            }\n            if (annotation.isVisible === isVisible) {\n                return;\n            }\n            if (!isVisible && filter?.(uid) === false) {\n                return;\n            }\n            annotation.isVisible = isVisible;\n            const eventDetail = {\n                ...baseEvent,\n                annotation,\n            };\n            triggerEvent(eventTarget, Events.ANNOTATION_MODIFIED, eventDetail);\n        });\n    }\n    get isVisible() {\n        return this._isVisible;\n    }\n    findNearby(uid, direction) {\n        const uids = [...this.annotationUIDs];\n        if (uids.length === 0) {\n            return null;\n        }\n        if (!uid) {\n            return uids[direction === 1 ? 0 : uids.length - 1];\n        }\n        const index = uids.indexOf(uid);\n        if (index === -1 ||\n            index + direction < 0 ||\n            index + direction >= uids.length) {\n            return null;\n        }\n        return uids[index + direction];\n    }\n    add(...annotationUIDs) {\n        annotationUIDs.forEach((annotationUID) => this.annotationUIDs.add(annotationUID));\n    }\n    remove(...annotationUIDs) {\n        annotationUIDs.forEach((annotationUID) => this.annotationUIDs.delete(annotationUID));\n    }\n    clear() {\n        this.annotationUIDs.clear();\n    }\n}\n","import { triggerEvent, eventTarget, Enums, getRenderingEngines, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations, Events as csToolsEvents, } from '../../enums';\nimport Representations from '../../enums/SegmentationRepresentations';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport surfaceDisplay from '../../tools/displayTools/Surface/surfaceDisplay';\nimport contourDisplay from '../../tools/displayTools/Contour/contourDisplay';\nimport labelmapDisplay from '../../tools/displayTools/Labelmap/labelmapDisplay';\nimport { addTool } from '../../store/addTool';\nimport { state } from '../../store/state';\nimport PlanarFreehandContourSegmentationTool from '../../tools/annotation/PlanarFreehandContourSegmentationTool';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nconst renderers = {\n    [Representations.Labelmap]: labelmapDisplay,\n    [Representations.Contour]: contourDisplay,\n    [Representations.Surface]: surfaceDisplay,\n};\nconst planarContourToolName = PlanarFreehandContourSegmentationTool.toolName;\nclass SegmentationRenderingEngine {\n    constructor() {\n        this._needsRender = new Set();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._getAllViewports = () => {\n            const renderingEngine = getRenderingEngines();\n            return renderingEngine.flatMap((renderingEngine) => renderingEngine.getViewports());\n        };\n        this._renderFlaggedSegmentations = () => {\n            this._throwIfDestroyed();\n            const viewportIds = Array.from(this._needsRender);\n            viewportIds.forEach((viewportId) => {\n                this._triggerRender(viewportId);\n            });\n            this._needsRender.clear();\n            this._animationFrameSet = false;\n            this._animationFrameHandle = null;\n        };\n    }\n    renderSegmentationsForViewport(viewportId) {\n        const viewportIds = viewportId\n            ? [viewportId]\n            : this._getViewportIdsForSegmentation();\n        this._setViewportsToBeRenderedNextFrame(viewportIds);\n    }\n    renderSegmentation(segmentationId) {\n        const viewportIds = this._getViewportIdsForSegmentation(segmentationId);\n        this._setViewportsToBeRenderedNextFrame(viewportIds);\n    }\n    _getViewportIdsForSegmentation(segmentationId) {\n        const viewports = this._getAllViewports();\n        const viewportIds = [];\n        for (const viewport of viewports) {\n            const viewportId = viewport.id;\n            if (segmentationId) {\n                const segmentationRepresentations = getSegmentationRepresentations(viewportId, { segmentationId });\n                if (segmentationRepresentations?.length > 0) {\n                    viewportIds.push(viewportId);\n                }\n            }\n            else {\n                const segmentationRepresentations = getSegmentationRepresentations(viewportId);\n                if (segmentationRepresentations?.length > 0) {\n                    viewportIds.push(viewportId);\n                }\n            }\n        }\n        return viewportIds;\n    }\n    _throwIfDestroyed() {\n        if (this.hasBeenDestroyed) {\n            throw new Error('this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.');\n        }\n    }\n    _setViewportsToBeRenderedNextFrame(viewportIds) {\n        viewportIds.forEach((viewportId) => {\n            this._needsRender.add(viewportId);\n        });\n        this._render();\n    }\n    _render() {\n        if (this._needsRender.size > 0 && this._animationFrameSet === false) {\n            this._animationFrameHandle = window.requestAnimationFrame(this._renderFlaggedSegmentations);\n            this._animationFrameSet = true;\n        }\n    }\n    _triggerRender(viewportId) {\n        const segmentationRepresentations = getSegmentationRepresentations(viewportId);\n        if (!segmentationRepresentations?.length) {\n            return;\n        }\n        const { viewport } = getEnabledElementByViewportId(viewportId) || {};\n        if (!viewport) {\n            return;\n        }\n        const viewportRenderList = [];\n        const segmentationRenderList = segmentationRepresentations.map((representation) => {\n            if (representation.type === SegmentationRepresentations.Contour) {\n                this._addPlanarFreeHandToolIfAbsent(viewport);\n            }\n            const display = renderers[representation.type];\n            try {\n                const viewportId = display.render(viewport, representation);\n                viewportRenderList.push(viewportId);\n            }\n            catch (error) {\n                console.error(error);\n            }\n            return Promise.resolve({\n                segmentationId: representation.segmentationId,\n                type: representation.type,\n            });\n        });\n        Promise.allSettled(segmentationRenderList).then((results) => {\n            const segmentationDetails = results\n                .filter((r) => r.status === 'fulfilled')\n                .map((r) => r.value);\n            function onSegmentationRender(evt) {\n                const { element, viewportId } = evt.detail;\n                element.removeEventListener(Enums.Events.IMAGE_RENDERED, onSegmentationRender);\n                segmentationDetails.forEach((detail) => {\n                    const eventDetail = {\n                        viewportId,\n                        segmentationId: detail.segmentationId,\n                        type: detail.type,\n                    };\n                    triggerEvent(eventTarget, csToolsEvents.SEGMENTATION_RENDERED, {\n                        ...eventDetail,\n                    });\n                });\n            }\n            const element = viewport.element;\n            element.addEventListener(Enums.Events.IMAGE_RENDERED, onSegmentationRender);\n            viewport.render();\n        });\n    }\n    _addPlanarFreeHandToolIfAbsent(viewport) {\n        if (!(planarContourToolName in state.tools)) {\n            addTool(PlanarFreehandContourSegmentationTool);\n        }\n        const toolGroup = getToolGroupForViewport(viewport.id);\n        if (!toolGroup.hasTool(planarContourToolName)) {\n            toolGroup.addTool(planarContourToolName);\n            toolGroup.setToolPassive(planarContourToolName);\n        }\n    }\n}\nfunction triggerSegmentationRender(viewportId) {\n    segmentationRenderingEngine.renderSegmentationsForViewport(viewportId);\n}\nfunction triggerSegmentationRenderBySegmentationId(segmentationId) {\n    segmentationRenderingEngine.renderSegmentation(segmentationId);\n}\nconst segmentationRenderingEngine = new SegmentationRenderingEngine();\nexport { triggerSegmentationRender, triggerSegmentationRenderBySegmentationId, segmentationRenderingEngine, };\n","import { BaseVolumeViewport, cache, utilities as csUtils, getEnabledElementByViewportId, volumeLoader, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../enums';\nimport vtkColorTransferFunction from '@kitware/vtk.js/Rendering/Core/ColorTransferFunction';\nimport vtkPiecewiseFunction from '@kitware/vtk.js/Common/DataModel/PiecewiseFunction';\nimport { triggerSegmentationModified, triggerSegmentationRemoved, triggerSegmentationRepresentationModified, triggerSegmentationRepresentationRemoved, } from './triggerSegmentationEvents';\nimport { segmentationStyle } from './SegmentationStyle';\nimport { triggerSegmentationAdded } from './events/triggerSegmentationAdded';\nconst initialDefaultState = {\n    colorLUT: [],\n    segmentations: [],\n    viewportSegRepresentations: {},\n};\nexport default class SegmentationStateManager {\n    constructor(uid) {\n        this._stackLabelmapImageIdReferenceMap = new Map();\n        uid ||= csUtils.uuidv4();\n        this.state = Object.freeze(csUtils.deepClone(initialDefaultState));\n        this.uid = uid;\n    }\n    getState() {\n        return this.state;\n    }\n    updateState(updater) {\n        const newState = csUtils.deepClone(this.state);\n        updater(newState);\n        this.state = Object.freeze(newState);\n    }\n    getColorLUT(lutIndex) {\n        return this.state.colorLUT[lutIndex];\n    }\n    getNextColorLUTIndex() {\n        return this.state.colorLUT.length;\n    }\n    resetState() {\n        this.state = Object.freeze(csUtils.deepClone(initialDefaultState));\n    }\n    getSegmentation(segmentationId) {\n        return this.state.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n    }\n    updateSegmentation(segmentationId, payload) {\n        this.updateState((draftState) => {\n            const segmentation = draftState.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n            if (!segmentation) {\n                console.warn(`Segmentation with id ${segmentationId} not found. Update aborted.`);\n                return;\n            }\n            Object.assign(segmentation, payload);\n        });\n        triggerSegmentationModified(segmentationId);\n    }\n    addSegmentation(segmentation) {\n        if (this.getSegmentation(segmentation.segmentationId)) {\n            throw new Error(`Segmentation with id ${segmentation.segmentationId} already exists`);\n        }\n        this.updateState((state) => {\n            const newSegmentation = csUtils.deepClone(segmentation);\n            if (newSegmentation.representationData.Labelmap &&\n                'volumeId' in newSegmentation.representationData.Labelmap &&\n                !('imageIds' in newSegmentation.representationData.Labelmap)) {\n                const imageIds = this.getLabelmapImageIds(newSegmentation.representationData);\n                newSegmentation.representationData\n                    .Labelmap.imageIds = imageIds;\n            }\n            state.segmentations.push(newSegmentation);\n        });\n        triggerSegmentationAdded(segmentation.segmentationId);\n    }\n    removeSegmentation(segmentationId) {\n        this.updateState((state) => {\n            const filteredSegmentations = state.segmentations.filter((segmentation) => segmentation.segmentationId !== segmentationId);\n            state.segmentations.splice(0, state.segmentations.length, ...filteredSegmentations);\n        });\n        triggerSegmentationRemoved(segmentationId);\n    }\n    addSegmentationRepresentation(viewportId, segmentationId, type, renderingConfig) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const existingRepresentations = this.getSegmentationRepresentations(viewportId, {\n            type: type,\n            segmentationId,\n        });\n        if (existingRepresentations.length > 0) {\n            console.debug('A segmentation representation of type', type, 'already exists in viewport', viewportId, 'for segmentation', segmentationId);\n            return;\n        }\n        this.updateState((state) => {\n            if (!state.viewportSegRepresentations[viewportId]) {\n                state.viewportSegRepresentations[viewportId] = [];\n                segmentationStyle.setRenderInactiveSegmentations(viewportId, true);\n            }\n            if (type !== SegmentationRepresentations.Labelmap) {\n                this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, type, renderingConfig);\n            }\n            else {\n                this.addLabelmapRepresentation(state, viewportId, segmentationId, renderingConfig);\n            }\n        });\n        triggerSegmentationRepresentationModified(viewportId, segmentationId, type);\n    }\n    addDefaultSegmentationRepresentation(state, viewportId, segmentationId, type, renderingConfig) {\n        const segmentation = state.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const segmentReps = {};\n        Object.keys(segmentation.segments).forEach((segmentIndex) => {\n            segmentReps[Number(segmentIndex)] = {\n                visible: true,\n            };\n        });\n        state.viewportSegRepresentations[viewportId].push({\n            segmentationId,\n            type,\n            active: true,\n            visible: true,\n            colorLUTIndex: renderingConfig?.colorLUTIndex || 0,\n            segments: segmentReps,\n            config: {\n                ...getDefaultRenderingConfig(type),\n                ...renderingConfig,\n            },\n        });\n        this._setActiveSegmentation(state, viewportId, segmentationId);\n    }\n    addLabelmapRepresentation(state, viewportId, segmentationId, renderingConfig = getDefaultRenderingConfig(SegmentationRepresentations.Labelmap)) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, SegmentationRepresentations.Labelmap, renderingConfig);\n        }\n        this.processLabelmapRepresentationAddition(viewportId, segmentationId);\n        this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, SegmentationRepresentations.Labelmap, renderingConfig);\n    }\n    async processLabelmapRepresentationAddition(viewportId, segmentationId) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const volumeViewport = enabledElement.viewport instanceof BaseVolumeViewport;\n        const { representationData } = segmentation;\n        const isBaseVolumeSegmentation = 'volumeId' in representationData.Labelmap;\n        const viewport = enabledElement.viewport;\n        if (!volumeViewport && !isBaseVolumeSegmentation) {\n            !this.updateLabelmapSegmentationImageReferences(viewportId, segmentation.segmentationId);\n        }\n    }\n    _updateLabelmapSegmentationReferences(segmentationId, viewport, labelmapImageIds, updateCallback) {\n        const currentImageId = viewport.getCurrentImageId();\n        let viewableLabelmapImageIdFound = false;\n        for (const labelmapImageId of labelmapImageIds) {\n            const viewableImageId = viewport.isReferenceViewable({ referencedImageId: labelmapImageId }, { asOverlay: true });\n            if (viewableImageId) {\n                viewableLabelmapImageIdFound = true;\n                this._stackLabelmapImageIdReferenceMap\n                    .get(segmentationId)\n                    .set(currentImageId, labelmapImageId);\n            }\n        }\n        if (updateCallback) {\n            updateCallback(viewport, segmentationId, labelmapImageIds);\n        }\n        return viewableLabelmapImageIdFound\n            ? this._stackLabelmapImageIdReferenceMap\n                .get(segmentationId)\n                .get(currentImageId)\n            : undefined;\n    }\n    updateLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            this._stackLabelmapImageIdReferenceMap.set(segmentationId, new Map());\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return;\n        }\n        const labelmapImageIds = this.getLabelmapImageIds(representationData);\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        const stackViewport = enabledElement.viewport;\n        return this._updateLabelmapSegmentationReferences(segmentationId, stackViewport, labelmapImageIds, null);\n    }\n    _updateAllLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            this._stackLabelmapImageIdReferenceMap.set(segmentationId, new Map());\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return;\n        }\n        const labelmapImageIds = this.getLabelmapImageIds(representationData);\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        const stackViewport = enabledElement.viewport;\n        this._updateLabelmapSegmentationReferences(segmentationId, stackViewport, labelmapImageIds, (stackViewport, segmentationId, labelmapImageIds) => {\n            const imageIds = stackViewport.getImageIds();\n            imageIds.forEach((imageId, index) => {\n                for (const labelmapImageId of labelmapImageIds) {\n                    const viewableImageId = stackViewport.isReferenceViewable({ referencedImageId: labelmapImageId, sliceIndex: index }, { asOverlay: true, withNavigation: true });\n                    if (viewableImageId) {\n                        this._stackLabelmapImageIdReferenceMap\n                            .get(segmentationId)\n                            .set(imageId, labelmapImageId);\n                    }\n                }\n            });\n        });\n    }\n    getLabelmapImageIds(representationData) {\n        const labelmapData = representationData.Labelmap;\n        let labelmapImageIds;\n        if (labelmapData.imageIds) {\n            labelmapImageIds = labelmapData\n                .imageIds;\n        }\n        else if (!labelmapImageIds &&\n            labelmapData.volumeId) {\n            const volumeId = labelmapData\n                .volumeId;\n            const volume = cache.getVolume(volumeId);\n            labelmapImageIds = volume.imageIds;\n        }\n        return labelmapImageIds;\n    }\n    getCurrentLabelmapImageIdForViewport(viewportId, segmentationId) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            return;\n        }\n        const stackViewport = enabledElement.viewport;\n        const currentImageId = stackViewport.getCurrentImageId();\n        const imageIdReferenceMap = this._stackLabelmapImageIdReferenceMap.get(segmentationId);\n        return imageIdReferenceMap.get(currentImageId);\n    }\n    getStackSegmentationImageIdsForViewport(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return [];\n        }\n        this._updateAllLabelmapSegmentationImageReferences(viewportId, segmentationId);\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        const imageIds = viewport.getImageIds();\n        const associatedReferenceImageAndLabelmapImageIds = this._stackLabelmapImageIdReferenceMap.get(segmentationId);\n        return imageIds.map((imageId) => {\n            return associatedReferenceImageAndLabelmapImageIds.get(imageId);\n        });\n    }\n    removeSegmentationRepresentationsInternal(viewportId, specifier) {\n        const removedRepresentations = [];\n        this.updateState((state) => {\n            if (!state.viewportSegRepresentations[viewportId]) {\n                return;\n            }\n            const currentRepresentations = state.viewportSegRepresentations[viewportId];\n            let activeRepresentationRemoved = false;\n            if (!specifier ||\n                Object.values(specifier).every((value) => value === undefined)) {\n                removedRepresentations.push(...currentRepresentations);\n                delete state.viewportSegRepresentations[viewportId];\n            }\n            else {\n                const { segmentationId, type } = specifier;\n                state.viewportSegRepresentations[viewportId] =\n                    currentRepresentations.filter((representation) => {\n                        const shouldRemove = (segmentationId &&\n                            type &&\n                            representation.segmentationId === segmentationId &&\n                            representation.type === type) ||\n                            (segmentationId &&\n                                !type &&\n                                representation.segmentationId === segmentationId) ||\n                            (!segmentationId && type && representation.type === type);\n                        if (shouldRemove) {\n                            removedRepresentations.push(representation);\n                            if (representation.active) {\n                                activeRepresentationRemoved = true;\n                            }\n                        }\n                        return !shouldRemove;\n                    });\n                if (state.viewportSegRepresentations[viewportId].length === 0) {\n                    delete state.viewportSegRepresentations[viewportId];\n                }\n                else if (activeRepresentationRemoved) {\n                    state.viewportSegRepresentations[viewportId][0].active = true;\n                }\n            }\n        });\n        return removedRepresentations;\n    }\n    removeSegmentationRepresentations(viewportId, specifier) {\n        const removedRepresentations = this.removeSegmentationRepresentationsInternal(viewportId, specifier);\n        removedRepresentations.forEach((representation) => {\n            triggerSegmentationRepresentationRemoved(viewportId, representation.segmentationId, representation.type);\n        });\n        const remainingRepresentations = this.getSegmentationRepresentations(viewportId);\n        if (remainingRepresentations.length > 0 &&\n            remainingRepresentations[0].active) {\n            triggerSegmentationRepresentationModified(viewportId, remainingRepresentations[0].segmentationId, remainingRepresentations[0].type);\n        }\n        return removedRepresentations;\n    }\n    removeSegmentationRepresentation(viewportId, specifier, suppressEvent) {\n        const removedRepresentations = this.removeSegmentationRepresentationsInternal(viewportId, specifier);\n        if (!suppressEvent) {\n            removedRepresentations.forEach(({ segmentationId, type }) => {\n                triggerSegmentationRepresentationRemoved(viewportId, segmentationId, type);\n            });\n        }\n        return removedRepresentations;\n    }\n    _setActiveSegmentation(state, viewportId, segmentationId) {\n        const viewport = state.viewportSegRepresentations[viewportId];\n        if (!viewport) {\n            return;\n        }\n        viewport.forEach((value) => {\n            value.active = value.segmentationId === segmentationId;\n        });\n    }\n    setActiveSegmentation(viewportId, segmentationId) {\n        this.updateState((state) => {\n            const viewport = state.viewportSegRepresentations[viewportId];\n            if (!viewport) {\n                return;\n            }\n            viewport.forEach((value) => {\n                value.active = value.segmentationId === segmentationId;\n            });\n        });\n        triggerSegmentationRepresentationModified(viewportId, segmentationId);\n    }\n    getActiveSegmentation(viewportId) {\n        if (!this.state.viewportSegRepresentations[viewportId]) {\n            return;\n        }\n        const activeSegRep = this.state.viewportSegRepresentations[viewportId].find((segRep) => segRep.active);\n        if (!activeSegRep) {\n            return;\n        }\n        return this.getSegmentation(activeSegRep.segmentationId);\n    }\n    getSegmentationRepresentations(viewportId, specifier = {}) {\n        const viewportRepresentations = this.state.viewportSegRepresentations[viewportId];\n        if (!viewportRepresentations) {\n            return [];\n        }\n        if (!specifier.type && !specifier.segmentationId) {\n            return viewportRepresentations;\n        }\n        return viewportRepresentations.filter((representation) => {\n            const typeMatch = specifier.type\n                ? representation.type === specifier.type\n                : true;\n            const idMatch = specifier.segmentationId\n                ? representation.segmentationId === specifier.segmentationId\n                : true;\n            return typeMatch && idMatch;\n        });\n    }\n    getSegmentationRepresentation(viewportId, specifier) {\n        return this.getSegmentationRepresentations(viewportId, specifier)[0];\n    }\n    getSegmentationRepresentationVisibility(viewportId, specifier) {\n        const viewportRepresentation = this.getSegmentationRepresentation(viewportId, specifier);\n        return viewportRepresentation?.visible;\n    }\n    setSegmentationRepresentationVisibility(viewportId, specifier, visible) {\n        this.updateState((state) => {\n            const viewportRepresentations = this.getSegmentationRepresentations(viewportId, specifier);\n            if (!viewportRepresentations) {\n                return;\n            }\n            viewportRepresentations.forEach((representation) => {\n                representation.visible = visible;\n                Object.entries(representation.segments).forEach(([segmentIndex, segment]) => {\n                    segment.visible = visible;\n                });\n            });\n        });\n        triggerSegmentationRepresentationModified(viewportId, specifier.segmentationId, specifier.type);\n    }\n    addColorLUT(colorLUT, lutIndex) {\n        this.updateState((state) => {\n            if (state.colorLUT[lutIndex]) {\n                console.warn('Color LUT table already exists, overwriting');\n            }\n            state.colorLUT[lutIndex] = csUtils.deepClone(colorLUT);\n        });\n    }\n    removeColorLUT(colorLUTIndex) {\n        this.updateState((state) => {\n            delete state.colorLUT[colorLUTIndex];\n        });\n    }\n    _getStackIdForImageIds(imageIds) {\n        return imageIds\n            .map((imageId) => imageId.slice(-Math.round(imageId.length * 0.15)))\n            .join('_');\n    }\n    getAllViewportSegmentationRepresentations() {\n        return Object.entries(this.state.viewportSegRepresentations).map(([viewportId, representations]) => ({\n            viewportId,\n            representations,\n        }));\n    }\n    getSegmentationRepresentationsBySegmentationId(segmentationId) {\n        const result = [];\n        Object.entries(this.state.viewportSegRepresentations).forEach(([viewportId, viewportReps]) => {\n            const filteredReps = viewportReps.filter((representation) => representation.segmentationId === segmentationId);\n            if (filteredReps.length > 0) {\n                result.push({ viewportId, representations: filteredReps });\n            }\n        });\n        return result;\n    }\n}\nasync function internalComputeVolumeLabelmapFromStack({ imageIds, options, }) {\n    const segmentationImageIds = imageIds;\n    const volumeId = options?.volumeId || csUtils.uuidv4();\n    await volumeLoader.createAndCacheVolumeFromImages(volumeId, segmentationImageIds);\n    return { volumeId };\n}\nasync function internalConvertStackToVolumeLabelmap({ segmentationId, options, }) {\n    const segmentation = defaultSegmentationStateManager.getSegmentation(segmentationId);\n    const data = segmentation.representationData\n        .Labelmap;\n    const { volumeId } = await internalComputeVolumeLabelmapFromStack({\n        imageIds: data.imageIds,\n        options,\n    });\n    segmentation.representationData.Labelmap.volumeId = volumeId;\n}\nfunction getDefaultRenderingConfig(type) {\n    const cfun = vtkColorTransferFunction.newInstance();\n    const ofun = vtkPiecewiseFunction.newInstance();\n    ofun.addPoint(0, 0);\n    if (type === SegmentationRepresentations.Labelmap) {\n        return {\n            cfun,\n            ofun,\n        };\n    }\n    else {\n        return {};\n    }\n}\nconst defaultSegmentationStateManager = new SegmentationStateManager('DEFAULT');\nexport { internalConvertStackToVolumeLabelmap, internalComputeVolumeLabelmapFromStack, defaultSegmentationStateManager, };\n","import getDefaultContourConfig from '../../tools/displayTools/Contour/contourConfig';\nimport getDefaultLabelmapConfig from '../../tools/displayTools/Labelmap/labelmapConfig';\nimport * as Enums from '../../enums';\nimport { utilities } from '@cornerstonejs/core';\nclass SegmentationStyle {\n    constructor() {\n        this.config = {\n            global: {},\n            segmentations: {},\n            viewportsStyle: {},\n        };\n    }\n    setStyle(specifier, styles) {\n        const { viewportId, segmentationId, type, segmentIndex } = specifier;\n        const currentStyles = this.getStyle(specifier);\n        let updatedStyles;\n        if (!viewportId && !segmentationId) {\n            updatedStyles = {\n                ...currentStyles,\n                ...styles,\n            };\n        }\n        else {\n            updatedStyles = this.copyActiveToInactiveIfNotProvided({\n                ...currentStyles,\n                ...styles,\n            }, type);\n        }\n        if (!type) {\n            throw new Error('Type is required to set a style');\n        }\n        if (viewportId) {\n            if (!this.config.viewportsStyle[viewportId]) {\n                this.config.viewportsStyle[viewportId] = {\n                    renderInactiveSegmentations: false,\n                    representations: {},\n                };\n            }\n            const representations = this.config.viewportsStyle[viewportId].representations;\n            if (segmentationId) {\n                if (!representations[segmentationId]) {\n                    representations[segmentationId] = {};\n                }\n                if (!representations[segmentationId][type]) {\n                    representations[segmentationId][type] = {};\n                }\n                const repConfig = representations[segmentationId][type];\n                if (segmentIndex !== undefined) {\n                    if (!repConfig.perSegment) {\n                        repConfig.perSegment = {};\n                    }\n                    repConfig.perSegment[segmentIndex] = updatedStyles;\n                }\n                else {\n                    repConfig.allSegments = updatedStyles;\n                }\n            }\n            else {\n                const ALL_SEGMENTATIONS_KEY = '__allSegmentations__';\n                if (!representations[ALL_SEGMENTATIONS_KEY]) {\n                    representations[ALL_SEGMENTATIONS_KEY] = {};\n                }\n                if (!representations[ALL_SEGMENTATIONS_KEY][type]) {\n                    representations[ALL_SEGMENTATIONS_KEY][type] = {};\n                }\n                representations[ALL_SEGMENTATIONS_KEY][type].allSegments =\n                    updatedStyles;\n            }\n        }\n        else if (segmentationId) {\n            if (!this.config.segmentations[segmentationId]) {\n                this.config.segmentations[segmentationId] = {};\n            }\n            if (!this.config.segmentations[segmentationId][type]) {\n                this.config.segmentations[segmentationId][type] = {};\n            }\n            const segConfig = this.config.segmentations[segmentationId][type];\n            if (segmentIndex !== undefined) {\n                if (!segConfig.perSegment) {\n                    segConfig.perSegment = {};\n                }\n                segConfig.perSegment[segmentIndex] = updatedStyles;\n            }\n            else {\n                segConfig.allSegments = updatedStyles;\n            }\n        }\n        else {\n            this.config.global[type] = updatedStyles;\n        }\n    }\n    copyActiveToInactiveIfNotProvided(styles, type) {\n        const processedStyles = { ...styles };\n        if (type === Enums.SegmentationRepresentations.Labelmap) {\n            const labelmapStyles = processedStyles;\n            labelmapStyles.renderOutlineInactive = labelmapStyles.renderOutline;\n            labelmapStyles.outlineWidthInactive = labelmapStyles.outlineWidth;\n            labelmapStyles.renderFillInactive = labelmapStyles.renderFill;\n            labelmapStyles.fillAlphaInactive = labelmapStyles.fillAlpha;\n            labelmapStyles.outlineOpacityInactive = labelmapStyles.outlineOpacity;\n        }\n        else if (type === Enums.SegmentationRepresentations.Contour) {\n            const contourStyles = processedStyles;\n            contourStyles.outlineWidthInactive = contourStyles.outlineWidth;\n            contourStyles.outlineOpacityInactive = contourStyles.outlineOpacity;\n            contourStyles.outlineDashInactive = contourStyles.outlineDash;\n            contourStyles.renderOutlineInactive = contourStyles.renderOutline;\n            contourStyles.renderFillInactive = contourStyles.renderFill;\n            contourStyles.fillAlphaInactive = contourStyles.fillAlpha;\n        }\n        return processedStyles;\n    }\n    getStyle(specifier) {\n        const { viewportId, segmentationId, type, segmentIndex } = specifier;\n        let combinedStyle = this.getDefaultStyle(type);\n        let renderInactiveSegmentations = false;\n        if (this.config.global[type]) {\n            combinedStyle = {\n                ...combinedStyle,\n                ...this.config.global[type],\n            };\n        }\n        if (this.config.segmentations[segmentationId]?.[type]) {\n            combinedStyle = {\n                ...combinedStyle,\n                ...this.config.segmentations[segmentationId][type].allSegments,\n            };\n            if (segmentIndex !== undefined &&\n                this.config.segmentations[segmentationId][type].perSegment?.[segmentIndex]) {\n                combinedStyle = {\n                    ...combinedStyle,\n                    ...this.config.segmentations[segmentationId][type].perSegment[segmentIndex],\n                };\n            }\n        }\n        if (viewportId && this.config.viewportsStyle[viewportId]) {\n            renderInactiveSegmentations =\n                this.config.viewportsStyle[viewportId].renderInactiveSegmentations;\n            const allSegmentationsKey = '__allSegmentations__';\n            if (this.config.viewportsStyle[viewportId].representations[allSegmentationsKey]?.[type]) {\n                combinedStyle = {\n                    ...combinedStyle,\n                    ...this.config.viewportsStyle[viewportId].representations[allSegmentationsKey][type].allSegments,\n                };\n            }\n            if (segmentationId &&\n                this.config.viewportsStyle[viewportId].representations[segmentationId]?.[type]) {\n                combinedStyle = {\n                    ...combinedStyle,\n                    ...this.config.viewportsStyle[viewportId].representations[segmentationId][type].allSegments,\n                };\n                if (segmentIndex !== undefined &&\n                    this.config.viewportsStyle[viewportId].representations[segmentationId][type].perSegment?.[segmentIndex]) {\n                    combinedStyle = {\n                        ...combinedStyle,\n                        ...this.config.viewportsStyle[viewportId].representations[segmentationId][type].perSegment[segmentIndex],\n                    };\n                }\n            }\n        }\n        return combinedStyle;\n    }\n    getRenderInactiveSegmentations(viewportId) {\n        return this.config.viewportsStyle[viewportId]?.renderInactiveSegmentations;\n    }\n    setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations) {\n        if (!this.config.viewportsStyle[viewportId]) {\n            this.config.viewportsStyle[viewportId] = {\n                renderInactiveSegmentations: false,\n                representations: {},\n            };\n        }\n        this.config.viewportsStyle[viewportId].renderInactiveSegmentations =\n            renderInactiveSegmentations;\n    }\n    getDefaultStyle(type) {\n        switch (type) {\n            case Enums.SegmentationRepresentations.Labelmap:\n                return getDefaultLabelmapConfig();\n            case Enums.SegmentationRepresentations.Contour:\n                return getDefaultContourConfig();\n            case Enums.SegmentationRepresentations.Surface:\n                return {};\n            default:\n                throw new Error(`Unknown representation type: ${type}`);\n        }\n    }\n    clearSegmentationStyle(segmentationId) {\n        if (this.config.segmentations[segmentationId]) {\n            delete this.config.segmentations[segmentationId];\n        }\n    }\n    clearAllSegmentationStyles() {\n        this.config.segmentations = {};\n    }\n    clearViewportStyle(viewportId) {\n        if (this.config.viewportsStyle[viewportId]) {\n            delete this.config.viewportsStyle[viewportId];\n        }\n    }\n    clearAllViewportStyles() {\n        for (const viewportId in this.config.viewportsStyle) {\n            const viewportStyle = this.config.viewportsStyle[viewportId];\n            const renderInactiveSegmentations = viewportStyle.renderInactiveSegmentations;\n            this.config.viewportsStyle[viewportId] = {\n                renderInactiveSegmentations,\n                representations: {},\n            };\n        }\n    }\n    resetToGlobalStyle() {\n        this.clearAllSegmentationStyles();\n        this.clearAllViewportStyles();\n    }\n    hasCustomStyle(specifier) {\n        const { type } = specifier;\n        const style = this.getStyle(specifier);\n        const defaultStyle = this.getDefaultStyle(type);\n        return !utilities.deepEqual(style, defaultStyle);\n    }\n}\nconst segmentationStyle = new SegmentationStyle();\nexport { segmentationStyle };\n","import { getActiveSegmentation as _getActiveSegmentation } from './getActiveSegmentation';\nimport { setActiveSegmentation as _setActiveSegmentation } from './setActiveSegmentation';\nfunction getActiveSegmentation(viewportId) {\n    return _getActiveSegmentation(viewportId);\n}\nfunction setActiveSegmentation(viewportId, segmentationId, suppressEvent = false) {\n    _setActiveSegmentation(viewportId, segmentationId);\n}\nexport { getActiveSegmentation, setActiveSegmentation, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function setActiveSegmentation(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.setActiveSegmentation(viewportId, segmentationId);\n}\n","import { utilities } from '@cornerstonejs/core';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport CORNERSTONE_COLOR_LUT from '../../constants/COLOR_LUT';\nexport function addColorLUT(colorLUT, index) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const indexToUse = index ?? getNextColorLUTIndex();\n    let colorLUTToUse = [...colorLUT];\n    if (!utilities.isEqual(colorLUTToUse[0], [0, 0, 0, 0])) {\n        console.warn('addColorLUT: [0, 0, 0, 0] color is not provided for the background color (segmentIndex =0), automatically adding it');\n        colorLUTToUse = [[0, 0, 0, 0], ...colorLUTToUse];\n    }\n    colorLUTToUse = colorLUTToUse.map((color) => {\n        if (color.length === 3) {\n            return [color[0], color[1], color[2], 255];\n        }\n        return color;\n    });\n    if (colorLUTToUse.length < 255) {\n        const missingColorLUTs = CORNERSTONE_COLOR_LUT.slice(colorLUTToUse.length);\n        colorLUTToUse = [...colorLUTToUse, ...missingColorLUTs];\n    }\n    segmentationStateManager.addColorLUT(colorLUTToUse, indexToUse);\n    return indexToUse;\n}\n","import CORNERSTONE_COLOR_LUT from '../../constants/COLOR_LUT';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { SegmentationRepresentations } from '../../enums';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport { addColorLUT } from './addColorLUT';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { getColorLUT } from './getColorLUT';\nfunction internalAddSegmentationRepresentation(viewportId, representationInput) {\n    const { segmentationId, config } = representationInput;\n    const renderingConfig = {\n        colorLUTIndex: getColorLUTIndex(config),\n    };\n    defaultSegmentationStateManager.addSegmentationRepresentation(viewportId, segmentationId, representationInput.type, renderingConfig);\n    if (representationInput.type === SegmentationRepresentations.Contour) {\n        triggerAnnotationRenderForViewportIds([viewportId]);\n    }\n    triggerSegmentationModified(segmentationId);\n}\nfunction getColorLUTIndex(config) {\n    const { colorLUTOrIndex } = config || {};\n    if (colorLUTOrIndex === undefined) {\n        const index = addColorLUT(JSON.parse(JSON.stringify(CORNERSTONE_COLOR_LUT)));\n        return index;\n    }\n    if (typeof colorLUTOrIndex === 'number') {\n        return colorLUTOrIndex;\n    }\n    if (Array.isArray(colorLUTOrIndex) &&\n        colorLUTOrIndex.every((item) => Array.isArray(item) && item.length === 4)) {\n        const index = addColorLUT(colorLUTOrIndex);\n        return index;\n    }\n    const index = addColorLUT(JSON.parse(JSON.stringify(CORNERSTONE_COLOR_LUT)));\n    return index;\n}\nexport { internalAddSegmentationRepresentation };\n","import { SegmentationRepresentations } from '../../enums';\nimport { internalAddSegmentationRepresentation } from './internalAddSegmentationRepresentation';\nexport function addSegmentationRepresentations(viewportId, segmentationInputArray) {\n    segmentationInputArray.map((segmentationInput) => {\n        return internalAddSegmentationRepresentation(viewportId, segmentationInput);\n    });\n}\nfunction addContourRepresentationToViewport(viewportId, contourInputArray) {\n    return addSegmentationRepresentations(viewportId, contourInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Contour,\n    })));\n}\nfunction addContourRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addContourRepresentationToViewport(viewportId, inputArray);\n    }\n    return results;\n}\nfunction addLabelmapRepresentationToViewport(viewportId, labelmapInputArray) {\n    return addSegmentationRepresentations(viewportId, labelmapInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Labelmap,\n    })));\n}\nfunction addLabelmapRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addLabelmapRepresentationToViewport(viewportId, inputArray.map((input) => ({\n            ...input,\n            type: SegmentationRepresentations.Labelmap,\n        })));\n    }\n}\nfunction addSurfaceRepresentationToViewport(viewportId, surfaceInputArray) {\n    return addSegmentationRepresentations(viewportId, surfaceInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Surface,\n    })));\n}\nfunction addSurfaceRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addSurfaceRepresentationToViewport(viewportId, inputArray);\n    }\n    return results;\n}\nexport { addContourRepresentationToViewport, addLabelmapRepresentationToViewport, addSurfaceRepresentationToViewport, addContourRepresentationToViewportMap, addLabelmapRepresentationToViewportMap, addSurfaceRepresentationToViewportMap, };\n","import { SegmentationRepresentations } from '../../../enums';\nimport { cache } from '@cornerstonejs/core';\nfunction normalizeSegmentationInput(segmentationInput) {\n    const { segmentationId, representation, config } = segmentationInput;\n    const { type, data: inputData } = representation;\n    const data = inputData ? { ...inputData } : {};\n    if (!data) {\n        throw new Error('Segmentation representation data may not be undefined');\n    }\n    if (type === SegmentationRepresentations.Contour) {\n        normalizeContourData(data);\n    }\n    const normalizedSegments = normalizeSegments(config?.segments, type, data);\n    delete config?.segments;\n    return {\n        segmentationId,\n        label: config?.label ?? null,\n        cachedStats: config?.cachedStats ?? {},\n        segments: normalizedSegments,\n        representationData: {\n            [type]: {\n                ...data,\n            },\n        },\n    };\n}\nfunction normalizeContourData(contourData) {\n    contourData.geometryIds = contourData.geometryIds ?? [];\n    contourData.annotationUIDsMap = contourData.annotationUIDsMap ?? new Map();\n}\nfunction normalizeSegments(segmentsConfig, type, data) {\n    const normalizedSegments = {};\n    if (segmentsConfig) {\n        Object.entries(segmentsConfig).forEach(([segmentIndex, segment]) => {\n            normalizedSegments[segmentIndex] = {\n                segmentIndex: Number(segmentIndex),\n                label: segment.label ?? `Segment ${segmentIndex}`,\n                locked: segment.locked ?? false,\n                cachedStats: segment.cachedStats ?? {},\n                active: segment.active ?? false,\n            };\n        });\n    }\n    else if (type === SegmentationRepresentations.Surface) {\n        normalizeSurfaceSegments(normalizedSegments, data);\n    }\n    else {\n        normalizedSegments[1] = createDefaultSegment();\n    }\n    return normalizedSegments;\n}\nfunction normalizeSurfaceSegments(normalizedSegments, surfaceData) {\n    const { geometryIds } = surfaceData;\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        if (geometry?.data) {\n            const { segmentIndex } = geometry.data;\n            normalizedSegments[segmentIndex] = { segmentIndex };\n        }\n    });\n}\nfunction createDefaultSegment() {\n    return {\n        segmentIndex: 1,\n        label: 'Segment 1',\n        locked: false,\n        cachedStats: {},\n        active: true,\n    };\n}\nexport default normalizeSegmentationInput;\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport normalizeSegmentationInput from './helpers/normalizeSegmentationInput';\nexport function addSegmentations(segmentationInputArray, suppressEvents) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationInputArray.forEach((segmentationInput) => {\n        const segmentation = normalizeSegmentationInput(segmentationInput);\n        segmentationStateManager.addSegmentation(segmentation);\n        if (!suppressEvents) {\n            triggerSegmentationModified(segmentation.segmentationId);\n        }\n    });\n}\nexport default addSegmentations;\n","import { addColorLUT as _addColorLUT } from '../addColorLUT';\nimport { getColorLUT as _getColorLUT } from '../getColorLUT';\nimport { getSegmentationRepresentations } from '../getSegmentationRepresentation';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction addColorLUT(colorLUT, colorLUTIndex) {\n    if (!colorLUT) {\n        throw new Error('addColorLUT: colorLUT is required');\n    }\n    return _addColorLUT(colorLUT, colorLUTIndex);\n}\nfunction setColorLUT(viewportId, segmentationId, colorLUTsIndex) {\n    if (!_getColorLUT(colorLUTsIndex)) {\n        throw new Error(`setColorLUT: could not find colorLUT with index ${colorLUTsIndex}`);\n    }\n    const segmentationRepresentations = getSegmentationRepresentations(viewportId, { segmentationId });\n    if (!segmentationRepresentations) {\n        throw new Error(`viewport specific state for viewport ${viewportId} does not exist`);\n    }\n    segmentationRepresentations.forEach((segmentationRepresentation) => {\n        segmentationRepresentation.colorLUTIndex = colorLUTsIndex;\n    });\n    triggerSegmentationRepresentationModified(viewportId, segmentationId);\n}\nfunction getSegmentIndexColor(viewportId, segmentationId, segmentIndex) {\n    const representations = getSegmentationRepresentations(viewportId, {\n        segmentationId,\n    });\n    if (!representations || representations.length === 0) {\n        return null;\n    }\n    const representation = representations[0];\n    const { colorLUTIndex } = representation;\n    const colorLUT = _getColorLUT(colorLUTIndex);\n    let colorValue = colorLUT[segmentIndex];\n    if (!colorValue) {\n        if (typeof segmentIndex !== 'number') {\n            throw new Error(`Can't create colour for LUT index ${segmentIndex}`);\n        }\n        colorValue = colorLUT[segmentIndex] = [0, 0, 0, 0];\n    }\n    return colorValue;\n}\nfunction setSegmentIndexColor(viewportId, segmentationId, segmentIndex, color) {\n    const colorReference = getSegmentIndexColor(viewportId, segmentationId, segmentIndex);\n    for (let i = 0; i < color.length; i++) {\n        colorReference[i] = color[i];\n    }\n    triggerSegmentationRepresentationModified(viewportId, segmentationId);\n}\nexport { getSegmentIndexColor, addColorLUT, setColorLUT, setSegmentIndexColor };\n","import { triggerEvent, eventTarget } from '@cornerstonejs/core';\nimport { Events } from '../../../enums';\nimport { setSegmentationDirty } from '../../../utilities/segmentation/utilities';\nexport function triggerSegmentationDataModified(segmentationId, modifiedSlicesToUse) {\n    const eventDetail = {\n        segmentationId,\n        modifiedSlicesToUse,\n    };\n    setSegmentationDirty(segmentationId);\n    triggerEvent(eventTarget, Events.SEGMENTATION_DATA_MODIFIED, eventDetail);\n}\n","import { getSegmentation } from './getSegmentation';\nexport function getActiveSegmentIndex(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    if (segmentation) {\n        const activeSegmentIndex = Object.keys(segmentation.segments).find((segmentIndex) => segmentation.segments[segmentIndex].active);\n        return activeSegmentIndex ? Number(activeSegmentIndex) : undefined;\n    }\n    return undefined;\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getActiveSegmentation(viewportId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getActiveSegmentation(viewportId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getCurrentLabelmapImageIdForViewport(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getCurrentLabelmapImageIdForViewport(viewportId, segmentationId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentationRepresentations(viewportId, specifier = {}) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentations(viewportId, specifier);\n}\nexport function getSegmentationRepresentation(viewportId, specifier) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    if (!specifier.segmentationId || !specifier.type) {\n        throw new Error('getSegmentationRepresentation: No segmentationId or type provided, you need to provide at least one of them');\n    }\n    const representations = segmentationStateManager.getSegmentationRepresentations(viewportId, specifier);\n    return representations?.[0];\n}\nexport function getSegmentationRepresentationsBySegmentationId(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentationsBySegmentationId(segmentationId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentationRepresentationVisibility(viewportId, specifier) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentationVisibility(viewportId, specifier);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentations() {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    return state.segmentations;\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getViewportIdsWithSegmentation(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    const viewportSegRepresentations = state.viewportSegRepresentations;\n    const viewportIdsWithSegmentation = Object.entries(viewportSegRepresentations)\n        .filter(([, viewportSegmentations]) => viewportSegmentations.some((segRep) => segRep.segmentationId === segmentationId))\n        .map(([viewportId]) => viewportId);\n    return viewportIdsWithSegmentation;\n}\n","import { getSegmentation } from './getSegmentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getViewportSegmentations(viewportId, type) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    const viewportRepresentations = state.viewportSegRepresentations[viewportId];\n    const segmentations = viewportRepresentations.map((representation) => {\n        if (type && representation.type === type) {\n            return getSegmentation(representation.segmentationId);\n        }\n        return getSegmentation(representation.segmentationId);\n    });\n    const filteredSegmentations = segmentations.filter((segmentation) => segmentation !== undefined);\n    return filteredSegmentations;\n}\n","import { internalComputeVolumeLabelmapFromStack } from '../SegmentationStateManager';\nexport async function computeVolumeLabelmapFromStack(args) {\n    return internalComputeVolumeLabelmapFromStack(args);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nexport function updateSegmentations(segmentationUpdateArray, suppressEvents) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationUpdateArray.forEach((segmentationUpdate) => {\n        segmentationStateManager.updateSegmentation(segmentationUpdate.segmentationId, segmentationUpdate.payload);\n        if (!suppressEvents) {\n            triggerSegmentationModified(segmentationUpdate.segmentationId);\n        }\n    });\n}\n","import { getSegmentationRepresentation, getSegmentationRepresentations, } from '../getSegmentationRepresentation';\nimport { setSegmentationRepresentationVisibility as _setSegmentationRepresentationVisibility } from '../setSegmentationRepresentationVisibility';\nimport { getSegmentationRepresentationVisibility as _getSegmentationRepresentationVisibility } from '../getSegmentationRepresentationVisibility';\nimport { triggerSegmentationRenderBySegmentationId } from '../SegmentationRenderingEngine';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction setSegmentationRepresentationVisibility(viewportId, specifier, visibility) {\n    const representations = getSegmentationRepresentations(viewportId, specifier);\n    if (!representations) {\n        return;\n    }\n    representations.forEach((representation) => {\n        _setSegmentationRepresentationVisibility(viewportId, {\n            segmentationId: representation.segmentationId,\n            type: representation.type,\n        }, visibility);\n    });\n}\nfunction getSegmentationRepresentationVisibility(viewportId, specifier) {\n    return _getSegmentationRepresentationVisibility(viewportId, specifier);\n}\nfunction setSegmentIndexVisibility(viewportId, specifier, segmentIndex, visibility) {\n    const representations = getSegmentationRepresentations(viewportId, specifier);\n    if (!representations) {\n        return;\n    }\n    representations.forEach((representation) => {\n        representation.segments[segmentIndex].visible = visibility;\n    });\n    triggerSegmentationRenderBySegmentationId(specifier.segmentationId);\n    triggerSegmentationRepresentationModified(viewportId, specifier.segmentationId);\n}\nfunction getSegmentIndexVisibility(viewportId, specifier, segmentIndex) {\n    const hiddenSegments = getHiddenSegmentIndices(viewportId, specifier);\n    return !hiddenSegments.has(segmentIndex);\n}\nfunction getHiddenSegmentIndices(viewportId, specifier) {\n    const representation = getSegmentationRepresentation(viewportId, specifier);\n    if (!representation) {\n        return new Set();\n    }\n    const segmentsHidden = Object.entries(representation.segments).reduce((acc, [segmentIndex, segment]) => {\n        if (!segment.visible) {\n            acc.add(Number(segmentIndex));\n        }\n        return acc;\n    }, new Set());\n    return segmentsHidden;\n}\nexport { setSegmentationRepresentationVisibility, getSegmentationRepresentationVisibility, setSegmentIndexVisibility, getSegmentIndexVisibility, getHiddenSegmentIndices, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function setSegmentationRepresentationVisibility(viewportId, specifier, visible) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.setSegmentationRepresentationVisibility(viewportId, specifier, visible);\n}\n","import { getSegmentations } from '../getSegmentations';\nimport { getViewportSegmentations } from '../getViewportSegmentations';\nimport { triggerSegmentationRender } from '../SegmentationRenderingEngine';\nimport { segmentationStyle } from '../SegmentationStyle';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction getStyle(specifier) {\n    return segmentationStyle.getStyle(specifier);\n}\nfunction setStyle(specifier, style) {\n    segmentationStyle.setStyle(specifier, style);\n    if (!specifier.viewportId && !specifier.segmentationId) {\n        const segmentations = getSegmentations();\n        segmentations.forEach((segmentation) => {\n            triggerSegmentationRender(segmentation.segmentationId);\n        });\n    }\n    triggerSegmentationRepresentationModified(specifier.viewportId, specifier.segmentationId, specifier.type);\n}\nfunction setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations) {\n    segmentationStyle.setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations);\n    triggerSegmentationRender(viewportId);\n    const segmentations = getViewportSegmentations(viewportId);\n    segmentations.forEach((segmentation) => {\n        triggerSegmentationRepresentationModified(viewportId, segmentation.segmentationId);\n    });\n}\nfunction getRenderInactiveSegmentations(viewportId) {\n    return segmentationStyle.getRenderInactiveSegmentations(viewportId);\n}\nfunction resetToGlobalStyle() {\n    segmentationStyle.resetToGlobalStyle();\n    triggerSegmentationRender();\n}\nfunction hasCustomStyle(specifier) {\n    return segmentationStyle.hasCustomStyle(specifier);\n}\nexport { getStyle, setStyle, setRenderInactiveSegmentations, getRenderInactiveSegmentations, resetToGlobalStyle, hasCustomStyle, };\n","import { cache } from '@cornerstonejs/core';\nimport { getSegmentation } from '../getSegmentation';\nimport { triggerSegmentationDataModified } from '../triggerSegmentationEvents';\nexport function clearSegmentValue(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (segmentation.representationData.Labelmap) {\n        const { representationData } = segmentation;\n        const labelmapData = representationData.Labelmap;\n        if ('imageIds' in labelmapData || 'volumeId' in labelmapData) {\n            const items = 'imageIds' in labelmapData\n                ? labelmapData.imageIds.map((imageId) => cache.getImage(imageId))\n                : [cache.getVolume(labelmapData.volumeId)];\n            items.forEach((item) => {\n                if (!item) {\n                    return;\n                }\n                const { voxelManager } = item;\n                voxelManager.forEach(({ value, index }) => {\n                    if (value === segmentIndex) {\n                        voxelManager.setAtIndex(index, 0);\n                    }\n                });\n            });\n        }\n        triggerSegmentationDataModified(segmentationId);\n    }\n    else {\n        throw new Error('Invalid segmentation type, only labelmap is supported right now');\n    }\n}\n","import { getActiveSegmentIndex } from './getActiveSegmentIndex';\nimport { getSegmentation } from './getSegmentation';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { clearSegmentValue } from './helpers/clearSegmentValue';\nimport { setActiveSegmentIndex } from './segmentIndex';\nimport { updateSegmentations } from './updateSegmentations';\nexport function removeSegment(segmentationId, segmentIndex, options = {\n    setNextSegmentAsActive: true,\n}) {\n    clearSegmentValue(segmentationId, segmentIndex);\n    const isThisSegmentActive = getActiveSegmentIndex(segmentationId) === segmentIndex;\n    const segmentation = getSegmentation(segmentationId);\n    const { segments } = segmentation;\n    delete segments[segmentIndex];\n    const updatedSegments = {\n        ...segments,\n    };\n    updateSegmentations([\n        {\n            segmentationId,\n            payload: {\n                segments: updatedSegments,\n            },\n        },\n    ]);\n    if (isThisSegmentActive && options.setNextSegmentAsActive) {\n        const segmentIndices = Object.keys(segments)\n            .map(Number)\n            .sort((a, b) => a - b);\n        const currentIndex = segmentIndices.indexOf(segmentIndex);\n        const nextSegmentIndex = segmentIndices[currentIndex + 1];\n        const previousSegmentIndex = segmentIndices[currentIndex - 1];\n        if (nextSegmentIndex !== undefined) {\n            setActiveSegmentIndex(segmentationId, nextSegmentIndex);\n        }\n        else if (previousSegmentIndex !== undefined) {\n            setActiveSegmentIndex(segmentationId, previousSegmentIndex);\n        }\n    }\n    const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n    viewportIds.forEach((viewportId) => {\n        const representations = getSegmentationRepresentations(viewportId, {\n            segmentationId,\n        });\n        representations.forEach((representation) => {\n            delete representation.segments[segmentIndex];\n        });\n    });\n}\n","import { getSegmentation } from './getSegmentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getLabelmapImageIds(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const segmentation = getSegmentation(segmentationId);\n    return segmentationStateManager.getLabelmapImageIds(segmentation.representationData);\n}\n","import { removeContourRepresentation, removeLabelmapRepresentation, removeSegmentationRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentations, removeAllSegmentationRepresentations, } from './removeSegmentationRepresentations';\nimport { addContourRepresentationToViewport, addContourRepresentationToViewportMap, addSurfaceRepresentationToViewport, addSurfaceRepresentationToViewportMap, addLabelmapRepresentationToViewport, addLabelmapRepresentationToViewportMap, addSegmentationRepresentations, } from './addSegmentationRepresentationsToViewport';\nimport { addSegmentations } from './addSegmentations';\nimport { updateSegmentations } from './updateSegmentations';\nimport * as activeSegmentation from './activeSegmentation';\nimport * as segmentLocking from './segmentLocking';\nimport * as state from './segmentationState';\nimport * as config from './config';\nimport * as segmentIndex from './segmentIndex';\nimport * as triggerSegmentationEvents from './triggerSegmentationEvents';\nimport { convertStackToVolumeLabelmap } from './helpers/convertStackToVolumeLabelmap';\nimport { computeVolumeLabelmapFromStack } from './helpers/computeVolumeLabelmapFromStack';\nimport * as polySegManager from './polySeg';\nimport { clearSegmentValue } from './helpers/clearSegmentValue';\nimport { convertVolumeToStackLabelmap } from './helpers/computeStackLabelmapFromVolume';\nimport { removeSegment } from './removeSegment';\nimport { getLabelmapImageIds } from './getLabelmapImageIds';\nimport { removeAllSegmentations, removeSegmentation, } from './removeSegmentation';\nconst helpers = {\n    clearSegmentValue,\n    convertStackToVolumeLabelmap,\n    computeVolumeLabelmapFromStack,\n    convertVolumeToStackLabelmap,\n};\nexport { removeSegmentationRepresentation, removeContourRepresentation, removeLabelmapRepresentation, removeSurfaceRepresentation, removeAllSegmentations, removeSegmentation, removeSegmentationRepresentations, addLabelmapRepresentationToViewport, addLabelmapRepresentationToViewportMap, addSegmentationRepresentations, removeAllSegmentationRepresentations, addContourRepresentationToViewport, addContourRepresentationToViewportMap, addSurfaceRepresentationToViewport, addSurfaceRepresentationToViewportMap, addSegmentations, updateSegmentations, state, activeSegmentation, segmentLocking, config, segmentIndex, triggerSegmentationEvents, helpers, polySegManager as polySeg, removeSegment, getLabelmapImageIds, };\n","import { SegmentationRepresentations } from '../../../../enums';\nimport { computeAndAddRepresentation } from '../computeAndAddRepresentation';\nimport { computeContourData } from './contourComputationStrategies';\nexport function computeAndAddContourRepresentation(segmentationId, options = {}) {\n    return computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Contour, () => computeContourData(segmentationId, options), () => undefined);\n}\n","import { SegmentationRepresentations } from '../../../../enums';\nimport { computeAndAddRepresentation } from '../computeAndAddRepresentation';\nimport { computeLabelmapData } from './labelmapComputationStrategies';\nimport { defaultSegmentationStateManager } from '../../SegmentationStateManager';\nimport { triggerSegmentationDataModified } from '../../triggerSegmentationEvents';\nexport async function computeAndAddLabelmapRepresentation(segmentationId, options = {}) {\n    return computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Labelmap, () => computeLabelmapData(segmentationId, options), () => null, () => {\n        defaultSegmentationStateManager.processLabelmapRepresentationAddition(options.viewport.id, segmentationId);\n        setTimeout(() => {\n            triggerSegmentationDataModified(segmentationId);\n        }, 0);\n    });\n}\n","import { SegmentationRepresentations } from '../../../../enums';\nimport { computeAndAddRepresentation } from '../computeAndAddRepresentation';\nimport { computeSurfaceData } from './surfaceComputationStrategies';\nimport { updateSurfaceData } from './updateSurfaceData';\nexport function computeAndAddSurfaceRepresentation(segmentationId, options = {}) {\n    return computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Surface, () => computeSurfaceData(segmentationId, options), () => updateSurfaceData(segmentationId));\n}\n","import { cache } from '@cornerstonejs/core';\nimport { getUniqueSegmentIndices } from '../../../../utilities/segmentation/getUniqueSegmentIndices';\nimport { getViewportIdsWithSegmentation } from '../../getViewportIdsWithSegmentation';\nimport { getSegmentation } from '../../getSegmentation';\nimport { triggerSegmentationModified } from '../../triggerSegmentationEvents';\nimport { getSegmentationRepresentation } from '../../getSegmentationRepresentation';\nimport { SegmentationRepresentations } from '../../../../enums';\nimport { computeSurfaceFromLabelmapSegmentation } from './surfaceComputationStrategies';\nimport { createAndCacheSurfacesFromRaw } from './createAndCacheSurfacesFromRaw';\nexport async function updateSurfaceData(segmentationId) {\n    const surfacesObj = await computeSurfaceFromLabelmapSegmentation(segmentationId);\n    if (!surfacesObj) {\n        return;\n    }\n    const segmentation = getSegmentation(segmentationId);\n    const indices = getUniqueSegmentIndices(segmentationId);\n    if (!indices.length) {\n        const geometryIds = segmentation.representationData.Surface.geometryIds;\n        geometryIds.forEach((geometryId) => {\n            const geometry = cache.getGeometry(geometryId);\n            const surface = geometry.data;\n            surface.points = [];\n            surface.polys = [];\n        });\n        triggerSegmentationModified(segmentationId);\n        return;\n    }\n    const promises = surfacesObj.map(({ data, segmentIndex }) => {\n        const geometryId = `segmentation_${segmentationId}_surface_${segmentIndex}`;\n        const geometry = cache.getGeometry(geometryId);\n        if (!geometry) {\n            const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n            return viewportIds.map((viewportId) => {\n                const surfaceRepresentation = getSegmentationRepresentation(viewportId, {\n                    segmentationId,\n                    type: SegmentationRepresentations.Surface,\n                });\n                return [surfaceRepresentation].map((surfaceRepresentation) => {\n                    segmentation.representationData.Surface.geometryIds.set(segmentIndex, geometryId);\n                    return createAndCacheSurfacesFromRaw(segmentationId, [{ segmentIndex, data }], {\n                        segmentationId: surfaceRepresentation.segmentationId,\n                    });\n                });\n            });\n        }\n        else if (indices.includes(segmentIndex)) {\n            const surface = geometry.data;\n            surface.points = data.points;\n            surface.polys = data.polys;\n        }\n        else {\n            const surface = geometry.data;\n            surface.points = [];\n            surface.polys = [];\n        }\n    });\n    await Promise.all(promises);\n    triggerSegmentationModified(segmentationId);\n}\n","import { Enums, geometryLoader } from '@cornerstonejs/core';\nimport { getSegmentIndexColor } from '../../config/segmentationColor';\nimport { getSegmentation } from '../../getSegmentation';\nexport async function createAndCacheSurfacesFromRaw(segmentationId, rawSurfacesData, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    const geometryIds = new Map();\n    const promises = Object.keys(rawSurfacesData).map(async (index) => {\n        const rawSurfaceData = rawSurfacesData[index];\n        const segmentIndex = rawSurfaceData.segmentIndex;\n        const color = getSegmentIndexColor(options.viewport.id, segmentation.segmentationId, segmentIndex).slice(0, 3);\n        if (!color) {\n            throw new Error('No color found for segment index, unable to create surface');\n        }\n        const closedSurface = {\n            id: `segmentation_${segmentation.segmentationId}_surface_${segmentIndex}`,\n            color,\n            frameOfReferenceUID: 'test-frameOfReferenceUID',\n            points: rawSurfaceData.data.points,\n            polys: rawSurfaceData.data.polys,\n            segmentIndex,\n        };\n        const geometryId = closedSurface.id;\n        geometryIds.set(segmentIndex, geometryId);\n        return geometryLoader.createAndCacheGeometry(geometryId, {\n            type: Enums.GeometryType.SURFACE,\n            geometryData: closedSurface,\n        });\n    });\n    await Promise.all(promises);\n    return {\n        geometryIds,\n    };\n}\n","import { Enums, eventTarget, triggerEvent, getWebWorkerManager, } from '@cornerstonejs/core';\nimport { getAnnotation } from '../../../annotation/annotationState';\nimport { WorkerTypes } from '../../../../enums';\nconst workerManager = getWebWorkerManager();\nconst triggerWorkerProgress = (eventTarget, progress, id) => {\n    triggerEvent(eventTarget, Enums.Events.WEB_WORKER_PROGRESS, {\n        progress,\n        type: WorkerTypes.POLYSEG_CONTOUR_TO_SURFACE,\n        id,\n    });\n};\nexport async function convertContourToSurface(contourRepresentationData, segmentIndex) {\n    const { annotationUIDsMap } = contourRepresentationData;\n    const polylines = [];\n    const numPointsArray = [];\n    const annotationUIDs = annotationUIDsMap.get(segmentIndex);\n    for (const annotationUID of annotationUIDs) {\n        const annotation = getAnnotation(annotationUID);\n        const { polyline } = annotation.data\n            .contour;\n        numPointsArray.push(polyline.length);\n        polyline.forEach((polyline) => polylines.push(...polyline));\n    }\n    triggerWorkerProgress(eventTarget, 0, segmentIndex);\n    const results = await workerManager.executeTask('polySeg', 'convertContourToSurface', {\n        polylines,\n        numPointsArray,\n    }, {\n        callbacks: [\n            (progress) => {\n                triggerWorkerProgress(eventTarget, progress, segmentIndex);\n            },\n        ],\n    });\n    triggerWorkerProgress(eventTarget, 100, segmentIndex);\n    return results;\n}\n","import { cache, eventTarget, getWebWorkerManager, triggerEvent, Enums, } from '@cornerstonejs/core';\nimport { computeVolumeLabelmapFromStack } from '../../helpers/computeVolumeLabelmapFromStack';\nimport { WorkerTypes } from '../../../../enums';\nconst workerManager = getWebWorkerManager();\nconst triggerWorkerProgress = (eventTarget, progress, id) => {\n    triggerEvent(eventTarget, Enums.Events.WEB_WORKER_PROGRESS, {\n        progress,\n        type: WorkerTypes.POLYSEG_LABELMAP_TO_SURFACE,\n        id,\n    });\n};\nexport async function convertLabelmapToSurface(labelmapRepresentationData, segmentIndex) {\n    let volumeId;\n    if (labelmapRepresentationData.volumeId) {\n        volumeId = labelmapRepresentationData\n            .volumeId;\n    }\n    else {\n        const { imageIds } = labelmapRepresentationData;\n        ({ volumeId } = await computeVolumeLabelmapFromStack({\n            imageIds,\n        }));\n    }\n    const volume = cache.getVolume(volumeId);\n    const scalarData = volume.voxelManager.getCompleteScalarDataArray();\n    const { dimensions, spacing, origin, direction } = volume;\n    triggerWorkerProgress(eventTarget, 0, segmentIndex);\n    const results = await workerManager.executeTask('polySeg', 'convertLabelmapToSurface', {\n        scalarData,\n        dimensions,\n        spacing,\n        origin,\n        direction,\n        segmentIndex,\n    }, {\n        callbacks: [\n            (progress) => {\n                triggerWorkerProgress(eventTarget, progress, segmentIndex);\n            },\n        ],\n    });\n    triggerWorkerProgress(eventTarget, 100, segmentIndex);\n    return results;\n}\n","import { getUniqueSegmentIndices } from '../../../../utilities/segmentation/getUniqueSegmentIndices';\nimport { getSegmentation } from '../../getSegmentation';\nimport { convertContourToSurface } from './convertContourToSurface';\nimport { createAndCacheSurfacesFromRaw } from './createAndCacheSurfacesFromRaw';\nimport { convertLabelmapToSurface } from './convertLabelmapToSurface';\nexport async function computeSurfaceData(segmentationId, options = {}) {\n    const segmentIndices = options.segmentIndices?.length\n        ? options.segmentIndices\n        : getUniqueSegmentIndices(segmentationId);\n    let rawSurfacesData;\n    const segmentation = getSegmentation(segmentationId);\n    const representationData = segmentation.representationData;\n    try {\n        if (representationData.Contour) {\n            rawSurfacesData = await computeSurfaceFromContourSegmentation(segmentationId, {\n                segmentIndices,\n                ...options,\n            });\n        }\n        else if (representationData.Labelmap) {\n            rawSurfacesData = await computeSurfaceFromLabelmapSegmentation(segmentation.segmentationId, {\n                segmentIndices,\n                ...options,\n            });\n        }\n    }\n    catch (error) {\n        console.error(error);\n        throw error;\n    }\n    if (!rawSurfacesData) {\n        throw new Error('Not enough data to convert to surface, currently only support converting volume labelmap to surface if available');\n    }\n    const surfacesData = await createAndCacheSurfacesFromRaw(segmentationId, rawSurfacesData, options);\n    return surfacesData;\n}\nasync function computeSurfaceFromLabelmapSegmentation(segmentationId, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation?.representationData?.Labelmap) {\n        console.warn('Only support surface update from labelmaps');\n        return;\n    }\n    const labelmapRepresentationData = segmentation.representationData.Labelmap;\n    const segmentIndices = options.segmentIndices || getUniqueSegmentIndices(segmentationId);\n    const promises = segmentIndices.map((index) => {\n        const surface = convertLabelmapToSurface(labelmapRepresentationData, index);\n        return surface;\n    });\n    const surfaces = await Promise.allSettled(promises);\n    const errors = surfaces.filter((p) => p.status === 'rejected');\n    if (errors.length > 0) {\n        console.error(errors);\n        throw new Error('Failed to convert labelmap to surface');\n    }\n    const rawSurfacesData = surfaces\n        .map((surface, index) => {\n        if (surface.status === 'fulfilled') {\n            return { segmentIndex: segmentIndices[index], data: surface.value };\n        }\n    })\n        .filter(Boolean);\n    return rawSurfacesData;\n}\nasync function computeSurfaceFromContourSegmentation(segmentationId, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    const contourRepresentationData = segmentation.representationData.Contour;\n    const segmentIndices = options.segmentIndices || getUniqueSegmentIndices(segmentationId);\n    const promises = segmentIndices.map(async (index) => {\n        const surface = await convertContourToSurface(contourRepresentationData, index);\n        return { segmentIndex: index, data: surface };\n    });\n    const surfaces = await Promise.all(promises);\n    return surfaces;\n}\nexport { computeSurfaceFromContourSegmentation, computeSurfaceFromLabelmapSegmentation, };\n","import { SegmentationRepresentations } from '../../../enums';\nimport { getSegmentation } from '../getSegmentation';\nimport { validate as validateLabelmap } from '../../../tools/displayTools/Labelmap/validateLabelmap';\nconst conversionPaths = new Map([\n    [\n        SegmentationRepresentations.Labelmap,\n        new Set([\n            SegmentationRepresentations.Surface,\n            SegmentationRepresentations.Contour,\n        ]),\n    ],\n    [\n        SegmentationRepresentations.Contour,\n        new Set([\n            SegmentationRepresentations.Labelmap,\n            SegmentationRepresentations.Surface,\n        ]),\n    ],\n    [\n        SegmentationRepresentations.Surface,\n        new Set([SegmentationRepresentations.Labelmap]),\n    ],\n]);\nfunction canComputeRequestedRepresentation(segmentationId, type) {\n    const { representationData } = getSegmentation(segmentationId);\n    const existingRepresentationTypes = getExistingRepresentationTypes(representationData);\n    return existingRepresentationTypes.some((existingRepresentationType) => canConvertFromTo(existingRepresentationType, type));\n}\nfunction getExistingRepresentationTypes(representationData) {\n    const supportedTypes = [];\n    Object.keys(representationData).forEach((representationType) => {\n        const representationTypeData = representationData[representationType];\n        let validateFn;\n        switch (representationType) {\n            case SegmentationRepresentations.Labelmap:\n                validateFn = validateLabelmap;\n                break;\n        }\n        if (validateFn) {\n            try {\n                validateFn(representationTypeData);\n                supportedTypes.push(representationType);\n            }\n            catch (error) {\n                console.warn(`Validation failed for labelmap of type ${representationType}`);\n            }\n        }\n        else {\n            supportedTypes.push(representationType);\n        }\n    });\n    return supportedTypes;\n}\nasync function canConvertFromTo(fromRepresentationType, toRepresentationType) {\n    return (conversionPaths.get(fromRepresentationType)?.has(toRepresentationType) ||\n        false);\n}\nexport { canComputeRequestedRepresentation };\n","import { eventTarget } from '@cornerstonejs/core';\nimport { Events } from '../../../enums';\nimport addRepresentationData from '../internalAddRepresentationData';\nimport { triggerSegmentationModified } from '../triggerSegmentationEvents';\nimport debounce from '../../../utilities/debounce';\nimport { registerPolySegWorker } from './registerPolySegWorker';\nconst computedRepresentations = new Map();\nasync function computeAndAddRepresentation(segmentationId, type, computeFunction, updateFunction, onComputationComplete) {\n    registerPolySegWorker();\n    const data = await computeFunction();\n    addRepresentationData({\n        segmentationId,\n        type,\n        data,\n    });\n    onComputationComplete?.();\n    if (!computedRepresentations.has(segmentationId)) {\n        computedRepresentations.set(segmentationId, []);\n    }\n    const representations = computedRepresentations.get(segmentationId);\n    if (!representations.includes(type)) {\n        representations.push(type);\n    }\n    subscribeToSegmentationChanges(updateFunction);\n    triggerSegmentationModified(segmentationId);\n    return data;\n}\nfunction subscribeToSegmentationChanges(updateFunction) {\n    const debouncedUpdateFunction = (event) => {\n        _debouncedSegmentationModified(event, updateFunction);\n    };\n    updateFunction._debouncedUpdateFunction = debouncedUpdateFunction;\n    eventTarget.removeEventListener(Events.SEGMENTATION_DATA_MODIFIED, updateFunction._debouncedUpdateFunction);\n    eventTarget.addEventListener(Events.SEGMENTATION_DATA_MODIFIED, updateFunction._debouncedUpdateFunction);\n}\nconst _debouncedSegmentationModified = debounce((event, updateFunction) => {\n    const segmentationId = event.detail.segmentationId;\n    const representations = computedRepresentations.get(segmentationId);\n    if (!representations || !representations.length) {\n        return;\n    }\n    updateFunction(segmentationId);\n    if (representations.length) {\n        triggerSegmentationModified(segmentationId);\n    }\n}, 300);\nexport { computeAndAddRepresentation };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationRemoved } from './triggerSegmentationEvents';\nimport { removeSegmentationRepresentations } from './removeSegmentationRepresentations';\nexport function removeSegmentation(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const viewportsWithSegmentation = segmentationStateManager\n        .getAllViewportSegmentationRepresentations()\n        .filter(({ representations }) => representations.some((rep) => rep.segmentationId === segmentationId))\n        .map(({ viewportId }) => viewportId);\n    viewportsWithSegmentation.forEach((viewportId) => {\n        removeSegmentationRepresentations(viewportId, { segmentationId });\n    });\n    segmentationStateManager.removeSegmentation(segmentationId);\n    triggerSegmentationRemoved(segmentationId);\n}\nexport function removeAllSegmentations() {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const segmentations = segmentationStateManager.getState().segmentations;\n    segmentations.forEach((segmentation) => {\n        removeSegmentation(segmentation.segmentationId);\n    });\n    segmentationStateManager.resetState();\n}\n","import SegmentationRepresentations from '../../enums/SegmentationRepresentations';\nimport labelmapDisplay from '../../tools/displayTools/Labelmap/labelmapDisplay';\nimport contourDisplay from '../../tools/displayTools/Contour/contourDisplay';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { surfaceDisplay } from '../../tools/displayTools/Surface';\nfunction removeSegmentationRepresentation(viewportId, specifier, immediate) {\n    return _removeSegmentationRepresentations(viewportId, specifier, immediate);\n}\nfunction removeSegmentationRepresentations(viewportId, specifier, immediate) {\n    return _removeSegmentationRepresentations(viewportId, specifier, immediate);\n}\nfunction _removeSegmentationRepresentations(viewportId, specifier, immediate) {\n    const { segmentationId, type } = specifier;\n    _removeRepresentationObject(viewportId, segmentationId, type, immediate);\n    return defaultSegmentationStateManager.removeSegmentationRepresentations(viewportId, {\n        segmentationId,\n        type,\n    });\n}\nfunction removeAllSegmentationRepresentations() {\n    const state = defaultSegmentationStateManager.getAllViewportSegmentationRepresentations();\n    state.forEach(({ viewportId, representations }) => {\n        representations.forEach(({ segmentationId, type }) => {\n            removeSegmentationRepresentation(viewportId, {\n                segmentationId,\n                type,\n            });\n        });\n    });\n    defaultSegmentationStateManager.resetState();\n}\nfunction removeLabelmapRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Labelmap,\n    }, immediate);\n}\nfunction removeContourRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Contour,\n    }, immediate);\n}\nfunction removeSurfaceRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Surface,\n    }, immediate);\n}\nfunction _removeRepresentationObject(viewportId, segmentationId, type, immediate) {\n    const representations = getSegmentationRepresentations(viewportId, {\n        segmentationId,\n        type,\n    });\n    representations.forEach((representation) => {\n        if (representation.type === SegmentationRepresentations.Labelmap) {\n            labelmapDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n        else if (representation.type === SegmentationRepresentations.Contour) {\n            contourDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n        else if (representation.type === SegmentationRepresentations.Surface) {\n            surfaceDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n    });\n    const { viewport } = getEnabledElementByViewportId(viewportId) || {};\n    if (viewport) {\n        viewport.render();\n    }\n}\nexport { removeSegmentationRepresentation, removeSegmentationRepresentations, removeAllSegmentationRepresentations, removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, };\n","import { getToolGroupForViewport } from '../../store/ToolGroupManager';\nimport { invalidateBrushCursor } from '../../utilities/segmentation/invalidateBrushCursor';\nimport { getSegmentation } from './getSegmentation';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport { getActiveSegmentIndex } from './getActiveSegmentIndex';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nfunction setActiveSegmentIndex(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (typeof segmentIndex === 'string') {\n        console.warn('segmentIndex is a string, converting to number');\n        segmentIndex = Number(segmentIndex);\n    }\n    Object.values(segmentation.segments).forEach((segment) => {\n        segment.active = false;\n    });\n    if (!segmentation.segments[segmentIndex]) {\n        segmentation.segments[segmentIndex] = {\n            segmentIndex,\n            label: '',\n            locked: false,\n            cachedStats: {},\n            active: false,\n        };\n    }\n    if (segmentation.segments[segmentIndex].active !== true) {\n        segmentation.segments[segmentIndex].active = true;\n        triggerSegmentationModified(segmentationId);\n    }\n    const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n    viewportIds.forEach((viewportId) => {\n        const representations = getSegmentationRepresentations(viewportId, {\n            segmentationId,\n        });\n        representations.forEach((representation) => {\n            if (!representation.segments[segmentIndex]) {\n                representation.segments[segmentIndex] = {\n                    visible: true,\n                };\n            }\n        });\n    });\n    viewportIds.forEach((viewportId) => {\n        const toolGroup = getToolGroupForViewport(viewportId);\n        invalidateBrushCursor(toolGroup.id);\n    });\n}\nexport { setActiveSegmentIndex, getActiveSegmentIndex };\n","import { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nfunction isSegmentIndexLocked(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    return segments[segmentIndex].locked;\n}\nfunction setSegmentIndexLocked(segmentationId, segmentIndex, locked = true) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    segments[segmentIndex].locked = locked;\n    triggerSegmentationModified(segmentationId);\n}\nfunction getLockedSegmentIndices(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    const lockedSegmentIndices = Object.keys(segments).filter((segmentIndex) => segments[segmentIndex].locked);\n    return lockedSegmentIndices.map((segmentIndex) => parseInt(segmentIndex));\n}\nexport { isSegmentIndexLocked, setSegmentIndexLocked, getLockedSegmentIndices };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function removeColorLUT(colorLUTIndex) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.removeColorLUT(colorLUTIndex);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getStackSegmentationImageIdsForViewport(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getStackSegmentationImageIdsForViewport(viewportId, segmentationId);\n}\n","import { getSegmentation } from './getSegmentation';\nimport { getSegmentations } from './getSegmentations';\nimport { addSegmentations } from './addSegmentations';\nimport { removeAllSegmentations, removeSegmentation, } from './removeSegmentation';\nimport { removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentation, removeAllSegmentationRepresentations, } from './removeSegmentationRepresentations';\nimport { addColorLUT } from './addColorLUT';\nimport { getColorLUT } from './getColorLUT';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport { removeColorLUT } from './removeColorLUT';\nimport { getViewportSegmentations } from './getViewportSegmentations';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { getCurrentLabelmapImageIdForViewport } from './getCurrentLabelmapImageIdForViewport';\nimport { updateLabelmapSegmentationImageReferences } from './updateLabelmapSegmentationImageReferences';\nimport { getStackSegmentationImageIdsForViewport } from './getStackSegmentationImageIdsForViewport';\nimport { getSegmentationRepresentation, getSegmentationRepresentations, getSegmentationRepresentationsBySegmentationId, } from './getSegmentationRepresentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nfunction destroy() {\n    defaultSegmentationStateManager.resetState();\n}\nexport { getColorLUT, getCurrentLabelmapImageIdForViewport, getNextColorLUTIndex, getSegmentation, getSegmentations, getStackSegmentationImageIdsForViewport, getViewportIdsWithSegmentation, getSegmentationRepresentation, getSegmentationRepresentations, removeColorLUT, getViewportSegmentations, removeSegmentation, removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentation, removeAllSegmentationRepresentations, removeAllSegmentations, addColorLUT, addSegmentations, updateLabelmapSegmentationImageReferences, getSegmentationRepresentationsBySegmentationId, destroy, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function updateLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.updateLabelmapSegmentationImageReferences(viewportId, segmentationId);\n}\n","import { getRenderingEngines } from '@cornerstonejs/core';\nimport { state } from '../state';\nfunction getToolGroupForViewport(viewportId, renderingEngineId) {\n    if (!renderingEngineId) {\n        renderingEngineId = getRenderingEngines().find((re) => re.getViewports().find((vp) => vp.id === viewportId))?.id;\n    }\n    const toolGroupFilteredByIds = state.toolGroups.filter((tg) => tg.viewportsInfo.some((vp) => vp.renderingEngineId === renderingEngineId &&\n        (!vp.viewportId || vp.viewportId === viewportId)));\n    if (!toolGroupFilteredByIds.length) {\n        return;\n    }\n    if (toolGroupFilteredByIds.length > 1) {\n        throw new Error(`Multiple tool groups found for renderingEngineId: ${renderingEngineId} and viewportId: ${viewportId}. You should only\n      have one tool group per viewport in a renderingEngine.`);\n    }\n    return toolGroupFilteredByIds[0];\n}\nexport default getToolGroupForViewport;\n","import { state } from '../state';\nfunction getToolGroup(toolGroupId) {\n    return state.toolGroups.find((s) => s.id === toolGroupId);\n}\nexport default getToolGroup;\n","import { MouseBindings, ToolModes, Events } from '../../enums';\nimport get from 'lodash.get';\nimport { triggerEvent, eventTarget, getRenderingEngine, getRenderingEngines, getEnabledElementByIds, Settings, } from '@cornerstonejs/core';\nimport { utilities } from '@cornerstonejs/core';\nimport { state } from '../state';\nimport { MouseCursor, SVGMouseCursor } from '../../cursors';\nimport { initElementCursor } from '../../cursors/elementCursor';\nimport getToolGroup from './getToolGroup';\nconst { Active, Passive, Enabled, Disabled } = ToolModes;\nconst PRIMARY_BINDINGS = [{ mouseButton: MouseBindings.Primary }];\nexport default class ToolGroup {\n    constructor(id) {\n        this.viewportsInfo = [];\n        this.toolOptions = {};\n        this.currentActivePrimaryToolName = null;\n        this.prevActivePrimaryToolName = null;\n        this.restoreToolOptions = {};\n        this._toolInstances = {};\n        this.id = id;\n    }\n    getViewportIds() {\n        return this.viewportsInfo.map(({ viewportId }) => viewportId);\n    }\n    getViewportsInfo() {\n        return this.viewportsInfo.slice();\n    }\n    getToolInstance(toolInstanceName) {\n        const toolInstance = this._toolInstances[toolInstanceName];\n        if (!toolInstance) {\n            console.warn(`'${toolInstanceName}' is not registered with this toolGroup (${this.id}).`);\n            return;\n        }\n        return toolInstance;\n    }\n    getToolInstances() {\n        return this._toolInstances;\n    }\n    hasTool(toolName) {\n        return !!this._toolInstances[toolName];\n    }\n    addTool(toolName, configuration = {}) {\n        const toolDefinition = state.tools[toolName];\n        const hasToolName = typeof toolName !== 'undefined' && toolName !== '';\n        const localToolInstance = this.toolOptions[toolName];\n        if (!hasToolName) {\n            console.warn('Tool with configuration did not produce a toolName: ', configuration);\n            return;\n        }\n        if (!toolDefinition) {\n            console.warn(`'${toolName}' is not registered with the library. You need to use cornerstoneTools.addTool to register it.`);\n            return;\n        }\n        if (localToolInstance) {\n            console.warn(`'${toolName}' is already registered for ToolGroup ${this.id}.`);\n            return;\n        }\n        const { toolClass: ToolClass } = toolDefinition;\n        const toolProps = {\n            name: toolName,\n            toolGroupId: this.id,\n            configuration,\n        };\n        const instantiatedTool = new ToolClass(toolProps);\n        this._toolInstances[toolName] = instantiatedTool;\n    }\n    addToolInstance(toolName, parentClassName, configuration = {}) {\n        let ToolClassToUse = state.tools[toolName]\n            ?.toolClass;\n        if (!ToolClassToUse) {\n            const ParentClass = state.tools[parentClassName]\n                .toolClass;\n            class ToolInstance extends ParentClass {\n            }\n            ToolInstance.toolName = toolName;\n            ToolClassToUse = ToolInstance;\n            state.tools[toolName] = {\n                toolClass: ToolInstance,\n            };\n        }\n        this.addTool(ToolClassToUse.toolName, configuration);\n    }\n    addViewport(viewportId, renderingEngineId) {\n        if (typeof viewportId !== 'string') {\n            throw new Error('viewportId must be defined and be a string');\n        }\n        const renderingEngineUIDToUse = this._findRenderingEngine(viewportId, renderingEngineId);\n        if (!this.viewportsInfo.some(({ viewportId: vpId }) => vpId === viewportId)) {\n            this.viewportsInfo.push({\n                viewportId,\n                renderingEngineId: renderingEngineUIDToUse,\n            });\n        }\n        const toolName = this.getActivePrimaryMouseButtonTool();\n        const runtimeSettings = Settings.getRuntimeSettings();\n        if (runtimeSettings.get('useCursors')) {\n            this.setViewportsCursorByToolName(toolName);\n        }\n        const eventDetail = {\n            toolGroupId: this.id,\n            viewportId,\n            renderingEngineId: renderingEngineUIDToUse,\n        };\n        triggerEvent(eventTarget, Events.TOOLGROUP_VIEWPORT_ADDED, eventDetail);\n    }\n    removeViewports(renderingEngineId, viewportId) {\n        const indices = [];\n        this.viewportsInfo.forEach((vpInfo, index) => {\n            let match = false;\n            if (vpInfo.renderingEngineId === renderingEngineId) {\n                match = true;\n                if (viewportId && vpInfo.viewportId !== viewportId) {\n                    match = false;\n                }\n            }\n            if (match) {\n                indices.push(index);\n            }\n        });\n        if (indices.length) {\n            for (let i = indices.length - 1; i >= 0; i--) {\n                this.viewportsInfo.splice(indices[i], 1);\n            }\n        }\n        const eventDetail = {\n            toolGroupId: this.id,\n            viewportId,\n            renderingEngineId,\n        };\n        triggerEvent(eventTarget, Events.TOOLGROUP_VIEWPORT_REMOVED, eventDetail);\n    }\n    setActiveStrategy(toolName, strategyName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool configuration.`);\n            return;\n        }\n        toolInstance.setActiveStrategy(strategyName);\n    }\n    setToolMode(toolName, mode, options = {}) {\n        if (!toolName) {\n            console.warn('setToolMode: toolName must be defined');\n            return;\n        }\n        if (mode === ToolModes.Active) {\n            this.setToolActive(toolName, options || this.restoreToolOptions[toolName]);\n            return;\n        }\n        if (mode === ToolModes.Passive) {\n            this.setToolPassive(toolName);\n            return;\n        }\n        if (mode === ToolModes.Enabled) {\n            this.setToolEnabled(toolName);\n            return;\n        }\n        if (mode === ToolModes.Disabled) {\n            this.setToolDisabled(toolName);\n            return;\n        }\n        console.warn('setToolMode: mode must be defined');\n    }\n    setToolActive(toolName, toolBindingsOptions = {}) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        if (!toolInstance) {\n            console.warn(`'${toolName}' instance ${toolInstance} is not registered with this toolGroup, can't set tool mode.`);\n            return;\n        }\n        const prevBindings = this.toolOptions[toolName]\n            ? this.toolOptions[toolName].bindings\n            : [];\n        const newBindings = toolBindingsOptions.bindings\n            ? toolBindingsOptions.bindings\n            : [];\n        const bindingsToUse = [...prevBindings, ...newBindings].reduce((unique, binding) => {\n            const TouchBinding = binding.numTouchPoints !== undefined;\n            const MouseBinding = binding.mouseButton !== undefined;\n            if (!unique.some((obj) => hasSameBinding(obj, binding)) &&\n                (TouchBinding || MouseBinding)) {\n                unique.push(binding);\n            }\n            return unique;\n        }, []);\n        const toolOptions = {\n            bindings: bindingsToUse,\n            mode: Active,\n        };\n        this.toolOptions[toolName] = toolOptions;\n        this._toolInstances[toolName].mode = Active;\n        const runtimeSettings = Settings.getRuntimeSettings();\n        const useCursor = runtimeSettings.get('useCursors');\n        if (this._hasMousePrimaryButtonBinding(toolBindingsOptions) && useCursor) {\n            this.setViewportsCursorByToolName(toolName);\n        }\n        else {\n            const activeToolIdentifier = this.getActivePrimaryMouseButtonTool();\n            if (!activeToolIdentifier && useCursor) {\n                const cursor = MouseCursor.getDefinedCursor('default');\n                this._setCursorForViewports(cursor);\n            }\n        }\n        if (this._hasMousePrimaryButtonBinding(toolBindingsOptions)) {\n            if (this.prevActivePrimaryToolName === null) {\n                this.prevActivePrimaryToolName = toolName;\n            }\n            else {\n                this.prevActivePrimaryToolName = this.currentActivePrimaryToolName;\n            }\n            this.currentActivePrimaryToolName = toolName;\n        }\n        if (typeof toolInstance.onSetToolActive === 'function') {\n            toolInstance.onSetToolActive();\n        }\n        this._renderViewports();\n        const eventDetail = {\n            toolGroupId: this.id,\n            toolName,\n            toolBindingsOptions,\n        };\n        triggerEvent(eventTarget, Events.TOOL_ACTIVATED, eventDetail);\n        this._triggerToolModeChangedEvent(toolName, Active, toolBindingsOptions);\n    }\n    setToolPassive(toolName, options) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const prevToolOptions = this.getToolOptions(toolName);\n        const toolOptions = Object.assign({\n            bindings: prevToolOptions ? prevToolOptions.bindings : [],\n        }, prevToolOptions, {\n            mode: Passive,\n        });\n        const matchBindings = Array.isArray(options?.removeAllBindings)\n            ? options.removeAllBindings\n            : this.getDefaultPrimaryBindings();\n        toolOptions.bindings = toolOptions.bindings.filter((binding) => options?.removeAllBindings !== true &&\n            !matchBindings.some((matchBinding) => hasSameBinding(binding, matchBinding)));\n        let mode = Passive;\n        if (toolOptions.bindings.length !== 0) {\n            mode = Active;\n            toolOptions.mode = mode;\n        }\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = mode;\n        if (typeof toolInstance.onSetToolPassive === 'function') {\n            toolInstance.onSetToolPassive();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Passive);\n    }\n    setToolEnabled(toolName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const toolOptions = {\n            bindings: [],\n            mode: Enabled,\n        };\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = Enabled;\n        if (typeof toolInstance.onSetToolEnabled === 'function') {\n            toolInstance.onSetToolEnabled();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Enabled);\n    }\n    setToolDisabled(toolName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const toolOptions = {\n            bindings: [],\n            mode: Disabled,\n        };\n        this.restoreToolOptions[toolName] = this.toolOptions[toolName];\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = Disabled;\n        if (typeof toolInstance.onSetToolDisabled === 'function') {\n            toolInstance.onSetToolDisabled();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Disabled);\n    }\n    getToolOptions(toolName) {\n        const toolOptionsForTool = this.toolOptions[toolName];\n        if (toolOptionsForTool === undefined) {\n            return;\n        }\n        return toolOptionsForTool;\n    }\n    getActivePrimaryMouseButtonTool() {\n        return Object.keys(this.toolOptions).find((toolName) => {\n            const toolOptions = this.toolOptions[toolName];\n            return (toolOptions.mode === Active &&\n                this._hasMousePrimaryButtonBinding(toolOptions));\n        });\n    }\n    setViewportsCursorByToolName(toolName, strategyName) {\n        const cursor = this._getCursor(toolName, strategyName);\n        this._setCursorForViewports(cursor);\n    }\n    _getCursor(toolName, strategyName) {\n        let cursorName;\n        let cursor;\n        if (strategyName) {\n            cursorName = `${toolName}.${strategyName}`;\n            cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n            if (cursor) {\n                return cursor;\n            }\n        }\n        cursorName = `${toolName}`;\n        cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n        if (cursor) {\n            return cursor;\n        }\n        cursorName = toolName;\n        cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n        if (cursor) {\n            return cursor;\n        }\n        return MouseCursor.getDefinedCursor('default');\n    }\n    _setCursorForViewports(cursor) {\n        this.viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            initElementCursor(viewport.element, cursor);\n        });\n    }\n    setToolConfiguration(toolName, configuration, overwrite) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not present, can't set tool configuration.`);\n            return false;\n        }\n        let _configuration;\n        if (overwrite) {\n            _configuration = configuration;\n        }\n        else {\n            _configuration = Object.assign(toolInstance.configuration, configuration);\n        }\n        toolInstance.configuration = _configuration;\n        if (typeof toolInstance.onSetToolConfiguration === 'function') {\n            toolInstance.onSetToolConfiguration();\n        }\n        this._renderViewports();\n        return true;\n    }\n    getDefaultMousePrimary() {\n        return MouseBindings.Primary;\n    }\n    getDefaultPrimaryBindings() {\n        return PRIMARY_BINDINGS;\n    }\n    getToolConfiguration(toolName, configurationPath) {\n        if (this._toolInstances[toolName] === undefined) {\n            console.warn(`Tool ${toolName} not present, can't set tool configuration.`);\n            return;\n        }\n        const _configuration = get(this._toolInstances[toolName].configuration, configurationPath) ||\n            this._toolInstances[toolName].configuration;\n        return utilities.deepClone(_configuration);\n    }\n    getPrevActivePrimaryToolName() {\n        return this.prevActivePrimaryToolName;\n    }\n    setActivePrimaryTool(toolName) {\n        const activeToolName = this.getCurrentActivePrimaryToolName();\n        this.setToolDisabled(activeToolName);\n        this.setToolActive(toolName, {\n            bindings: [{ mouseButton: MouseBindings.Primary }],\n        });\n    }\n    getCurrentActivePrimaryToolName() {\n        return this.currentActivePrimaryToolName;\n    }\n    clone(newToolGroupId, fnToolFilter = null) {\n        let toolGroup = getToolGroup(newToolGroupId);\n        if (toolGroup) {\n            console.debug(`ToolGroup ${newToolGroupId} already exists`);\n            return toolGroup;\n        }\n        toolGroup = new ToolGroup(newToolGroupId);\n        state.toolGroups.push(toolGroup);\n        fnToolFilter = fnToolFilter ?? (() => true);\n        Object.keys(this._toolInstances)\n            .filter(fnToolFilter)\n            .forEach((toolName) => {\n            const sourceToolInstance = this._toolInstances[toolName];\n            const sourceToolOptions = this.toolOptions[toolName];\n            const sourceToolMode = sourceToolInstance.mode;\n            toolGroup.addTool(toolName);\n            toolGroup.setToolMode(toolName, sourceToolMode, {\n                bindings: sourceToolOptions.bindings ?? [],\n            });\n        });\n        return toolGroup;\n    }\n    _hasMousePrimaryButtonBinding(toolOptions) {\n        const primaryBindings = this.getDefaultPrimaryBindings();\n        return toolOptions?.bindings?.some((binding) => primaryBindings.some((primary) => hasSameBinding(binding, primary)));\n    }\n    _renderViewports() {\n        this.viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            getRenderingEngine(renderingEngineId).renderViewport(viewportId);\n        });\n    }\n    _triggerToolModeChangedEvent(toolName, mode, toolBindingsOptions) {\n        const eventDetail = {\n            toolGroupId: this.id,\n            toolName,\n            mode,\n            toolBindingsOptions,\n        };\n        triggerEvent(eventTarget, Events.TOOL_MODE_CHANGED, eventDetail);\n    }\n    _findRenderingEngine(viewportId, renderingEngineId) {\n        const renderingEngines = getRenderingEngines();\n        if (renderingEngines?.length === 0) {\n            throw new Error('No rendering engines found.');\n        }\n        if (renderingEngineId) {\n            return renderingEngineId;\n        }\n        const matchingEngines = renderingEngines.filter((engine) => engine.getViewport(viewportId));\n        if (matchingEngines.length === 0) {\n            if (renderingEngines.length === 1) {\n                return renderingEngines[0].id;\n            }\n            throw new Error('No rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.');\n        }\n        if (matchingEngines.length > 1) {\n            throw new Error('Multiple rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.');\n        }\n        return matchingEngines[0].id;\n    }\n}\nfunction hasSameBinding(binding1, binding2) {\n    if (binding1.mouseButton !== binding2.mouseButton) {\n        return false;\n    }\n    if (binding1.numTouchPoints !== binding2.numTouchPoints) {\n        return false;\n    }\n    return binding1.modifierKey === binding2.modifierKey;\n}\n","import { state } from '../state';\nimport ToolGroup from './ToolGroup';\nfunction createToolGroup(toolGroupId) {\n    const toolGroupWithIdExists = state.toolGroups.some((tg) => tg.id === toolGroupId);\n    if (toolGroupWithIdExists) {\n        console.warn(`'${toolGroupId}' already exists.`);\n        return;\n    }\n    const toolGroup = new ToolGroup(toolGroupId);\n    state.toolGroups.push(toolGroup);\n    return toolGroup;\n}\nexport default createToolGroup;\n","import { state } from '../state';\nfunction destroyToolGroup(toolGroupId) {\n    const toolGroupIndex = state.toolGroups.findIndex((tg) => tg.id === toolGroupId);\n    if (toolGroupIndex > -1) {\n        state.toolGroups.splice(toolGroupIndex, 1);\n    }\n}\nexport default destroyToolGroup;\n","import { state } from '../state';\nimport destroyToolGroup from './destroyToolGroup';\nfunction destroy() {\n    const toolGroups = [...state.toolGroups];\n    for (const toolGroup of toolGroups) {\n        destroyToolGroup(toolGroup.id);\n    }\n    state.toolGroups = [];\n}\nexport default destroy;\n","import { state } from '../state';\nfunction getAllToolGroups() {\n    return state.toolGroups;\n}\nexport default getAllToolGroups;\n","import { state } from '../state';\nimport { ToolModes } from '../../enums';\nconst MODES = [ToolModes.Active, ToolModes.Passive, ToolModes.Enabled];\nfunction getToolGroupsWithToolName(toolName) {\n    return state.toolGroups.filter(({ toolOptions }) => {\n        const toolGroupToolNames = Object.keys(toolOptions);\n        for (let i = 0; i < toolGroupToolNames.length; i++) {\n            if (toolName !== toolGroupToolNames[i]) {\n                continue;\n            }\n            if (!toolOptions[toolName]) {\n                continue;\n            }\n            if (MODES.includes(toolOptions[toolName].mode)) {\n                return true;\n            }\n        }\n        return false;\n    });\n}\nexport default getToolGroupsWithToolName;\n","import { state } from './state';\nexport function addTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    const toolAlreadyAdded = state.tools[toolName] !== undefined;\n    if (!toolName) {\n        throw new Error(`No Tool Found for the ToolClass ${ToolClass.name}`);\n    }\n    state.tools[toolName] = {\n        toolClass: ToolClass,\n    };\n}\nexport function hasTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    return !!(toolName && state.tools[toolName]);\n}\nexport function hasToolByName(toolName) {\n    return !!(toolName && state.tools[toolName]);\n}\nexport function removeTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    if (!toolName) {\n        throw new Error(`No tool found for: ${ToolClass.name}`);\n    }\n    if (!state.tools[toolName] !== undefined) {\n        delete state.tools[toolName];\n    }\n    else {\n        throw new Error(`${toolName} cannot be removed because it has not been added`);\n    }\n}\nexport default addTool;\n","import svgNodeCache, { resetSvgNodeCache } from './svgNodeCache';\nconst defaultState = {\n    isInteractingWithTool: false,\n    isMultiPartToolActive: false,\n    tools: {},\n    toolGroups: [],\n    synchronizers: [],\n    svgNodeCache: svgNodeCache,\n    enabledElements: [],\n    handleRadius: 6,\n};\nlet state = {\n    isInteractingWithTool: false,\n    isMultiPartToolActive: false,\n    tools: {},\n    toolGroups: [],\n    synchronizers: [],\n    svgNodeCache: svgNodeCache,\n    enabledElements: [],\n    handleRadius: 6,\n};\nfunction resetCornerstoneToolsState() {\n    resetSvgNodeCache();\n    state = {\n        ...structuredClone({\n            ...defaultState,\n            svgNodeCache: {},\n        }),\n        svgNodeCache: {\n            ...defaultState.svgNodeCache,\n        },\n    };\n}\nexport { resetCornerstoneToolsState, state, state as default };\n","let svgNodeCache = {};\nexport function resetSvgNodeCache() {\n    svgNodeCache = {};\n}\nexport default svgNodeCache;\n","import { vec2, vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawLine as drawLineSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as lineSegment from '../../utilities/math/line';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nconst { transformWorldToIndex } = csUtils;\nclass BidirectionalTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            let canvasPoint1 = viewport.worldToCanvas(points[0]);\n            let canvasPoint2 = viewport.worldToCanvas(points[1]);\n            let line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            let distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            canvasPoint1 = viewport.worldToCanvas(points[2]);\n            canvasPoint2 = viewport.worldToCanvas(points[3]);\n            line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const data = annotation.data;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            hideElementCursor(element);\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            if (this.editData.handleIndex !== undefined) {\n                const { points } = data.handles;\n                const firstLineSegmentLength = vec3.distance(points[0], points[1]);\n                const secondLineSegmentLength = vec3.distance(points[2], points[3]);\n                if (secondLineSegmentLength > firstLineSegmentLength) {\n                    const longAxis = [[...points[2]], [...points[3]]];\n                    const shortAxisPoint0 = [...points[0]];\n                    const shortAxisPoint1 = [...points[1]];\n                    const longAxisVector = vec2.create();\n                    vec2.set(longAxisVector, longAxis[1][0] - longAxis[0][0], longAxis[1][1] - longAxis[1][0]);\n                    const counterClockWisePerpendicularToLongAxis = vec2.create();\n                    vec2.set(counterClockWisePerpendicularToLongAxis, -longAxisVector[1], longAxisVector[0]);\n                    const currentShortAxisVector = vec2.create();\n                    vec2.set(currentShortAxisVector, shortAxisPoint1[0] - shortAxisPoint0[0], shortAxisPoint1[1] - shortAxisPoint0[0]);\n                    let shortAxis;\n                    if (vec2.dot(currentShortAxisVector, counterClockWisePerpendicularToLongAxis) > 0) {\n                        shortAxis = [shortAxisPoint0, shortAxisPoint1];\n                    }\n                    else {\n                        shortAxis = [shortAxisPoint1, shortAxisPoint0];\n                    }\n                    data.handles.points = [\n                        longAxis[0],\n                        longAxis[1],\n                        shortAxis[0],\n                        shortAxis[1],\n                    ];\n                }\n            }\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { worldToCanvas } = viewport;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            const worldPos = currentPoints.world;\n            data.handles.points[handleIndex] = [...worldPos];\n            const canvasCoordPoints = data.handles.points.map(worldToCanvas);\n            const canvasCoords = {\n                longLineSegment: {\n                    start: {\n                        x: canvasCoordPoints[0][0],\n                        y: canvasCoordPoints[0][1],\n                    },\n                    end: {\n                        x: canvasCoordPoints[1][0],\n                        y: canvasCoordPoints[1][1],\n                    },\n                },\n                shortLineSegment: {\n                    start: {\n                        x: canvasCoordPoints[2][0],\n                        y: canvasCoordPoints[2][1],\n                    },\n                    end: {\n                        x: canvasCoordPoints[3][0],\n                        y: canvasCoordPoints[3][1],\n                    },\n                },\n            };\n            const dist = vec2.distance(canvasCoordPoints[0], canvasCoordPoints[1]);\n            const shortAxisDistFromCenter = dist / 3;\n            const dx = canvasCoords.longLineSegment.start.x - canvasCoords.longLineSegment.end.x;\n            const dy = canvasCoords.longLineSegment.start.y - canvasCoords.longLineSegment.end.y;\n            const length = Math.sqrt(dx * dx + dy * dy);\n            const vectorX = dx / length;\n            const vectorY = dy / length;\n            const xMid = (canvasCoords.longLineSegment.start.x +\n                canvasCoords.longLineSegment.end.x) /\n                2;\n            const yMid = (canvasCoords.longLineSegment.start.y +\n                canvasCoords.longLineSegment.end.y) /\n                2;\n            const startX = xMid + shortAxisDistFromCenter * vectorY;\n            const startY = yMid - shortAxisDistFromCenter * vectorX;\n            const endX = xMid - shortAxisDistFromCenter * vectorY;\n            const endY = yMid + shortAxisDistFromCenter * vectorX;\n            data.handles.points[2] = viewport.canvasToWorld([startX, startY]);\n            data.handles.points[3] = viewport.canvasToWorld([endX, endY]);\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.editData.hasMoved = true;\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragModifyHandle(evt);\n                annotation.invalidated = true;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { annotation, handleIndex: movingHandleIndex } = this.editData;\n            const { data } = annotation;\n            const worldPos = currentPoints.world;\n            const canvasCoordHandlesCurrent = [\n                viewport.worldToCanvas(data.handles.points[0]),\n                viewport.worldToCanvas(data.handles.points[1]),\n                viewport.worldToCanvas(data.handles.points[2]),\n                viewport.worldToCanvas(data.handles.points[3]),\n            ];\n            const firstLineSegment = {\n                start: {\n                    x: canvasCoordHandlesCurrent[0][0],\n                    y: canvasCoordHandlesCurrent[0][1],\n                },\n                end: {\n                    x: canvasCoordHandlesCurrent[1][0],\n                    y: canvasCoordHandlesCurrent[1][1],\n                },\n            };\n            const secondLineSegment = {\n                start: {\n                    x: canvasCoordHandlesCurrent[2][0],\n                    y: canvasCoordHandlesCurrent[2][1],\n                },\n                end: {\n                    x: canvasCoordHandlesCurrent[3][0],\n                    y: canvasCoordHandlesCurrent[3][1],\n                },\n            };\n            const proposedPoint = [...worldPos];\n            const proposedCanvasCoord = viewport.worldToCanvas(proposedPoint);\n            if (movingHandleIndex === 0 || movingHandleIndex === 1) {\n                const fixedHandleIndex = movingHandleIndex === 0 ? 1 : 0;\n                const fixedHandleCanvasCoord = canvasCoordHandlesCurrent[fixedHandleIndex];\n                const fixedHandleToProposedCoordVec = vec2.set(vec2.create(), proposedCanvasCoord[0] - fixedHandleCanvasCoord[0], proposedCanvasCoord[1] - fixedHandleCanvasCoord[1]);\n                const fixedHandleToOldCoordVec = vec2.set(vec2.create(), canvasCoordHandlesCurrent[movingHandleIndex][0] -\n                    fixedHandleCanvasCoord[0], canvasCoordHandlesCurrent[movingHandleIndex][1] -\n                    fixedHandleCanvasCoord[1]);\n                vec2.normalize(fixedHandleToProposedCoordVec, fixedHandleToProposedCoordVec);\n                vec2.normalize(fixedHandleToOldCoordVec, fixedHandleToOldCoordVec);\n                const proposedFirstLineSegment = {\n                    start: {\n                        x: fixedHandleCanvasCoord[0],\n                        y: fixedHandleCanvasCoord[1],\n                    },\n                    end: {\n                        x: proposedCanvasCoord[0],\n                        y: proposedCanvasCoord[1],\n                    },\n                };\n                if (this._movingLongAxisWouldPutItThroughShortAxis(proposedFirstLineSegment, secondLineSegment)) {\n                    return;\n                }\n                const centerOfRotation = fixedHandleCanvasCoord;\n                const angle = this._getSignedAngle(fixedHandleToOldCoordVec, fixedHandleToProposedCoordVec);\n                let firstPointX = canvasCoordHandlesCurrent[2][0];\n                let firstPointY = canvasCoordHandlesCurrent[2][1];\n                let secondPointX = canvasCoordHandlesCurrent[3][0];\n                let secondPointY = canvasCoordHandlesCurrent[3][1];\n                firstPointX -= centerOfRotation[0];\n                firstPointY -= centerOfRotation[1];\n                secondPointX -= centerOfRotation[0];\n                secondPointY -= centerOfRotation[1];\n                const rotatedFirstPoint = firstPointX * Math.cos(angle) - firstPointY * Math.sin(angle);\n                const rotatedFirstPointY = firstPointX * Math.sin(angle) + firstPointY * Math.cos(angle);\n                const rotatedSecondPoint = secondPointX * Math.cos(angle) - secondPointY * Math.sin(angle);\n                const rotatedSecondPointY = secondPointX * Math.sin(angle) + secondPointY * Math.cos(angle);\n                firstPointX = rotatedFirstPoint + centerOfRotation[0];\n                firstPointY = rotatedFirstPointY + centerOfRotation[1];\n                secondPointX = rotatedSecondPoint + centerOfRotation[0];\n                secondPointY = rotatedSecondPointY + centerOfRotation[1];\n                const newFirstPoint = viewport.canvasToWorld([firstPointX, firstPointY]);\n                const newSecondPoint = viewport.canvasToWorld([\n                    secondPointX,\n                    secondPointY,\n                ]);\n                data.handles.points[movingHandleIndex] = proposedPoint;\n                data.handles.points[2] = newFirstPoint;\n                data.handles.points[3] = newSecondPoint;\n            }\n            else {\n                const translateHandleIndex = movingHandleIndex === 2 ? 3 : 2;\n                const canvasCoordsCurrent = {\n                    longLineSegment: {\n                        start: firstLineSegment.start,\n                        end: firstLineSegment.end,\n                    },\n                    shortLineSegment: {\n                        start: secondLineSegment.start,\n                        end: secondLineSegment.end,\n                    },\n                };\n                const longLineSegmentVec = vec2.subtract(vec2.create(), [\n                    canvasCoordsCurrent.longLineSegment.end.x,\n                    canvasCoordsCurrent.longLineSegment.end.y,\n                ], [\n                    canvasCoordsCurrent.longLineSegment.start.x,\n                    canvasCoordsCurrent.longLineSegment.start.y,\n                ]);\n                const longLineSegmentVecNormalized = vec2.normalize(vec2.create(), longLineSegmentVec);\n                const proposedToCurrentVec = vec2.subtract(vec2.create(), [proposedCanvasCoord[0], proposedCanvasCoord[1]], [\n                    canvasCoordHandlesCurrent[movingHandleIndex][0],\n                    canvasCoordHandlesCurrent[movingHandleIndex][1],\n                ]);\n                const movementLength = vec2.length(proposedToCurrentVec);\n                const angle = this._getSignedAngle(longLineSegmentVecNormalized, proposedToCurrentVec);\n                const movementAlongLineSegmentLength = Math.cos(angle) * movementLength;\n                const newTranslatedPoint = vec2.scaleAndAdd(vec2.create(), [\n                    canvasCoordHandlesCurrent[translateHandleIndex][0],\n                    canvasCoordHandlesCurrent[translateHandleIndex][1],\n                ], longLineSegmentVecNormalized, movementAlongLineSegmentLength);\n                if (this._movingLongAxisWouldPutItThroughShortAxis({\n                    start: {\n                        x: proposedCanvasCoord[0],\n                        y: proposedCanvasCoord[1],\n                    },\n                    end: {\n                        x: newTranslatedPoint[0],\n                        y: newTranslatedPoint[1],\n                    },\n                }, {\n                    start: {\n                        x: canvasCoordsCurrent.longLineSegment.start.x,\n                        y: canvasCoordsCurrent.longLineSegment.start.y,\n                    },\n                    end: {\n                        x: canvasCoordsCurrent.longLineSegment.end.x,\n                        y: canvasCoordsCurrent.longLineSegment.end.y,\n                    },\n                })) {\n                    return;\n                }\n                const intersectionPoint = lineSegment.intersectLine([proposedCanvasCoord[0], proposedCanvasCoord[1]], [newTranslatedPoint[0], newTranslatedPoint[1]], [firstLineSegment.start.x, firstLineSegment.start.y], [firstLineSegment.end.x, firstLineSegment.end.y]);\n                if (!intersectionPoint) {\n                    return;\n                }\n                data.handles.points[translateHandleIndex] = viewport.canvasToWorld(newTranslatedPoint);\n                data.handles.points[movingHandleIndex] = proposedPoint;\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = true;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        width: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId1 = `${annotationUID}-line-1`;\n                const dataId2 = `${annotationUID}-line-2`;\n                const lineUID = '0';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                    shadow,\n                }, dataId1);\n                const secondLineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, secondLineUID, canvasCoordinates[2], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                    shadow,\n                }, dataId2);\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._movingLongAxisWouldPutItThroughShortAxis = (firstLineSegment, secondLineSegment) => {\n            const vectorInSecondLineDirection = vec2.create();\n            vec2.set(vectorInSecondLineDirection, secondLineSegment.end.x - secondLineSegment.start.x, secondLineSegment.end.y - secondLineSegment.start.y);\n            vec2.normalize(vectorInSecondLineDirection, vectorInSecondLineDirection);\n            const extendedSecondLineSegment = {\n                start: {\n                    x: secondLineSegment.start.x - vectorInSecondLineDirection[0] * 10,\n                    y: secondLineSegment.start.y - vectorInSecondLineDirection[1] * 10,\n                },\n                end: {\n                    x: secondLineSegment.end.x + vectorInSecondLineDirection[0] * 10,\n                    y: secondLineSegment.end.y + vectorInSecondLineDirection[1] * 10,\n                },\n            };\n            const proposedIntersectionPoint = lineSegment.intersectLine([extendedSecondLineSegment.start.x, extendedSecondLineSegment.start.y], [extendedSecondLineSegment.end.x, extendedSecondLineSegment.end.y], [firstLineSegment.start.x, firstLineSegment.start.y], [firstLineSegment.end.x, firstLineSegment.end.y]);\n            const wouldPutThroughShortAxis = !proposedIntersectionPoint;\n            return wouldPutThroughShortAxis;\n        };\n        this._calculateCachedStats = (annotation, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { element } = enabledElement.viewport;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[1];\n            const worldPos3 = data.handles.points[2];\n            const worldPos4 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { imageData, dimensions } = image;\n                const index1 = transformWorldToIndex(imageData, worldPos1);\n                const index2 = transformWorldToIndex(imageData, worldPos2);\n                const index3 = transformWorldToIndex(imageData, worldPos3);\n                const index4 = transformWorldToIndex(imageData, worldPos4);\n                const handles1 = [index1, index2];\n                const handles2 = [index3, index4];\n                const { scale: scale1, unit: units1 } = getCalibratedLengthUnitsAndScale(image, handles1);\n                const { scale: scale2, unit: units2 } = getCalibratedLengthUnitsAndScale(image, handles2);\n                const dist1 = this._calculateLength(worldPos1, worldPos2) / scale1;\n                const dist2 = this._calculateLength(worldPos3, worldPos4) / scale2;\n                const length = dist1 > dist2 ? dist1 : dist2;\n                const width = dist1 > dist2 ? dist2 : dist1;\n                const unit = dist1 > dist2 ? units1 : units2;\n                const widthUnit = dist1 > dist2 ? units2 : units1;\n                this._isInsideVolume(index1, index2, index3, index4, dimensions)\n                    ? (this.isHandleOutsideImage = false)\n                    : (this.isHandleOutsideImage = true);\n                cachedStats[targetId] = {\n                    length,\n                    width,\n                    unit,\n                    widthUnit,\n                };\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, index3, index4, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions) &&\n                csUtils.indexWithinDimensions(index3, dimensions) &&\n                csUtils.indexWithinDimensions(index4, dimensions));\n        };\n        this._getSignedAngle = (vector1, vector2) => {\n            return Math.atan2(vector1[0] * vector2[1] - vector1[1] * vector2[0], vector1[0] * vector2[0] + vector1[1] * vector2[1]);\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const worldPos = currentPoints.world;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        this.isDrawing = true;\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, viewUp } = camera;\n        const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const annotation = {\n            highlighted: true,\n            invalidated: true,\n            metadata: {\n                toolName: this.getToolName(),\n                viewPlaneNormal: [...viewPlaneNormal],\n                viewUp: [...viewUp],\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...viewport.getViewReference({ points: [worldPos] }),\n            },\n            data: {\n                handles: {\n                    points: [\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                    ],\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n        };\n        addAnnotation(annotation, element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex: 1,\n            movingTextBox: false,\n            newAnnotation: true,\n            hasMoved: false,\n        };\n        this._activateDraw(element);\n        hideElementCursor(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        return annotation;\n    }\n    _calculateLength(pos1, pos2) {\n        const dx = pos1[0] - pos2[0];\n        const dy = pos1[1] - pos2[1];\n        const dz = pos1[2] - pos2[2];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const { cachedStats, label } = data;\n    const { length, width, unit } = cachedStats[targetId];\n    const textLines = [];\n    if (label) {\n        textLines.push(label);\n    }\n    if (length === undefined) {\n        return textLines;\n    }\n    textLines.push(`L: ${csUtils.roundNumber(length)} ${unit || unit}`, `W: ${csUtils.roundNumber(width)} ${unit}`);\n    return textLines;\n}\nBidirectionalTool.toolName = 'Bidirectional';\nexport default BidirectionalTool;\n","import { utilities } from '@cornerstonejs/core';\nimport { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport PlanarFreehandROITool from './PlanarFreehandROITool';\nclass PlanarFreehandContourSegmentationTool extends PlanarFreehandROITool {\n    constructor(toolProps) {\n        const initialProps = utilities.deepMerge({\n            configuration: {\n                calculateStats: false,\n                allowOpenContours: false,\n            },\n        }, toolProps);\n        super(initialProps);\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n    renderAnnotationInstance(renderContext) {\n        const annotation = renderContext.annotation;\n        const { invalidated } = annotation;\n        const renderResult = super.renderAnnotationInstance(renderContext);\n        if (invalidated) {\n            const { segmentationId } = annotation.data.segmentation;\n            triggerSegmentationDataModified(segmentationId);\n        }\n        return renderResult;\n    }\n}\nPlanarFreehandContourSegmentationTool.toolName =\n    'PlanarFreehandContourSegmentationTool';\nexport default PlanarFreehandContourSegmentationTool;\n","import { CONSTANTS, getEnabledElement, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport * as math from '../../utilities/math';\nimport { polyline } from '../../utilities/math';\nimport { filterAnnotationsForDisplay } from '../../utilities/planar';\nimport throttle from '../../utilities/throttle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport registerDrawLoop from './planarFreehandROITool/drawLoop';\nimport registerEditLoopCommon from './planarFreehandROITool/editLoopCommon';\nimport registerClosedContourEditLoop from './planarFreehandROITool/closedContourEditLoop';\nimport registerOpenContourEditLoop from './planarFreehandROITool/openContourEditLoop';\nimport registerOpenContourEndEditLoop from './planarFreehandROITool/openContourEndEditLoop';\nimport registerRenderMethods from './planarFreehandROITool/renderMethods';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport { drawLinkedTextBox } from '../../drawingSvg';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getLineSegmentIntersectionsCoordinates } from '../../utilities/math/polyline';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport calculatePerimeter from '../../utilities/contours/calculatePerimeter';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { KeyboardBindings, ChangeTypes } from '../../enums';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { pointCanProjectOnLine } = polyline;\nconst { EPSILON } = CONSTANTS;\nconst PARALLEL_THRESHOLD = 1 - EPSILON;\nclass PlanarFreehandROITool extends ContourSegmentationBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            shadow: true,\n            preventHandleOutsideImage: false,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            alwaysRenderOpenContourHandles: {\n                enabled: false,\n                radius: 2,\n            },\n            allowOpenContours: true,\n            closeContourProximity: 10,\n            checkCanvasEditFallbackProximity: 6,\n            makeClockWise: true,\n            subPixelResolution: 4,\n            smoothing: {\n                smoothOnAdd: false,\n                smoothOnEdit: false,\n                knotsRatioPercentageOnAdd: 40,\n                knotsRatioPercentageOnEdit: 40,\n            },\n            interpolation: {\n                enabled: false,\n                onInterpolationComplete: null,\n            },\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            displayOnePointAsCrosshairs: false,\n            calculateStats: true,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isDrawing = false;\n        this.isEditingClosed = false;\n        this.isEditingOpen = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const annotation = this.createAnnotation(evt);\n            this.addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.activateDraw(evt, annotation, viewportIdsToRender);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.activateOpenContourEndEdit(evt, annotation, viewportIdsToRender, handle);\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            if (annotation.data.contour.closed) {\n                this.activateClosedContourEdit(evt, annotation, viewportIdsToRender);\n            }\n            else {\n                this.activateOpenContourEdit(evt, annotation, viewportIdsToRender);\n            }\n            evt.preventDefault();\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { polyline: points } = annotation.data.contour;\n            let previousPoint = viewport.worldToCanvas(points[0]);\n            for (let i = 1; i < points.length; i++) {\n                const p1 = previousPoint;\n                const p2 = viewport.worldToCanvas(points[i]);\n                const canProject = pointCanProjectOnLine(canvasCoords, p1, p2, proximity);\n                if (canProject) {\n                    return true;\n                }\n                previousPoint = p2;\n            }\n            if (!annotation.data.contour.closed) {\n                return false;\n            }\n            const pStart = viewport.worldToCanvas(points[0]);\n            const pEnd = viewport.worldToCanvas(points[points.length - 1]);\n            return pointCanProjectOnLine(canvasCoords, pStart, pEnd, proximity);\n        };\n        this.cancel = (element) => {\n            const isDrawing = this.isDrawing;\n            const isEditingOpen = this.isEditingOpen;\n            const isEditingClosed = this.isEditingClosed;\n            if (isDrawing) {\n                this.cancelDrawing(element);\n            }\n            else if (isEditingOpen) {\n                this.cancelOpenContourEdit(element);\n            }\n            else if (isEditingClosed) {\n                this.cancelClosedContourEdit(element);\n            }\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { cachedStats } = data;\n            const { polyline: points, closed } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { imageData, metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const modalityUnitOptions = {\n                    isPreScaled: isViewportPreScaled(viewport, targetId),\n                    isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                };\n                const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n                const calibratedScale = getCalibratedLengthUnitsAndScale(image, () => {\n                    const polyline = data.contour.polyline;\n                    const numPoints = polyline.length;\n                    const projectedPolyline = new Array(numPoints);\n                    for (let i = 0; i < numPoints; i++) {\n                        projectedPolyline[i] = viewport.worldToCanvas(polyline[i]);\n                    }\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(projectedPolyline);\n                    const topLeftBBWorld = viewport.canvasToWorld([canvasMinX, canvasMinY]);\n                    const topLeftBBIndex = csUtils.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = csUtils.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                if (closed) {\n                    this.updateClosedCachedStats({\n                        targetId,\n                        viewport,\n                        canvasCoordinates,\n                        points,\n                        imageData,\n                        metadata,\n                        cachedStats,\n                        modalityUnit,\n                        calibratedScale,\n                    });\n                }\n                else {\n                    this.updateOpenCachedStats({\n                        metadata,\n                        canvasCoordinates,\n                        targetId,\n                        cachedStats,\n                        modalityUnit,\n                        calibratedScale,\n                    });\n                }\n            }\n            triggerAnnotationModified(annotation, enabledElement.viewport.element, ChangeTypes.StatsUpdated);\n            annotation.invalidated = false;\n            return cachedStats;\n        };\n        this._renderStats = (annotation, viewport, enabledElement, svgDrawingHelper) => {\n            const { data } = annotation;\n            const targetId = this.getTargetId(viewport);\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n            if (!options.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.contour.polyline.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = '1';\n            const boundingBox = drawLinkedTextBox(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        registerDrawLoop(this);\n        registerEditLoopCommon(this);\n        registerClosedContourEditLoop(this);\n        registerOpenContourEditLoop(this);\n        registerOpenContourEndEditLoop(this);\n        registerRenderMethods(this);\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!annotations || !annotations.length) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let annotationsToDisplay;\n        if (viewport instanceof VolumeViewport) {\n            const camera = viewport.getCamera();\n            const { spacingInNormalDirection } = csUtils.getTargetVolumeAndSpacingInNormalDir(viewport, camera);\n            annotationsToDisplay = this.filterAnnotationsWithinSlice(annotations, camera, spacingInNormalDirection);\n        }\n        else {\n            annotationsToDisplay = filterAnnotationsForDisplay(viewport, annotations);\n        }\n        return annotationsToDisplay;\n    }\n    filterAnnotationsWithinSlice(annotations, camera, spacingInNormalDirection) {\n        const { viewPlaneNormal } = camera;\n        const annotationsWithParallelNormals = annotations.filter((td) => {\n            const annotationViewPlaneNormal = td.metadata.viewPlaneNormal;\n            const isParallel = Math.abs(vec3.dot(viewPlaneNormal, annotationViewPlaneNormal)) >\n                PARALLEL_THRESHOLD;\n            return annotationViewPlaneNormal && isParallel;\n        });\n        if (!annotationsWithParallelNormals.length) {\n            return [];\n        }\n        const halfSpacingInNormalDirection = spacingInNormalDirection / 2;\n        const { focalPoint } = camera;\n        const annotationsWithinSlice = [];\n        for (const annotation of annotationsWithParallelNormals) {\n            const data = annotation.data;\n            const point = data.contour.polyline[0];\n            if (!annotation.isVisible) {\n                continue;\n            }\n            const dir = vec3.create();\n            vec3.sub(dir, focalPoint, point);\n            const dot = vec3.dot(dir, viewPlaneNormal);\n            if (Math.abs(dot) < halfSpacingInNormalDirection) {\n                annotationsWithinSlice.push(annotation);\n            }\n        }\n        return annotationsWithinSlice;\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    createAnnotation(evt) {\n        const worldPos = evt.detail.currentPoints.world;\n        const contourAnnotation = super.createAnnotation(evt);\n        const onInterpolationComplete = (annotation) => {\n            annotation.data.handles.points.length = 0;\n        };\n        const annotation = csUtils.deepMerge(contourAnnotation, {\n            data: {\n                contour: {\n                    polyline: [[...worldPos]],\n                },\n                label: '',\n                cachedStats: {},\n            },\n            onInterpolationComplete,\n        });\n        return annotation;\n    }\n    getAnnotationStyle(context) {\n        return super.getAnnotationStyle(context);\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, targetId, svgDrawingHelper } = renderContext;\n        const annotation = renderContext.annotation;\n        let renderStatus = false;\n        const { viewport, renderingEngine } = enabledElement;\n        const isDrawing = this.isDrawing;\n        const isEditingOpen = this.isEditingOpen;\n        const isEditingClosed = this.isEditingClosed;\n        if (!(isDrawing || isEditingOpen || isEditingClosed)) {\n            if (this.configuration.displayOnePointAsCrosshairs &&\n                annotation.data.contour.polyline.length === 1) {\n                this.renderPointContourWithMarker(enabledElement, svgDrawingHelper, annotation);\n            }\n            else {\n                this.renderContour(enabledElement, svgDrawingHelper, annotation);\n            }\n        }\n        else {\n            const activeAnnotationUID = this.commonData.annotation.annotationUID;\n            if (annotation.annotationUID === activeAnnotationUID) {\n                if (isDrawing) {\n                    this.renderContourBeingDrawn(enabledElement, svgDrawingHelper, annotation);\n                }\n                else if (isEditingClosed) {\n                    this.renderClosedContourBeingEdited(enabledElement, svgDrawingHelper, annotation);\n                }\n                else if (isEditingOpen) {\n                    this.renderOpenContourBeingEdited(enabledElement, svgDrawingHelper, annotation);\n                }\n                else {\n                    throw new Error(`Unknown ${this.getToolName()} annotation rendering state`);\n                }\n            }\n            else {\n                if (this.configuration.displayOnePointAsCrosshairs &&\n                    annotation.data.contour.polyline.length === 1) {\n                    this.renderPointContourWithMarker(enabledElement, svgDrawingHelper, annotation);\n                }\n                else {\n                    this.renderContour(enabledElement, svgDrawingHelper, annotation);\n                }\n            }\n            renderStatus = true;\n        }\n        if (!this.configuration.calculateStats) {\n            return;\n        }\n        this._calculateStatsIfActive(annotation, targetId, viewport, renderingEngine, enabledElement);\n        this._renderStats(annotation, viewport, enabledElement, svgDrawingHelper);\n        return renderStatus;\n    }\n    _calculateStatsIfActive(annotation, targetId, viewport, renderingEngine, enabledElement) {\n        const activeAnnotationUID = this.commonData?.annotation.annotationUID;\n        if (annotation.annotationUID === activeAnnotationUID &&\n            !this.commonData?.movingTextBox) {\n            return;\n        }\n        if (!this.commonData?.movingTextBox) {\n            const { data } = annotation;\n            if (!data.cachedStats[targetId] ||\n                data.cachedStats[targetId].areaUnit == null) {\n                data.cachedStats[targetId] = {\n                    Modality: null,\n                    area: null,\n                    max: null,\n                    mean: null,\n                    stdDev: null,\n                    areaUnit: null,\n                };\n                this._calculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n            }\n            else if (annotation.invalidated) {\n                this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n            }\n        }\n    }\n    updateClosedCachedStats({ viewport, points, imageData, metadata, cachedStats, targetId, modalityUnit, canvasCoordinates, calibratedScale, }) {\n        const { scale, areaUnit, units } = calibratedScale;\n        const { voxelManager } = viewport.getImageData();\n        const canvasPoint = canvasCoordinates[0];\n        const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n        const deltaXPoint = viewport.canvasToWorld([\n            canvasPoint[0] + 1,\n            canvasPoint[1],\n        ]);\n        const deltaYPoint = viewport.canvasToWorld([\n            canvasPoint[0],\n            canvasPoint[1] + 1,\n        ]);\n        const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n        const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n        const worldPosIndex = csUtils.transformWorldToIndex(imageData, points[0]);\n        worldPosIndex[0] = Math.floor(worldPosIndex[0]);\n        worldPosIndex[1] = Math.floor(worldPosIndex[1]);\n        worldPosIndex[2] = Math.floor(worldPosIndex[2]);\n        let iMin = worldPosIndex[0];\n        let iMax = worldPosIndex[0];\n        let jMin = worldPosIndex[1];\n        let jMax = worldPosIndex[1];\n        let kMin = worldPosIndex[2];\n        let kMax = worldPosIndex[2];\n        for (let j = 1; j < points.length; j++) {\n            const worldPosIndex = csUtils.transformWorldToIndex(imageData, points[j]);\n            worldPosIndex[0] = Math.floor(worldPosIndex[0]);\n            worldPosIndex[1] = Math.floor(worldPosIndex[1]);\n            worldPosIndex[2] = Math.floor(worldPosIndex[2]);\n            iMin = Math.min(iMin, worldPosIndex[0]);\n            iMax = Math.max(iMax, worldPosIndex[0]);\n            jMin = Math.min(jMin, worldPosIndex[1]);\n            jMax = Math.max(jMax, worldPosIndex[1]);\n            kMin = Math.min(kMin, worldPosIndex[2]);\n            kMax = Math.max(kMax, worldPosIndex[2]);\n        }\n        const worldPosIndex2 = csUtils.transformWorldToIndex(imageData, points[1]);\n        worldPosIndex2[0] = Math.floor(worldPosIndex2[0]);\n        worldPosIndex2[1] = Math.floor(worldPosIndex2[1]);\n        worldPosIndex2[2] = Math.floor(worldPosIndex2[2]);\n        let area = polyline.getArea(canvasCoordinates) / scale / scale;\n        area *= deltaInX * deltaInY;\n        const iDelta = 0.01 * (iMax - iMin);\n        const jDelta = 0.01 * (jMax - jMin);\n        const kDelta = 0.01 * (kMax - kMin);\n        iMin = Math.floor(iMin - iDelta);\n        iMax = Math.ceil(iMax + iDelta);\n        jMin = Math.floor(jMin - jDelta);\n        jMax = Math.ceil(jMax + jDelta);\n        kMin = Math.floor(kMin - kDelta);\n        kMax = Math.ceil(kMax + kDelta);\n        const boundsIJK = [\n            [iMin, iMax],\n            [jMin, jMax],\n            [kMin, kMax],\n        ];\n        const worldPosEnd = imageData.indexToWorld([iMax, jMax, kMax]);\n        const canvasPosEnd = viewport.worldToCanvas(worldPosEnd);\n        let curRow = 0;\n        let intersections = [];\n        let intersectionCounter = 0;\n        const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n            imageData,\n            isInObject: (pointLPS, _pointIJK) => {\n                let result = true;\n                const point = viewport.worldToCanvas(pointLPS);\n                if (point[1] != curRow) {\n                    intersectionCounter = 0;\n                    curRow = point[1];\n                    intersections = getLineSegmentIntersectionsCoordinates(canvasCoordinates, point, [canvasPosEnd[0], point[1]]);\n                    intersections.sort((function (index) {\n                        return function (a, b) {\n                            return a[index] === b[index]\n                                ? 0\n                                : a[index] < b[index]\n                                    ? -1\n                                    : 1;\n                        };\n                    })(0));\n                }\n                if (intersections.length && point[0] > intersections[0][0]) {\n                    intersections.shift();\n                    intersectionCounter++;\n                }\n                if (intersectionCounter % 2 === 0) {\n                    result = false;\n                }\n                return result;\n            },\n            boundsIJK,\n            returnPoints: this.configuration.storePointData,\n        });\n        const stats = this.configuration.statsCalculator.getStatistics();\n        cachedStats[targetId] = {\n            Modality: metadata.Modality,\n            area,\n            perimeter: calculatePerimeter(canvasCoordinates, closed) / scale,\n            mean: stats.mean?.value,\n            max: stats.max?.value,\n            stdDev: stats.stdDev?.value,\n            statsArray: stats.array,\n            pointsInShape: pointsInShape,\n            areaUnit,\n            modalityUnit,\n            unit: units,\n        };\n    }\n    updateOpenCachedStats({ targetId, metadata, canvasCoordinates, cachedStats, modalityUnit, calibratedScale, }) {\n        const { scale, units } = calibratedScale;\n        cachedStats[targetId] = {\n            Modality: metadata.Modality,\n            length: calculatePerimeter(canvasCoordinates, false) / scale,\n            modalityUnit,\n            getPixelValueUnitunit: units,\n        };\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, stdDev, length, perimeter, max, isEmptyArea, unit, areaUnit, modalityUnit, } = cachedVolumeStats || {};\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (Number.isFinite(max)) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    if (perimeter) {\n        textLines.push(`Perimeter: ${csUtils.roundNumber(perimeter)} ${unit}`);\n    }\n    if (length) {\n        textLines.push(`${csUtils.roundNumber(length)} ${unit}`);\n    }\n    return textLines;\n}\nPlanarFreehandROITool.toolName = 'PlanarFreehandROI';\nexport default PlanarFreehandROITool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, drawRectByCoordinates as drawRectSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as rectangle from '../../utilities/math/rectangle';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromCorners from '../../utilities/planar/getWorldWidthAndHeightFromCorners';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass RectangleROITool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasPoint1 = viewport.worldToCanvas(points[0]);\n            const canvasPoint2 = viewport.worldToCanvas(points[3]);\n            const rect = this._getRectangleImageCoordinates([\n                canvasPoint1,\n                canvasPoint2,\n            ]);\n            const point = [canvasCoords[0], canvasCoords[1]];\n            const { left, top, width, height } = rect;\n            const distanceToPoint = rectangle.distanceToPoint([left, top, width, height], point);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { points } = data.handles;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const enabledElement = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n                const worldPos = currentPoints.world;\n                const { points } = data.handles;\n                points[handleIndex] = [...worldPos];\n                let bottomLeftCanvas;\n                let bottomRightCanvas;\n                let topLeftCanvas;\n                let topRightCanvas;\n                let bottomLeftWorld;\n                let bottomRightWorld;\n                let topLeftWorld;\n                let topRightWorld;\n                switch (handleIndex) {\n                    case 0:\n                    case 3:\n                        bottomLeftCanvas = worldToCanvas(points[0]);\n                        topRightCanvas = worldToCanvas(points[3]);\n                        bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                        topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                        bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                        topLeftWorld = canvasToWorld(topLeftCanvas);\n                        points[1] = bottomRightWorld;\n                        points[2] = topLeftWorld;\n                        break;\n                    case 1:\n                    case 2:\n                        bottomRightCanvas = worldToCanvas(points[1]);\n                        topLeftCanvas = worldToCanvas(points[2]);\n                        bottomLeftCanvas = [\n                            topLeftCanvas[0],\n                            bottomRightCanvas[1],\n                        ];\n                        topRightCanvas = [\n                            bottomRightCanvas[0],\n                            topLeftCanvas[1],\n                        ];\n                        bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                        topRightWorld = canvasToWorld(topRightCanvas);\n                        points[0] = bottomLeftWorld;\n                        points[3] = topRightWorld;\n                        break;\n                }\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const { viewPlaneNormal, viewUp } = viewport.getCamera();\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                    };\n                    this._calculateCachedStats(annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-rect`;\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._getRectangleImageCoordinates = (points) => {\n            const [point0, point1] = points;\n            return {\n                left: Math.min(point0[0], point1[0]),\n                top: Math.min(point0[1], point1[1]),\n                width: Math.abs(point0[0] - point1[0]),\n                height: Math.abs(point0[1] - point1[1]),\n            };\n        };\n        this._calculateCachedStats = (annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const pos2Index = transformWorldToIndex(imageData, worldPos2);\n                pos2Index[0] = Math.floor(pos2Index[0]);\n                pos2Index[1] = Math.floor(pos2Index[1]);\n                pos2Index[2] = Math.floor(pos2Index[2]);\n                if (this._isInsideVolume(pos1Index, pos2Index, dimensions)) {\n                    this.isHandleOutsideImage = false;\n                    const iMin = Math.min(pos1Index[0], pos2Index[0]);\n                    const iMax = Math.max(pos1Index[0], pos2Index[0]);\n                    const jMin = Math.min(pos1Index[1], pos2Index[1]);\n                    const jMax = Math.max(pos1Index[1], pos2Index[1]);\n                    const kMin = Math.min(pos1Index[2], pos2Index[2]);\n                    const kMax = Math.max(pos1Index[2], pos2Index[2]);\n                    const boundsIJK = [\n                        [iMin, iMax],\n                        [jMin, jMax],\n                        [kMin, kMax],\n                    ];\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromCorners(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const handles = [pos1Index, pos2Index];\n                    const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                    const area = Math.abs(worldWidth * worldHeight) / (scale * scale);\n                    const pixelUnitsOptions = {\n                        isPreScaled: isViewportPreScaled(viewport, targetId),\n                        isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                    };\n                    const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                    const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                        boundsIJK,\n                        imageData,\n                        returnPoints: this.configuration.storePointData,\n                    });\n                    const stats = this.configuration.statsCalculator.getStatistics();\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean: stats.mean?.value,\n                        stdDev: stats.stdDev?.value,\n                        max: stats.max?.value,\n                        statsArray: stats.array,\n                        pointsInShape: pointsInShape,\n                        areaUnit,\n                        modalityUnit,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    static { this.hydrate = (viewportId, points, options) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        const instance = new this();\n        const referencedImageId = instance.getReferencedImageId(viewport, points[0], viewPlaneNormal, viewUp);\n        const annotation = {\n            annotationUID: options?.annotationUID || csUtils.uuidv4(),\n            data: {\n                handles: {\n                    points,\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n            highlighted: false,\n            autoGenerated: false,\n            invalidated: false,\n            isLocked: false,\n            isVisible: true,\n            metadata: {\n                toolName: instance.getToolName(),\n                viewPlaneNormal,\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...options,\n            },\n        };\n        addAnnotation(annotation, viewport.element);\n        triggerAnnotationRenderForViewportIds([viewport.id]);\n    }; }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nRectangleROITool.toolName = 'RectangleROI';\nexport default RectangleROITool;\n","import { utilities, getEnabledElement, StackViewport, cache, VideoViewport, BaseVolumeViewport, } from '@cornerstonejs/core';\nimport BaseTool from './BaseTool';\nimport { getAnnotationManager } from '../../stateManagement/annotation/annotationState';\nimport triggerAnnotationRender from '../../utilities/triggerAnnotationRender';\nimport filterAnnotationsForDisplay from '../../utilities/planar/filterAnnotationsForDisplay';\nimport { getStyleProperty } from '../../stateManagement/annotation/config/helpers';\nimport { getState } from '../../stateManagement/annotation/config';\nclass AnnotationDisplayTool extends BaseTool {\n    constructor() {\n        super(...arguments);\n        this.onImageSpacingCalibrated = (evt) => {\n            const { element, imageId } = evt.detail;\n            const imageURI = utilities.imageIdToURI(imageId);\n            const annotationManager = getAnnotationManager();\n            const framesOfReference = annotationManager.getFramesOfReference();\n            framesOfReference.forEach((frameOfReference) => {\n                const frameOfReferenceSpecificAnnotations = annotationManager.getAnnotations(frameOfReference);\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[this.getToolName()];\n                if (!toolSpecificAnnotations || !toolSpecificAnnotations.length) {\n                    return;\n                }\n                toolSpecificAnnotations.forEach((annotation) => {\n                    if (!annotation.metadata?.referencedImageId) {\n                        return;\n                    }\n                    const referencedImageURI = utilities.imageIdToURI(annotation.metadata.referencedImageId);\n                    if (referencedImageURI === imageURI) {\n                        annotation.invalidated = true;\n                        annotation.data.cachedStats = {};\n                    }\n                });\n                triggerAnnotationRender(element);\n            });\n        };\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!annotations || !annotations.length) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        return filterAnnotationsForDisplay(viewport, annotations);\n    }\n    getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp) {\n        const targetId = this.getTargetId(viewport);\n        let referencedImageId = targetId.split(/^[a-zA-Z]+:/)[1];\n        if (viewport instanceof BaseVolumeViewport) {\n            const volumeId = utilities.getVolumeId(targetId);\n            const imageVolume = cache.getVolume(volumeId);\n            referencedImageId = utilities.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n        }\n        return referencedImageId;\n    }\n    getStyle(property, specifications, annotation) {\n        return getStyleProperty(property, specifications, getState(annotation), this.mode);\n    }\n}\nAnnotationDisplayTool.toolName = 'AnnotationDisplayTool';\nexport default AnnotationDisplayTool;\n","import { utilities, BaseVolumeViewport } from '@cornerstonejs/core';\nimport ToolModes from '../../enums/ToolModes';\nclass BaseTool {\n    constructor(toolProps, defaultToolProps) {\n        const initialProps = utilities.deepMerge(defaultToolProps, toolProps);\n        const { configuration = {}, supportedInteractionTypes, toolGroupId, } = initialProps;\n        if (!configuration.strategies) {\n            configuration.strategies = {};\n            configuration.defaultStrategy = undefined;\n            configuration.activeStrategy = undefined;\n            configuration.strategyOptions = {};\n        }\n        this.toolGroupId = toolGroupId;\n        this.supportedInteractionTypes = supportedInteractionTypes || [];\n        this.configuration = Object.assign({}, configuration);\n        this.mode = ToolModes.Disabled;\n    }\n    getToolName() {\n        return this.constructor.toolName;\n    }\n    applyActiveStrategy(enabledElement, operationData) {\n        const { strategies, activeStrategy } = this.configuration;\n        return strategies[activeStrategy]?.call(this, enabledElement, operationData);\n    }\n    applyActiveStrategyCallback(enabledElement, operationData, callbackType) {\n        const { strategies, activeStrategy } = this.configuration;\n        if (!strategies[activeStrategy]) {\n            throw new Error(`applyActiveStrategyCallback: active strategy ${activeStrategy} not found, check tool configuration or spellings`);\n        }\n        return strategies[activeStrategy][callbackType]?.call(this, enabledElement, operationData);\n    }\n    setConfiguration(newConfiguration) {\n        this.configuration = utilities.deepMerge(this.configuration, newConfiguration);\n    }\n    setActiveStrategy(strategyName) {\n        this.setConfiguration({ activeStrategy: strategyName });\n    }\n    getTargetImageData(targetId) {\n        if (targetId.startsWith('imageId:')) {\n            const imageId = targetId.split('imageId:')[1];\n            const imageURI = utilities.imageIdToURI(imageId);\n            let viewports = utilities.getViewportsWithImageURI(imageURI);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            viewports = viewports.filter((viewport) => {\n                return viewport.getCurrentImageId() === imageId;\n            });\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else if (targetId.startsWith('volumeId:')) {\n            const volumeId = utilities.getVolumeId(targetId);\n            const viewports = utilities.getViewportsWithVolumeId(volumeId);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else if (targetId.startsWith('videoId:')) {\n            const imageURI = utilities.imageIdToURI(targetId);\n            const viewports = utilities.getViewportsWithImageURI(imageURI);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else {\n            throw new Error('getTargetIdImage: targetId must start with \"imageId:\" or \"volumeId:\"');\n        }\n    }\n    getTargetId(viewport) {\n        const targetId = viewport.getViewReferenceId?.();\n        if (targetId) {\n            return targetId;\n        }\n        throw new Error('getTargetId: viewport must have a getViewReferenceId method');\n    }\n}\nBaseTool.toolName = 'BaseTool';\nexport default BaseTool;\n","import { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport Representations from '../../../enums/SegmentationRepresentations';\nimport { handleContourSegmentation } from './contourHandler/handleContourSegmentation';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { canComputeRequestedRepresentation } from '../../../stateManagement/segmentation/polySeg/canComputeRequestedRepresentation';\nimport { computeAndAddContourRepresentation } from '../../../stateManagement/segmentation/polySeg/Contour/computeAndAddContourRepresentation';\nimport removeContourFromElement from './removeContourFromElement';\nlet polySegConversionInProgress = false;\nconst processedViewportSegmentations = new Map();\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    if (!renderImmediate) {\n        return;\n    }\n    removeContourFromElement(viewportId, segmentationId);\n    viewport.render();\n}\nasync function render(viewport, contourRepresentation) {\n    const { segmentationId } = contourRepresentation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return;\n    }\n    let contourData = segmentation.representationData[Representations.Contour];\n    if (!contourData &&\n        canComputeRequestedRepresentation(segmentationId, Representations.Contour) &&\n        !polySegConversionInProgress) {\n        polySegConversionInProgress = true;\n        contourData = await computeAndAddContourRepresentation(segmentationId, {\n            viewport,\n        });\n        polySegConversionInProgress = false;\n    }\n    if (!contourData) {\n        return;\n    }\n    if (!contourData.geometryIds?.length) {\n        return;\n    }\n    handleContourSegmentation(viewport, contourData.geometryIds, contourData.annotationUIDsMap, contourRepresentation);\n}\nexport default {\n    render,\n    removeRepresentation,\n};\n","import { getEnabledElementByViewportId, VolumeViewport, } from '@cornerstonejs/core';\nimport addLabelmapToElement from './addLabelmapToElement';\nimport removeLabelmapFromElement from './removeLabelmapFromElement';\nimport { getActiveSegmentation } from '../../../stateManagement/segmentation/activeSegmentation';\nimport { getColorLUT } from '../../../stateManagement/segmentation/getColorLUT';\nimport { getCurrentLabelmapImageIdForViewport } from '../../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { canComputeRequestedRepresentation } from '../../../stateManagement/segmentation/polySeg/canComputeRequestedRepresentation';\nimport { computeAndAddLabelmapRepresentation } from '../../../stateManagement/segmentation/polySeg/Labelmap/computeAndAddLabelmapRepresentation';\nimport { segmentationStyle } from '../../../stateManagement/segmentation/SegmentationStyle';\nimport SegmentationRepresentations from '../../../enums/SegmentationRepresentations';\nimport { internalGetHiddenSegmentIndices } from '../../../stateManagement/segmentation/helpers/internalGetHiddenSegmentIndices';\nimport { getActiveSegmentIndex } from '../../../stateManagement/segmentation/getActiveSegmentIndex';\nimport { getLabelmapActorEntry } from '../../../stateManagement/segmentation/helpers/getSegmentationActor';\nconst MAX_NUMBER_COLORS = 255;\nconst labelMapConfigCache = new Map();\nlet polySegConversionInProgress = false;\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    labelMapConfigCache.forEach((value, key) => {\n        if (key.includes(segmentationId)) {\n            labelMapConfigCache.delete(key);\n        }\n    });\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    removeLabelmapFromElement(viewport.element, segmentationId);\n    if (!renderImmediate) {\n        return;\n    }\n    viewport.render();\n}\nasync function render(viewport, representation) {\n    const { segmentationId } = representation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        console.warn('No segmentation found for segmentationId: ', segmentationId);\n        return;\n    }\n    let labelmapData = segmentation.representationData[SegmentationRepresentations.Labelmap];\n    let labelmapActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    if (!labelmapData &&\n        canComputeRequestedRepresentation(segmentationId, SegmentationRepresentations.Labelmap) &&\n        !polySegConversionInProgress) {\n        polySegConversionInProgress = true;\n        labelmapData = await computeAndAddLabelmapRepresentation(segmentationId, {\n            viewport,\n        });\n        if (!labelmapData) {\n            throw new Error(`No labelmap data found for segmentationId ${segmentationId}.`);\n        }\n        polySegConversionInProgress = false;\n    }\n    if (!labelmapData) {\n        return;\n    }\n    if (viewport instanceof VolumeViewport) {\n        if (!labelmapActorEntry) {\n            await _addLabelmapToViewport(viewport, labelmapData, segmentationId);\n        }\n        labelmapActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    }\n    else {\n        const labelmapImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n        if (!labelmapImageId) {\n            return;\n        }\n        if (!labelmapActorEntry) {\n            await _addLabelmapToViewport(viewport, labelmapData, segmentationId);\n        }\n        labelmapActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    }\n    if (!labelmapActorEntry) {\n        return;\n    }\n    _setLabelmapColorAndOpacity(viewport.id, labelmapActorEntry, representation);\n}\nfunction _setLabelmapColorAndOpacity(viewportId, labelmapActorEntry, segmentationRepresentation) {\n    const { segmentationId } = segmentationRepresentation;\n    const { cfun, ofun } = segmentationRepresentation.config;\n    const { colorLUTIndex } = segmentationRepresentation;\n    const activeSegmentation = getActiveSegmentation(viewportId);\n    const isActiveLabelmap = activeSegmentation?.segmentationId === segmentationId;\n    const labelmapStyle = segmentationStyle.getStyle({\n        viewportId,\n        type: SegmentationRepresentations.Labelmap,\n        segmentationId,\n    });\n    const renderInactiveSegmentations = segmentationStyle.getRenderInactiveSegmentations(viewportId);\n    const colorLUT = getColorLUT(colorLUTIndex);\n    const numColors = Math.min(256, colorLUT.length);\n    const { outlineWidth, renderOutline, outlineOpacity, activeSegmentOutlineWidthDelta, } = _getLabelmapConfig(labelmapStyle, isActiveLabelmap);\n    const segmentsHidden = internalGetHiddenSegmentIndices(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Labelmap,\n    });\n    for (let i = 0; i < numColors; i++) {\n        const segmentIndex = i;\n        const segmentColor = colorLUT[segmentIndex];\n        const perSegmentStyle = segmentationStyle.getStyle({\n            viewportId,\n            type: SegmentationRepresentations.Labelmap,\n            segmentationId,\n            segmentIndex,\n        });\n        const segmentSpecificLabelmapConfig = perSegmentStyle;\n        const { fillAlpha, outlineWidth, renderFill, renderOutline } = _getLabelmapConfig(labelmapStyle, isActiveLabelmap, segmentSpecificLabelmapConfig);\n        const { forceOpacityUpdate, forceColorUpdate } = _needsTransferFunctionUpdate(viewportId, segmentationId, segmentIndex, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            segmentColor,\n            outlineWidth,\n            segmentsHidden: segmentsHidden,\n            cfun,\n            ofun,\n        });\n        if (forceColorUpdate) {\n            cfun.addRGBPoint(segmentIndex, segmentColor[0] / MAX_NUMBER_COLORS, segmentColor[1] / MAX_NUMBER_COLORS, segmentColor[2] / MAX_NUMBER_COLORS);\n        }\n        if (forceOpacityUpdate) {\n            if (renderFill) {\n                const segmentOpacity = segmentsHidden.has(segmentIndex)\n                    ? 0\n                    : (segmentColor[3] / 255) * fillAlpha;\n                ofun.removePoint(segmentIndex);\n                ofun.addPointLong(segmentIndex, segmentOpacity, 0.5, 1.0);\n            }\n            else {\n                ofun.addPointLong(segmentIndex, 0.01, 0.5, 1.0);\n            }\n        }\n    }\n    const labelmapActor = labelmapActorEntry.actor;\n    labelmapActor.getProperty().setRGBTransferFunction(0, cfun);\n    ofun.setClamping(false);\n    labelmapActor.getProperty().setScalarOpacity(0, ofun);\n    labelmapActor.getProperty().setInterpolationTypeToNearest();\n    if (renderOutline) {\n        labelmapActor.getProperty().setUseLabelOutline(renderOutline);\n        labelmapActor.getProperty().setLabelOutlineOpacity(outlineOpacity);\n        const activeSegmentIndex = getActiveSegmentIndex(segmentationRepresentation.segmentationId);\n        const outlineWidths = new Array(numColors - 1);\n        for (let i = 1; i < numColors; i++) {\n            const isHidden = segmentsHidden.has(i);\n            if (isHidden) {\n                outlineWidths[i - 1] = 0;\n                continue;\n            }\n            outlineWidths[i - 1] =\n                i === activeSegmentIndex\n                    ? outlineWidth + activeSegmentOutlineWidthDelta\n                    : outlineWidth;\n        }\n        labelmapActor.getProperty().setLabelOutlineThickness(outlineWidths);\n    }\n    else {\n        labelmapActor\n            .getProperty()\n            .setLabelOutlineThickness(new Array(numColors - 1).fill(0));\n    }\n    const visible = isActiveLabelmap || renderInactiveSegmentations;\n    labelmapActor.setVisibility(visible);\n}\nfunction _getLabelmapConfig(labelmapConfig, isActiveLabelmap, segmentsLabelmapConfig) {\n    const segmentLabelmapConfig = segmentsLabelmapConfig || {};\n    const configToUse = {\n        ...labelmapConfig,\n        ...segmentLabelmapConfig,\n    };\n    const fillAlpha = isActiveLabelmap\n        ? configToUse.fillAlpha\n        : configToUse.fillAlphaInactive;\n    const outlineWidth = isActiveLabelmap\n        ? configToUse.outlineWidth\n        : configToUse.outlineWidthInactive;\n    const renderFill = isActiveLabelmap\n        ? configToUse.renderFill\n        : configToUse.renderFillInactive;\n    const renderOutline = isActiveLabelmap\n        ? configToUse.renderOutline\n        : configToUse.renderOutlineInactive;\n    const outlineOpacity = isActiveLabelmap\n        ? configToUse.outlineOpacity\n        : configToUse.outlineOpacityInactive;\n    const activeSegmentOutlineWidthDelta = configToUse.activeSegmentOutlineWidthDelta;\n    return {\n        fillAlpha,\n        outlineWidth,\n        renderFill,\n        renderOutline,\n        outlineOpacity,\n        activeSegmentOutlineWidthDelta,\n    };\n}\nfunction _needsTransferFunctionUpdate(viewportId, segmentationId, segmentIndex, { fillAlpha, renderFill, renderOutline, segmentColor, outlineWidth, segmentsHidden, cfun, ofun, }) {\n    const cacheUID = `${viewportId}-${segmentationId}-${segmentIndex}`;\n    const oldConfig = labelMapConfigCache.get(cacheUID);\n    if (!oldConfig) {\n        labelMapConfigCache.set(cacheUID, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            outlineWidth,\n            segmentColor: segmentColor.slice(),\n            segmentsHidden: new Set(segmentsHidden),\n            cfunMTime: cfun.getMTime(),\n            ofunMTime: ofun.getMTime(),\n        });\n        return {\n            forceOpacityUpdate: true,\n            forceColorUpdate: true,\n        };\n    }\n    const { fillAlpha: oldFillAlpha, renderFill: oldRenderFill, renderOutline: oldRenderOutline, outlineWidth: oldOutlineWidth, segmentColor: oldSegmentColor, segmentsHidden: oldSegmentsHidden, cfunMTime: oldCfunMTime, ofunMTime: oldOfunMTime, } = oldConfig;\n    const forceColorUpdate = oldSegmentColor[0] !== segmentColor[0] ||\n        oldSegmentColor[1] !== segmentColor[1] ||\n        oldSegmentColor[2] !== segmentColor[2];\n    const forceOpacityUpdate = oldSegmentColor[3] !== segmentColor[3] ||\n        oldFillAlpha !== fillAlpha ||\n        oldRenderFill !== renderFill ||\n        oldRenderOutline !== renderOutline ||\n        oldOutlineWidth !== outlineWidth ||\n        oldSegmentsHidden !== segmentsHidden;\n    if (forceOpacityUpdate || forceColorUpdate) {\n        labelMapConfigCache.set(cacheUID, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            outlineWidth,\n            segmentColor: segmentColor.slice(),\n            segmentsHidden: new Set(segmentsHidden),\n            cfunMTime: cfun.getMTime(),\n            ofunMTime: ofun.getMTime(),\n        });\n    }\n    return {\n        forceOpacityUpdate,\n        forceColorUpdate,\n    };\n}\nasync function _addLabelmapToViewport(viewport, labelmapData, segmentationId) {\n    await addLabelmapToElement(viewport.element, labelmapData, segmentationId);\n}\nexport default {\n    render,\n    removeRepresentation,\n};\nexport { render, removeRepresentation };\n","import { cache, getEnabledElementByViewportId, Enums, } from '@cornerstonejs/core';\nimport Representations from '../../../enums/SegmentationRepresentations';\nimport removeSurfaceFromElement from './removeSurfaceFromElement';\nimport addOrUpdateSurfaceToElement from './addOrUpdateSurfaceToElement';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { getColorLUT } from '../../../stateManagement/segmentation/getColorLUT';\nimport { canComputeRequestedRepresentation } from '../../../stateManagement/segmentation/polySeg/canComputeRequestedRepresentation';\nimport { computeAndAddSurfaceRepresentation } from '../../../stateManagement/segmentation/polySeg/Surface/computeAndAddSurfaceRepresentation';\nconst { ViewportType } = Enums;\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    removeSurfaceFromElement(viewport.element, segmentationId);\n    if (!renderImmediate) {\n        return;\n    }\n    viewport.render();\n}\nasync function render(viewport, representation) {\n    const { segmentationId } = representation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return;\n    }\n    let SurfaceData = segmentation.representationData[Representations.Surface];\n    if (!SurfaceData &&\n        canComputeRequestedRepresentation(segmentationId, Representations.Surface)) {\n        SurfaceData = await computeAndAddSurfaceRepresentation(segmentationId, {\n            viewport,\n        });\n        if (!SurfaceData) {\n            throw new Error(`No Surface data found for segmentationId ${segmentationId}.`);\n        }\n    }\n    const { geometryIds } = SurfaceData;\n    if (!geometryIds?.size) {\n        console.warn(`No Surfaces found for segmentationId ${segmentationId}. Skipping render.`);\n    }\n    const { colorLUTIndex } = representation;\n    const colorLUT = getColorLUT(colorLUTIndex);\n    const surfaces = [];\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        if (!geometry?.data) {\n            console.warn(`No Surfaces found for geometryId ${geometryId}. Skipping render.`);\n            return;\n        }\n        const segmentIndex = geometry.data.segmentIndex;\n        const surface = geometry.data;\n        const color = colorLUT[segmentIndex];\n        surface.color = color.slice(0, 3);\n        surfaces.push(surface);\n        addOrUpdateSurfaceToElement(viewport.element, surface, segmentationId);\n    });\n    viewport.render();\n}\nexport default {\n    render,\n    removeRepresentation,\n};\nexport { render, removeRepresentation };\n","import { utilities as csUtils, cache, getEnabledElement, StackViewport, eventTarget, Enums, BaseVolumeViewport, volumeLoader, } from '@cornerstonejs/core';\nimport { vec3, vec2 } from 'gl-matrix';\nimport { BaseTool } from '../base';\nimport { fillInsideSphere, thresholdInsideSphere, } from './strategies/fillSphere';\nimport { eraseInsideSphere } from './strategies/eraseSphere';\nimport { thresholdInsideCircle, fillInsideCircle, } from './strategies/fillCircle';\nimport { eraseInsideCircle } from './strategies/eraseCircle';\nimport { Events, ToolModes, SegmentationRepresentations, StrategyCallbacks, } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportUIDs from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, getStackSegmentationImageIdsForViewport, } from '../../stateManagement/segmentation/segmentationState';\nimport { getLockedSegmentIndices } from '../../stateManagement/segmentation/segmentLocking';\nimport { getActiveSegmentIndex } from '../../stateManagement/segmentation/getActiveSegmentIndex';\nimport { getSegmentIndexColor } from '../../stateManagement/segmentation/config/segmentationColor';\nimport { getActiveSegmentation } from '../../stateManagement/segmentation/getActiveSegmentation';\nclass BrushTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE_CIRCLE: fillInsideCircle,\n                ERASE_INSIDE_CIRCLE: eraseInsideCircle,\n                FILL_INSIDE_SPHERE: fillInsideSphere,\n                ERASE_INSIDE_SPHERE: eraseInsideSphere,\n                THRESHOLD_INSIDE_CIRCLE: thresholdInsideCircle,\n                THRESHOLD_INSIDE_SPHERE: thresholdInsideSphere,\n            },\n            strategySpecificConfiguration: {\n                THRESHOLD: {\n                    threshold: [-150, -70],\n                },\n            },\n            defaultStrategy: 'FILL_INSIDE_CIRCLE',\n            activeStrategy: 'FILL_INSIDE_CIRCLE',\n            thresholdVolumeId: null,\n            brushSize: 25,\n            preview: {\n                enabled: false,\n                previewColors: {},\n                previewTimeMs: 250,\n                previewMoveDistance: 8,\n                dragMoveDistance: 4,\n                dragTimeMs: 500,\n            },\n            actions: {\n                [StrategyCallbacks.AcceptPreview]: {\n                    method: StrategyCallbacks.AcceptPreview,\n                    bindings: [\n                        {\n                            key: 'Enter',\n                        },\n                    ],\n                },\n                [StrategyCallbacks.RejectPreview]: {\n                    method: StrategyCallbacks.RejectPreview,\n                    bindings: [\n                        {\n                            key: 'Escape',\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._previewData = {\n            preview: null,\n            element: null,\n            timerStart: 0,\n            timer: null,\n            startPoint: [NaN, NaN],\n            isDrag: false,\n        };\n        this.onSetToolPassive = (evt) => {\n            this.disableCursor();\n        };\n        this.onSetToolEnabled = () => {\n            this.disableCursor();\n        };\n        this.onSetToolDisabled = (evt) => {\n            this.disableCursor();\n        };\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            this._editData = this.createEditData(element);\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            this._previewData.isDrag = false;\n            this._previewData.timerStart = Date.now();\n            const hoverData = this._hoverData || this.createHoverData(element);\n            triggerAnnotationRenderForViewportUIDs(hoverData.viewportIdsToRender);\n            const operationData = this.getOperationData(element);\n            this.applyActiveStrategyCallback(enabledElement, operationData, StrategyCallbacks.OnInteractionStart);\n            return true;\n        };\n        this.mouseMoveCallback = (evt) => {\n            if (this.mode === ToolModes.Active) {\n                this.updateCursor(evt);\n                if (!this.configuration.preview.enabled) {\n                    return;\n                }\n                const { previewTimeMs, previewMoveDistance, dragMoveDistance } = this.configuration.preview;\n                const { currentPoints, element } = evt.detail;\n                const { canvas } = currentPoints;\n                const { preview, startPoint, timer, timerStart, isDrag } = this._previewData;\n                const delta = vec2.distance(canvas, startPoint);\n                const time = Date.now() - timerStart;\n                if (delta > previewMoveDistance ||\n                    (time > previewTimeMs && delta > dragMoveDistance)) {\n                    if (timer) {\n                        window.clearTimeout(timer);\n                        this._previewData.timer = null;\n                    }\n                    if (preview && !isDrag) {\n                        this.rejectPreview(element);\n                    }\n                }\n                if (!this._previewData.timer) {\n                    const timer = window.setTimeout(this.previewCallback, 250);\n                    Object.assign(this._previewData, {\n                        timerStart: Date.now(),\n                        timer,\n                        startPoint: canvas,\n                        element,\n                    });\n                }\n            }\n        };\n        this.previewCallback = () => {\n            this._previewData.timer = null;\n            if (this._previewData.preview) {\n                return;\n            }\n            this._previewData.preview = this.applyActiveStrategyCallback(getEnabledElement(this._previewData.element), this.getOperationData(this._previewData.element), StrategyCallbacks.Preview);\n        };\n        this._dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const enabledElement = getEnabledElement(element);\n            this.updateCursor(evt);\n            const { viewportIdsToRender } = this._hoverData;\n            triggerAnnotationRenderForViewportUIDs(viewportIdsToRender);\n            const delta = vec2.distance(currentPoints.canvas, this._previewData.startPoint);\n            const { dragTimeMs, dragMoveDistance } = this.configuration.preview;\n            if (!this._previewData.isDrag &&\n                this._previewData.preview &&\n                Date.now() - this._previewData.timerStart < dragTimeMs &&\n                delta < dragMoveDistance) {\n                return;\n            }\n            this._previewData.preview = this.applyActiveStrategy(enabledElement, this.getOperationData(element));\n            this._previewData.element = element;\n            this._previewData.timerStart = Date.now() + dragTimeMs;\n            this._previewData.isDrag = true;\n            this._previewData.startPoint = currentPoints.canvas;\n        };\n        this._endCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            const operationData = this.getOperationData(element);\n            if (!this._previewData.preview && !this._previewData.isDrag) {\n                this.applyActiveStrategy(enabledElement, operationData);\n            }\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.updateCursor(evt);\n            this._editData = null;\n            this.applyActiveStrategyCallback(enabledElement, operationData, StrategyCallbacks.OnInteractionEnd);\n            if (!this._previewData.isDrag) {\n                this.acceptPreview(element);\n            }\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n    }\n    disableCursor() {\n        this._hoverData = undefined;\n        this.rejectPreview();\n    }\n    createEditData(element) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const activeSegmentation = getActiveSegmentation(viewport.id);\n        if (!activeSegmentation) {\n            const event = new CustomEvent(Enums.Events.ERROR_EVENT, {\n                detail: {\n                    type: 'Segmentation',\n                    message: 'No active segmentation detected, create a segmentation representation before using the brush tool',\n                },\n                cancelable: true,\n            });\n            eventTarget.dispatchEvent(event);\n            return null;\n        }\n        const { segmentationId } = activeSegmentation;\n        const segmentsLocked = getLockedSegmentIndices(segmentationId);\n        const { representationData } = getSegmentation(segmentationId);\n        if (viewport instanceof BaseVolumeViewport) {\n            const { volumeId } = representationData[SegmentationRepresentations.Labelmap];\n            const actors = viewport.getActors();\n            const isStackViewport = viewport instanceof StackViewport;\n            if (isStackViewport) {\n                const event = new CustomEvent(Enums.Events.ERROR_EVENT, {\n                    detail: {\n                        type: 'Segmentation',\n                        message: 'Cannot perform brush operation on the selected viewport',\n                    },\n                    cancelable: true,\n                });\n                eventTarget.dispatchEvent(event);\n                return null;\n            }\n            const volumes = actors.map((actorEntry) => cache.getVolume(actorEntry.referencedId));\n            const segmentationVolume = cache.getVolume(volumeId);\n            const referencedVolumeIdToThreshold = volumes.find((volume) => csUtils.isEqual(volume.dimensions, segmentationVolume.dimensions))?.volumeId || volumes[0]?.volumeId;\n            return {\n                volumeId,\n                referencedVolumeId: this.configuration.thresholdVolumeId ?? referencedVolumeIdToThreshold,\n                segmentsLocked,\n            };\n        }\n        else {\n            const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n            if (!segmentationImageId) {\n                return;\n            }\n            if (this.configuration.activeStrategy.includes('SPHERE')) {\n                const referencedImageIds = viewport.getImageIds();\n                const isValidVolumeForSphere = csUtils.isValidVolume(referencedImageIds);\n                if (!isValidVolumeForSphere) {\n                    throw new Error('Volume is not reconstructable for sphere manipulation');\n                }\n                const volumeId = `${segmentationId}_${viewport.id}`;\n                const volume = cache.getVolume(volumeId);\n                if (volume) {\n                    return {\n                        imageId: segmentationImageId,\n                        segmentsLocked,\n                        override: {\n                            voxelManager: volume.voxelManager,\n                            imageData: volume.imageData,\n                        },\n                    };\n                }\n                else {\n                    const labelmapImageIds = getStackSegmentationImageIdsForViewport(viewport.id, segmentationId);\n                    if (!labelmapImageIds || labelmapImageIds.length === 1) {\n                        return {\n                            imageId: segmentationImageId,\n                            segmentsLocked,\n                        };\n                    }\n                    const volume = volumeLoader.createAndCacheVolumeFromImagesSync(volumeId, labelmapImageIds);\n                    return {\n                        imageId: segmentationImageId,\n                        segmentsLocked,\n                        override: {\n                            voxelManager: volume.voxelManager,\n                            imageData: volume.imageData,\n                        },\n                    };\n                }\n            }\n            else {\n                return {\n                    imageId: segmentationImageId,\n                    segmentsLocked,\n                };\n            }\n        }\n    }\n    createHoverData(element, centerCanvas) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, viewUp } = camera;\n        const viewportIdsToRender = [viewport.id];\n        const { segmentIndex, segmentationId, segmentColor } = this.getActiveSegmentationData(viewport) || {};\n        const brushCursor = {\n            metadata: {\n                viewPlaneNormal: [...viewPlaneNormal],\n                viewUp: [...viewUp],\n                FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                referencedImageId: '',\n                toolName: this.getToolName(),\n                segmentColor,\n            },\n            data: {},\n        };\n        return {\n            brushCursor,\n            centerCanvas,\n            segmentIndex,\n            viewport,\n            segmentationId,\n            segmentColor,\n            viewportIdsToRender,\n        };\n    }\n    getActiveSegmentationData(viewport) {\n        const viewportId = viewport.id;\n        const activeRepresentation = getActiveSegmentation(viewportId);\n        if (!activeRepresentation) {\n            return;\n        }\n        const { segmentationId } = activeRepresentation;\n        const segmentIndex = getActiveSegmentIndex(segmentationId);\n        if (!segmentIndex) {\n            return;\n        }\n        const segmentColor = getSegmentIndexColor(viewportId, segmentationId, segmentIndex);\n        return {\n            segmentIndex,\n            segmentationId,\n            segmentColor,\n        };\n    }\n    updateCursor(evt) {\n        const eventData = evt.detail;\n        const { element } = eventData;\n        const { currentPoints } = eventData;\n        const centerCanvas = currentPoints.canvas;\n        this._hoverData = this.createHoverData(element, centerCanvas);\n        this._calculateCursor(element, centerCanvas);\n        if (!this._hoverData) {\n            return;\n        }\n        triggerAnnotationRenderForViewportUIDs(this._hoverData.viewportIdsToRender);\n    }\n    getOperationData(element) {\n        const editData = this._editData || this.createEditData(element);\n        const { segmentIndex, segmentationId, brushCursor } = this._hoverData || this.createHoverData(element);\n        const { data, metadata = {} } = brushCursor || {};\n        const { viewPlaneNormal, viewUp } = metadata;\n        const operationData = {\n            ...editData,\n            points: data?.handles?.points,\n            segmentIndex,\n            previewColors: this.configuration.preview.enabled\n                ? this.configuration.preview.previewColors\n                : null,\n            viewPlaneNormal,\n            toolGroupId: this.toolGroupId,\n            segmentationId,\n            viewUp,\n            strategySpecificConfiguration: this.configuration.strategySpecificConfiguration,\n            preview: this._previewData?.preview,\n        };\n        return operationData;\n    }\n    _calculateCursor(element, centerCanvas) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { canvasToWorld } = viewport;\n        const camera = viewport.getCamera();\n        const { brushSize } = this.configuration;\n        const viewUp = vec3.fromValues(camera.viewUp[0], camera.viewUp[1], camera.viewUp[2]);\n        const viewPlaneNormal = vec3.fromValues(camera.viewPlaneNormal[0], camera.viewPlaneNormal[1], camera.viewPlaneNormal[2]);\n        const viewRight = vec3.create();\n        vec3.cross(viewRight, viewUp, viewPlaneNormal);\n        const centerCursorInWorld = canvasToWorld([\n            centerCanvas[0],\n            centerCanvas[1],\n        ]);\n        const bottomCursorInWorld = vec3.create();\n        const topCursorInWorld = vec3.create();\n        const leftCursorInWorld = vec3.create();\n        const rightCursorInWorld = vec3.create();\n        for (let i = 0; i <= 2; i++) {\n            bottomCursorInWorld[i] = centerCursorInWorld[i] - viewUp[i] * brushSize;\n            topCursorInWorld[i] = centerCursorInWorld[i] + viewUp[i] * brushSize;\n            leftCursorInWorld[i] = centerCursorInWorld[i] - viewRight[i] * brushSize;\n            rightCursorInWorld[i] = centerCursorInWorld[i] + viewRight[i] * brushSize;\n        }\n        if (!this._hoverData) {\n            return;\n        }\n        const { brushCursor } = this._hoverData;\n        const { data } = brushCursor;\n        if (data.handles === undefined) {\n            data.handles = {};\n        }\n        data.handles.points = [\n            bottomCursorInWorld,\n            topCursorInWorld,\n            leftCursorInWorld,\n            rightCursorInWorld,\n        ];\n        const activeStrategy = this.configuration.activeStrategy;\n        const strategy = this.configuration.strategies[activeStrategy];\n        if (typeof strategy.computeInnerCircleRadius === 'function') {\n            strategy.computeInnerCircleRadius({\n                configuration: this.configuration,\n                viewport,\n            });\n        }\n        data.invalidated = false;\n    }\n    rejectPreview(element = this._previewData.element) {\n        if (!element || !this._previewData.preview) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        this.applyActiveStrategyCallback(enabledElement, this.getOperationData(element), StrategyCallbacks.RejectPreview);\n        this._previewData.preview = null;\n        this._previewData.isDrag = false;\n    }\n    acceptPreview(element = this._previewData.element) {\n        if (!element) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        this.applyActiveStrategyCallback(enabledElement, this.getOperationData(element), StrategyCallbacks.AcceptPreview);\n        this._previewData.isDrag = false;\n        this._previewData.preview = null;\n    }\n    invalidateBrushCursor() {\n        if (this._hoverData === undefined) {\n            return;\n        }\n        const { data } = this._hoverData.brushCursor;\n        const { viewport } = this._hoverData;\n        data.invalidated = true;\n        const { segmentColor } = this.getActiveSegmentationData(viewport) || {};\n        this._hoverData.brushCursor.metadata.segmentColor = segmentColor;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this._hoverData) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const viewportIdsToRender = this._hoverData.viewportIdsToRender;\n        if (!viewportIdsToRender.includes(viewport.id)) {\n            return;\n        }\n        const brushCursor = this._hoverData.brushCursor;\n        if (brushCursor.data.invalidated === true) {\n            const { centerCanvas } = this._hoverData;\n            const { element } = viewport;\n            this._calculateCursor(element, centerCanvas);\n        }\n        const toolMetadata = brushCursor.metadata;\n        if (!toolMetadata) {\n            return;\n        }\n        const annotationUID = toolMetadata.brushCursorUID;\n        const data = brushCursor.data;\n        const { points } = data.handles;\n        const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n        const bottom = canvasCoordinates[0];\n        const top = canvasCoordinates[1];\n        const center = [\n            Math.floor((bottom[0] + top[0]) / 2),\n            Math.floor((bottom[1] + top[1]) / 2),\n        ];\n        const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n        const color = `rgb(${toolMetadata.segmentColor?.slice(0, 3) || [0, 0, 0]})`;\n        if (!viewport.getRenderingEngine()) {\n            console.warn('Rendering Engine has been destroyed');\n            return;\n        }\n        const circleUID = '0';\n        drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n            color,\n        });\n        const activeStrategy = this.configuration.activeStrategy;\n        const { dynamicRadiusInCanvas } = this.configuration\n            .strategySpecificConfiguration[activeStrategy] || {\n            dynamicRadiusInCanvas: 0,\n        };\n        if (dynamicRadiusInCanvas) {\n            const circleUID1 = '1';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID1, center, dynamicRadiusInCanvas, {\n                color,\n            });\n        }\n    }\n}\nBrushTool.toolName = 'Brush';\nexport default BrushTool;\n","import { getEnabledElement, cache, StackViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawHandles as drawHandlesSvg, drawRect as drawRectSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport throttle from '../../utilities/throttle';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromCorners from '../../utilities/planar/getWorldWidthAndHeightFromCorners';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { hideElementCursor, resetElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport RectangleROITool from '../annotation/RectangleROITool';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport { filterAnnotationsWithinSamePlane } from '../../utilities/planar';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { transformWorldToIndex } = csUtils;\nclass RectangleROIStartEndThresholdTool extends RectangleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            storePointData: false,\n            numSlicesToPropagate: 10,\n            computePointsInsideVolume: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n            showTextBox: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            let referencedImageId, imageVolume, volumeId;\n            if (viewport instanceof StackViewport) {\n                throw new Error('Stack Viewport Not implemented');\n            }\n            else {\n                const targetId = this.getTargetId(viewport);\n                volumeId = csUtils.getVolumeId(targetId);\n                imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const spacingInNormal = csUtils.getSpacingInNormalDirection(imageVolume, viewPlaneNormal);\n            const startCoord = this._getStartCoordinate(worldPos, viewPlaneNormal);\n            const endCoord = this._getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    enabledElement,\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                    volumeId,\n                    spacingInNormal,\n                },\n                data: {\n                    label: '',\n                    startCoordinate: startCoord,\n                    endCoordinate: endCoord,\n                    cachedStats: {\n                        pointsInVolume: [],\n                        projectionPoints: [],\n                        projectionPointsImageIds: [referencedImageId],\n                        statistics: [],\n                    },\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    labelmapUID: null,\n                },\n            };\n            this._computeProjectionPoints(annotation, imageVolume);\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const targetId = this.getTargetId(enabledElement.viewport);\n            const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n            if (this.configuration.calculatePointsInsideVolume) {\n                this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            let annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = filterAnnotationsWithinSamePlane(annotations, viewport.getCamera());\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { startCoordinate, endCoordinate } = data;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const focalPoint = viewport.getCamera().focalPoint;\n                const viewplaneNormal = viewport.getCamera().viewPlaneNormal;\n                let startCoord = startCoordinate;\n                let endCoord = endCoordinate;\n                if (Array.isArray(startCoordinate)) {\n                    startCoord = this._getCoordinateForViewplaneNormal(startCoord, viewplaneNormal);\n                    data.startCoordinate = startCoord;\n                    data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = startCoord;\n                    data.startCoordinate = startCoord;\n                    data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = startCoord;\n                }\n                if (Array.isArray(endCoordinate)) {\n                    endCoord = this._getCoordinateForViewplaneNormal(endCoord, viewplaneNormal);\n                    data.endCoordinate = endCoord;\n                    data.endCoordinate = endCoord;\n                }\n                const roundedStartCoord = csUtils.roundToPrecision(startCoord);\n                const roundedEndCoord = csUtils.roundToPrecision(endCoord);\n                const coord = this._getCoordinateForViewplaneNormal(focalPoint, viewplaneNormal);\n                const roundedCoord = csUtils.roundToPrecision(coord);\n                if (roundedCoord < Math.min(roundedStartCoord, roundedEndCoord) ||\n                    roundedCoord > Math.max(roundedStartCoord, roundedEndCoord)) {\n                    continue;\n                }\n                if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, enabledElement);\n                }\n                let firstOrLastSlice = false;\n                if (roundedCoord === roundedStartCoord ||\n                    roundedCoord === roundedEndCoord) {\n                    firstOrLastSlice = true;\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null &&\n                    firstOrLastSlice) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                let lineDashToUse = lineDash;\n                if (!firstOrLastSlice) {\n                    lineDashToUse = 2;\n                }\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash: lineDashToUse,\n                    lineWidth,\n                });\n                renderStatus = true;\n                if (this.configuration.showTextBox &&\n                    this.configuration.calculatePointsInsideVolume) {\n                    const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                    if (!options.visibility) {\n                        data.handles.textBox = {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        };\n                        continue;\n                    }\n                    const textLines = this.configuration.getTextLines(data);\n                    if (!textLines || textLines.length === 0) {\n                        continue;\n                    }\n                    if (!data.handles.textBox.hasMoved) {\n                        const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                        data.handles.textBox.worldPosition =\n                            viewport.canvasToWorld(canvasTextBoxCoords);\n                    }\n                    const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                    const textBoxUID = '1';\n                    const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                    const { x: left, y: top, width, height } = boundingBox;\n                    data.handles.textBox.worldBoundingBox = {\n                        topLeft: viewport.canvasToWorld([left, top]),\n                        topRight: viewport.canvasToWorld([left + width, top]),\n                        bottomLeft: viewport.canvasToWorld([left, top + height]),\n                        bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                    };\n                }\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStatsTool, 100, { trailing: true });\n    }\n    _computeProjectionPoints(annotation, imageVolume) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, spacingInNormal } = metadata;\n        const { imageData } = imageVolume;\n        const { startCoordinate, endCoordinate } = data;\n        const { points } = data.handles;\n        const startIJK = transformWorldToIndex(imageData, points[0]);\n        const endIJK = transformWorldToIndex(imageData, points[0]);\n        const startWorld = vec3.create();\n        imageData.indexToWorldVec3(startIJK, startWorld);\n        const endWorld = vec3.create();\n        imageData.indexToWorldVec3(endIJK, endWorld);\n        if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 2) {\n            startWorld[2] = startCoordinate;\n            endWorld[2] = endCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 0) {\n            startWorld[0] = startCoordinate;\n            endWorld[0] = endCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 1) {\n            startWorld[1] = startCoordinate;\n            endWorld[1] = endCoordinate;\n        }\n        const distance = vec3.distance(startWorld, endWorld);\n        const newProjectionPoints = [];\n        for (let dist = 0; dist < distance; dist += spacingInNormal) {\n            newProjectionPoints.push(points.map((point) => {\n                const newPoint = vec3.create();\n                vec3.scaleAndAdd(newPoint, point, viewPlaneNormal, dist);\n                return Array.from(newPoint);\n            }));\n        }\n        data.cachedStats.projectionPoints = newProjectionPoints;\n    }\n    _computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, viewUp } = metadata;\n        const { viewport } = enabledElement;\n        const projectionPoints = data.cachedStats.projectionPoints;\n        const pointsInsideVolume = [[]];\n        const image = this.getTargetImageData(targetId);\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[3];\n        const { worldWidth, worldHeight } = getWorldWidthAndHeightFromCorners(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n        const measureInfo = getCalibratedLengthUnitsAndScale(image, data.habdles);\n        const area = Math.abs(worldWidth * worldHeight) /\n            (measureInfo.scale * measureInfo.scale);\n        const modalityUnitOptions = {\n            isPreScaled: isViewportPreScaled(viewport, targetId),\n            isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n        };\n        const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n        for (let i = 0; i < projectionPoints.length; i++) {\n            if (!imageVolume) {\n                continue;\n            }\n            const projectionPoint = projectionPoints[i][0];\n            const { dimensions, imageData, voxelManager } = imageVolume;\n            const worldPos1Index = transformWorldToIndex(imageData, worldPos1);\n            const worldProjectionPointIndex = transformWorldToIndex(imageData, projectionPoint);\n            const indexOfProjection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n            worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n            worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n            worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n            worldPos1Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            const worldPos2Index = transformWorldToIndex(imageData, worldPos2);\n            worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n            worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n            worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n            worldPos2Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                this.isHandleOutsideImage = false;\n                const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    boundsIJK,\n                    imageData,\n                    returnPoints: this.configuration.storePointData,\n                });\n                pointsInsideVolume.push(pointsInShape);\n            }\n        }\n        const stats = this.configuration.statsCalculator.getStatistics();\n        data.cachedStats.pointsInVolume = pointsInsideVolume;\n        data.cachedStats.statistics = {\n            Modality: metadata.Modality,\n            area,\n            mean: stats.mean?.value,\n            stdDev: stats.stdDev?.value,\n            max: stats.max?.value,\n            statsArray: stats.array,\n            areaUnit: measureInfo.areaUnit,\n            modalityUnit,\n        };\n    }\n    _calculateCachedStatsTool(annotation, enabledElement) {\n        const data = annotation.data;\n        const { viewport } = enabledElement;\n        const { cachedStats } = data;\n        const targetId = this.getTargetId(viewport);\n        const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n        this._computeProjectionPoints(annotation, imageVolume);\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n        }\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, viewport.element);\n        return cachedStats;\n    }\n    _getStartCoordinate(worldPos, viewPlaneNormal) {\n        const startPos = worldPos;\n        const startCoord = this._getCoordinateForViewplaneNormal(startPos, viewPlaneNormal);\n        return startCoord;\n    }\n    _getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const endPos = vec3.create();\n        vec3.scaleAndAdd(endPos, worldPos, viewPlaneNormal, numSlicesToPropagate * spacingInNormal);\n        const endCoord = this._getCoordinateForViewplaneNormal(endPos, viewPlaneNormal);\n        return endCoord;\n    }\n    _getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) {\n        const viewplaneNormalAbs = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const indexOfDirection = viewplaneNormalAbs.indexOf(Math.max(...viewplaneNormalAbs));\n        return indexOfDirection;\n    }\n    _getCoordinateForViewplaneNormal(pos, viewPlaneNormal) {\n        const indexOfDirection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n        return pos[indexOfDirection];\n    }\n}\nfunction defaultGetTextLines(data) {\n    const cachedVolumeStats = data.cachedStats.statistics;\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nRectangleROIStartEndThresholdTool.toolName = 'RectangleROIStartEndThreshold';\nexport default RectangleROIStartEndThresholdTool;\n","import { getEnabledElement, cache, StackViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawHandles as drawHandlesSvg, drawRect as drawRectSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { hideElementCursor } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport RectangleROITool from '../annotation/RectangleROITool';\nclass RectangleROIThresholdTool extends RectangleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const targetId = this.getTargetId(viewport);\n            let referencedImageId, volumeId;\n            if (viewport instanceof StackViewport) {\n                referencedImageId = targetId.split('imageId:')[1];\n            }\n            else {\n                volumeId = csUtils.getVolumeId(targetId);\n                const imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    enabledElement,\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                    volumeId,\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: null,\n                            worldBoundingBox: null,\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    segmentationId: null,\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                triggerAnnotationModified(annotation, element);\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n    }\n}\nRectangleROIThresholdTool.toolName = 'RectangleROIThreshold';\nexport default RectangleROIThresholdTool;\n","export var ContourWindingDirection;\n(function (ContourWindingDirection) {\n    ContourWindingDirection[ContourWindingDirection[\"CounterClockwise\"] = -1] = \"CounterClockwise\";\n    ContourWindingDirection[ContourWindingDirection[\"Unknown\"] = 0] = \"Unknown\";\n    ContourWindingDirection[ContourWindingDirection[\"Clockwise\"] = 1] = \"Clockwise\";\n})(ContourWindingDirection || (ContourWindingDirection = {}));\n","import { getEnabledElements, utilities as csUtils } from '@cornerstonejs/core';\nconst { isEqual } = csUtils;\nexport default function getViewportsForAnnotation(annotation) {\n    const { metadata } = annotation;\n    return getEnabledElements()\n        .filter((enabledElement) => {\n        if (enabledElement.FrameOfReferenceUID === metadata.FrameOfReferenceUID) {\n            const viewport = enabledElement.viewport;\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            return (isEqual(viewPlaneNormal, metadata.viewPlaneNormal) &&\n                (!metadata.viewUp || isEqual(viewUp, metadata.viewUp)));\n        }\n        return;\n    })\n        .map((enabledElement) => enabledElement.viewport);\n}\n","import { utilities, triggerEvent } from '@cornerstonejs/core';\nimport { getAnnotationNearPoint, getAnnotationNearPointOnEnabledElement, } from './getAnnotationNearPoint';\nimport debounce from './debounce';\nimport throttle from './throttle';\nimport isObject from './isObject';\nimport calibrateImageSpacing from './calibrateImageSpacing';\nimport { getCalibratedLengthUnitsAndScale, getCalibratedProbeUnitsAndValue, getCalibratedAspect, } from './getCalibratedUnits';\nimport triggerAnnotationRenderForViewportIds from './triggerAnnotationRenderForViewportIds';\nimport triggerAnnotationRenderForToolGroupIds from './triggerAnnotationRenderForToolGroupIds';\nimport triggerAnnotationRender from './triggerAnnotationRender';\nimport { getSphereBoundsInfo } from './getSphereBoundsInfo';\nimport { pointToString } from './pointToString';\nimport annotationFrameRange from './annotationFrameRange';\nimport getViewportForAnnotation from './getViewportForAnnotation';\nimport { annotationHydration, getClosestImageIdForStackViewport, } from './annotationHydration';\nimport * as contours from './contours';\nimport * as segmentation from './segmentation';\nimport * as drawing from './drawing';\nimport * as math from './math';\nimport * as planar from './planar';\nimport * as viewportFilters from './viewportFilters';\nimport * as orientation from './orientation';\nimport * as cine from './cine';\nimport * as boundingBox from './boundingBox';\nimport * as planarFreehandROITool from './planarFreehandROITool';\nimport * as rectangleROITool from './rectangleROITool';\nimport { stackPrefetch, stackContextPrefetch } from './stackPrefetch';\nimport * as viewport from './viewport';\nimport * as touch from './touch';\nimport * as dynamicVolume from './dynamicVolume';\nimport * as polyDataUtils from './polyData/utils';\nimport * as voi from './voi';\nimport * as contourSegmentation from './contourSegmentation';\nimport { pointInSurroundingSphereCallback } from './pointInSurroundingSphereCallback';\nconst roundNumber = utilities.roundNumber;\nexport { math, planar, viewportFilters, drawing, debounce, dynamicVolume, throttle, orientation, isObject, touch, triggerEvent, calibrateImageSpacing, getCalibratedLengthUnitsAndScale, getCalibratedProbeUnitsAndValue, getCalibratedAspect, segmentation, contours, triggerAnnotationRenderForViewportIds, triggerAnnotationRenderForToolGroupIds, triggerAnnotationRender, getSphereBoundsInfo, getAnnotationNearPoint, getViewportForAnnotation, getAnnotationNearPointOnEnabledElement, viewport, cine, boundingBox, rectangleROITool, planarFreehandROITool, stackPrefetch, stackContextPrefetch, roundNumber, pointToString, polyDataUtils, voi, annotationFrameRange, contourSegmentation, annotationHydration, getClosestImageIdForStackViewport, pointInSurroundingSphereCallback, };\n","export default function findClosestPoint(sourcePoints, targetPoint) {\n    let minPoint = [0, 0];\n    let minDistance = Number.MAX_SAFE_INTEGER;\n    sourcePoints.forEach(function (sourcePoint) {\n        const distance = _distanceBetween(targetPoint, sourcePoint);\n        if (distance < minDistance) {\n            minDistance = distance;\n            minPoint = [...sourcePoint];\n        }\n    });\n    return minPoint;\n}\nfunction _distanceBetween(p1, p2) {\n    const [x1, y1] = p1;\n    const [x2, y2] = p2;\n    return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n}\n","import { cache } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../enums';\nimport { getCachedSegmentIndices, setCachedSegmentIndices } from './utilities';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nfunction getUniqueSegmentIndices(segmentationId) {\n    const cachedResult = getCachedSegmentIndices(segmentationId);\n    if (cachedResult) {\n        return cachedResult;\n    }\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation found for segmentationId ${segmentationId}`);\n    }\n    let indices;\n    if (segmentation.representationData.Labelmap) {\n        indices = handleLabelmapSegmentation(segmentation, segmentationId);\n    }\n    else if (segmentation.representationData.Contour) {\n        indices = handleContourSegmentation(segmentation);\n    }\n    else if (segmentation.representationData.Surface) {\n        indices = handleSurfaceSegmentation(segmentation);\n    }\n    else {\n        throw new Error(`Unsupported segmentation type: ${segmentation.representationData}`);\n    }\n    setCachedSegmentIndices(segmentationId, indices);\n    return indices;\n}\nfunction handleLabelmapSegmentation(segmentation, segmentationId) {\n    const labelmapData = segmentation.representationData[SegmentationRepresentations.Labelmap];\n    const keySet = new Set();\n    if (labelmapData.imageIds) {\n        addImageSegmentIndices(keySet, labelmapData.imageIds);\n    }\n    else {\n        addVolumeSegmentIndices(keySet, segmentationId);\n    }\n    return Array.from(keySet)\n        .map(Number)\n        .sort((a, b) => a - b);\n}\nfunction addVolumeSegmentIndices(keySet, segmentationId) {\n    const volume = cache.getVolume(segmentationId);\n    volume.voxelManager.forEach(({ value }) => {\n        if (value !== 0) {\n            keySet.add(value);\n        }\n    });\n}\nfunction addImageSegmentIndices(keySet, imageIds) {\n    imageIds.forEach((segmentationImageId) => {\n        const image = cache.getImage(segmentationImageId);\n        const scalarData = image.voxelManager.getScalarData();\n        scalarData.forEach((segmentIndex) => {\n            if (segmentIndex !== 0) {\n                keySet.add(segmentIndex);\n            }\n        });\n    });\n}\nfunction handleContourSegmentation(segmentation) {\n    const { annotationUIDsMap, geometryIds } = segmentation.representationData.Contour || {};\n    if (!geometryIds) {\n        throw new Error(`No geometryIds found for segmentationId ${segmentation.segmentationId}`);\n    }\n    const indices = new Set([...annotationUIDsMap.keys()]);\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        indices.add(geometry.data.segmentIndex);\n    });\n    return Array.from(indices).sort((a, b) => a - b);\n}\nfunction handleSurfaceSegmentation(segmentation) {\n    const geometryIds = segmentation.representationData.Surface?.geometryIds ?? [];\n    return Array.from(geometryIds.keys())\n        .map(Number)\n        .sort((a, b) => a - b);\n}\nexport { getUniqueSegmentIndices };\n","import { getToolGroup } from '../../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../triggerAnnotationRenderForViewportIds';\nimport { getBrushToolInstances } from './getBrushToolInstances';\nexport function invalidateBrushCursor(toolGroupId) {\n    const toolGroup = getToolGroup(toolGroupId);\n    if (toolGroup === undefined) {\n        return;\n    }\n    const brushBasedToolInstances = getBrushToolInstances(toolGroupId);\n    brushBasedToolInstances.forEach((tool) => {\n        tool.invalidateBrushCursor();\n    });\n    const viewportsInfo = toolGroup.getViewportsInfo();\n    const viewportsInfoArray = Object.keys(viewportsInfo).map((key) => viewportsInfo[key]);\n    if (!viewportsInfoArray.length) {\n        return;\n    }\n    const viewportIds = toolGroup.getViewportIds();\n    triggerAnnotationRenderForViewportIds(viewportIds);\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { getBoundingBoxAroundShapeIJK } from '../boundingBox/getBoundingBoxAroundShape';\nconst equalsCheck = (a, b) => {\n    return JSON.stringify(a) === JSON.stringify(b);\n};\nexport function getVoxelOverlap(imageData, dimensions, voxelSpacing, voxelCenter) {\n    const halfSpacingX = voxelSpacing[0] / 2;\n    const halfSpacingY = voxelSpacing[1] / 2;\n    const halfSpacingZ = voxelSpacing[2] / 2;\n    const voxelCornersIJK = new Array(8);\n    voxelCornersIJK[0] = csUtils.transformWorldToIndex(imageData, [\n        voxelCenter[0] - halfSpacingX,\n        voxelCenter[1] - halfSpacingY,\n        voxelCenter[2] - halfSpacingZ,\n    ]);\n    const offsets = [\n        [1, -1, -1],\n        [-1, 1, -1],\n        [1, 1, -1],\n        [-1, -1, 1],\n        [1, -1, 1],\n        [-1, 1, 1],\n        [1, 1, 1],\n    ];\n    for (let i = 0; i < 7; i++) {\n        const [xOff, yOff, zOff] = offsets[i];\n        voxelCornersIJK[i + 1] = csUtils.transformWorldToIndex(imageData, [\n            voxelCenter[0] + xOff * halfSpacingX,\n            voxelCenter[1] + yOff * halfSpacingY,\n            voxelCenter[2] + zOff * halfSpacingZ,\n        ]);\n    }\n    return getBoundingBoxAroundShapeIJK(voxelCornersIJK, dimensions);\n}\nexport function processVolumes(segmentationVolume, thresholdVolumeInformation) {\n    const { spacing: segmentationSpacing } = segmentationVolume;\n    const scalarDataLength = segmentationVolume.voxelManager.getScalarDataLength();\n    const volumeInfoList = [];\n    let baseVolumeIdx = 0;\n    for (let i = 0; i < thresholdVolumeInformation.length; i++) {\n        const { imageData, spacing, dimensions, voxelManager } = thresholdVolumeInformation[i].volume;\n        const volumeSize = thresholdVolumeInformation[i].volume.voxelManager.getScalarDataLength();\n        if (volumeSize === scalarDataLength &&\n            equalsCheck(spacing, segmentationSpacing)) {\n            baseVolumeIdx = i;\n        }\n        const lower = thresholdVolumeInformation[i].lower;\n        const upper = thresholdVolumeInformation[i].upper;\n        volumeInfoList.push({\n            imageData,\n            lower,\n            upper,\n            spacing,\n            dimensions,\n            volumeSize,\n            voxelManager,\n        });\n    }\n    return {\n        volumeInfoList,\n        baseVolumeIdx,\n    };\n}\nconst segmentIndicesCache = new Map();\nexport const setSegmentationDirty = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached) {\n        cached.isDirty = true;\n    }\n};\nexport const setSegmentationClean = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached) {\n        cached.isDirty = false;\n    }\n};\nexport const getCachedSegmentIndices = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached && !cached.isDirty) {\n        return cached.indices;\n    }\n    return null;\n};\nexport const setCachedSegmentIndices = (segmentationId, indices) => {\n    segmentIndicesCache.set(segmentationId, { indices, isDirty: false });\n};\n","import { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport triggerAnnotationRender from './triggerAnnotationRender';\nexport function triggerAnnotationRenderForViewportIds(viewportIdsToRender) {\n    if (!viewportIdsToRender.length) {\n        return;\n    }\n    viewportIdsToRender.forEach((viewportId) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            console.warn(`Viewport not available for ${viewportId}`);\n            return;\n        }\n        const { viewport } = enabledElement;\n        if (!viewport) {\n            console.warn(`Viewport not available for ${viewportId}`);\n            return;\n        }\n        const element = viewport.element;\n        triggerAnnotationRender(element);\n    });\n}\nexport default triggerAnnotationRenderForViewportIds;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nvar DEFAULT_SIZE = 24;\n\nexports.default = function (_ref) {\n  var _ref$fill = _ref.fill,\n      fill = _ref$fill === undefined ? 'currentColor' : _ref$fill,\n      _ref$width = _ref.width,\n      width = _ref$width === undefined ? DEFAULT_SIZE : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === undefined ? DEFAULT_SIZE : _ref$height,\n      _ref$style = _ref.style,\n      style = _ref$style === undefined ? {} : _ref$style,\n      props = _objectWithoutProperties(_ref, ['fill', 'width', 'height', 'style']);\n\n  return _react2.default.createElement(\n    'svg',\n    _extends({\n      viewBox: '0 0 ' + DEFAULT_SIZE + ' ' + DEFAULT_SIZE,\n      style: _extends({ fill: fill, width: width, height: height }, style)\n    }, props),\n    _react2.default.createElement('path', { d: 'M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z' })\n  );\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nvar DEFAULT_SIZE = 24;\n\nexports.default = function (_ref) {\n  var _ref$fill = _ref.fill,\n      fill = _ref$fill === undefined ? 'currentColor' : _ref$fill,\n      _ref$width = _ref.width,\n      width = _ref$width === undefined ? DEFAULT_SIZE : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === undefined ? DEFAULT_SIZE : _ref$height,\n      _ref$style = _ref.style,\n      style = _ref$style === undefined ? {} : _ref$style,\n      props = _objectWithoutProperties(_ref, ['fill', 'width', 'height', 'style']);\n\n  return _react2.default.createElement(\n    'svg',\n    _extends({\n      viewBox: '0 0 ' + DEFAULT_SIZE + ' ' + DEFAULT_SIZE,\n      style: _extends({ fill: fill, width: width, height: height }, style)\n    }, props),\n    _react2.default.createElement('path', { d: 'M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z' })\n  );\n};","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\n\n/**\n * Converts a Uint8Array to a String.\n * @param {Uint8Array} array that should be converted\n * @param {Number} offset array offset in case only subset of array items should\n                   be extracted (default: 0)\n * @param {Number} limit maximum number of array items that should be extracted\n                   (defaults to length of array)\n * @returns {String}\n */\nfunction uint8ArrayToString(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var limit = arguments.length > 2 ? arguments[2] : undefined;\n  var itemLimit = limit || arr.length - offset;\n  var str = '';\n  for (var i = offset; i < offset + itemLimit; i++) {\n    str += String.fromCharCode(arr[i]);\n  }\n  return str;\n}\n\n/**\n * Converts a String to a Uint8Array.\n * @param {String} str string that should be converted\n * @returns {Uint8Array}\n */\nfunction stringToUint8Array(str) {\n  var arr = new Uint8Array(str.length);\n  for (var i = 0, j = str.length; i < j; i++) {\n    arr[i] = str.charCodeAt(i);\n  }\n  return arr;\n}\n\n/**\n * Identifies the boundary in a multipart/related message header.\n * @param {String} header message header\n * @returns {String} boundary\n */\nfunction identifyBoundary(header) {\n  var parts = header.split('\\r\\n');\n  for (var i = 0; i < parts.length; i++) {\n    if (parts[i].substr(0, 2) === '--') {\n      return parts[i];\n    }\n  }\n  return null;\n}\n\n/**\n * Checks whether a given token is contained by a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be present\n * @param {Number} offset offset in message content from where search should start\n * @returns {Boolean} whether message contains token at offset\n */\nfunction containsToken(message, token) {\n  var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  if (offset + token.length > message.length) {\n    return false;\n  }\n  var index = offset;\n  for (var i = 0; i < token.length; i++) {\n    if (token[i] !== message[index]) {\n      return false;\n    }\n    index += 1;\n  }\n  return true;\n}\n\n/**\n * Finds a given token in a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be found\n * @param {String} offset message body offset from where search should start\n * @returns {Boolean} whether message has a part at given offset or not\n */\nfunction findToken(message, token) {\n  var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var maxSearchLength = arguments.length > 3 ? arguments[3] : undefined;\n  var searchLength = message.length;\n  if (maxSearchLength) {\n    searchLength = Math.min(offset + maxSearchLength, message.length);\n  }\n  for (var i = offset; i < searchLength; i++) {\n    // If the first value of the message matches\n    // the first value of the token, check if\n    // this is the full token.\n    if (message[i] === token[0]) {\n      if (containsToken(message, token, i)) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * Create a random GUID\n *\n * @return {string}\n */\nfunction guid() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n  }\n  return \"\".concat(s4() + s4(), \"-\").concat(s4(), \"-\").concat(s4(), \"-\").concat(s4(), \"-\").concat(s4()).concat(s4()).concat(s4());\n}\n\n/**\n * @typedef {Object} MultipartEncodedData\n * @property {ArrayBuffer} data The encoded Multipart Data\n * @property {String} boundary The boundary used to divide pieces of the encoded data\n */\n\n/**\n * Encode one or more DICOM datasets into a single body so it can be\n * sent using the Multipart Content-Type.\n *\n * @param {ArrayBuffer[]} datasets Array containing each file to be encoded in the\n                          multipart body, passed as ArrayBuffers.\n * @param {String} [boundary] Optional string to define a boundary between each part\n                              of the multipart body. If this is not specified, a random\n                              GUID will be generated.\n * @return {MultipartEncodedData} The Multipart encoded data returned as an Object. This\n                                  contains both the data itself, and the boundary string\n                                  used to divide it.\n */\nfunction multipartEncode(datasets) {\n  var boundary = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : guid();\n  var contentType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'application/dicom';\n  var contentTypeString = \"Content-Type: \".concat(contentType);\n  var header = \"\\r\\n--\".concat(boundary, \"\\r\\n\").concat(contentTypeString, \"\\r\\n\\r\\n\");\n  var footer = \"\\r\\n--\".concat(boundary, \"--\");\n  var headerArray = stringToUint8Array(header);\n  var footerArray = stringToUint8Array(footer);\n  var headerLength = headerArray.length;\n  var footerLength = footerArray.length;\n  var length = 0;\n\n  // Calculate the total length for the final array\n  var contentArrays = datasets.map(function (datasetBuffer) {\n    var contentArray = new Uint8Array(datasetBuffer);\n    var contentLength = contentArray.length;\n    length += headerLength + contentLength + footerLength;\n    return contentArray;\n  });\n\n  // Allocate the array\n  var multipartArray = new Uint8Array(length);\n\n  // Set the initial header\n  multipartArray.set(headerArray, 0);\n\n  // Write each dataset into the multipart array\n  var position = 0;\n  contentArrays.forEach(function (contentArray) {\n    multipartArray.set(headerArray, position);\n    multipartArray.set(contentArray, position + headerLength);\n    position += headerLength + contentArray.length;\n  });\n  multipartArray.set(footerArray, position);\n  return {\n    data: multipartArray.buffer,\n    boundary: boundary\n  };\n}\n\n/**\n * Decode a Multipart encoded ArrayBuffer and return the components as an Array.\n *\n * @param {ArrayBuffer} response Data encoded as a 'multipart/related' message\n * @returns {Array} The content\n */\nfunction multipartDecode(response) {\n  // Use the raw data if it is provided in an appropriate format\n  var message = ArrayBuffer.isView(response) ? response : new Uint8Array(response);\n\n  /* Set a maximum length to search for the header boundaries, otherwise\n       findToken can run for a long time\n    */\n  var maxSearchLength = 1000;\n\n  // First look for the multipart mime header\n  var separator = stringToUint8Array('\\r\\n\\r\\n');\n  var headerIndex = findToken(message, separator, 0, maxSearchLength);\n  if (headerIndex === -1) {\n    throw new Error('Response message has no multipart mime header');\n  }\n  var header = uint8ArrayToString(message, 0, headerIndex);\n  var boundaryString = identifyBoundary(header);\n  if (!boundaryString) {\n    throw new Error('Header of response message does not specify boundary');\n  }\n  var boundary = stringToUint8Array(boundaryString);\n  var boundaryLength = boundary.length;\n  var components = [];\n  var offset = boundaryLength;\n\n  // Loop until we cannot find any more boundaries\n  var boundaryIndex;\n  while (boundaryIndex !== -1) {\n    // Search for the next boundary in the message, starting\n    // from the current offset position\n    boundaryIndex = findToken(message, boundary, offset);\n\n    // If no further boundaries are found, stop here.\n    if (boundaryIndex === -1) {\n      break;\n    }\n    var headerTokenIndex = findToken(message, separator, offset, maxSearchLength);\n    if (headerTokenIndex === -1) {\n      throw new Error('Response message part has no mime header');\n    }\n    offset = headerTokenIndex + separator.length;\n\n    // Extract data from response message, excluding \"\\r\\n\"\n    var spacingLength = 2;\n    var data = response.slice(offset, boundaryIndex - spacingLength);\n\n    // Add the data to the array of results\n    components.push(data);\n\n    // Move the offset to the end of the current section,\n    // plus the identified boundary\n    offset = boundaryIndex + boundaryLength;\n  }\n  return components;\n}\n\nfunction isObject(obj) {\n  return _typeof(obj) === 'object' && obj !== null;\n}\nfunction isEmptyObject(obj) {\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\nfunction areValidRequestHooks(requestHooks) {\n  var isValid = Array.isArray(requestHooks) && requestHooks.every(function (requestHook) {\n    return typeof requestHook === 'function' && requestHook.length === 2;\n  });\n  if (!isValid) {\n    console.warn('Request hooks should have the following signature: ' + 'function requestHook(request, metadata) { return request; }');\n  }\n  return isValid;\n}\nvar getFirstResult = function getFirstResult(result) {\n  return result[0];\n};\nvar MEDIATYPES = {\n  DICOM: 'application/dicom',\n  DICOM_JSON: 'application/dicom+json',\n  OCTET_STREAM: 'application/octet-stream',\n  PDF: 'application/pdf',\n  JPEG: 'image/jpeg',\n  PNG: 'image/png'\n};\n\n/**\n * debugLog is a function that can be called with console.log arguments, and will\n * be conditionally displayed, only when debug logging is enabled.\n */\nvar debugLog = function debugLog() {};\n\n/**\n * @typedef { import(\"../types/types\").InstanceMetadata } InstanceMetadata\n */\n\n/**\n * A callback with the request instance and metadata information\n * of the currently request being executed that should necessarily\n * return the given request optionally modified.\n * @typedef {function} RequestHook\n * @param {XMLHttpRequest} request - The original XMLHttpRequest instance.\n * @param {object} metadata - The metadata used by the request.\n */\n\n/**\n * Class for interacting with DICOMweb RESTful services.\n */\nvar DICOMwebClient = /*#__PURE__*/function () {\n  /**\n   * @constructor\n   * @param {Object} options\n   * @param {String} options.url - URL of the DICOMweb RESTful Service endpoint\n   * @param {String=} options.qidoURLPrefix - URL path prefix for QIDO-RS\n   * @param {String=} options.wadoURLPrefix - URL path prefix for WADO-RS\n   * @param {String=} options.stowURLPrefix - URL path prefix for STOW-RS\n   * @param {String=} options.username - Username\n   * @param {String=} options.password - Password\n   * @param {Object=} options.headers - HTTP headers\n   * @param {Array.<RequestHook>=} options.requestHooks - Request hooks.\n   * @param {Object=} options.verbose - print to console request warnings and errors, default true\n   * @param {Object=} options.debug - print to the console debug level information/status updates.\n   * @param {boolean|String} options.singlepart - retrieve singlepart for the named types.\n   * The available types are:  bulkdata, video, image.  true means all.\n   */\n  function DICOMwebClient(options) {\n    _classCallCheck(this, DICOMwebClient);\n    this.baseURL = options.url;\n    if (!this.baseURL) {\n      console.error('no DICOMweb base url provided - calls that require a URL will fail');\n    }\n    if ('username' in options) {\n      this.username = options.username;\n      if (!('password' in options)) {\n        console.error('no password provided to authenticate with DICOMweb service');\n      }\n      this.password = options.password;\n    }\n    if ('qidoURLPrefix' in options) {\n      debugLog(\"use URL prefix for QIDO-RS: \".concat(options.qidoURLPrefix));\n      this.qidoURL = \"\".concat(this.baseURL, \"/\").concat(options.qidoURLPrefix);\n    } else {\n      this.qidoURL = this.baseURL;\n    }\n    if ('wadoURLPrefix' in options) {\n      debugLog(\"use URL prefix for WADO-RS: \".concat(options.wadoURLPrefix));\n      this.wadoURL = \"\".concat(this.baseURL, \"/\").concat(options.wadoURLPrefix);\n    } else {\n      this.wadoURL = this.baseURL;\n    }\n    if ('stowURLPrefix' in options) {\n      debugLog(\"use URL prefix for STOW-RS: \".concat(options.stowURLPrefix));\n      this.stowURL = \"\".concat(this.baseURL, \"/\").concat(options.stowURLPrefix);\n    } else {\n      this.stowURL = this.baseURL;\n    }\n    if (options.singlepart) {\n      debugLog('use singlepart', options.singlepart);\n      this.singlepart = options.singlepart === true ? 'bulkdata,video,image' : options.singlepart;\n    } else {\n      this.singlepart = '';\n    }\n    if ('requestHooks' in options) {\n      this.requestHooks = options.requestHooks;\n    }\n\n    // Headers to pass to requests.\n    this.headers = options.headers || {};\n\n    // Optional error interceptor callback to handle any failed request.\n    this.errorInterceptor = options.errorInterceptor || function () {\n      return undefined;\n    };\n\n    // Verbose - print to console request warnings and errors, default true\n    this.verbose = options.verbose !== false;\n    this.setDebug(options.debug);\n  }\n\n  /**\n   * Allows setting the debug log information. \n   * Note this is different from verbose in that verbose is whether to include warning/error information, defaulting to true\n   * \n   * @param {boolean} debugLevel \n   * @param {function} debugLogFunction to call with the debug output arguments. \n   */\n  _createClass(DICOMwebClient, [{\n    key: \"setDebug\",\n    value: function setDebug() {\n      var debugLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var debugLogFunction = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      this.debugLevel = !!debugLevel;\n      debugLog = debugLogFunction || debugLevel ? console.log : function () {};\n    }\n    /**\n     * Gets debug flag\n     * \n     * @returns true if debug logging is enabled\n     */\n  }, {\n    key: \"getDebug\",\n    value: function getDebug() {\n      return this.debugLevel;\n    }\n    /**\n     * Sets verbose flag.\n     *\n     * @param {Boolean} verbose\n     */\n  }, {\n    key: \"setVerbose\",\n    value: function setVerbose(verbose) {\n      this.verbose = verbose;\n    }\n    /**\n     * Gets verbose flag.\n     *\n     * @return {Boolean} verbose\n     */\n  }, {\n    key: \"getVerbose\",\n    value: function getVerbose() {\n      return this.verbose;\n    }\n  }, {\n    key: \"_httpRequest\",\n    /**\n     * Performs an HTTP request.\n     *\n     * @param {String} url\n     * @param {String} method\n     * @param {Object} headers\n     * @param {Object} options\n     * @param {Array.<RequestHook>} options.requestHooks - Request hooks.\n     * @param {XMLHttpRequest} [options.request] - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @return {*}\n     * @private\n     */\n    value: function _httpRequest(url, method) {\n      var _this = this;\n      var headers = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var errorInterceptor = this.errorInterceptor,\n        requestHooks = this.requestHooks;\n      return new Promise(function (resolve, reject) {\n        var request = options.request ? options.request : new XMLHttpRequest();\n        request.open(method, url, true);\n        if ('responseType' in options) {\n          request.responseType = options.responseType;\n        }\n        if (_typeof(headers) === 'object') {\n          Object.keys(headers).forEach(function (key) {\n            request.setRequestHeader(key, headers[key]);\n          });\n        }\n\n        // now add custom headers from the user\n        // (e.g. access tokens)\n        var userHeaders = _this.headers;\n        Object.keys(userHeaders).forEach(function (key) {\n          request.setRequestHeader(key, userHeaders[key]);\n        });\n\n        // Event triggered when upload starts\n        request.onloadstart = function onloadstart() {\n          debugLog('upload started: ', url);\n        };\n\n        // Event triggered when upload ends\n        request.onloadend = function onloadend() {\n          debugLog('upload finished');\n        };\n\n        // Handle response message\n        request.onreadystatechange = function () {\n          if (request.readyState === 4) {\n            if (request.status === 200) {\n              var contentType = request.getResponseHeader('Content-Type');\n              // Automatically distinguishes between multipart and singlepart in an array buffer, and\n              // converts them into a consistent type.\n              if (contentType && contentType.indexOf('multipart') !== -1) {\n                resolve(multipartDecode(request.response));\n              } else if (request.responseType === 'arraybuffer') {\n                resolve([request.response]);\n              } else {\n                resolve(request.response);\n              }\n            } else if (request.status === 202) {\n              if (_this.verbose) {\n                console.warn('some resources already existed: ', request);\n              }\n              resolve(request.response);\n            } else if (request.status === 204) {\n              if (_this.verbose) {\n                console.warn('empty response for request: ', request);\n              }\n              resolve([]);\n            } else {\n              var error = new Error('request failed');\n              error.request = request;\n              error.response = request.response;\n              error.status = request.status;\n              if (_this.verbose) {\n                console.error('request failed: ', request);\n                console.error(error);\n                console.error(error.response);\n              }\n              errorInterceptor(error);\n              reject(error);\n            }\n          }\n        };\n\n        // Event triggered while download progresses\n        if ('progressCallback' in options) {\n          if (typeof options.progressCallback === 'function') {\n            request.onprogress = options.progressCallback;\n          }\n        }\n        if (requestHooks && areValidRequestHooks(requestHooks)) {\n          var combinedHeaders = Object.assign({}, headers, _this.headers);\n          var metadata = {\n            method: method,\n            url: url,\n            headers: combinedHeaders\n          };\n          var pipeRequestHooks = function pipeRequestHooks(functions) {\n            return function (args) {\n              return functions.reduce(function (props, fn) {\n                return fn(props, metadata);\n              }, args);\n            };\n          };\n          var pipedRequest = pipeRequestHooks(requestHooks);\n          request = pipedRequest(request);\n        }\n\n        // Add withCredentials to request if needed\n        if ('withCredentials' in options) {\n          if (options.withCredentials) {\n            request.withCredentials = true;\n          }\n        }\n        if ('data' in options) {\n          request.send(options.data);\n        } else {\n          request.send();\n        }\n      });\n    }\n    /**\n     * Performs an HTTP GET request.\n     *\n     * @param {String} url\n     * @param {Object} headers\n     * @param {Object} responseType\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGet\",\n    value: function _httpGet(url, headers, responseType, progressCallback, withCredentials) {\n      return this._httpRequest(url, 'get', headers, {\n        responseType: responseType,\n        progressCallback: progressCallback,\n        withCredentials: withCredentials\n      });\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with application/json\n     * media type.\n     *\n     * @param {String} url\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetApplicationJson\",\n    value: function _httpGetApplicationJson(url) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var progressCallback = arguments.length > 2 ? arguments[2] : undefined;\n      var withCredentials = arguments.length > 3 ? arguments[3] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var headers = {\n        Accept: MEDIATYPES.DICOM_JSON\n      };\n      var responseType = 'json';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with application/pdf\n     * media type.\n     *\n     * @param {String} url\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetApplicationPdf\",\n    value: function _httpGetApplicationPdf(url) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var progressCallback = arguments.length > 2 ? arguments[2] : undefined;\n      var withCredentials = arguments.length > 3 ? arguments[3] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var headers = {\n        Accept: MEDIATYPES.PDF\n      };\n      var responseType = 'json';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with an image\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetImage\",\n    value: function _httpGetImage(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['image/', 'image/*', 'image/jpeg', 'image/jp2', 'image/gif', 'image/png'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with a text\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetText\",\n    value: function _httpGetText(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['text/', 'text/*', 'text/html', 'text/plain', 'text/rtf', 'text/xml'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with a video\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetVideo\",\n    value: function _httpGetVideo(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['video/', 'video/*', 'video/mpeg', 'video/mp4', 'video/H265'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Asserts that a given media type is valid.\n     *\n     * @params {String} mediaType media type\n     */\n  }, {\n    key: \"_httpGetMultipartImage\",\n    /**\n     * Performs an HTTP GET request that accepts a multipart message with an image media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange - Start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n    value: function _httpGetMultipartImage(url, mediaTypes, byteRange, params) {\n      var rendered = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var progressCallback = arguments.length > 5 ? arguments[5] : undefined;\n      var withCredentials = arguments.length > 6 ? arguments[6] : undefined;\n      var headers = {};\n      var supportedMediaTypes;\n      if (rendered) {\n        supportedMediaTypes = ['image/jpeg', 'image/gif', 'image/png', 'image/jp2'];\n      } else {\n        supportedMediaTypes = {\n          '1.2.840.10008.1.2.5': ['image/x-dicom-rle'],\n          '1.2.840.10008.1.2.4.50': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.51': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.57': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.70': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.80': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.81': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.90': ['image/jp2'],\n          '1.2.840.10008.1.2.4.91': ['image/jp2'],\n          '1.2.840.10008.1.2.4.92': ['image/jpx'],\n          '1.2.840.10008.1.2.4.93': ['image/jpx']\n        };\n        if (byteRange) {\n          headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n        }\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message with a video media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange - Start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartVideo\",\n    value: function _httpGetMultipartVideo(url, mediaTypes, byteRange, params) {\n      var rendered = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var progressCallback = arguments.length > 5 ? arguments[5] : undefined;\n      var withCredentials = arguments.length > 6 ? arguments[6] : undefined;\n      var headers = {};\n      var supportedMediaTypes;\n      if (rendered) {\n        supportedMediaTypes = ['video/', 'video/*', 'video/mpeg2', 'video/mp4', 'video/H265'];\n      } else {\n        supportedMediaTypes = {\n          '1.2.840.10008.1.2.4.100': ['video/mpeg2'],\n          '1.2.840.10008.1.2.4.101': ['video/mpeg2'],\n          '1.2.840.10008.1.2.4.102': ['video/mp4'],\n          '1.2.840.10008.1.2.4.103': ['video/mp4'],\n          '1.2.840.10008.1.2.4.104': ['video/mp4'],\n          '1.2.840.10008.1.2.4.105': ['video/mp4'],\n          '1.2.840.10008.1.2.4.106': ['video/mp4']\n        };\n        if (byteRange) {\n          headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n        }\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message\n     * with a application/dicom media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartApplicationDicom\",\n    value: function _httpGetMultipartApplicationDicom(url, mediaTypes, params, progressCallback, withCredentials) {\n      var headers = {};\n      var defaultMediaType = 'application/dicom';\n      var supportedMediaTypes = {\n        '1.2.840.10008.1.2.1': [defaultMediaType],\n        '1.2.840.10008.1.2.5': [defaultMediaType],\n        '1.2.840.10008.1.2.4.50': [defaultMediaType],\n        '1.2.840.10008.1.2.4.51': [defaultMediaType],\n        '1.2.840.10008.1.2.4.57': [defaultMediaType],\n        '1.2.840.10008.1.2.4.70': [defaultMediaType],\n        '1.2.840.10008.1.2.4.80': [defaultMediaType],\n        '1.2.840.10008.1.2.4.81': [defaultMediaType],\n        '1.2.840.10008.1.2.4.90': [defaultMediaType],\n        '1.2.840.10008.1.2.4.91': [defaultMediaType],\n        '1.2.840.10008.1.2.4.92': [defaultMediaType],\n        '1.2.840.10008.1.2.4.93': [defaultMediaType],\n        '1.2.840.10008.1.2.4.100': [defaultMediaType],\n        '1.2.840.10008.1.2.4.101': [defaultMediaType],\n        '1.2.840.10008.1.2.4.102': [defaultMediaType],\n        '1.2.840.10008.1.2.4.103': [defaultMediaType],\n        '1.2.840.10008.1.2.4.104': [defaultMediaType],\n        '1.2.840.10008.1.2.4.105': [defaultMediaType],\n        '1.2.840.10008.1.2.4.106': [defaultMediaType]\n      };\n      var acceptableMediaTypes = mediaTypes;\n      if (!mediaTypes) {\n        acceptableMediaTypes = [{\n          mediaType: defaultMediaType\n        }];\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(acceptableMediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message\n     * with a application/octet-stream, OR any of the equivalencies for that (eg\n     * application/pdf etc)\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartApplicationOctetStream\",\n    value: function _httpGetMultipartApplicationOctetStream(url, mediaTypes, byteRange, params, progressCallback, withCredentials) {\n      var headers = {};\n      var defaultMediaType = 'application/octet-stream';\n      var supportedMediaTypes = {\n        '1.2.840.10008.1.2.1': _toConsumableArray(Object.values(MEDIATYPES))\n      };\n      var acceptableMediaTypes = mediaTypes;\n      if (!mediaTypes) {\n        acceptableMediaTypes = [{\n          mediaType: defaultMediaType\n        }];\n      }\n      if (byteRange) {\n        headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(acceptableMediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP POST request.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object} headers - HTTP header fields\n     * @param {Array} data - Data that should be stored\n     * @param {Function} progressCallback\n     * @param {Function} progressCallback\n     * @param {XMLHttpRequest} request - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @private\n     * @returns {Promise} Response\n     */\n  }, {\n    key: \"_httpPost\",\n    value: function _httpPost(url, headers, data, progressCallback, withCredentials, request) {\n      return this._httpRequest(url, 'post', headers, {\n        data: data,\n        progressCallback: progressCallback,\n        withCredentials: withCredentials,\n        request: request\n      });\n    }\n    /**\n     * Performs an HTTP POST request with content-type application/dicom+json.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object} headers - HTTP header fields\n     * @param {Array} data - Data that should be stored\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise} Response\n     */\n  }, {\n    key: \"_httpPostApplicationJson\",\n    value: function _httpPostApplicationJson(url, data, progressCallback, withCredentials) {\n      var headers = {\n        'Content-Type': MEDIATYPES.DICOM_JSON\n      };\n      return this._httpPost(url, headers, data, progressCallback, withCredentials);\n    }\n    /**\n     * Parses media type and extracts its type and subtype.\n     *\n     * @param {String} mediaType - HTTP media type (e.g. image/jpeg)\n     * @private\n     * @returns {String[]} Media type and subtype\n     */\n  }, {\n    key: \"searchForStudies\",\n    /**\n     * Searches for DICOM studies.\n     *\n     * @param {Object} options\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @return {Object[]} Study representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2)\n     */\n    value: function searchForStudies() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      debugLog('search for studies');\n      var withCredentials = false;\n      var url = \"\".concat(this.qidoURL, \"/studies\");\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves metadata for a DICOM study.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @returns {Promise<InstanceMetadata[]>} Metadata elements in DICOM JSON format for each instance\n                        belonging to the study\n     */\n  }, {\n    key: \"retrieveStudyMetadata\",\n    value: function retrieveStudyMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of study metadata');\n      }\n      debugLog(\"retrieve metadata of study \".concat(options.studyInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Searches for DICOM series.\n     *\n     * @param {Object} options\n     * @param {Object} [options.studyInstanceUID] - Study Instance UID\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Object[]} Series representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2a)\n     */\n  }, {\n    key: \"searchForSeries\",\n    value: function searchForSeries() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var url = this.qidoURL;\n      if ('studyInstanceUID' in options) {\n        debugLog(\"search series of study \".concat(options.studyInstanceUID));\n        url += \"/studies/\".concat(options.studyInstanceUID);\n      }\n      url += '/series';\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves metadata for a DICOM series.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @returns {Promise<InstanceMetadata[]>} Metadata elements in DICOM JSON format for each instance\n                        belonging to the series\n     */\n  }, {\n    key: \"retrieveSeriesMetadata\",\n    value: function retrieveSeriesMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of series metadata');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of series metadata');\n      }\n      debugLog(\"retrieve metadata of series \".concat(options.seriesInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Searches for DICOM Instances.\n     *\n     * @param {Object} options\n     * @param {String} [options.studyInstanceUID] - Study Instance UID\n     * @param {String} [options.seriesInstanceUID] - Series Instance UID\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Object[]} Instance representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2b)\n     */\n  }, {\n    key: \"searchForInstances\",\n    value: function searchForInstances() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var url = this.qidoURL;\n      var withCredentials = false;\n      if ('studyInstanceUID' in options) {\n        url += \"/studies/\".concat(options.studyInstanceUID);\n        if ('seriesInstanceUID' in options) {\n          debugLog(\"search for instances of series \".concat(options.seriesInstanceUID));\n          url += \"/series/\".concat(options.seriesInstanceUID);\n        } else {\n          debugLog(\"search for instances of study \".concat(options.studyInstanceUID));\n        }\n      } else {\n        debugLog('search for instances');\n      }\n      url += '/instances';\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /** Returns a WADO-URI URL for an instance\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {String} WADO-URI URL\n     */\n  }, {\n    key: \"buildInstanceWadoURIUrl\",\n    value: function buildInstanceWadoURIUrl(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required.');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required.');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required.');\n      }\n      var contentType = options.contentType || MEDIATYPES.DICOM;\n      var transferSyntax = options.transferSyntax || '*';\n      var params = [];\n      params.push('requestType=WADO');\n      params.push(\"studyUID=\".concat(options.studyInstanceUID));\n      params.push(\"seriesUID=\".concat(options.seriesInstanceUID));\n      params.push(\"objectUID=\".concat(options.sopInstanceUID));\n      params.push(\"contentType=\".concat(contentType));\n      params.push(\"transferSyntax=\".concat(transferSyntax));\n      var paramString = params.join('&');\n      return \"\".concat(this.wadoURL, \"?\").concat(paramString);\n    }\n    /**\n     * Retrieves metadata for a DICOM Instance.\n     *\n     * @param {Object} options object\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {Promise<InstanceMetadata>} metadata elements in DICOM JSON format\n     */\n  }, {\n    key: \"retrieveInstanceMetadata\",\n    value: function retrieveInstanceMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of instance metadata');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of instance metadata');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of instance metadata');\n      }\n      debugLog(\"retrieve metadata of instance \".concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves frames for a DICOM Instance.\n     * @param {Object} options options object\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @returns {Array} frame items as byte arrays of the pixel data element\n     */\n  }, {\n    key: \"retrieveInstanceFrames\",\n    value: function retrieveInstanceFrames(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of instance frames');\n      }\n      debugLog(\"retrieve frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString());\n      var mediaTypes = options.mediaTypes;\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationOctetStream(url, false, false, false, progressCallback, withCredentials);\n      }\n      var sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n      if (sharedMediaTypes.length > 1) {\n        /**\n         * Enable request of frames that are stored either compressed\n         * (image/* media type) or uncompressed (application/octet-stream\n         * media type).\n         */\n        var supportedMediaTypes = {\n          '1.2.840.10008.1.2.1': ['application/octet-stream'],\n          '1.2.840.10008.1.2.5': ['image/x-dicom-rle'],\n          '1.2.840.10008.1.2.4.50': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.51': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.57': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.70': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.80': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.81': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.90': ['image/jp2'],\n          '1.2.840.10008.1.2.4.91': ['image/jp2'],\n          '1.2.840.10008.1.2.4.92': ['image/jpx'],\n          '1.2.840.10008.1.2.4.93': ['image/jpx'],\n          '1.2.840.10008.1.2.4.201': ['image/jhc'],\n          '1.2.840.10008.1.2.4.202': ['image/jhc']\n        };\n        var headers = {\n          Accept: DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes)\n        };\n        return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('application')) {\n        return this._httpGetMultipartApplicationOctetStream(url, mediaTypes, false, false, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetMultipartImage(url, mediaTypes, false, false, false, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetMultipartVideo(url, mediaTypes, false, false, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of frames.\"));\n    }\n    /**\n    * Element in mediaTypes parameter\n    * @typedef {Object} MediaType\n    * @param {String} [MediaType.mediaType] - ie 'image/jpeg', 'image/png'...\n    */\n    /**\n     * Retrieves an individual, server-side rendered DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Promise<ArrayBuffer>} Rendered DICOM Instance\n     */\n  }, {\n    key: \"retrieveInstanceRendered\",\n    value: function retrieveInstanceRendered(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/rendered\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetVideo(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('text')) {\n        return this._httpGetText(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType === MEDIATYPES.PDF) {\n        return this._httpGetApplicationPdf(url, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered instance.');\n    }\n    /**\n     * Retrieves a thumbnail of an DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer} Thumbnail\n     */\n  }, {\n    key: \"retrieveInstanceThumbnail\",\n    value: function retrieveInstanceThumbnail(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/thumbnail\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered instance.');\n    }\n    /**\n     * Retrieves rendered frames for a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n     */\n  }, {\n    key: \"retrieveInstanceFramesRendered\",\n    value: function retrieveInstanceFramesRendered(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of rendered instance frames');\n      }\n      debugLog(\"retrieve rendered frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString(), \"/rendered\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, false, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetVideo(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered frame.');\n    }\n    /**\n     * Retrieves thumbnail of frames for a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n     */\n  }, {\n    key: \"retrieveInstanceFramesThumbnail\",\n    value: function retrieveInstanceFramesThumbnail(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of rendered instance frames');\n      }\n      console.debug(\"retrieve rendered frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString(), \"/thumbnail\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered frame.');\n    }\n    /**\n     * Retrieves a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {Promise<ArrayBuffer>} DICOM Part 10 file as Arraybuffer\n     */\n  }, {\n    key: \"retrieveInstance\",\n    value: function retrieveInstance(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var _options$withCredenti = options.withCredentials,\n        withCredentials = _options$withCredenti === void 0 ? false : _options$withCredenti;\n      var _options$progressCall = options.progressCallback,\n        progressCallback = _options$progressCall === void 0 ? false : _options$progressCall;\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials).then(getFirstResult);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials).then(getFirstResult);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of instance.\"));\n    }\n    /**\n     * Retrieves all DICOM Instances of a Series.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {Function} options.progressCallback\n     * @returns {Promise<ArrayBuffer[]>} DICOM Instances\n     */\n  }, {\n    key: \"retrieveSeries\",\n    value: function retrieveSeries(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of series.\"));\n    }\n    /**\n     * Retrieves all DICOM Instances of a Study.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @returns {ArrayBuffer[]} DICOM Instances\n     */\n  }, {\n    key: \"retrieveStudy\",\n    value: function retrieveStudy(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var _options$withCredenti2 = options.withCredentials,\n        withCredentials = _options$withCredenti2 === void 0 ? false : _options$withCredenti2;\n      var _options$progressCall2 = options.progressCallback,\n        progressCallback = _options$progressCall2 === void 0 ? false : _options$progressCall2;\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of study.\"));\n    }\n    /**\n     * Retrieves and parses BulkData from a BulkDataURI location.\n     * Decodes the multipart encoded data and returns the resulting data\n     * as an ArrayBuffer.\n     *\n     * See http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.5.5.html\n     *\n     * @param {Object} options\n     * @param {string} options.BulkDataURI to retrieve\n     * @param {Array}  options.mediaTypes to use to fetch the URI\n     * @param {string} options.byteRange to request a sub-range (only valid on single part)\n     * @returns {Promise<Array>} Bulkdata parts\n     */\n  }, {\n    key: \"retrieveBulkData\",\n    value: function retrieveBulkData(options) {\n      if (!('BulkDataURI' in options)) {\n        throw new Error('BulkDataURI is required.');\n      }\n      var url = options.BulkDataURI;\n      var mediaTypes = options.mediaTypes,\n        byteRange = options.byteRange;\n      var _options$withCredenti3 = options.withCredentials,\n        withCredentials = _options$withCredenti3 === void 0 ? false : _options$withCredenti3;\n      var _options$progressCall3 = options.progressCallback,\n        progressCallback = _options$progressCall3 === void 0 ? false : _options$progressCall3;\n      if (this.singlepart.indexOf('bulkdata') !== -1) {\n        return this._httpGet(url, options.headers, 'arraybuffer', null, withCredentials);\n      }\n      if (mediaTypes) {\n        try {\n          var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n          if (commonMediaType === 'image/') {\n            return this._httpGetMultipartImage(url, mediaTypes, byteRange, false, false, progressCallback, withCredentials);\n          }\n        } catch (e) {\n          // No-op - this happens sometimes if trying to fetch the specific desired type but want to fallback to octet-stream\n        }\n      }\n\n      // Just use the media types provided\n      return this._httpGetMultipartApplicationOctetStream(url, mediaTypes, byteRange, false, progressCallback, withCredentials);\n    }\n    /**\n     * Stores DICOM Instances.\n     *\n     * @param {Object} options\n     * @param {ArrayBuffer[]} options.datasets - DICOM Instances in PS3.10 format\n     * @param {String} [options.studyInstanceUID] - Study Instance UID\n     * @param {XMLHttpRequest} [options.request] - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @returns {Promise} Response message\n     */\n  }, {\n    key: \"storeInstances\",\n    value: function storeInstances(options) {\n      if (!('datasets' in options)) {\n        throw new Error('datasets are required for storing');\n      }\n      var url = \"\".concat(this.stowURL, \"/studies\");\n      if ('studyInstanceUID' in options) {\n        url += \"/\".concat(options.studyInstanceUID);\n      }\n      var _multipartEncode = multipartEncode(options.datasets),\n        data = _multipartEncode.data,\n        boundary = _multipartEncode.boundary;\n      var headers = {\n        'Content-Type': \"multipart/related; type=\\\"application/dicom\\\"; boundary=\\\"\".concat(boundary, \"\\\"\")\n      };\n      var _options$withCredenti4 = options.withCredentials,\n        withCredentials = _options$withCredenti4 === void 0 ? false : _options$withCredenti4;\n      return this._httpPost(url, headers, data, options.progressCallback, withCredentials, options.request);\n    }\n  }], [{\n    key: \"_parseQueryParameters\",\n    value: function _parseQueryParameters() {\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var queryString = '?';\n      Object.keys(params).forEach(function (key, index) {\n        if (index !== 0) {\n          queryString += '&';\n        }\n        queryString += \"\".concat(key, \"=\").concat(encodeURIComponent(params[key]));\n      });\n      return queryString;\n    }\n  }, {\n    key: \"_assertMediaTypeIsValid\",\n    value: function _assertMediaTypeIsValid(mediaType) {\n      if (!mediaType) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      var sepIndex = mediaType.indexOf('/');\n      if (sepIndex === -1) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      var mediaTypeType = mediaType.slice(0, sepIndex);\n      var types = ['application', 'image', 'text', 'video'];\n      if (!types.includes(mediaTypeType)) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      if (mediaType.slice(sepIndex + 1).includes('/')) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n    }\n  }, {\n    key: \"_parseMediaType\",\n    value: function _parseMediaType(mediaType) {\n      DICOMwebClient._assertMediaTypeIsValid(mediaType);\n      return mediaType.split('/');\n    }\n    /**\n     * Builds an accept header field value for HTTP GET request messages.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types\n     * @param {Object[]} supportedMediaTypes - Supported media types\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_buildAcceptHeaderFieldValue\",\n    value: function _buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes) {\n      if (!Array.isArray(mediaTypes)) {\n        throw new Error('Acceptable media types must be provided as an Array');\n      }\n      var fieldValueParts = mediaTypes.map(function (item) {\n        var mediaType = item.mediaType;\n        DICOMwebClient._assertMediaTypeIsValid(mediaType);\n        if (!supportedMediaTypes.includes(mediaType)) {\n          throw new Error(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n        }\n        return mediaType;\n      });\n      return fieldValueParts.join(', ');\n    }\n    /**\n     * Builds an accept header field value for HTTP GET multipart request\n     * messages.  Will throw an exception if no media types are found which are acceptable,\n     * but will only log a verbose level message when types are specified which are\n     * not acceptable.  This allows requesting several types with having to know\n     * whether they are all acceptable or not.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types\n     * @param {Object[]} supportedMediaTypes - Supported media types\n     * @private\n     */\n  }, {\n    key: \"_buildMultipartAcceptHeaderFieldValue\",\n    value: function _buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes) {\n      var _this2 = this;\n      if (!Array.isArray(mediaTypes)) {\n        throw new Error('Acceptable media types must be provided as an Array');\n      }\n      if (!Array.isArray(supportedMediaTypes) && !isObject(supportedMediaTypes)) {\n        throw new Error('Supported media types must be provided as an Array or an Object');\n      }\n      var fieldValueParts = [];\n      mediaTypes.forEach(function (item) {\n        var transferSyntaxUID = item.transferSyntaxUID,\n          mediaType = item.mediaType;\n        DICOMwebClient._assertMediaTypeIsValid(mediaType);\n        var fieldValue = \"multipart/related; type=\\\"\".concat(mediaType, \"\\\"\");\n        if (isObject(supportedMediaTypes)) {\n          // SupportedMediaTypes is a lookup table that maps Transfer Syntax UID\n          // to one or more Media Types\n          if (!Object.values(supportedMediaTypes).flat(1).includes(mediaType)) {\n            if (!mediaType.endsWith('/*') || !mediaType.endsWith('/')) {\n              debugLog(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n              return;\n            }\n          }\n          if (transferSyntaxUID) {\n            if (transferSyntaxUID !== '*') {\n              if (!Object.keys(supportedMediaTypes).includes(transferSyntaxUID)) {\n                throw new Error(\"Transfer syntax \".concat(transferSyntaxUID, \" is not supported for requested resource\"));\n              }\n              var expectedMediaTypes = supportedMediaTypes[transferSyntaxUID];\n              if (!expectedMediaTypes.includes(mediaType)) {\n                var actualType = DICOMwebClient._parseMediaType(mediaType)[0];\n                expectedMediaTypes.map(function (expectedMediaType) {\n                  var expectedType = DICOMwebClient._parseMediaType(expectedMediaType)[0];\n                  var haveSameType = actualType === expectedType;\n                  if (haveSameType && (mediaType.endsWith('/*') || mediaType.endsWith('/'))) {\n                    return;\n                  }\n                  throw new Error(\"Transfer syntax \".concat(transferSyntaxUID, \" is not supported for requested resource\"));\n                });\n              }\n            }\n            fieldValue += \"; transfer-syntax=\".concat(transferSyntaxUID);\n          }\n        } else if (Array.isArray(supportedMediaTypes) && !supportedMediaTypes.includes(mediaType)) {\n          if (_this2.verbose) {\n            console.warn(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n          }\n          return;\n        }\n        fieldValueParts.push(fieldValue);\n      });\n      if (!fieldValueParts.length) {\n        throw new Error(\"No acceptable media types found among \".concat(JSON.stringify(mediaTypes)));\n      }\n      return fieldValueParts.join(', ');\n    }\n    /**\n     * Builds a range header field value for HTTP GET request messages.\n     *\n     * @param {Array} byteRange - Start and end of byte range\n     * @returns {String} Range header field value\n     * @private\n     */\n  }, {\n    key: \"_buildRangeHeaderFieldValue\",\n    value: function _buildRangeHeaderFieldValue() {\n      var byteRange = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      if (byteRange.length === 1) {\n        return \"bytes=\".concat(byteRange[0], \"-\");\n      }\n      if (byteRange.length === 2) {\n        return \"bytes=\".concat(byteRange[0], \"-\").concat(byteRange[1]);\n      }\n      return 'bytes=0-';\n    }\n    /**\n     * Gets types that are shared among acceptable media types.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @private\n     * @returns {String[]} Types that are shared among acceptable media types\n     */\n  }, {\n    key: \"_getSharedMediaTypes\",\n    value: function _getSharedMediaTypes(mediaTypes) {\n      var types = new Set();\n      if (!mediaTypes || !mediaTypes.length) {\n        return types;\n      }\n      mediaTypes.forEach(function (item) {\n        var mediaType = item.mediaType;\n        var type = DICOMwebClient._parseMediaType(mediaType)[0];\n        types.add(\"\".concat(type, \"/\"));\n      });\n      return Array.from(types);\n    }\n    /**\n     * Gets common base type of acceptable media types and asserts that only\n     one type is specified. For example, ``(\"image/jpeg\", \"image/jp2\")``\n     will pass, but ``(\"image/jpeg\", \"video/mpeg2\")`` will raise an\n     exception.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @private\n     * @returns {String[]} Common media type, eg `image/` for the above example.\n     */\n  }, {\n    key: \"_getCommonMediaType\",\n    value: function _getCommonMediaType(mediaTypes) {\n      if (!mediaTypes || !mediaTypes.length) {\n        throw new Error('No acceptable media types provided');\n      }\n      var sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n      if (sharedMediaTypes.length === 0) {\n        throw new Error('No common acceptable media type could be identified.');\n      } else if (sharedMediaTypes.length > 1) {\n        throw new Error('Acceptable media types must have the same type.');\n      }\n      return sharedMediaTypes[0];\n    }\n  }]);\n  return DICOMwebClient;\n}();\n\nfunction findSubstring(str, before, after) {\n  var beforeIndex = str.lastIndexOf(before) + before.length;\n  if (beforeIndex < before.length) {\n    return null;\n  }\n  if (after !== undefined) {\n    var afterIndex = str.lastIndexOf(after);\n    if (afterIndex < 0) {\n      return null;\n    }\n    return str.substring(beforeIndex, afterIndex);\n  }\n  return str.substring(beforeIndex);\n}\nfunction getStudyInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, 'studies/', '/series');\n  if (!uid) {\n    uid = findSubstring(uri, 'studies/');\n  }\n  if (!uid) {\n    console.debug(\"Study Instance UID could not be dertermined from URI \\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getSeriesInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, 'series/', '/instances');\n  if (!uid) {\n    uid = findSubstring(uri, 'series/');\n  }\n  if (!uid) {\n    console.debug(\"Series Instance UID could not be dertermined from URI \\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getSOPInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, '/instances/', '/frames');\n  if (!uid) {\n    uid = findSubstring(uri, '/instances/', '/metadata');\n  }\n  if (!uid) {\n    uid = findSubstring(uri, '/instances/');\n  }\n  if (!uid) {\n    console.debug(\"SOP Instance UID could not be dertermined from URI\\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getFrameNumbersFromUri(uri) {\n  var numbers = findSubstring(uri, '/frames/', '/rendered');\n  if (!numbers) {\n    numbers = findSubstring(uri, '/frames/');\n  }\n  if (numbers === undefined) {\n    console.debug(\"Frame Numbers could not be dertermined from URI\\\"\".concat(uri, \"\\\"\"));\n  }\n  return numbers.split(',');\n}\n\nvar version = '0.5.2';\n\nvar api = {\n  DICOMwebClient: DICOMwebClient\n};\nvar utils = {\n  getStudyInstanceUIDFromUri: getStudyInstanceUIDFromUri,\n  getSeriesInstanceUIDFromUri: getSeriesInstanceUIDFromUri,\n  getSOPInstanceUIDFromUri: getSOPInstanceUIDFromUri,\n  getFrameNumbersFromUri: getFrameNumbersFromUri\n};\n\nexport { api, utils, version };\n//# sourceMappingURL=dicomweb-client.es.js.map\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    symbolTag = '[object Symbol]';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/,\n    reLeadingDot = /^\\./,\n    rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    splice = arrayProto.splice;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value) {\n  return isArray(value) ? value : stringToPath(value);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoize(function(string) {\n  string = toString(string);\n\n  var result = [];\n  if (reLeadingDot.test(string)) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, string) {\n    result.push(quote ? string.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result);\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Assign cache to `_.memoize`.\nmemoize.Cache = MapCache;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arraySome;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","var copyObject = require('./_copyObject'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.assign` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssign(object, source) {\n  return object && copyObject(source, keys(source), object);\n}\n\nmodule.exports = baseAssign;\n","var copyObject = require('./_copyObject'),\n    keysIn = require('./keysIn');\n\n/**\n * The base implementation of `_.assignIn` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssignIn(object, source) {\n  return object && copyObject(source, keysIn(source), object);\n}\n\nmodule.exports = baseAssignIn;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var Stack = require('./_Stack'),\n    arrayEach = require('./_arrayEach'),\n    assignValue = require('./_assignValue'),\n    baseAssign = require('./_baseAssign'),\n    baseAssignIn = require('./_baseAssignIn'),\n    cloneBuffer = require('./_cloneBuffer'),\n    copyArray = require('./_copyArray'),\n    copySymbols = require('./_copySymbols'),\n    copySymbolsIn = require('./_copySymbolsIn'),\n    getAllKeys = require('./_getAllKeys'),\n    getAllKeysIn = require('./_getAllKeysIn'),\n    getTag = require('./_getTag'),\n    initCloneArray = require('./_initCloneArray'),\n    initCloneByTag = require('./_initCloneByTag'),\n    initCloneObject = require('./_initCloneObject'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isMap = require('./isMap'),\n    isObject = require('./isObject'),\n    isSet = require('./isSet'),\n    keys = require('./keys'),\n    keysIn = require('./keysIn');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values supported by `_.clone`. */\nvar cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\ncloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\ncloneableTags[boolTag] = cloneableTags[dateTag] =\ncloneableTags[float32Tag] = cloneableTags[float64Tag] =\ncloneableTags[int8Tag] = cloneableTags[int16Tag] =\ncloneableTags[int32Tag] = cloneableTags[mapTag] =\ncloneableTags[numberTag] = cloneableTags[objectTag] =\ncloneableTags[regexpTag] = cloneableTags[setTag] =\ncloneableTags[stringTag] = cloneableTags[symbolTag] =\ncloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\ncloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\ncloneableTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n * traversed objects.\n *\n * @private\n * @param {*} value The value to clone.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Deep clone\n *  2 - Flatten inherited properties\n *  4 - Clone symbols\n * @param {Function} [customizer] The function to customize cloning.\n * @param {string} [key] The key of `value`.\n * @param {Object} [object] The parent object of `value`.\n * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n * @returns {*} Returns the cloned value.\n */\nfunction baseClone(value, bitmask, customizer, key, object, stack) {\n  var result,\n      isDeep = bitmask & CLONE_DEEP_FLAG,\n      isFlat = bitmask & CLONE_FLAT_FLAG,\n      isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n  if (customizer) {\n    result = object ? customizer(value, key, object, stack) : customizer(value);\n  }\n  if (result !== undefined) {\n    return result;\n  }\n  if (!isObject(value)) {\n    return value;\n  }\n  var isArr = isArray(value);\n  if (isArr) {\n    result = initCloneArray(value);\n    if (!isDeep) {\n      return copyArray(value, result);\n    }\n  } else {\n    var tag = getTag(value),\n        isFunc = tag == funcTag || tag == genTag;\n\n    if (isBuffer(value)) {\n      return cloneBuffer(value, isDeep);\n    }\n    if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n      result = (isFlat || isFunc) ? {} : initCloneObject(value);\n      if (!isDeep) {\n        return isFlat\n          ? copySymbolsIn(value, baseAssignIn(result, value))\n          : copySymbols(value, baseAssign(result, value));\n      }\n    } else {\n      if (!cloneableTags[tag]) {\n        return object ? value : {};\n      }\n      result = initCloneByTag(value, tag, isDeep);\n    }\n  }\n  // Check for circular references and return its corresponding clone.\n  stack || (stack = new Stack);\n  var stacked = stack.get(value);\n  if (stacked) {\n    return stacked;\n  }\n  stack.set(value, result);\n\n  if (isSet(value)) {\n    value.forEach(function(subValue) {\n      result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n    });\n  } else if (isMap(value)) {\n    value.forEach(function(subValue, key) {\n      result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n    });\n  }\n\n  var keysFunc = isFull\n    ? (isFlat ? getAllKeysIn : getAllKeys)\n    : (isFlat ? keysIn : keys);\n\n  var props = isArr ? undefined : keysFunc(value);\n  arrayEach(props || value, function(subValue, key) {\n    if (props) {\n      key = subValue;\n      subValue = value[key];\n    }\n    // Recursively populate clone (susceptible to call stack limits).\n    assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n  });\n  return result;\n}\n\nmodule.exports = baseClone;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nmodule.exports = baseHasIn;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsEqualDeep = require('./_baseIsEqualDeep'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nmodule.exports = baseIsEqual;\n","var Stack = require('./_Stack'),\n    equalArrays = require('./_equalArrays'),\n    equalByTag = require('./_equalByTag'),\n    equalObjects = require('./_equalObjects'),\n    getTag = require('./_getTag'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nmodule.exports = baseIsEqualDeep;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]';\n\n/**\n * The base implementation of `_.isMap` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n */\nfunction baseIsMap(value) {\n  return isObjectLike(value) && getTag(value) == mapTag;\n}\n\nmodule.exports = baseIsMap;\n","var Stack = require('./_Stack'),\n    baseIsEqual = require('./_baseIsEqual');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nmodule.exports = baseIsMatch;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar setTag = '[object Set]';\n\n/**\n * The base implementation of `_.isSet` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n */\nfunction baseIsSet(value) {\n  return isObjectLike(value) && getTag(value) == setTag;\n}\n\nmodule.exports = baseIsSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","var baseMatches = require('./_baseMatches'),\n    baseMatchesProperty = require('./_baseMatchesProperty'),\n    identity = require('./identity'),\n    isArray = require('./isArray'),\n    property = require('./property');\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nmodule.exports = baseIteratee;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var isObject = require('./isObject'),\n    isPrototype = require('./_isPrototype'),\n    nativeKeysIn = require('./_nativeKeysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeysIn;\n","var baseEach = require('./_baseEach'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nmodule.exports = baseMap;\n","var baseIsMatch = require('./_baseIsMatch'),\n    getMatchData = require('./_getMatchData'),\n    matchesStrictComparable = require('./_matchesStrictComparable');\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nmodule.exports = baseMatches;\n","var baseIsEqual = require('./_baseIsEqual'),\n    get = require('./get'),\n    hasIn = require('./hasIn'),\n    isKey = require('./_isKey'),\n    isStrictComparable = require('./_isStrictComparable'),\n    matchesStrictComparable = require('./_matchesStrictComparable'),\n    toKey = require('./_toKey');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nmodule.exports = baseMatchesProperty;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = baseProperty;\n","var baseGet = require('./_baseGet');\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nmodule.exports = basePropertyDeep;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","var Uint8Array = require('./_Uint8Array');\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nmodule.exports = cloneArrayBuffer;\n","var root = require('./_root');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nmodule.exports = cloneBuffer;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `dataView`.\n *\n * @private\n * @param {Object} dataView The data view to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned data view.\n */\nfunction cloneDataView(dataView, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n  return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nmodule.exports = cloneDataView;\n","/** Used to match `RegExp` flags from their coerced string values. */\nvar reFlags = /\\w*$/;\n\n/**\n * Creates a clone of `regexp`.\n *\n * @private\n * @param {Object} regexp The regexp to clone.\n * @returns {Object} Returns the cloned regexp.\n */\nfunction cloneRegExp(regexp) {\n  var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n  result.lastIndex = regexp.lastIndex;\n  return result;\n}\n\nmodule.exports = cloneRegExp;\n","var Symbol = require('./_Symbol');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a clone of the `symbol` object.\n *\n * @private\n * @param {Object} symbol The symbol object to clone.\n * @returns {Object} Returns the cloned symbol object.\n */\nfunction cloneSymbol(symbol) {\n  return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nmodule.exports = cloneSymbol;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nmodule.exports = cloneTypedArray;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","var copyObject = require('./_copyObject'),\n    getSymbols = require('./_getSymbols');\n\n/**\n * Copies own symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbols(source, object) {\n  return copyObject(source, getSymbols(source), object);\n}\n\nmodule.exports = copySymbols;\n","var copyObject = require('./_copyObject'),\n    getSymbolsIn = require('./_getSymbolsIn');\n\n/**\n * Copies own and inherited symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbolsIn(source, object) {\n  return copyObject(source, getSymbolsIn(source), object);\n}\n\nmodule.exports = copySymbolsIn;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var SetCache = require('./_SetCache'),\n    arraySome = require('./_arraySome'),\n    cacheHas = require('./_cacheHas');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalArrays;\n","var Symbol = require('./_Symbol'),\n    Uint8Array = require('./_Uint8Array'),\n    eq = require('./eq'),\n    equalArrays = require('./_equalArrays'),\n    mapToArray = require('./_mapToArray'),\n    setToArray = require('./_setToArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nmodule.exports = equalByTag;\n","var getAllKeys = require('./_getAllKeys');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalObjects;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbolsIn = require('./_getSymbolsIn'),\n    keysIn = require('./keysIn');\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nmodule.exports = getAllKeysIn;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","var isStrictComparable = require('./_isStrictComparable'),\n    keys = require('./keys');\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nmodule.exports = getMatchData;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","var arrayPush = require('./_arrayPush'),\n    getPrototype = require('./_getPrototype'),\n    getSymbols = require('./_getSymbols'),\n    stubArray = require('./stubArray');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own and inherited enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\nmodule.exports = getSymbolsIn;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var castPath = require('./_castPath'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isIndex = require('./_isIndex'),\n    isLength = require('./isLength'),\n    toKey = require('./_toKey');\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nmodule.exports = hasPath;\n","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Initializes an array clone.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the initialized clone.\n */\nfunction initCloneArray(array) {\n  var length = array.length,\n      result = new array.constructor(length);\n\n  // Add properties assigned by `RegExp#exec`.\n  if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n    result.index = array.index;\n    result.input = array.input;\n  }\n  return result;\n}\n\nmodule.exports = initCloneArray;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer'),\n    cloneDataView = require('./_cloneDataView'),\n    cloneRegExp = require('./_cloneRegExp'),\n    cloneSymbol = require('./_cloneSymbol'),\n    cloneTypedArray = require('./_cloneTypedArray');\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Initializes an object clone based on its `toStringTag`.\n *\n * **Note:** This function only supports cloning values with tags of\n * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n *\n * @private\n * @param {Object} object The object to clone.\n * @param {string} tag The `toStringTag` of the object to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneByTag(object, tag, isDeep) {\n  var Ctor = object.constructor;\n  switch (tag) {\n    case arrayBufferTag:\n      return cloneArrayBuffer(object);\n\n    case boolTag:\n    case dateTag:\n      return new Ctor(+object);\n\n    case dataViewTag:\n      return cloneDataView(object, isDeep);\n\n    case float32Tag: case float64Tag:\n    case int8Tag: case int16Tag: case int32Tag:\n    case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n      return cloneTypedArray(object, isDeep);\n\n    case mapTag:\n      return new Ctor;\n\n    case numberTag:\n    case stringTag:\n      return new Ctor(object);\n\n    case regexpTag:\n      return cloneRegExp(object);\n\n    case setTag:\n      return new Ctor;\n\n    case symbolTag:\n      return cloneSymbol(object);\n  }\n}\n\nmodule.exports = initCloneByTag;\n","var baseCreate = require('./_baseCreate'),\n    getPrototype = require('./_getPrototype'),\n    isPrototype = require('./_isPrototype');\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nmodule.exports = initCloneObject;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var isObject = require('./isObject');\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nmodule.exports = isStrictComparable;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nmodule.exports = mapToArray;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nmodule.exports = matchesStrictComparable;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = nativeKeysIn;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var baseClone = require('./_baseClone');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * This method is like `_.clone` except that it recursively clones `value`.\n *\n * @static\n * @memberOf _\n * @since 1.0.0\n * @category Lang\n * @param {*} value The value to recursively clone.\n * @returns {*} Returns the deep cloned value.\n * @see _.clone\n * @example\n *\n * var objects = [{ 'a': 1 }, { 'b': 2 }];\n *\n * var deep = _.cloneDeep(objects);\n * console.log(deep[0] === objects[0]);\n * // => false\n */\nfunction cloneDeep(value) {\n  return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nmodule.exports = cloneDeep;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseForOwn = require('./_baseForOwn'),\n    castFunction = require('./_castFunction');\n\n/**\n * Iterates over own enumerable string keyed properties of an object and\n * invokes `iteratee` for each property. The iteratee is invoked with three\n * arguments: (value, key, object). Iteratee functions may exit iteration\n * early by explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @since 0.3.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Object} Returns `object`.\n * @see _.forOwnRight\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.forOwn(new Foo, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forOwn(object, iteratee) {\n  return object && baseForOwn(object, castFunction(iteratee));\n}\n\nmodule.exports = forOwn;\n","var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","var baseHasIn = require('./_baseHasIn'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nmodule.exports = hasIn;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var baseIsMap = require('./_baseIsMap'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsMap = nodeUtil && nodeUtil.isMap;\n\n/**\n * Checks if `value` is classified as a `Map` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n * @example\n *\n * _.isMap(new Map);\n * // => true\n *\n * _.isMap(new WeakMap);\n * // => false\n */\nvar isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\nmodule.exports = isMap;\n","var baseGetTag = require('./_baseGetTag'),\n    getPrototype = require('./_getPrototype'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nmodule.exports = isPlainObject;\n","var baseIsSet = require('./_baseIsSet'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsSet = nodeUtil && nodeUtil.isSet;\n\n/**\n * Checks if `value` is classified as a `Set` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n * @example\n *\n * _.isSet(new Set);\n * // => true\n *\n * _.isSet(new WeakSet);\n * // => false\n */\nvar isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\nmodule.exports = isSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isArray = require('./isArray'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n}\n\nmodule.exports = isString;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeysIn = require('./_baseKeysIn'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nmodule.exports = keysIn;\n","var arrayMap = require('./_arrayMap'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    isArray = require('./isArray');\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nmodule.exports = map;\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var baseProperty = require('./_baseProperty'),\n    basePropertyDeep = require('./_basePropertyDeep'),\n    isKey = require('./_isKey'),\n    toKey = require('./_toKey');\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = property;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","var checkboardCache = {};\n\nexport var render = function render(c1, c2, size, serverCanvas) {\n  if (typeof document === 'undefined' && !serverCanvas) {\n    return null;\n  }\n  var canvas = serverCanvas ? new serverCanvas() : document.createElement('canvas');\n  canvas.width = size * 2;\n  canvas.height = size * 2;\n  var ctx = canvas.getContext('2d');\n  if (!ctx) {\n    return null;\n  } // If no context can be found, return early.\n  ctx.fillStyle = c1;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = c2;\n  ctx.fillRect(0, 0, size, size);\n  ctx.translate(size, size);\n  ctx.fillRect(0, 0, size, size);\n  return canvas.toDataURL();\n};\n\nexport var get = function get(c1, c2, size, serverCanvas) {\n  var key = c1 + '-' + c2 + '-' + size + (serverCanvas ? '-server' : '');\n\n  if (checkboardCache[key]) {\n    return checkboardCache[key];\n  }\n\n  var checkboard = render(c1, c2, size, serverCanvas);\n  checkboardCache[key] = checkboard;\n  return checkboard;\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React, { isValidElement } from 'react';\nimport reactCSS from 'reactcss';\nimport * as checkboard from '../../helpers/checkboard';\n\nexport var Checkboard = function Checkboard(_ref) {\n  var white = _ref.white,\n      grey = _ref.grey,\n      size = _ref.size,\n      renderers = _ref.renderers,\n      borderRadius = _ref.borderRadius,\n      boxShadow = _ref.boxShadow,\n      children = _ref.children;\n\n  var styles = reactCSS({\n    'default': {\n      grid: {\n        borderRadius: borderRadius,\n        boxShadow: boxShadow,\n        absolute: '0px 0px 0px 0px',\n        background: 'url(' + checkboard.get(white, grey, size, renderers.canvas) + ') center left'\n      }\n    }\n  });\n  return isValidElement(children) ? React.cloneElement(children, _extends({}, children.props, { style: _extends({}, children.props.style, styles.grid) })) : React.createElement('div', { style: styles.grid });\n};\n\nCheckboard.defaultProps = {\n  size: 8,\n  white: 'transparent',\n  grey: 'rgba(0,0,0,.08)',\n  renderers: {}\n};\n\nexport default Checkboard;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport * as alpha from '../../helpers/alpha';\n\nimport Checkboard from './Checkboard';\n\nexport var Alpha = function (_ref) {\n  _inherits(Alpha, _ref);\n\n  function Alpha() {\n    var _ref2;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Alpha);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref2 = Alpha.__proto__ || Object.getPrototypeOf(Alpha)).call.apply(_ref2, [this].concat(args))), _this), _this.handleChange = function (e) {\n      var change = alpha.calculateChange(e, _this.props.hsl, _this.props.direction, _this.props.a, _this.container);\n      change && typeof _this.props.onChange === 'function' && _this.props.onChange(change, e);\n    }, _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      window.addEventListener('mousemove', _this.handleChange);\n      window.addEventListener('mouseup', _this.handleMouseUp);\n    }, _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    }, _this.unbindEventListeners = function () {\n      window.removeEventListener('mousemove', _this.handleChange);\n      window.removeEventListener('mouseup', _this.handleMouseUp);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Alpha, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var rgb = this.props.rgb;\n      var styles = reactCSS({\n        'default': {\n          alpha: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius\n          },\n          checkboard: {\n            absolute: '0px 0px 0px 0px',\n            overflow: 'hidden',\n            borderRadius: this.props.radius\n          },\n          gradient: {\n            absolute: '0px 0px 0px 0px',\n            background: 'linear-gradient(to right, rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 0) 0%,\\n           rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 1) 100%)',\n            boxShadow: this.props.shadow,\n            borderRadius: this.props.radius\n          },\n          container: {\n            position: 'relative',\n            height: '100%',\n            margin: '0 3px'\n          },\n          pointer: {\n            position: 'absolute',\n            left: rgb.a * 100 + '%'\n          },\n          slider: {\n            width: '4px',\n            borderRadius: '1px',\n            height: '8px',\n            boxShadow: '0 0 2px rgba(0, 0, 0, .6)',\n            background: '#fff',\n            marginTop: '1px',\n            transform: 'translateX(-2px)'\n          }\n        },\n        'vertical': {\n          gradient: {\n            background: 'linear-gradient(to bottom, rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 0) 0%,\\n           rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 1) 100%)'\n          },\n          pointer: {\n            left: 0,\n            top: rgb.a * 100 + '%'\n          }\n        },\n        'overwrite': _extends({}, this.props.style)\n      }, {\n        vertical: this.props.direction === 'vertical',\n        overwrite: true\n      });\n\n      return React.createElement(\n        'div',\n        { style: styles.alpha },\n        React.createElement(\n          'div',\n          { style: styles.checkboard },\n          React.createElement(Checkboard, { renderers: this.props.renderers })\n        ),\n        React.createElement('div', { style: styles.gradient }),\n        React.createElement(\n          'div',\n          {\n            style: styles.container,\n            ref: function ref(container) {\n              return _this2.container = container;\n            },\n            onMouseDown: this.handleMouseDown,\n            onTouchMove: this.handleChange,\n            onTouchStart: this.handleChange\n          },\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.slider })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Alpha;\n}(PureComponent || Component);\n\nexport default Alpha;","export var calculateChange = function calculateChange(e, hsl, direction, initialA, container) {\n  var containerWidth = container.clientWidth;\n  var containerHeight = container.clientHeight;\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (direction === 'vertical') {\n    var a = void 0;\n    if (top < 0) {\n      a = 0;\n    } else if (top > containerHeight) {\n      a = 1;\n    } else {\n      a = Math.round(top * 100 / containerHeight) / 100;\n    }\n\n    if (hsl.a !== a) {\n      return {\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: a,\n        source: 'rgb'\n      };\n    }\n  } else {\n    var _a = void 0;\n    if (left < 0) {\n      _a = 0;\n    } else if (left > containerWidth) {\n      _a = 1;\n    } else {\n      _a = Math.round(left * 100 / containerWidth) / 100;\n    }\n\n    if (initialA !== _a) {\n      return {\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: _a,\n        source: 'rgb'\n      };\n    }\n  }\n  return null;\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\n\nvar DEFAULT_ARROW_OFFSET = 1;\n\nvar UP_KEY_CODE = 38;\nvar DOWN_KEY_CODE = 40;\nvar VALID_KEY_CODES = [UP_KEY_CODE, DOWN_KEY_CODE];\nvar isValidKeyCode = function isValidKeyCode(keyCode) {\n  return VALID_KEY_CODES.indexOf(keyCode) > -1;\n};\nvar getNumberValue = function getNumberValue(value) {\n  return Number(String(value).replace(/%/g, ''));\n};\n\nvar idCounter = 1;\n\nexport var EditableInput = function (_ref) {\n  _inherits(EditableInput, _ref);\n\n  function EditableInput(props) {\n    _classCallCheck(this, EditableInput);\n\n    var _this = _possibleConstructorReturn(this, (EditableInput.__proto__ || Object.getPrototypeOf(EditableInput)).call(this));\n\n    _this.handleBlur = function () {\n      if (_this.state.blurValue) {\n        _this.setState({ value: _this.state.blurValue, blurValue: null });\n      }\n    };\n\n    _this.handleChange = function (e) {\n      _this.setUpdatedValue(e.target.value, e);\n    };\n\n    _this.handleKeyDown = function (e) {\n      // In case `e.target.value` is a percentage remove the `%` character\n      // and update accordingly with a percentage\n      // https://github.com/casesandberg/react-color/issues/383\n      var value = getNumberValue(e.target.value);\n      if (!isNaN(value) && isValidKeyCode(e.keyCode)) {\n        var offset = _this.getArrowOffset();\n        var updatedValue = e.keyCode === UP_KEY_CODE ? value + offset : value - offset;\n\n        _this.setUpdatedValue(updatedValue, e);\n      }\n    };\n\n    _this.handleDrag = function (e) {\n      if (_this.props.dragLabel) {\n        var newValue = Math.round(_this.props.value + e.movementX);\n        if (newValue >= 0 && newValue <= _this.props.dragMax) {\n          _this.props.onChange && _this.props.onChange(_this.getValueObjectWithLabel(newValue), e);\n        }\n      }\n    };\n\n    _this.handleMouseDown = function (e) {\n      if (_this.props.dragLabel) {\n        e.preventDefault();\n        _this.handleDrag(e);\n        window.addEventListener('mousemove', _this.handleDrag);\n        window.addEventListener('mouseup', _this.handleMouseUp);\n      }\n    };\n\n    _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    };\n\n    _this.unbindEventListeners = function () {\n      window.removeEventListener('mousemove', _this.handleDrag);\n      window.removeEventListener('mouseup', _this.handleMouseUp);\n    };\n\n    _this.state = {\n      value: String(props.value).toUpperCase(),\n      blurValue: String(props.value).toUpperCase()\n    };\n\n    _this.inputId = 'rc-editable-input-' + idCounter++;\n    return _this;\n  }\n\n  _createClass(EditableInput, [{\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.value !== this.state.value && (prevProps.value !== this.props.value || prevState.value !== this.state.value)) {\n        if (this.input === document.activeElement) {\n          this.setState({ blurValue: String(this.props.value).toUpperCase() });\n        } else {\n          this.setState({ value: String(this.props.value).toUpperCase(), blurValue: !this.state.blurValue && String(this.props.value).toUpperCase() });\n        }\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'getValueObjectWithLabel',\n    value: function getValueObjectWithLabel(value) {\n      return _defineProperty({}, this.props.label, value);\n    }\n  }, {\n    key: 'getArrowOffset',\n    value: function getArrowOffset() {\n      return this.props.arrowOffset || DEFAULT_ARROW_OFFSET;\n    }\n  }, {\n    key: 'setUpdatedValue',\n    value: function setUpdatedValue(value, e) {\n      var onChangeValue = this.props.label ? this.getValueObjectWithLabel(value) : value;\n      this.props.onChange && this.props.onChange(onChangeValue, e);\n\n      this.setState({ value: value });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var styles = reactCSS({\n        'default': {\n          wrap: {\n            position: 'relative'\n          }\n        },\n        'user-override': {\n          wrap: this.props.style && this.props.style.wrap ? this.props.style.wrap : {},\n          input: this.props.style && this.props.style.input ? this.props.style.input : {},\n          label: this.props.style && this.props.style.label ? this.props.style.label : {}\n        },\n        'dragLabel-true': {\n          label: {\n            cursor: 'ew-resize'\n          }\n        }\n      }, {\n        'user-override': true\n      }, this.props);\n\n      return React.createElement(\n        'div',\n        { style: styles.wrap },\n        React.createElement('input', {\n          id: this.inputId,\n          style: styles.input,\n          ref: function ref(input) {\n            return _this2.input = input;\n          },\n          value: this.state.value,\n          onKeyDown: this.handleKeyDown,\n          onChange: this.handleChange,\n          onBlur: this.handleBlur,\n          placeholder: this.props.placeholder,\n          spellCheck: 'false'\n        }),\n        this.props.label && !this.props.hideLabel ? React.createElement(\n          'label',\n          {\n            htmlFor: this.inputId,\n            style: styles.label,\n            onMouseDown: this.handleMouseDown\n          },\n          this.props.label\n        ) : null\n      );\n    }\n  }]);\n\n  return EditableInput;\n}(PureComponent || Component);\n\nexport default EditableInput;","export var calculateChange = function calculateChange(e, direction, hsl, container) {\n  var containerWidth = container.clientWidth;\n  var containerHeight = container.clientHeight;\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (direction === 'vertical') {\n    var h = void 0;\n    if (top < 0) {\n      h = 359;\n    } else if (top > containerHeight) {\n      h = 0;\n    } else {\n      var percent = -(top * 100 / containerHeight) + 100;\n      h = 360 * percent / 100;\n    }\n\n    if (hsl.h !== h) {\n      return {\n        h: h,\n        s: hsl.s,\n        l: hsl.l,\n        a: hsl.a,\n        source: 'hsl'\n      };\n    }\n  } else {\n    var _h = void 0;\n    if (left < 0) {\n      _h = 0;\n    } else if (left > containerWidth) {\n      _h = 359;\n    } else {\n      var _percent = left * 100 / containerWidth;\n      _h = 360 * _percent / 100;\n    }\n\n    if (hsl.h !== _h) {\n      return {\n        h: _h,\n        s: hsl.s,\n        l: hsl.l,\n        a: hsl.a,\n        source: 'hsl'\n      };\n    }\n  }\n  return null;\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport * as hue from '../../helpers/hue';\n\nexport var Hue = function (_ref) {\n  _inherits(Hue, _ref);\n\n  function Hue() {\n    var _ref2;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Hue);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref2 = Hue.__proto__ || Object.getPrototypeOf(Hue)).call.apply(_ref2, [this].concat(args))), _this), _this.handleChange = function (e) {\n      var change = hue.calculateChange(e, _this.props.direction, _this.props.hsl, _this.container);\n      change && typeof _this.props.onChange === 'function' && _this.props.onChange(change, e);\n    }, _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      window.addEventListener('mousemove', _this.handleChange);\n      window.addEventListener('mouseup', _this.handleMouseUp);\n    }, _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Hue, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'unbindEventListeners',\n    value: function unbindEventListeners() {\n      window.removeEventListener('mousemove', this.handleChange);\n      window.removeEventListener('mouseup', this.handleMouseUp);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props$direction = this.props.direction,\n          direction = _props$direction === undefined ? 'horizontal' : _props$direction;\n\n\n      var styles = reactCSS({\n        'default': {\n          hue: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius,\n            boxShadow: this.props.shadow\n          },\n          container: {\n            padding: '0 2px',\n            position: 'relative',\n            height: '100%',\n            borderRadius: this.props.radius\n          },\n          pointer: {\n            position: 'absolute',\n            left: this.props.hsl.h * 100 / 360 + '%'\n          },\n          slider: {\n            marginTop: '1px',\n            width: '4px',\n            borderRadius: '1px',\n            height: '8px',\n            boxShadow: '0 0 2px rgba(0, 0, 0, .6)',\n            background: '#fff',\n            transform: 'translateX(-2px)'\n          }\n        },\n        'vertical': {\n          pointer: {\n            left: '0px',\n            top: -(this.props.hsl.h * 100 / 360) + 100 + '%'\n          }\n        }\n      }, { vertical: direction === 'vertical' });\n\n      return React.createElement(\n        'div',\n        { style: styles.hue },\n        React.createElement(\n          'div',\n          {\n            className: 'hue-' + direction,\n            style: styles.container,\n            ref: function ref(container) {\n              return _this2.container = container;\n            },\n            onMouseDown: this.handleMouseDown,\n            onTouchMove: this.handleChange,\n            onTouchStart: this.handleChange\n          },\n          React.createElement(\n            'style',\n            null,\n            '\\n            .hue-horizontal {\\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n            }\\n\\n            .hue-vertical {\\n              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,\\n                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,\\n                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n            }\\n          '\n          ),\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.slider })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Hue;\n}(PureComponent || Component);\n\nexport default Hue;","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","import getNative from './_getNative.js';\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nexport default defineProperty;\n","import defineProperty from './_defineProperty.js';\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nexport default baseAssignValue;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/**\n * This function is like `assignValue` except that it doesn't assign\n * `undefined` values.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignMergeValue(object, key, value) {\n  if ((value !== undefined && !eq(object[key], value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignMergeValue;\n","import createBaseFor from './_createBaseFor.js';\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nexport default baseFor;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nexport default createBaseFor;\n","import root from './_root.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nexport default cloneBuffer;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","import Uint8Array from './_Uint8Array.js';\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nexport default cloneArrayBuffer;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nexport default cloneTypedArray;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nexport default copyArray;\n","import isObject from './isObject.js';\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nexport default baseCreate;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n","import baseCreate from './_baseCreate.js';\nimport getPrototype from './_getPrototype.js';\nimport isPrototype from './_isPrototype.js';\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nexport default initCloneObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n","import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n","import isArrayLike from './isArrayLike.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nexport default isArrayLikeObject;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n","import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n","import baseGetTag from './_baseGetTag.js';\nimport getPrototype from './_getPrototype.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nexport default isPlainObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n","import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n","/**\n * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction safeGet(object, key) {\n  if (key === 'constructor' && typeof object[key] === 'function') {\n    return;\n  }\n\n  if (key == '__proto__') {\n    return;\n  }\n\n  return object[key];\n}\n\nexport default safeGet;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignValue;\n","import assignValue from './_assignValue.js';\nimport baseAssignValue from './_baseAssignValue.js';\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nexport default copyObject;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default nativeKeysIn;\n","import isObject from './isObject.js';\nimport isPrototype from './_isPrototype.js';\nimport nativeKeysIn from './_nativeKeysIn.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeysIn;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeysIn from './_baseKeysIn.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nexport default keysIn;\n","import copyObject from './_copyObject.js';\nimport keysIn from './keysIn.js';\n\n/**\n * Converts `value` to a plain object flattening inherited enumerable string\n * keyed properties of `value` to own properties of the plain object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {Object} Returns the converted plain object.\n * @example\n *\n * function Foo() {\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.assign({ 'a': 1 }, new Foo);\n * // => { 'a': 1, 'b': 2 }\n *\n * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n * // => { 'a': 1, 'b': 2, 'c': 3 }\n */\nfunction toPlainObject(value) {\n  return copyObject(value, keysIn(value));\n}\n\nexport default toPlainObject;\n","import assignMergeValue from './_assignMergeValue.js';\nimport cloneBuffer from './_cloneBuffer.js';\nimport cloneTypedArray from './_cloneTypedArray.js';\nimport copyArray from './_copyArray.js';\nimport initCloneObject from './_initCloneObject.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isArrayLikeObject from './isArrayLikeObject.js';\nimport isBuffer from './isBuffer.js';\nimport isFunction from './isFunction.js';\nimport isObject from './isObject.js';\nimport isPlainObject from './isPlainObject.js';\nimport isTypedArray from './isTypedArray.js';\nimport safeGet from './_safeGet.js';\nimport toPlainObject from './toPlainObject.js';\n\n/**\n * A specialized version of `baseMerge` for arrays and objects which performs\n * deep merges and tracks traversed objects enabling objects with circular\n * references to be merged.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {string} key The key of the value to merge.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} mergeFunc The function to merge values.\n * @param {Function} [customizer] The function to customize assigned values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n  var objValue = safeGet(object, key),\n      srcValue = safeGet(source, key),\n      stacked = stack.get(srcValue);\n\n  if (stacked) {\n    assignMergeValue(object, key, stacked);\n    return;\n  }\n  var newValue = customizer\n    ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n    : undefined;\n\n  var isCommon = newValue === undefined;\n\n  if (isCommon) {\n    var isArr = isArray(srcValue),\n        isBuff = !isArr && isBuffer(srcValue),\n        isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n    newValue = srcValue;\n    if (isArr || isBuff || isTyped) {\n      if (isArray(objValue)) {\n        newValue = objValue;\n      }\n      else if (isArrayLikeObject(objValue)) {\n        newValue = copyArray(objValue);\n      }\n      else if (isBuff) {\n        isCommon = false;\n        newValue = cloneBuffer(srcValue, true);\n      }\n      else if (isTyped) {\n        isCommon = false;\n        newValue = cloneTypedArray(srcValue, true);\n      }\n      else {\n        newValue = [];\n      }\n    }\n    else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n      newValue = objValue;\n      if (isArguments(objValue)) {\n        newValue = toPlainObject(objValue);\n      }\n      else if (!isObject(objValue) || isFunction(objValue)) {\n        newValue = initCloneObject(srcValue);\n      }\n    }\n    else {\n      isCommon = false;\n    }\n  }\n  if (isCommon) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, newValue);\n    mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n    stack['delete'](srcValue);\n  }\n  assignMergeValue(object, key, newValue);\n}\n\nexport default baseMergeDeep;\n","import Stack from './_Stack.js';\nimport assignMergeValue from './_assignMergeValue.js';\nimport baseFor from './_baseFor.js';\nimport baseMergeDeep from './_baseMergeDeep.js';\nimport isObject from './isObject.js';\nimport keysIn from './keysIn.js';\nimport safeGet from './_safeGet.js';\n\n/**\n * The base implementation of `_.merge` without support for multiple sources.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} [customizer] The function to customize merged values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMerge(object, source, srcIndex, customizer, stack) {\n  if (object === source) {\n    return;\n  }\n  baseFor(source, function(srcValue, key) {\n    stack || (stack = new Stack);\n    if (isObject(srcValue)) {\n      baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n    }\n    else {\n      var newValue = customizer\n        ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      if (newValue === undefined) {\n        newValue = srcValue;\n      }\n      assignMergeValue(object, key, newValue);\n    }\n  }, keysIn);\n}\n\nexport default baseMerge;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nexport default apply;\n","import apply from './_apply.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nexport default overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nexport default constant;\n","import constant from './constant.js';\nimport defineProperty from './_defineProperty.js';\nimport identity from './identity.js';\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nexport default baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nexport default shortOut;\n","import baseSetToString from './_baseSetToString.js';\nimport shortOut from './_shortOut.js';\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nexport default setToString;\n","import identity from './identity.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nexport default baseRest;\n","import eq from './eq.js';\nimport isArrayLike from './isArrayLike.js';\nimport isIndex from './_isIndex.js';\nimport isObject from './isObject.js';\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nexport default isIterateeCall;\n","import baseMerge from './_baseMerge.js';\nimport createAssigner from './_createAssigner.js';\n\n/**\n * This method is like `_.assign` except that it recursively merges own and\n * inherited enumerable string keyed properties of source objects into the\n * destination object. Source properties that resolve to `undefined` are\n * skipped if a destination value exists. Array and plain object properties\n * are merged recursively. Other objects and value types are overridden by\n * assignment. Source objects are applied from left to right. Subsequent\n * sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 0.5.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = {\n *   'a': [{ 'b': 2 }, { 'd': 4 }]\n * };\n *\n * var other = {\n *   'a': [{ 'c': 3 }, { 'e': 5 }]\n * };\n *\n * _.merge(object, other);\n * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n */\nvar merge = createAssigner(function(object, source, srcIndex) {\n  baseMerge(object, source, srcIndex);\n});\n\nexport default merge;\n","import baseRest from './_baseRest.js';\nimport isIterateeCall from './_isIterateeCall.js';\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nexport default createAssigner;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nexport var Raised = function Raised(_ref) {\n  var zDepth = _ref.zDepth,\n      radius = _ref.radius,\n      background = _ref.background,\n      children = _ref.children,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles;\n\n  var styles = reactCSS(merge({\n    'default': {\n      wrap: {\n        position: 'relative',\n        display: 'inline-block'\n      },\n      content: {\n        position: 'relative'\n      },\n      bg: {\n        absolute: '0px 0px 0px 0px',\n        boxShadow: '0 ' + zDepth + 'px ' + zDepth * 4 + 'px rgba(0,0,0,.24)',\n        borderRadius: radius,\n        background: background\n      }\n    },\n    'zDepth-0': {\n      bg: {\n        boxShadow: 'none'\n      }\n    },\n\n    'zDepth-1': {\n      bg: {\n        boxShadow: '0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)'\n      }\n    },\n    'zDepth-2': {\n      bg: {\n        boxShadow: '0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)'\n      }\n    },\n    'zDepth-3': {\n      bg: {\n        boxShadow: '0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)'\n      }\n    },\n    'zDepth-4': {\n      bg: {\n        boxShadow: '0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)'\n      }\n    },\n    'zDepth-5': {\n      bg: {\n        boxShadow: '0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)'\n      }\n    },\n    'square': {\n      bg: {\n        borderRadius: '0'\n      }\n    },\n    'circle': {\n      bg: {\n        borderRadius: '50%'\n      }\n    }\n  }, passedStyles), { 'zDepth-1': zDepth === 1 });\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap },\n    React.createElement('div', { style: styles.bg }),\n    React.createElement(\n      'div',\n      { style: styles.content },\n      children\n    )\n  );\n};\n\nRaised.propTypes = {\n  background: PropTypes.string,\n  zDepth: PropTypes.oneOf([0, 1, 2, 3, 4, 5]),\n  radius: PropTypes.number,\n  styles: PropTypes.object\n};\n\nRaised.defaultProps = {\n  background: '#fff',\n  zDepth: 1,\n  radius: 2,\n  styles: {}\n};\n\nexport default Raised;","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","import debounce from './debounce.js';\nimport isObject from './isObject.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nexport default throttle;\n","export var calculateChange = function calculateChange(e, hsl, container) {\n  var _container$getBoundin = container.getBoundingClientRect(),\n      containerWidth = _container$getBoundin.width,\n      containerHeight = _container$getBoundin.height;\n\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (left < 0) {\n    left = 0;\n  } else if (left > containerWidth) {\n    left = containerWidth;\n  }\n\n  if (top < 0) {\n    top = 0;\n  } else if (top > containerHeight) {\n    top = containerHeight;\n  }\n\n  var saturation = left / containerWidth;\n  var bright = 1 - top / containerHeight;\n\n  return {\n    h: hsl.h,\n    s: saturation,\n    v: bright,\n    a: hsl.a,\n    source: 'hsv'\n  };\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport throttle from 'lodash-es/throttle';\nimport * as saturation from '../../helpers/saturation';\n\nexport var Saturation = function (_ref) {\n  _inherits(Saturation, _ref);\n\n  function Saturation(props) {\n    _classCallCheck(this, Saturation);\n\n    var _this = _possibleConstructorReturn(this, (Saturation.__proto__ || Object.getPrototypeOf(Saturation)).call(this, props));\n\n    _this.handleChange = function (e) {\n      typeof _this.props.onChange === 'function' && _this.throttle(_this.props.onChange, saturation.calculateChange(e, _this.props.hsl, _this.container), e);\n    };\n\n    _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      var renderWindow = _this.getContainerRenderWindow();\n      renderWindow.addEventListener('mousemove', _this.handleChange);\n      renderWindow.addEventListener('mouseup', _this.handleMouseUp);\n    };\n\n    _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    };\n\n    _this.throttle = throttle(function (fn, data, e) {\n      fn(data, e);\n    }, 50);\n    return _this;\n  }\n\n  _createClass(Saturation, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.throttle.cancel();\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'getContainerRenderWindow',\n    value: function getContainerRenderWindow() {\n      var container = this.container;\n\n      var renderWindow = window;\n      while (!renderWindow.document.contains(container) && renderWindow.parent !== renderWindow) {\n        renderWindow = renderWindow.parent;\n      }\n      return renderWindow;\n    }\n  }, {\n    key: 'unbindEventListeners',\n    value: function unbindEventListeners() {\n      var renderWindow = this.getContainerRenderWindow();\n      renderWindow.removeEventListener('mousemove', this.handleChange);\n      renderWindow.removeEventListener('mouseup', this.handleMouseUp);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _ref2 = this.props.style || {},\n          color = _ref2.color,\n          white = _ref2.white,\n          black = _ref2.black,\n          pointer = _ref2.pointer,\n          circle = _ref2.circle;\n\n      var styles = reactCSS({\n        'default': {\n          color: {\n            absolute: '0px 0px 0px 0px',\n            background: 'hsl(' + this.props.hsl.h + ',100%, 50%)',\n            borderRadius: this.props.radius\n          },\n          white: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius\n          },\n          black: {\n            absolute: '0px 0px 0px 0px',\n            boxShadow: this.props.shadow,\n            borderRadius: this.props.radius\n          },\n          pointer: {\n            position: 'absolute',\n            top: -(this.props.hsv.v * 100) + 100 + '%',\n            left: this.props.hsv.s * 100 + '%',\n            cursor: 'default'\n          },\n          circle: {\n            width: '4px',\n            height: '4px',\n            boxShadow: '0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),\\n            0 0 1px 2px rgba(0,0,0,.4)',\n            borderRadius: '50%',\n            cursor: 'hand',\n            transform: 'translate(-2px, -2px)'\n          }\n        },\n        'custom': {\n          color: color,\n          white: white,\n          black: black,\n          pointer: pointer,\n          circle: circle\n        }\n      }, { 'custom': !!this.props.style });\n\n      return React.createElement(\n        'div',\n        {\n          style: styles.color,\n          ref: function ref(container) {\n            return _this2.container = container;\n          },\n          onMouseDown: this.handleMouseDown,\n          onTouchMove: this.handleChange,\n          onTouchStart: this.handleChange\n        },\n        React.createElement(\n          'style',\n          null,\n          '\\n          .saturation-white {\\n            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\\n            background: linear-gradient(to right, #fff, rgba(255,255,255,0));\\n          }\\n          .saturation-black {\\n            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\\n            background: linear-gradient(to top, #000, rgba(0,0,0,0));\\n          }\\n        '\n        ),\n        React.createElement(\n          'div',\n          { style: styles.white, className: 'saturation-white' },\n          React.createElement('div', { style: styles.black, className: 'saturation-black' }),\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.circle })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Saturation;\n}(PureComponent || Component);\n\nexport default Saturation;","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nexport default arrayEach;\n","import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n","import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","import baseForOwn from './_baseForOwn.js';\nimport createBaseEach from './_createBaseEach.js';\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nexport default baseEach;\n","import isArrayLike from './isArrayLike.js';\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nexport default createBaseEach;\n","import baseFor from './_baseFor.js';\nimport keys from './keys.js';\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nexport default baseForOwn;\n","import identity from './identity.js';\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nexport default castFunction;\n","import arrayEach from './_arrayEach.js';\nimport baseEach from './_baseEach.js';\nimport castFunction from './_castFunction.js';\nimport isArray from './isArray.js';\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nexport default forEach;\n","// This file is autogenerated. It's used to publish ESM to npm.\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\n// https://github.com/bgrins/TinyColor\n// Brian Grinstead, MIT License\n\nvar trimLeft = /^\\s+/;\nvar trimRight = /\\s+$/;\nfunction tinycolor(color, opts) {\n  color = color ? color : \"\";\n  opts = opts || {};\n\n  // If input is already a tinycolor, return itself\n  if (color instanceof tinycolor) {\n    return color;\n  }\n  // If we are called as a function, call using new instead\n  if (!(this instanceof tinycolor)) {\n    return new tinycolor(color, opts);\n  }\n  var rgb = inputToRGB(color);\n  this._originalInput = color, this._r = rgb.r, this._g = rgb.g, this._b = rgb.b, this._a = rgb.a, this._roundA = Math.round(100 * this._a) / 100, this._format = opts.format || rgb.format;\n  this._gradientType = opts.gradientType;\n\n  // Don't let the range of [0,255] come back in [0,1].\n  // Potentially lose a little bit of precision here, but will fix issues where\n  // .5 gets interpreted as half of the total, instead of half of 1\n  // If it was supposed to be 128, this was already taken care of by `inputToRgb`\n  if (this._r < 1) this._r = Math.round(this._r);\n  if (this._g < 1) this._g = Math.round(this._g);\n  if (this._b < 1) this._b = Math.round(this._b);\n  this._ok = rgb.ok;\n}\ntinycolor.prototype = {\n  isDark: function isDark() {\n    return this.getBrightness() < 128;\n  },\n  isLight: function isLight() {\n    return !this.isDark();\n  },\n  isValid: function isValid() {\n    return this._ok;\n  },\n  getOriginalInput: function getOriginalInput() {\n    return this._originalInput;\n  },\n  getFormat: function getFormat() {\n    return this._format;\n  },\n  getAlpha: function getAlpha() {\n    return this._a;\n  },\n  getBrightness: function getBrightness() {\n    //http://www.w3.org/TR/AERT#color-contrast\n    var rgb = this.toRgb();\n    return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\n  },\n  getLuminance: function getLuminance() {\n    //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n    var rgb = this.toRgb();\n    var RsRGB, GsRGB, BsRGB, R, G, B;\n    RsRGB = rgb.r / 255;\n    GsRGB = rgb.g / 255;\n    BsRGB = rgb.b / 255;\n    if (RsRGB <= 0.03928) R = RsRGB / 12.92;else R = Math.pow((RsRGB + 0.055) / 1.055, 2.4);\n    if (GsRGB <= 0.03928) G = GsRGB / 12.92;else G = Math.pow((GsRGB + 0.055) / 1.055, 2.4);\n    if (BsRGB <= 0.03928) B = BsRGB / 12.92;else B = Math.pow((BsRGB + 0.055) / 1.055, 2.4);\n    return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n  },\n  setAlpha: function setAlpha(value) {\n    this._a = boundAlpha(value);\n    this._roundA = Math.round(100 * this._a) / 100;\n    return this;\n  },\n  toHsv: function toHsv() {\n    var hsv = rgbToHsv(this._r, this._g, this._b);\n    return {\n      h: hsv.h * 360,\n      s: hsv.s,\n      v: hsv.v,\n      a: this._a\n    };\n  },\n  toHsvString: function toHsvString() {\n    var hsv = rgbToHsv(this._r, this._g, this._b);\n    var h = Math.round(hsv.h * 360),\n      s = Math.round(hsv.s * 100),\n      v = Math.round(hsv.v * 100);\n    return this._a == 1 ? \"hsv(\" + h + \", \" + s + \"%, \" + v + \"%)\" : \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \" + this._roundA + \")\";\n  },\n  toHsl: function toHsl() {\n    var hsl = rgbToHsl(this._r, this._g, this._b);\n    return {\n      h: hsl.h * 360,\n      s: hsl.s,\n      l: hsl.l,\n      a: this._a\n    };\n  },\n  toHslString: function toHslString() {\n    var hsl = rgbToHsl(this._r, this._g, this._b);\n    var h = Math.round(hsl.h * 360),\n      s = Math.round(hsl.s * 100),\n      l = Math.round(hsl.l * 100);\n    return this._a == 1 ? \"hsl(\" + h + \", \" + s + \"%, \" + l + \"%)\" : \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \" + this._roundA + \")\";\n  },\n  toHex: function toHex(allow3Char) {\n    return rgbToHex(this._r, this._g, this._b, allow3Char);\n  },\n  toHexString: function toHexString(allow3Char) {\n    return \"#\" + this.toHex(allow3Char);\n  },\n  toHex8: function toHex8(allow4Char) {\n    return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);\n  },\n  toHex8String: function toHex8String(allow4Char) {\n    return \"#\" + this.toHex8(allow4Char);\n  },\n  toRgb: function toRgb() {\n    return {\n      r: Math.round(this._r),\n      g: Math.round(this._g),\n      b: Math.round(this._b),\n      a: this._a\n    };\n  },\n  toRgbString: function toRgbString() {\n    return this._a == 1 ? \"rgb(\" + Math.round(this._r) + \", \" + Math.round(this._g) + \", \" + Math.round(this._b) + \")\" : \"rgba(\" + Math.round(this._r) + \", \" + Math.round(this._g) + \", \" + Math.round(this._b) + \", \" + this._roundA + \")\";\n  },\n  toPercentageRgb: function toPercentageRgb() {\n    return {\n      r: Math.round(bound01(this._r, 255) * 100) + \"%\",\n      g: Math.round(bound01(this._g, 255) * 100) + \"%\",\n      b: Math.round(bound01(this._b, 255) * 100) + \"%\",\n      a: this._a\n    };\n  },\n  toPercentageRgbString: function toPercentageRgbString() {\n    return this._a == 1 ? \"rgb(\" + Math.round(bound01(this._r, 255) * 100) + \"%, \" + Math.round(bound01(this._g, 255) * 100) + \"%, \" + Math.round(bound01(this._b, 255) * 100) + \"%)\" : \"rgba(\" + Math.round(bound01(this._r, 255) * 100) + \"%, \" + Math.round(bound01(this._g, 255) * 100) + \"%, \" + Math.round(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\n  },\n  toName: function toName() {\n    if (this._a === 0) {\n      return \"transparent\";\n    }\n    if (this._a < 1) {\n      return false;\n    }\n    return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\n  },\n  toFilter: function toFilter(secondColor) {\n    var hex8String = \"#\" + rgbaToArgbHex(this._r, this._g, this._b, this._a);\n    var secondHex8String = hex8String;\n    var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\n    if (secondColor) {\n      var s = tinycolor(secondColor);\n      secondHex8String = \"#\" + rgbaToArgbHex(s._r, s._g, s._b, s._a);\n    }\n    return \"progid:DXImageTransform.Microsoft.gradient(\" + gradientType + \"startColorstr=\" + hex8String + \",endColorstr=\" + secondHex8String + \")\";\n  },\n  toString: function toString(format) {\n    var formatSet = !!format;\n    format = format || this._format;\n    var formattedString = false;\n    var hasAlpha = this._a < 1 && this._a >= 0;\n    var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"hex4\" || format === \"hex8\" || format === \"name\");\n    if (needsAlphaFormat) {\n      // Special case for \"transparent\", all other non-alpha formats\n      // will return rgba when there is transparency.\n      if (format === \"name\" && this._a === 0) {\n        return this.toName();\n      }\n      return this.toRgbString();\n    }\n    if (format === \"rgb\") {\n      formattedString = this.toRgbString();\n    }\n    if (format === \"prgb\") {\n      formattedString = this.toPercentageRgbString();\n    }\n    if (format === \"hex\" || format === \"hex6\") {\n      formattedString = this.toHexString();\n    }\n    if (format === \"hex3\") {\n      formattedString = this.toHexString(true);\n    }\n    if (format === \"hex4\") {\n      formattedString = this.toHex8String(true);\n    }\n    if (format === \"hex8\") {\n      formattedString = this.toHex8String();\n    }\n    if (format === \"name\") {\n      formattedString = this.toName();\n    }\n    if (format === \"hsl\") {\n      formattedString = this.toHslString();\n    }\n    if (format === \"hsv\") {\n      formattedString = this.toHsvString();\n    }\n    return formattedString || this.toHexString();\n  },\n  clone: function clone() {\n    return tinycolor(this.toString());\n  },\n  _applyModification: function _applyModification(fn, args) {\n    var color = fn.apply(null, [this].concat([].slice.call(args)));\n    this._r = color._r;\n    this._g = color._g;\n    this._b = color._b;\n    this.setAlpha(color._a);\n    return this;\n  },\n  lighten: function lighten() {\n    return this._applyModification(_lighten, arguments);\n  },\n  brighten: function brighten() {\n    return this._applyModification(_brighten, arguments);\n  },\n  darken: function darken() {\n    return this._applyModification(_darken, arguments);\n  },\n  desaturate: function desaturate() {\n    return this._applyModification(_desaturate, arguments);\n  },\n  saturate: function saturate() {\n    return this._applyModification(_saturate, arguments);\n  },\n  greyscale: function greyscale() {\n    return this._applyModification(_greyscale, arguments);\n  },\n  spin: function spin() {\n    return this._applyModification(_spin, arguments);\n  },\n  _applyCombination: function _applyCombination(fn, args) {\n    return fn.apply(null, [this].concat([].slice.call(args)));\n  },\n  analogous: function analogous() {\n    return this._applyCombination(_analogous, arguments);\n  },\n  complement: function complement() {\n    return this._applyCombination(_complement, arguments);\n  },\n  monochromatic: function monochromatic() {\n    return this._applyCombination(_monochromatic, arguments);\n  },\n  splitcomplement: function splitcomplement() {\n    return this._applyCombination(_splitcomplement, arguments);\n  },\n  // Disabled until https://github.com/bgrins/TinyColor/issues/254\n  // polyad: function (number) {\n  //   return this._applyCombination(polyad, [number]);\n  // },\n  triad: function triad() {\n    return this._applyCombination(polyad, [3]);\n  },\n  tetrad: function tetrad() {\n    return this._applyCombination(polyad, [4]);\n  }\n};\n\n// If input is an object, force 1 into \"1.0\" to handle ratios properly\n// String input requires \"1.0\" as input, so 1 will be treated as 1\ntinycolor.fromRatio = function (color, opts) {\n  if (_typeof(color) == \"object\") {\n    var newColor = {};\n    for (var i in color) {\n      if (color.hasOwnProperty(i)) {\n        if (i === \"a\") {\n          newColor[i] = color[i];\n        } else {\n          newColor[i] = convertToPercentage(color[i]);\n        }\n      }\n    }\n    color = newColor;\n  }\n  return tinycolor(color, opts);\n};\n\n// Given a string or object, convert that input to RGB\n// Possible string inputs:\n//\n//     \"red\"\n//     \"#f00\" or \"f00\"\n//     \"#ff0000\" or \"ff0000\"\n//     \"#ff000000\" or \"ff000000\"\n//     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\n//     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\n//     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\n//     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\n//     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\n//     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\n//     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\n//\nfunction inputToRGB(color) {\n  var rgb = {\n    r: 0,\n    g: 0,\n    b: 0\n  };\n  var a = 1;\n  var s = null;\n  var v = null;\n  var l = null;\n  var ok = false;\n  var format = false;\n  if (typeof color == \"string\") {\n    color = stringInputToObject(color);\n  }\n  if (_typeof(color) == \"object\") {\n    if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\n      rgb = rgbToRgb(color.r, color.g, color.b);\n      ok = true;\n      format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\n    } else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\n      s = convertToPercentage(color.s);\n      v = convertToPercentage(color.v);\n      rgb = hsvToRgb(color.h, s, v);\n      ok = true;\n      format = \"hsv\";\n    } else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\n      s = convertToPercentage(color.s);\n      l = convertToPercentage(color.l);\n      rgb = hslToRgb(color.h, s, l);\n      ok = true;\n      format = \"hsl\";\n    }\n    if (color.hasOwnProperty(\"a\")) {\n      a = color.a;\n    }\n  }\n  a = boundAlpha(a);\n  return {\n    ok: ok,\n    format: color.format || format,\n    r: Math.min(255, Math.max(rgb.r, 0)),\n    g: Math.min(255, Math.max(rgb.g, 0)),\n    b: Math.min(255, Math.max(rgb.b, 0)),\n    a: a\n  };\n}\n\n// Conversion Functions\n// --------------------\n\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n\n// `rgbToRgb`\n// Handle bounds / percentage checking to conform to CSS color spec\n// <http://www.w3.org/TR/css3-color/>\n// *Assumes:* r, g, b in [0, 255] or [0, 1]\n// *Returns:* { r, g, b } in [0, 255]\nfunction rgbToRgb(r, g, b) {\n  return {\n    r: bound01(r, 255) * 255,\n    g: bound01(g, 255) * 255,\n    b: bound01(b, 255) * 255\n  };\n}\n\n// `rgbToHsl`\n// Converts an RGB color value to HSL.\n// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n// *Returns:* { h, s, l } in [0,1]\nfunction rgbToHsl(r, g, b) {\n  r = bound01(r, 255);\n  g = bound01(g, 255);\n  b = bound01(b, 255);\n  var max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n  var h,\n    s,\n    l = (max + min) / 2;\n  if (max == min) {\n    h = s = 0; // achromatic\n  } else {\n    var d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n  return {\n    h: h,\n    s: s,\n    l: l\n  };\n}\n\n// `hslToRgb`\n// Converts an HSL color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hslToRgb(h, s, l) {\n  var r, g, b;\n  h = bound01(h, 360);\n  s = bound01(s, 100);\n  l = bound01(l, 100);\n  function hue2rgb(p, q, t) {\n    if (t < 0) t += 1;\n    if (t > 1) t -= 1;\n    if (t < 1 / 6) return p + (q - p) * 6 * t;\n    if (t < 1 / 2) return q;\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n    return p;\n  }\n  if (s === 0) {\n    r = g = b = l; // achromatic\n  } else {\n    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    var p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n  return {\n    r: r * 255,\n    g: g * 255,\n    b: b * 255\n  };\n}\n\n// `rgbToHsv`\n// Converts an RGB color value to HSV\n// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n// *Returns:* { h, s, v } in [0,1]\nfunction rgbToHsv(r, g, b) {\n  r = bound01(r, 255);\n  g = bound01(g, 255);\n  b = bound01(b, 255);\n  var max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n  var h,\n    s,\n    v = max;\n  var d = max - min;\n  s = max === 0 ? 0 : d / max;\n  if (max == min) {\n    h = 0; // achromatic\n  } else {\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n  return {\n    h: h,\n    s: s,\n    v: v\n  };\n}\n\n// `hsvToRgb`\n// Converts an HSV color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hsvToRgb(h, s, v) {\n  h = bound01(h, 360) * 6;\n  s = bound01(s, 100);\n  v = bound01(v, 100);\n  var i = Math.floor(h),\n    f = h - i,\n    p = v * (1 - s),\n    q = v * (1 - f * s),\n    t = v * (1 - (1 - f) * s),\n    mod = i % 6,\n    r = [v, q, p, p, t, v][mod],\n    g = [t, v, v, q, p, p][mod],\n    b = [p, p, t, v, v, q][mod];\n  return {\n    r: r * 255,\n    g: g * 255,\n    b: b * 255\n  };\n}\n\n// `rgbToHex`\n// Converts an RGB color to hex\n// Assumes r, g, and b are contained in the set [0, 255]\n// Returns a 3 or 6 character hex\nfunction rgbToHex(r, g, b, allow3Char) {\n  var hex = [pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16))];\n\n  // Return a 3 character hex if possible\n  if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\n    return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n  }\n  return hex.join(\"\");\n}\n\n// `rgbaToHex`\n// Converts an RGBA color plus alpha transparency to hex\n// Assumes r, g, b are contained in the set [0, 255] and\n// a in [0, 1]. Returns a 4 or 8 character rgba hex\nfunction rgbaToHex(r, g, b, a, allow4Char) {\n  var hex = [pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16)), pad2(convertDecimalToHex(a))];\n\n  // Return a 4 character hex if possible\n  if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {\n    return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\n  }\n  return hex.join(\"\");\n}\n\n// `rgbaToArgbHex`\n// Converts an RGBA color to an ARGB Hex8 string\n// Rarely used, but required for \"toFilter()\"\nfunction rgbaToArgbHex(r, g, b, a) {\n  var hex = [pad2(convertDecimalToHex(a)), pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16))];\n  return hex.join(\"\");\n}\n\n// `equals`\n// Can be called with any tinycolor input\ntinycolor.equals = function (color1, color2) {\n  if (!color1 || !color2) return false;\n  return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\n};\ntinycolor.random = function () {\n  return tinycolor.fromRatio({\n    r: Math.random(),\n    g: Math.random(),\n    b: Math.random()\n  });\n};\n\n// Modification Functions\n// ----------------------\n// Thanks to less.js for some of the basics here\n// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\n\nfunction _desaturate(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.s -= amount / 100;\n  hsl.s = clamp01(hsl.s);\n  return tinycolor(hsl);\n}\nfunction _saturate(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.s += amount / 100;\n  hsl.s = clamp01(hsl.s);\n  return tinycolor(hsl);\n}\nfunction _greyscale(color) {\n  return tinycolor(color).desaturate(100);\n}\nfunction _lighten(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.l += amount / 100;\n  hsl.l = clamp01(hsl.l);\n  return tinycolor(hsl);\n}\nfunction _brighten(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var rgb = tinycolor(color).toRgb();\n  rgb.r = Math.max(0, Math.min(255, rgb.r - Math.round(255 * -(amount / 100))));\n  rgb.g = Math.max(0, Math.min(255, rgb.g - Math.round(255 * -(amount / 100))));\n  rgb.b = Math.max(0, Math.min(255, rgb.b - Math.round(255 * -(amount / 100))));\n  return tinycolor(rgb);\n}\nfunction _darken(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.l -= amount / 100;\n  hsl.l = clamp01(hsl.l);\n  return tinycolor(hsl);\n}\n\n// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\n// Values outside of this range will be wrapped into this range.\nfunction _spin(color, amount) {\n  var hsl = tinycolor(color).toHsl();\n  var hue = (hsl.h + amount) % 360;\n  hsl.h = hue < 0 ? 360 + hue : hue;\n  return tinycolor(hsl);\n}\n\n// Combination Functions\n// ---------------------\n// Thanks to jQuery xColor for some of the ideas behind these\n// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\n\nfunction _complement(color) {\n  var hsl = tinycolor(color).toHsl();\n  hsl.h = (hsl.h + 180) % 360;\n  return tinycolor(hsl);\n}\nfunction polyad(color, number) {\n  if (isNaN(number) || number <= 0) {\n    throw new Error(\"Argument to polyad must be a positive number\");\n  }\n  var hsl = tinycolor(color).toHsl();\n  var result = [tinycolor(color)];\n  var step = 360 / number;\n  for (var i = 1; i < number; i++) {\n    result.push(tinycolor({\n      h: (hsl.h + i * step) % 360,\n      s: hsl.s,\n      l: hsl.l\n    }));\n  }\n  return result;\n}\nfunction _splitcomplement(color) {\n  var hsl = tinycolor(color).toHsl();\n  var h = hsl.h;\n  return [tinycolor(color), tinycolor({\n    h: (h + 72) % 360,\n    s: hsl.s,\n    l: hsl.l\n  }), tinycolor({\n    h: (h + 216) % 360,\n    s: hsl.s,\n    l: hsl.l\n  })];\n}\nfunction _analogous(color, results, slices) {\n  results = results || 6;\n  slices = slices || 30;\n  var hsl = tinycolor(color).toHsl();\n  var part = 360 / slices;\n  var ret = [tinycolor(color)];\n  for (hsl.h = (hsl.h - (part * results >> 1) + 720) % 360; --results;) {\n    hsl.h = (hsl.h + part) % 360;\n    ret.push(tinycolor(hsl));\n  }\n  return ret;\n}\nfunction _monochromatic(color, results) {\n  results = results || 6;\n  var hsv = tinycolor(color).toHsv();\n  var h = hsv.h,\n    s = hsv.s,\n    v = hsv.v;\n  var ret = [];\n  var modification = 1 / results;\n  while (results--) {\n    ret.push(tinycolor({\n      h: h,\n      s: s,\n      v: v\n    }));\n    v = (v + modification) % 1;\n  }\n  return ret;\n}\n\n// Utility Functions\n// ---------------------\n\ntinycolor.mix = function (color1, color2, amount) {\n  amount = amount === 0 ? 0 : amount || 50;\n  var rgb1 = tinycolor(color1).toRgb();\n  var rgb2 = tinycolor(color2).toRgb();\n  var p = amount / 100;\n  var rgba = {\n    r: (rgb2.r - rgb1.r) * p + rgb1.r,\n    g: (rgb2.g - rgb1.g) * p + rgb1.g,\n    b: (rgb2.b - rgb1.b) * p + rgb1.b,\n    a: (rgb2.a - rgb1.a) * p + rgb1.a\n  };\n  return tinycolor(rgba);\n};\n\n// Readability Functions\n// ---------------------\n// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)\n\n// `contrast`\n// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)\ntinycolor.readability = function (color1, color2) {\n  var c1 = tinycolor(color1);\n  var c2 = tinycolor(color2);\n  return (Math.max(c1.getLuminance(), c2.getLuminance()) + 0.05) / (Math.min(c1.getLuminance(), c2.getLuminance()) + 0.05);\n};\n\n// `isReadable`\n// Ensure that foreground and background color combinations meet WCAG2 guidelines.\n// The third argument is an optional Object.\n//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';\n//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.\n// If the entire object is absent, isReadable defaults to {level:\"AA\",size:\"small\"}.\n\n// *Example*\n//    tinycolor.isReadable(\"#000\", \"#111\") => false\n//    tinycolor.isReadable(\"#000\", \"#111\",{level:\"AA\",size:\"large\"}) => false\ntinycolor.isReadable = function (color1, color2, wcag2) {\n  var readability = tinycolor.readability(color1, color2);\n  var wcag2Parms, out;\n  out = false;\n  wcag2Parms = validateWCAG2Parms(wcag2);\n  switch (wcag2Parms.level + wcag2Parms.size) {\n    case \"AAsmall\":\n    case \"AAAlarge\":\n      out = readability >= 4.5;\n      break;\n    case \"AAlarge\":\n      out = readability >= 3;\n      break;\n    case \"AAAsmall\":\n      out = readability >= 7;\n      break;\n  }\n  return out;\n};\n\n// `mostReadable`\n// Given a base color and a list of possible foreground or background\n// colors for that base, returns the most readable color.\n// Optionally returns Black or White if the most readable color is unreadable.\n// *Example*\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:false}).toHexString(); // \"#112255\"\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:true}).toHexString();  // \"#ffffff\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"large\"}).toHexString(); // \"#faf3f3\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"small\"}).toHexString(); // \"#ffffff\"\ntinycolor.mostReadable = function (baseColor, colorList, args) {\n  var bestColor = null;\n  var bestScore = 0;\n  var readability;\n  var includeFallbackColors, level, size;\n  args = args || {};\n  includeFallbackColors = args.includeFallbackColors;\n  level = args.level;\n  size = args.size;\n  for (var i = 0; i < colorList.length; i++) {\n    readability = tinycolor.readability(baseColor, colorList[i]);\n    if (readability > bestScore) {\n      bestScore = readability;\n      bestColor = tinycolor(colorList[i]);\n    }\n  }\n  if (tinycolor.isReadable(baseColor, bestColor, {\n    level: level,\n    size: size\n  }) || !includeFallbackColors) {\n    return bestColor;\n  } else {\n    args.includeFallbackColors = false;\n    return tinycolor.mostReadable(baseColor, [\"#fff\", \"#000\"], args);\n  }\n};\n\n// Big List of Colors\n// ------------------\n// <https://www.w3.org/TR/css-color-4/#named-colors>\nvar names = tinycolor.names = {\n  aliceblue: \"f0f8ff\",\n  antiquewhite: \"faebd7\",\n  aqua: \"0ff\",\n  aquamarine: \"7fffd4\",\n  azure: \"f0ffff\",\n  beige: \"f5f5dc\",\n  bisque: \"ffe4c4\",\n  black: \"000\",\n  blanchedalmond: \"ffebcd\",\n  blue: \"00f\",\n  blueviolet: \"8a2be2\",\n  brown: \"a52a2a\",\n  burlywood: \"deb887\",\n  burntsienna: \"ea7e5d\",\n  cadetblue: \"5f9ea0\",\n  chartreuse: \"7fff00\",\n  chocolate: \"d2691e\",\n  coral: \"ff7f50\",\n  cornflowerblue: \"6495ed\",\n  cornsilk: \"fff8dc\",\n  crimson: \"dc143c\",\n  cyan: \"0ff\",\n  darkblue: \"00008b\",\n  darkcyan: \"008b8b\",\n  darkgoldenrod: \"b8860b\",\n  darkgray: \"a9a9a9\",\n  darkgreen: \"006400\",\n  darkgrey: \"a9a9a9\",\n  darkkhaki: \"bdb76b\",\n  darkmagenta: \"8b008b\",\n  darkolivegreen: \"556b2f\",\n  darkorange: \"ff8c00\",\n  darkorchid: \"9932cc\",\n  darkred: \"8b0000\",\n  darksalmon: \"e9967a\",\n  darkseagreen: \"8fbc8f\",\n  darkslateblue: \"483d8b\",\n  darkslategray: \"2f4f4f\",\n  darkslategrey: \"2f4f4f\",\n  darkturquoise: \"00ced1\",\n  darkviolet: \"9400d3\",\n  deeppink: \"ff1493\",\n  deepskyblue: \"00bfff\",\n  dimgray: \"696969\",\n  dimgrey: \"696969\",\n  dodgerblue: \"1e90ff\",\n  firebrick: \"b22222\",\n  floralwhite: \"fffaf0\",\n  forestgreen: \"228b22\",\n  fuchsia: \"f0f\",\n  gainsboro: \"dcdcdc\",\n  ghostwhite: \"f8f8ff\",\n  gold: \"ffd700\",\n  goldenrod: \"daa520\",\n  gray: \"808080\",\n  green: \"008000\",\n  greenyellow: \"adff2f\",\n  grey: \"808080\",\n  honeydew: \"f0fff0\",\n  hotpink: \"ff69b4\",\n  indianred: \"cd5c5c\",\n  indigo: \"4b0082\",\n  ivory: \"fffff0\",\n  khaki: \"f0e68c\",\n  lavender: \"e6e6fa\",\n  lavenderblush: \"fff0f5\",\n  lawngreen: \"7cfc00\",\n  lemonchiffon: \"fffacd\",\n  lightblue: \"add8e6\",\n  lightcoral: \"f08080\",\n  lightcyan: \"e0ffff\",\n  lightgoldenrodyellow: \"fafad2\",\n  lightgray: \"d3d3d3\",\n  lightgreen: \"90ee90\",\n  lightgrey: \"d3d3d3\",\n  lightpink: \"ffb6c1\",\n  lightsalmon: \"ffa07a\",\n  lightseagreen: \"20b2aa\",\n  lightskyblue: \"87cefa\",\n  lightslategray: \"789\",\n  lightslategrey: \"789\",\n  lightsteelblue: \"b0c4de\",\n  lightyellow: \"ffffe0\",\n  lime: \"0f0\",\n  limegreen: \"32cd32\",\n  linen: \"faf0e6\",\n  magenta: \"f0f\",\n  maroon: \"800000\",\n  mediumaquamarine: \"66cdaa\",\n  mediumblue: \"0000cd\",\n  mediumorchid: \"ba55d3\",\n  mediumpurple: \"9370db\",\n  mediumseagreen: \"3cb371\",\n  mediumslateblue: \"7b68ee\",\n  mediumspringgreen: \"00fa9a\",\n  mediumturquoise: \"48d1cc\",\n  mediumvioletred: \"c71585\",\n  midnightblue: \"191970\",\n  mintcream: \"f5fffa\",\n  mistyrose: \"ffe4e1\",\n  moccasin: \"ffe4b5\",\n  navajowhite: \"ffdead\",\n  navy: \"000080\",\n  oldlace: \"fdf5e6\",\n  olive: \"808000\",\n  olivedrab: \"6b8e23\",\n  orange: \"ffa500\",\n  orangered: \"ff4500\",\n  orchid: \"da70d6\",\n  palegoldenrod: \"eee8aa\",\n  palegreen: \"98fb98\",\n  paleturquoise: \"afeeee\",\n  palevioletred: \"db7093\",\n  papayawhip: \"ffefd5\",\n  peachpuff: \"ffdab9\",\n  peru: \"cd853f\",\n  pink: \"ffc0cb\",\n  plum: \"dda0dd\",\n  powderblue: \"b0e0e6\",\n  purple: \"800080\",\n  rebeccapurple: \"663399\",\n  red: \"f00\",\n  rosybrown: \"bc8f8f\",\n  royalblue: \"4169e1\",\n  saddlebrown: \"8b4513\",\n  salmon: \"fa8072\",\n  sandybrown: \"f4a460\",\n  seagreen: \"2e8b57\",\n  seashell: \"fff5ee\",\n  sienna: \"a0522d\",\n  silver: \"c0c0c0\",\n  skyblue: \"87ceeb\",\n  slateblue: \"6a5acd\",\n  slategray: \"708090\",\n  slategrey: \"708090\",\n  snow: \"fffafa\",\n  springgreen: \"00ff7f\",\n  steelblue: \"4682b4\",\n  tan: \"d2b48c\",\n  teal: \"008080\",\n  thistle: \"d8bfd8\",\n  tomato: \"ff6347\",\n  turquoise: \"40e0d0\",\n  violet: \"ee82ee\",\n  wheat: \"f5deb3\",\n  white: \"fff\",\n  whitesmoke: \"f5f5f5\",\n  yellow: \"ff0\",\n  yellowgreen: \"9acd32\"\n};\n\n// Make it easy to access colors via `hexNames[hex]`\nvar hexNames = tinycolor.hexNames = flip(names);\n\n// Utilities\n// ---------\n\n// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\nfunction flip(o) {\n  var flipped = {};\n  for (var i in o) {\n    if (o.hasOwnProperty(i)) {\n      flipped[o[i]] = i;\n    }\n  }\n  return flipped;\n}\n\n// Return a valid alpha value [0,1] with all invalid values being set to 1\nfunction boundAlpha(a) {\n  a = parseFloat(a);\n  if (isNaN(a) || a < 0 || a > 1) {\n    a = 1;\n  }\n  return a;\n}\n\n// Take input from [0, n] and return it as [0, 1]\nfunction bound01(n, max) {\n  if (isOnePointZero(n)) n = \"100%\";\n  var processPercent = isPercentage(n);\n  n = Math.min(max, Math.max(0, parseFloat(n)));\n\n  // Automatically convert percentage into number\n  if (processPercent) {\n    n = parseInt(n * max, 10) / 100;\n  }\n\n  // Handle floating point rounding errors\n  if (Math.abs(n - max) < 0.000001) {\n    return 1;\n  }\n\n  // Convert into [0, 1] range if it isn't already\n  return n % max / parseFloat(max);\n}\n\n// Force a number between 0 and 1\nfunction clamp01(val) {\n  return Math.min(1, Math.max(0, val));\n}\n\n// Parse a base-16 hex value into a base-10 integer\nfunction parseIntFromHex(val) {\n  return parseInt(val, 16);\n}\n\n// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\nfunction isOnePointZero(n) {\n  return typeof n == \"string\" && n.indexOf(\".\") != -1 && parseFloat(n) === 1;\n}\n\n// Check to see if string passed in is a percentage\nfunction isPercentage(n) {\n  return typeof n === \"string\" && n.indexOf(\"%\") != -1;\n}\n\n// Force a hex value to have 2 characters\nfunction pad2(c) {\n  return c.length == 1 ? \"0\" + c : \"\" + c;\n}\n\n// Replace a decimal with it's percentage value\nfunction convertToPercentage(n) {\n  if (n <= 1) {\n    n = n * 100 + \"%\";\n  }\n  return n;\n}\n\n// Converts a decimal to a hex value\nfunction convertDecimalToHex(d) {\n  return Math.round(parseFloat(d) * 255).toString(16);\n}\n// Converts a hex value to a decimal\nfunction convertHexToDecimal(h) {\n  return parseIntFromHex(h) / 255;\n}\nvar matchers = function () {\n  // <http://www.w3.org/TR/css3-values/#integers>\n  var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\n\n  // <http://www.w3.org/TR/css3-values/#number-value>\n  var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\n\n  // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\n  var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\n\n  // Actual matching.\n  // Parentheses and commas are optional, but not required.\n  // Whitespace can take the place of commas or opening paren\n  var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n  var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n  return {\n    CSS_UNIT: new RegExp(CSS_UNIT),\n    rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\n    rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\n    hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\n    hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\n    hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\n    hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\n    hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n    hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\n  };\n}();\n\n// `isValidCSSUnit`\n// Take in a single string / number and check to see if it looks like a CSS unit\n// (see `matchers` above for definition).\nfunction isValidCSSUnit(color) {\n  return !!matchers.CSS_UNIT.exec(color);\n}\n\n// `stringInputToObject`\n// Permissive string parsing.  Take in a number of formats, and output an object\n// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\nfunction stringInputToObject(color) {\n  color = color.replace(trimLeft, \"\").replace(trimRight, \"\").toLowerCase();\n  var named = false;\n  if (names[color]) {\n    color = names[color];\n    named = true;\n  } else if (color == \"transparent\") {\n    return {\n      r: 0,\n      g: 0,\n      b: 0,\n      a: 0,\n      format: \"name\"\n    };\n  }\n\n  // Try to match string input using regular expressions.\n  // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\n  // Just return an object and let the conversion functions handle that.\n  // This way the result will be the same whether the tinycolor is initialized with string or object.\n  var match;\n  if (match = matchers.rgb.exec(color)) {\n    return {\n      r: match[1],\n      g: match[2],\n      b: match[3]\n    };\n  }\n  if (match = matchers.rgba.exec(color)) {\n    return {\n      r: match[1],\n      g: match[2],\n      b: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hsl.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      l: match[3]\n    };\n  }\n  if (match = matchers.hsla.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      l: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hsv.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      v: match[3]\n    };\n  }\n  if (match = matchers.hsva.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      v: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hex8.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1]),\n      g: parseIntFromHex(match[2]),\n      b: parseIntFromHex(match[3]),\n      a: convertHexToDecimal(match[4]),\n      format: named ? \"name\" : \"hex8\"\n    };\n  }\n  if (match = matchers.hex6.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1]),\n      g: parseIntFromHex(match[2]),\n      b: parseIntFromHex(match[3]),\n      format: named ? \"name\" : \"hex\"\n    };\n  }\n  if (match = matchers.hex4.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1] + \"\" + match[1]),\n      g: parseIntFromHex(match[2] + \"\" + match[2]),\n      b: parseIntFromHex(match[3] + \"\" + match[3]),\n      a: convertHexToDecimal(match[4] + \"\" + match[4]),\n      format: named ? \"name\" : \"hex8\"\n    };\n  }\n  if (match = matchers.hex3.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1] + \"\" + match[1]),\n      g: parseIntFromHex(match[2] + \"\" + match[2]),\n      b: parseIntFromHex(match[3] + \"\" + match[3]),\n      format: named ? \"name\" : \"hex\"\n    };\n  }\n  return false;\n}\nfunction validateWCAG2Parms(parms) {\n  // return valid WCAG2 parms for isReadable.\n  // If input parms are invalid, return {\"level\":\"AA\", \"size\":\"small\"}\n  var level, size;\n  parms = parms || {\n    level: \"AA\",\n    size: \"small\"\n  };\n  level = (parms.level || \"AA\").toUpperCase();\n  size = (parms.size || \"small\").toLowerCase();\n  if (level !== \"AA\" && level !== \"AAA\") {\n    level = \"AA\";\n  }\n  if (size !== \"small\" && size !== \"large\") {\n    size = \"small\";\n  }\n  return {\n    level: level,\n    size: size\n  };\n}\n\nexport { tinycolor as default };\n","import each from 'lodash-es/each';\nimport tinycolor from 'tinycolor2';\n\nexport var simpleCheckForValidColor = function simpleCheckForValidColor(data) {\n  var keysToCheck = ['r', 'g', 'b', 'a', 'h', 's', 'l', 'v'];\n  var checked = 0;\n  var passed = 0;\n  each(keysToCheck, function (letter) {\n    if (data[letter]) {\n      checked += 1;\n      if (!isNaN(data[letter])) {\n        passed += 1;\n      }\n      if (letter === 's' || letter === 'l') {\n        var percentPatt = /^\\d+%$/;\n        if (percentPatt.test(data[letter])) {\n          passed += 1;\n        }\n      }\n    }\n  });\n  return checked === passed ? data : false;\n};\n\nexport var toState = function toState(data, oldHue) {\n  var color = data.hex ? tinycolor(data.hex) : tinycolor(data);\n  var hsl = color.toHsl();\n  var hsv = color.toHsv();\n  var rgb = color.toRgb();\n  var hex = color.toHex();\n  if (hsl.s === 0) {\n    hsl.h = oldHue || 0;\n    hsv.h = oldHue || 0;\n  }\n  var transparent = hex === '000000' && rgb.a === 0;\n\n  return {\n    hsl: hsl,\n    hex: transparent ? 'transparent' : '#' + hex,\n    rgb: rgb,\n    hsv: hsv,\n    oldHue: data.h || oldHue || hsl.h,\n    source: data.source\n  };\n};\n\nexport var isValidHex = function isValidHex(hex) {\n  if (hex === 'transparent') {\n    return true;\n  }\n  // disable hex4 and hex8\n  var lh = String(hex).charAt(0) === '#' ? 1 : 0;\n  return hex.length !== 4 + lh && hex.length < 7 + lh && tinycolor(hex).isValid();\n};\n\nexport var getContrastingColor = function getContrastingColor(data) {\n  if (!data) {\n    return '#fff';\n  }\n  var col = toState(data);\n  if (col.hex === 'transparent') {\n    return 'rgba(0,0,0,0.4)';\n  }\n  var yiq = (col.rgb.r * 299 + col.rgb.g * 587 + col.rgb.b * 114) / 1000;\n  return yiq >= 128 ? '#000' : '#fff';\n};\n\nexport var red = {\n  hsl: { a: 1, h: 0, l: 0.5, s: 1 },\n  hex: '#ff0000',\n  rgb: { r: 255, g: 0, b: 0, a: 1 },\n  hsv: { h: 0, s: 1, v: 1, a: 1 }\n};\n\nexport var isvalidColorString = function isvalidColorString(string, type) {\n  var stringWithoutDegree = string.replace('', '');\n  return tinycolor(type + ' (' + stringWithoutDegree + ')')._ok;\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport debounce from 'lodash-es/debounce';\nimport * as color from '../../helpers/color';\n\nexport var ColorWrap = function ColorWrap(Picker) {\n  var ColorPicker = function (_ref) {\n    _inherits(ColorPicker, _ref);\n\n    function ColorPicker(props) {\n      _classCallCheck(this, ColorPicker);\n\n      var _this = _possibleConstructorReturn(this, (ColorPicker.__proto__ || Object.getPrototypeOf(ColorPicker)).call(this));\n\n      _this.handleChange = function (data, event) {\n        var isValidColor = color.simpleCheckForValidColor(data);\n        if (isValidColor) {\n          var colors = color.toState(data, data.h || _this.state.oldHue);\n          _this.setState(colors);\n          _this.props.onChangeComplete && _this.debounce(_this.props.onChangeComplete, colors, event);\n          _this.props.onChange && _this.props.onChange(colors, event);\n        }\n      };\n\n      _this.handleSwatchHover = function (data, event) {\n        var isValidColor = color.simpleCheckForValidColor(data);\n        if (isValidColor) {\n          var colors = color.toState(data, data.h || _this.state.oldHue);\n          _this.props.onSwatchHover && _this.props.onSwatchHover(colors, event);\n        }\n      };\n\n      _this.state = _extends({}, color.toState(props.color, 0));\n\n      _this.debounce = debounce(function (fn, data, event) {\n        fn(data, event);\n      }, 100);\n      return _this;\n    }\n\n    _createClass(ColorPicker, [{\n      key: 'render',\n      value: function render() {\n        var optionalEvents = {};\n        if (this.props.onSwatchHover) {\n          optionalEvents.onSwatchHover = this.handleSwatchHover;\n        }\n\n        return React.createElement(Picker, _extends({}, this.props, this.state, {\n          onChange: this.handleChange\n        }, optionalEvents));\n      }\n    }], [{\n      key: 'getDerivedStateFromProps',\n      value: function getDerivedStateFromProps(nextProps, state) {\n        return _extends({}, color.toState(nextProps.color, state.oldHue));\n      }\n    }]);\n\n    return ColorPicker;\n  }(PureComponent || Component);\n\n  ColorPicker.propTypes = _extends({}, Picker.propTypes);\n\n  ColorPicker.defaultProps = _extends({}, Picker.defaultProps, {\n    color: {\n      h: 250,\n      s: 0.50,\n      l: 0.20,\n      a: 1\n    }\n  });\n\n  return ColorPicker;\n};\n\nexport default ColorWrap;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* eslint-disable no-invalid-this */\nimport React from 'react';\n\nexport var handleFocus = function handleFocus(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n  return function (_React$Component) {\n    _inherits(Focus, _React$Component);\n\n    function Focus() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Focus);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Focus.__proto__ || Object.getPrototypeOf(Focus)).call.apply(_ref, [this].concat(args))), _this), _this.state = { focus: false }, _this.handleFocus = function () {\n        return _this.setState({ focus: true });\n      }, _this.handleBlur = function () {\n        return _this.setState({ focus: false });\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    _createClass(Focus, [{\n      key: 'render',\n      value: function render() {\n        return React.createElement(\n          Span,\n          { onFocus: this.handleFocus, onBlur: this.handleBlur },\n          React.createElement(Component, _extends({}, this.props, this.state))\n        );\n      }\n    }]);\n\n    return Focus;\n  }(React.Component);\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport { handleFocus } from '../../helpers/interaction';\n\nimport Checkboard from './Checkboard';\n\nvar ENTER = 13;\n\nexport var Swatch = function Swatch(_ref) {\n  var color = _ref.color,\n      style = _ref.style,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onHover = _ref.onHover,\n      _ref$title = _ref.title,\n      title = _ref$title === undefined ? color : _ref$title,\n      children = _ref.children,\n      focus = _ref.focus,\n      _ref$focusStyle = _ref.focusStyle,\n      focusStyle = _ref$focusStyle === undefined ? {} : _ref$focusStyle;\n\n  var transparent = color === 'transparent';\n  var styles = reactCSS({\n    default: {\n      swatch: _extends({\n        background: color,\n        height: '100%',\n        width: '100%',\n        cursor: 'pointer',\n        position: 'relative',\n        outline: 'none'\n      }, style, focus ? focusStyle : {})\n    }\n  });\n\n  var handleClick = function handleClick(e) {\n    return onClick(color, e);\n  };\n  var handleKeyDown = function handleKeyDown(e) {\n    return e.keyCode === ENTER && onClick(color, e);\n  };\n  var handleHover = function handleHover(e) {\n    return onHover(color, e);\n  };\n\n  var optionalEvents = {};\n  if (onHover) {\n    optionalEvents.onMouseOver = handleHover;\n  }\n\n  return React.createElement(\n    'div',\n    _extends({\n      style: styles.swatch,\n      onClick: handleClick,\n      title: title,\n      tabIndex: 0,\n      onKeyDown: handleKeyDown\n    }, optionalEvents),\n    children,\n    transparent && React.createElement(Checkboard, {\n      borderRadius: styles.swatch.borderRadius,\n      boxShadow: 'inset 0 0 0 1px rgba(0,0,0,0.1)'\n    })\n  );\n};\n\nexport default handleFocus(Swatch);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var AlphaPointer = function AlphaPointer(_ref) {\n  var direction = _ref.direction;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '18px',\n        height: '18px',\n        borderRadius: '50%',\n        transform: 'translate(-9px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    },\n    'vertical': {\n      picker: {\n        transform: 'translate(-3px, -9px)'\n      }\n    }\n  }, { vertical: direction === 'vertical' });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default AlphaPointer;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\n\nimport { ColorWrap, Alpha } from '../common';\nimport AlphaPointer from './AlphaPointer';\n\nexport var AlphaPicker = function AlphaPicker(_ref) {\n  var rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      direction = _ref.direction,\n      style = _ref.style,\n      renderers = _ref.renderers,\n      pointer = _ref.pointer,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        position: 'relative',\n        width: width,\n        height: height\n      },\n      alpha: {\n        radius: '2px',\n        style: style\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'alpha-picker ' + className },\n    React.createElement(Alpha, _extends({}, styles.alpha, {\n      rgb: rgb,\n      hsl: hsl,\n      pointer: pointer,\n      renderers: renderers,\n      onChange: onChange,\n      direction: direction\n    }))\n  );\n};\n\nAlphaPicker.defaultProps = {\n  width: '316px',\n  height: '16px',\n  direction: 'horizontal',\n  pointer: AlphaPointer\n};\n\nexport default ColorWrap(AlphaPicker);","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n","import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","import Stack from './_Stack.js';\nimport baseIsEqual from './_baseIsEqual.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport default baseIsMatch;\n","import isObject from './isObject.js';\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nexport default isStrictComparable;\n","import isStrictComparable from './_isStrictComparable.js';\nimport keys from './keys.js';\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nexport default getMatchData;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nexport default matchesStrictComparable;\n","import baseIsMatch from './_baseIsMatch.js';\nimport getMatchData from './_getMatchData.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nexport default baseMatches;\n","import isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nexport default isKey;\n","import MapCache from './_MapCache.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nexport default memoize;\n","import memoizeCapped from './_memoizeCapped.js';\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nexport default stringToPath;\n","import memoize from './memoize.js';\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nexport default memoizeCapped;\n","import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n","import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n","import isArray from './isArray.js';\nimport isKey from './_isKey.js';\nimport stringToPath from './_stringToPath.js';\nimport toString from './toString.js';\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nexport default castPath;\n","import isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default toKey;\n","import castPath from './_castPath.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nexport default baseGet;\n","import baseGet from './_baseGet.js';\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nexport default get;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nexport default baseHasIn;\n","import castPath from './_castPath.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isIndex from './_isIndex.js';\nimport isLength from './isLength.js';\nimport toKey from './_toKey.js';\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nexport default hasPath;\n","import baseHasIn from './_baseHasIn.js';\nimport hasPath from './_hasPath.js';\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nexport default hasIn;\n","import baseIsEqual from './_baseIsEqual.js';\nimport get from './get.js';\nimport hasIn from './hasIn.js';\nimport isKey from './_isKey.js';\nimport isStrictComparable from './_isStrictComparable.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\nimport toKey from './_toKey.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nexport default baseMatchesProperty;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default baseProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nexport default basePropertyDeep;\n","import baseProperty from './_baseProperty.js';\nimport basePropertyDeep from './_basePropertyDeep.js';\nimport isKey from './_isKey.js';\nimport toKey from './_toKey.js';\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nexport default property;\n","import baseMatches from './_baseMatches.js';\nimport baseMatchesProperty from './_baseMatchesProperty.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\nimport property from './property.js';\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nexport default baseIteratee;\n","import baseEach from './_baseEach.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nexport default baseMap;\n","import arrayMap from './_arrayMap.js';\nimport baseIteratee from './_baseIteratee.js';\nimport baseMap from './_baseMap.js';\nimport isArray from './isArray.js';\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nexport default map;\n","import React from 'react';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\n\nimport { Swatch } from '../common';\n\nexport var BlockSwatches = function BlockSwatches(_ref) {\n  var colors = _ref.colors,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        marginRight: '-10px'\n      },\n      swatch: {\n        width: '22px',\n        height: '22px',\n        float: 'left',\n        marginRight: '10px',\n        marginBottom: '10px',\n        borderRadius: '4px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatches },\n    map(colors, function (c) {\n      return React.createElement(Swatch, {\n        key: c,\n        color: c,\n        style: styles.swatch,\n        onClick: onClick,\n        onHover: onSwatchHover,\n        focusStyle: {\n          boxShadow: '0 0 4px ' + c\n        }\n      });\n    }),\n    React.createElement('div', { style: styles.clear })\n  );\n};\n\nexport default BlockSwatches;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Checkboard } from '../common';\nimport BlockSwatches from './BlockSwatches';\n\nexport var Block = function Block(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      hex = _ref.hex,\n      colors = _ref.colors,\n      width = _ref.width,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var transparent = hex === 'transparent';\n  var handleChange = function handleChange(hexCode, e) {\n    color.isValidHex(hexCode) && onChange({\n      hex: hexCode,\n      source: 'hex'\n    }, e);\n  };\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        boxShadow: '0 1px rgba(0,0,0,.1)',\n        borderRadius: '6px',\n        position: 'relative'\n      },\n      head: {\n        height: '110px',\n        background: hex,\n        borderRadius: '6px 6px 0 0',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        position: 'relative'\n      },\n      body: {\n        padding: '10px'\n      },\n      label: {\n        fontSize: '18px',\n        color: color.getContrastingColor(hex),\n        position: 'relative'\n      },\n      triangle: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 10px 10px 10px',\n        borderColor: 'transparent transparent ' + hex + ' transparent',\n        position: 'absolute',\n        top: '-10px',\n        left: '50%',\n        marginLeft: '-10px'\n      },\n      input: {\n        width: '100%',\n        fontSize: '12px',\n        color: '#666',\n        border: '0px',\n        outline: 'none',\n        height: '22px',\n        boxShadow: 'inset 0 0 0 1px #ddd',\n        borderRadius: '4px',\n        padding: '0 7px',\n        boxSizing: 'border-box'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      }\n    }\n  }, passedStyles), { 'hide-triangle': triangle === 'hide' });\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'block-picker ' + className },\n    React.createElement('div', { style: styles.triangle }),\n    React.createElement(\n      'div',\n      { style: styles.head },\n      transparent && React.createElement(Checkboard, { borderRadius: '6px 6px 0 0' }),\n      React.createElement(\n        'div',\n        { style: styles.label },\n        hex\n      )\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(BlockSwatches, { colors: colors, onClick: handleChange, onSwatchHover: onSwatchHover }),\n      React.createElement(EditableInput, {\n        style: { input: styles.input },\n        value: hex,\n        onChange: handleChange\n      })\n    )\n  );\n};\n\nBlock.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  triangle: PropTypes.oneOf(['top', 'hide']),\n  styles: PropTypes.object\n};\n\nBlock.defaultProps = {\n  width: 170,\n  colors: ['#D9E3F0', '#F47373', '#697689', '#37D67A', '#2CCCE4', '#555555', '#dce775', '#ff8a65', '#ba68c8'],\n  triangle: 'top',\n  styles: {}\n};\n\nexport default ColorWrap(Block);","export var red = {\"50\":\"#ffebee\",\"100\":\"#ffcdd2\",\"200\":\"#ef9a9a\",\"300\":\"#e57373\",\"400\":\"#ef5350\",\"500\":\"#f44336\",\"600\":\"#e53935\",\"700\":\"#d32f2f\",\"800\":\"#c62828\",\"900\":\"#b71c1c\",\"a100\":\"#ff8a80\",\"a200\":\"#ff5252\",\"a400\":\"#ff1744\",\"a700\":\"#d50000\"};\nexport var pink = {\"50\":\"#fce4ec\",\"100\":\"#f8bbd0\",\"200\":\"#f48fb1\",\"300\":\"#f06292\",\"400\":\"#ec407a\",\"500\":\"#e91e63\",\"600\":\"#d81b60\",\"700\":\"#c2185b\",\"800\":\"#ad1457\",\"900\":\"#880e4f\",\"a100\":\"#ff80ab\",\"a200\":\"#ff4081\",\"a400\":\"#f50057\",\"a700\":\"#c51162\"};\nexport var purple = {\"50\":\"#f3e5f5\",\"100\":\"#e1bee7\",\"200\":\"#ce93d8\",\"300\":\"#ba68c8\",\"400\":\"#ab47bc\",\"500\":\"#9c27b0\",\"600\":\"#8e24aa\",\"700\":\"#7b1fa2\",\"800\":\"#6a1b9a\",\"900\":\"#4a148c\",\"a100\":\"#ea80fc\",\"a200\":\"#e040fb\",\"a400\":\"#d500f9\",\"a700\":\"#aa00ff\"};\nexport var deepPurple = {\"50\":\"#ede7f6\",\"100\":\"#d1c4e9\",\"200\":\"#b39ddb\",\"300\":\"#9575cd\",\"400\":\"#7e57c2\",\"500\":\"#673ab7\",\"600\":\"#5e35b1\",\"700\":\"#512da8\",\"800\":\"#4527a0\",\"900\":\"#311b92\",\"a100\":\"#b388ff\",\"a200\":\"#7c4dff\",\"a400\":\"#651fff\",\"a700\":\"#6200ea\"};\nexport var indigo = {\"50\":\"#e8eaf6\",\"100\":\"#c5cae9\",\"200\":\"#9fa8da\",\"300\":\"#7986cb\",\"400\":\"#5c6bc0\",\"500\":\"#3f51b5\",\"600\":\"#3949ab\",\"700\":\"#303f9f\",\"800\":\"#283593\",\"900\":\"#1a237e\",\"a100\":\"#8c9eff\",\"a200\":\"#536dfe\",\"a400\":\"#3d5afe\",\"a700\":\"#304ffe\"};\nexport var blue = {\"50\":\"#e3f2fd\",\"100\":\"#bbdefb\",\"200\":\"#90caf9\",\"300\":\"#64b5f6\",\"400\":\"#42a5f5\",\"500\":\"#2196f3\",\"600\":\"#1e88e5\",\"700\":\"#1976d2\",\"800\":\"#1565c0\",\"900\":\"#0d47a1\",\"a100\":\"#82b1ff\",\"a200\":\"#448aff\",\"a400\":\"#2979ff\",\"a700\":\"#2962ff\"};\nexport var lightBlue = {\"50\":\"#e1f5fe\",\"100\":\"#b3e5fc\",\"200\":\"#81d4fa\",\"300\":\"#4fc3f7\",\"400\":\"#29b6f6\",\"500\":\"#03a9f4\",\"600\":\"#039be5\",\"700\":\"#0288d1\",\"800\":\"#0277bd\",\"900\":\"#01579b\",\"a100\":\"#80d8ff\",\"a200\":\"#40c4ff\",\"a400\":\"#00b0ff\",\"a700\":\"#0091ea\"};\nexport var cyan = {\"50\":\"#e0f7fa\",\"100\":\"#b2ebf2\",\"200\":\"#80deea\",\"300\":\"#4dd0e1\",\"400\":\"#26c6da\",\"500\":\"#00bcd4\",\"600\":\"#00acc1\",\"700\":\"#0097a7\",\"800\":\"#00838f\",\"900\":\"#006064\",\"a100\":\"#84ffff\",\"a200\":\"#18ffff\",\"a400\":\"#00e5ff\",\"a700\":\"#00b8d4\"};\nexport var teal = {\"50\":\"#e0f2f1\",\"100\":\"#b2dfdb\",\"200\":\"#80cbc4\",\"300\":\"#4db6ac\",\"400\":\"#26a69a\",\"500\":\"#009688\",\"600\":\"#00897b\",\"700\":\"#00796b\",\"800\":\"#00695c\",\"900\":\"#004d40\",\"a100\":\"#a7ffeb\",\"a200\":\"#64ffda\",\"a400\":\"#1de9b6\",\"a700\":\"#00bfa5\"};\nexport var green = {\"50\":\"#e8f5e9\",\"100\":\"#c8e6c9\",\"200\":\"#a5d6a7\",\"300\":\"#81c784\",\"400\":\"#66bb6a\",\"500\":\"#4caf50\",\"600\":\"#43a047\",\"700\":\"#388e3c\",\"800\":\"#2e7d32\",\"900\":\"#1b5e20\",\"a100\":\"#b9f6ca\",\"a200\":\"#69f0ae\",\"a400\":\"#00e676\",\"a700\":\"#00c853\"};\nexport var lightGreen = {\"50\":\"#f1f8e9\",\"100\":\"#dcedc8\",\"200\":\"#c5e1a5\",\"300\":\"#aed581\",\"400\":\"#9ccc65\",\"500\":\"#8bc34a\",\"600\":\"#7cb342\",\"700\":\"#689f38\",\"800\":\"#558b2f\",\"900\":\"#33691e\",\"a100\":\"#ccff90\",\"a200\":\"#b2ff59\",\"a400\":\"#76ff03\",\"a700\":\"#64dd17\"};\nexport var lime = {\"50\":\"#f9fbe7\",\"100\":\"#f0f4c3\",\"200\":\"#e6ee9c\",\"300\":\"#dce775\",\"400\":\"#d4e157\",\"500\":\"#cddc39\",\"600\":\"#c0ca33\",\"700\":\"#afb42b\",\"800\":\"#9e9d24\",\"900\":\"#827717\",\"a100\":\"#f4ff81\",\"a200\":\"#eeff41\",\"a400\":\"#c6ff00\",\"a700\":\"#aeea00\"};\nexport var yellow = {\"50\":\"#fffde7\",\"100\":\"#fff9c4\",\"200\":\"#fff59d\",\"300\":\"#fff176\",\"400\":\"#ffee58\",\"500\":\"#ffeb3b\",\"600\":\"#fdd835\",\"700\":\"#fbc02d\",\"800\":\"#f9a825\",\"900\":\"#f57f17\",\"a100\":\"#ffff8d\",\"a200\":\"#ffff00\",\"a400\":\"#ffea00\",\"a700\":\"#ffd600\"};\nexport var amber = {\"50\":\"#fff8e1\",\"100\":\"#ffecb3\",\"200\":\"#ffe082\",\"300\":\"#ffd54f\",\"400\":\"#ffca28\",\"500\":\"#ffc107\",\"600\":\"#ffb300\",\"700\":\"#ffa000\",\"800\":\"#ff8f00\",\"900\":\"#ff6f00\",\"a100\":\"#ffe57f\",\"a200\":\"#ffd740\",\"a400\":\"#ffc400\",\"a700\":\"#ffab00\"};\nexport var orange = {\"50\":\"#fff3e0\",\"100\":\"#ffe0b2\",\"200\":\"#ffcc80\",\"300\":\"#ffb74d\",\"400\":\"#ffa726\",\"500\":\"#ff9800\",\"600\":\"#fb8c00\",\"700\":\"#f57c00\",\"800\":\"#ef6c00\",\"900\":\"#e65100\",\"a100\":\"#ffd180\",\"a200\":\"#ffab40\",\"a400\":\"#ff9100\",\"a700\":\"#ff6d00\"};\nexport var deepOrange = {\"50\":\"#fbe9e7\",\"100\":\"#ffccbc\",\"200\":\"#ffab91\",\"300\":\"#ff8a65\",\"400\":\"#ff7043\",\"500\":\"#ff5722\",\"600\":\"#f4511e\",\"700\":\"#e64a19\",\"800\":\"#d84315\",\"900\":\"#bf360c\",\"a100\":\"#ff9e80\",\"a200\":\"#ff6e40\",\"a400\":\"#ff3d00\",\"a700\":\"#dd2c00\"};\nexport var brown = {\"50\":\"#efebe9\",\"100\":\"#d7ccc8\",\"200\":\"#bcaaa4\",\"300\":\"#a1887f\",\"400\":\"#8d6e63\",\"500\":\"#795548\",\"600\":\"#6d4c41\",\"700\":\"#5d4037\",\"800\":\"#4e342e\",\"900\":\"#3e2723\"};\nexport var grey = {\"50\":\"#fafafa\",\"100\":\"#f5f5f5\",\"200\":\"#eeeeee\",\"300\":\"#e0e0e0\",\"400\":\"#bdbdbd\",\"500\":\"#9e9e9e\",\"600\":\"#757575\",\"700\":\"#616161\",\"800\":\"#424242\",\"900\":\"#212121\"};\nexport var blueGrey = {\"50\":\"#eceff1\",\"100\":\"#cfd8dc\",\"200\":\"#b0bec5\",\"300\":\"#90a4ae\",\"400\":\"#78909c\",\"500\":\"#607d8b\",\"600\":\"#546e7a\",\"700\":\"#455a64\",\"800\":\"#37474f\",\"900\":\"#263238\"};\nexport var darkText = {\"primary\":\"rgba(0, 0, 0, 0.87)\",\"secondary\":\"rgba(0, 0, 0, 0.54)\",\"disabled\":\"rgba(0, 0, 0, 0.38)\",\"dividers\":\"rgba(0, 0, 0, 0.12)\"};\nexport var lightText = {\"primary\":\"rgba(255, 255, 255, 1)\",\"secondary\":\"rgba(255, 255, 255, 0.7)\",\"disabled\":\"rgba(255, 255, 255, 0.5)\",\"dividers\":\"rgba(255, 255, 255, 0.12)\"};\nexport var darkIcons = {\"active\":\"rgba(0, 0, 0, 0.54)\",\"inactive\":\"rgba(0, 0, 0, 0.38)\"};\nexport var lightIcons = {\"active\":\"rgba(255, 255, 255, 1)\",\"inactive\":\"rgba(255, 255, 255, 0.5)\"};\nexport var white = \"#ffffff\";\nexport var black = \"#000000\";\n\nexport default {\n  red: red,\n  pink: pink,\n  purple: purple,\n  deepPurple: deepPurple,\n  indigo: indigo,\n  blue: blue,\n  lightBlue: lightBlue,\n  cyan: cyan,\n  teal: teal,\n  green: green,\n  lightGreen: lightGreen,\n  lime: lime,\n  yellow: yellow,\n  amber: amber,\n  orange: orange,\n  deepOrange: deepOrange,\n  brown: brown,\n  grey: grey,\n  blueGrey: blueGrey,\n  darkText: darkText,\n  lightText: lightText,\n  darkIcons: darkIcons,\n  lightIcons: lightIcons,\n  white: white,\n  black: black\n};\n","import React from 'react';\nimport reactCSS, { handleHover } from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var CircleSwatch = function CircleSwatch(_ref) {\n  var color = _ref.color,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      hover = _ref.hover,\n      active = _ref.active,\n      circleSize = _ref.circleSize,\n      circleSpacing = _ref.circleSpacing;\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        width: circleSize,\n        height: circleSize,\n        marginRight: circleSpacing,\n        marginBottom: circleSpacing,\n        transform: 'scale(1)',\n        transition: '100ms transform ease'\n      },\n      Swatch: {\n        borderRadius: '50%',\n        background: 'transparent',\n        boxShadow: 'inset 0 0 0 ' + (circleSize / 2 + 1) + 'px ' + color,\n        transition: '100ms box-shadow ease'\n      }\n    },\n    'hover': {\n      swatch: {\n        transform: 'scale(1.2)'\n      }\n    },\n    'active': {\n      Swatch: {\n        boxShadow: 'inset 0 0 0 3px ' + color\n      }\n    }\n  }, { hover: hover, active: active });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatch },\n    React.createElement(Swatch, {\n      style: styles.Swatch,\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: styles.Swatch.boxShadow + ', 0 0 5px ' + color }\n    })\n  );\n};\n\nCircleSwatch.defaultProps = {\n  circleSize: 28,\n  circleSpacing: 14\n};\n\nexport default handleHover(CircleSwatch);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as material from 'material-colors';\n\nimport { ColorWrap } from '../common';\nimport CircleSwatch from './CircleSwatch';\n\nexport var Circle = function Circle(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      circleSize = _ref.circleSize,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      circleSpacing = _ref.circleSpacing,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        display: 'flex',\n        flexWrap: 'wrap',\n        marginRight: -circleSpacing,\n        marginBottom: -circleSpacing\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(hexCode, e) {\n    return onChange({ hex: hexCode, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'circle-picker ' + className },\n    map(colors, function (c) {\n      return React.createElement(CircleSwatch, {\n        key: c,\n        color: c,\n        onClick: handleChange,\n        onSwatchHover: onSwatchHover,\n        active: hex === c.toLowerCase(),\n        circleSize: circleSize,\n        circleSpacing: circleSpacing\n      });\n    })\n  );\n};\n\nCircle.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  circleSize: PropTypes.number,\n  circleSpacing: PropTypes.number,\n  styles: PropTypes.object\n};\n\nCircle.defaultProps = {\n  width: 252,\n  circleSize: 28,\n  circleSpacing: 14,\n  colors: [material.red['500'], material.pink['500'], material.purple['500'], material.deepPurple['500'], material.indigo['500'], material.blue['500'], material.lightBlue['500'], material.cyan['500'], material.teal['500'], material.green['500'], material.lightGreen['500'], material.lime['500'], material.yellow['500'], material.amber['500'], material.orange['500'], material.deepOrange['500'], material.brown['500'], material.blueGrey['500']],\n  styles: {}\n};\n\nexport default ColorWrap(Circle);","/**\n * Checks if `value` is `undefined`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n * @example\n *\n * _.isUndefined(void 0);\n * // => true\n *\n * _.isUndefined(null);\n * // => false\n */\nfunction isUndefined(value) {\n  return value === undefined;\n}\n\nexport default isUndefined;\n","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* eslint-disable react/no-did-mount-set-state, no-param-reassign */\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\nimport isUndefined from 'lodash-es/isUndefined';\n\nimport { EditableInput } from '../common';\nimport UnfoldMoreHorizontalIcon from '@icons/material/UnfoldMoreHorizontalIcon';\n\nexport var ChromeFields = function (_React$Component) {\n  _inherits(ChromeFields, _React$Component);\n\n  function ChromeFields(props) {\n    _classCallCheck(this, ChromeFields);\n\n    var _this = _possibleConstructorReturn(this, (ChromeFields.__proto__ || Object.getPrototypeOf(ChromeFields)).call(this));\n\n    _this.toggleViews = function () {\n      if (_this.state.view === 'hex') {\n        _this.setState({ view: 'rgb' });\n      } else if (_this.state.view === 'rgb') {\n        _this.setState({ view: 'hsl' });\n      } else if (_this.state.view === 'hsl') {\n        if (_this.props.hsl.a === 1) {\n          _this.setState({ view: 'hex' });\n        } else {\n          _this.setState({ view: 'rgb' });\n        }\n      }\n    };\n\n    _this.handleChange = function (data, e) {\n      if (data.hex) {\n        color.isValidHex(data.hex) && _this.props.onChange({\n          hex: data.hex,\n          source: 'hex'\n        }, e);\n      } else if (data.r || data.g || data.b) {\n        _this.props.onChange({\n          r: data.r || _this.props.rgb.r,\n          g: data.g || _this.props.rgb.g,\n          b: data.b || _this.props.rgb.b,\n          source: 'rgb'\n        }, e);\n      } else if (data.a) {\n        if (data.a < 0) {\n          data.a = 0;\n        } else if (data.a > 1) {\n          data.a = 1;\n        }\n\n        _this.props.onChange({\n          h: _this.props.hsl.h,\n          s: _this.props.hsl.s,\n          l: _this.props.hsl.l,\n          a: Math.round(data.a * 100) / 100,\n          source: 'rgb'\n        }, e);\n      } else if (data.h || data.s || data.l) {\n        // Remove any occurances of '%'.\n        if (typeof data.s === 'string' && data.s.includes('%')) {\n          data.s = data.s.replace('%', '');\n        }\n        if (typeof data.l === 'string' && data.l.includes('%')) {\n          data.l = data.l.replace('%', '');\n        }\n\n        // We store HSL as a unit interval so we need to override the 1 input to 0.01\n        if (data.s == 1) {\n          data.s = 0.01;\n        } else if (data.l == 1) {\n          data.l = 0.01;\n        }\n\n        _this.props.onChange({\n          h: data.h || _this.props.hsl.h,\n          s: Number(!isUndefined(data.s) ? data.s : _this.props.hsl.s),\n          l: Number(!isUndefined(data.l) ? data.l : _this.props.hsl.l),\n          source: 'hsl'\n        }, e);\n      }\n    };\n\n    _this.showHighlight = function (e) {\n      e.currentTarget.style.background = '#eee';\n    };\n\n    _this.hideHighlight = function (e) {\n      e.currentTarget.style.background = 'transparent';\n    };\n\n    if (props.hsl.a !== 1 && props.view === \"hex\") {\n      _this.state = {\n        view: \"rgb\"\n      };\n    } else {\n      _this.state = {\n        view: props.view\n      };\n    }\n    return _this;\n  }\n\n  _createClass(ChromeFields, [{\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var styles = reactCSS({\n        'default': {\n          wrap: {\n            paddingTop: '16px',\n            display: 'flex'\n          },\n          fields: {\n            flex: '1',\n            display: 'flex',\n            marginLeft: '-6px'\n          },\n          field: {\n            paddingLeft: '6px',\n            width: '100%'\n          },\n          alpha: {\n            paddingLeft: '6px',\n            width: '100%'\n          },\n          toggle: {\n            width: '32px',\n            textAlign: 'right',\n            position: 'relative'\n          },\n          icon: {\n            marginRight: '-4px',\n            marginTop: '12px',\n            cursor: 'pointer',\n            position: 'relative'\n          },\n          iconHighlight: {\n            position: 'absolute',\n            width: '24px',\n            height: '28px',\n            background: '#eee',\n            borderRadius: '4px',\n            top: '10px',\n            left: '12px',\n            display: 'none'\n          },\n          input: {\n            fontSize: '11px',\n            color: '#333',\n            width: '100%',\n            borderRadius: '2px',\n            border: 'none',\n            boxShadow: 'inset 0 0 0 1px #dadada',\n            height: '21px',\n            textAlign: 'center'\n          },\n          label: {\n            textTransform: 'uppercase',\n            fontSize: '11px',\n            lineHeight: '11px',\n            color: '#969696',\n            textAlign: 'center',\n            display: 'block',\n            marginTop: '12px'\n          },\n          svg: {\n            fill: '#333',\n            width: '24px',\n            height: '24px',\n            border: '1px transparent solid',\n            borderRadius: '5px'\n          }\n        },\n        'disableAlpha': {\n          alpha: {\n            display: 'none'\n          }\n        }\n      }, this.props, this.state);\n\n      var fields = void 0;\n      if (this.state.view === 'hex') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'hex', value: this.props.hex,\n              onChange: this.handleChange\n            })\n          )\n        );\n      } else if (this.state.view === 'rgb') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'r',\n              value: this.props.rgb.r,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'g',\n              value: this.props.rgb.g,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'b',\n              value: this.props.rgb.b,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'a',\n              value: this.props.rgb.a,\n              arrowOffset: 0.01,\n              onChange: this.handleChange\n            })\n          )\n        );\n      } else if (this.state.view === 'hsl') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'h',\n              value: Math.round(this.props.hsl.h),\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 's',\n              value: Math.round(this.props.hsl.s * 100) + '%',\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'l',\n              value: Math.round(this.props.hsl.l * 100) + '%',\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'a',\n              value: this.props.hsl.a,\n              arrowOffset: 0.01,\n              onChange: this.handleChange\n            })\n          )\n        );\n      }\n\n      return React.createElement(\n        'div',\n        { style: styles.wrap, className: 'flexbox-fix' },\n        fields,\n        React.createElement(\n          'div',\n          { style: styles.toggle },\n          React.createElement(\n            'div',\n            { style: styles.icon, onClick: this.toggleViews, ref: function ref(icon) {\n                return _this2.icon = icon;\n              } },\n            React.createElement(UnfoldMoreHorizontalIcon, {\n              style: styles.svg,\n              onMouseOver: this.showHighlight,\n              onMouseEnter: this.showHighlight,\n              onMouseOut: this.hideHighlight\n            })\n          )\n        )\n      );\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, state) {\n      if (nextProps.hsl.a !== 1 && state.view === 'hex') {\n        return { view: 'rgb' };\n      }\n      return null;\n    }\n  }]);\n\n  return ChromeFields;\n}(React.Component);\n\nChromeFields.defaultProps = {\n  view: \"hex\"\n};\n\nexport default ChromeFields;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var ChromePointer = function ChromePointer() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        transform: 'translate(-6px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default ChromePointer;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var ChromePointerCircle = function ChromePointerCircle() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        boxShadow: 'inset 0 0 0 1px #fff',\n        transform: 'translate(-6px, -6px)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default ChromePointerCircle;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue, Alpha, Checkboard } from '../common';\nimport ChromeFields from './ChromeFields';\nimport ChromePointer from './ChromePointer';\nimport ChromePointerCircle from './ChromePointerCircle';\n\nexport var Chrome = function Chrome(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      disableAlpha = _ref.disableAlpha,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hsv = _ref.hsv,\n      hex = _ref.hex,\n      renderers = _ref.renderers,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className,\n      defaultView = _ref.defaultView;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        background: '#fff',\n        borderRadius: '2px',\n        boxShadow: '0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)',\n        boxSizing: 'initial',\n        fontFamily: 'Menlo'\n      },\n      saturation: {\n        width: '100%',\n        paddingBottom: '55%',\n        position: 'relative',\n        borderRadius: '2px 2px 0 0',\n        overflow: 'hidden'\n      },\n      Saturation: {\n        radius: '2px 2px 0 0'\n      },\n      body: {\n        padding: '16px 16px 12px'\n      },\n      controls: {\n        display: 'flex'\n      },\n      color: {\n        width: '32px'\n      },\n      swatch: {\n        marginTop: '6px',\n        width: '16px',\n        height: '16px',\n        borderRadius: '8px',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      active: {\n        absolute: '0px 0px 0px 0px',\n        borderRadius: '8px',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.1)',\n        background: 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', ' + rgb.a + ')',\n        zIndex: '2'\n      },\n      toggles: {\n        flex: '1'\n      },\n      hue: {\n        height: '10px',\n        position: 'relative',\n        marginBottom: '8px'\n      },\n      Hue: {\n        radius: '2px'\n      },\n      alpha: {\n        height: '10px',\n        position: 'relative'\n      },\n      Alpha: {\n        radius: '2px'\n      }\n    },\n    'disableAlpha': {\n      color: {\n        width: '22px'\n      },\n      alpha: {\n        display: 'none'\n      },\n      hue: {\n        marginBottom: '0px'\n      },\n      swatch: {\n        width: '10px',\n        height: '10px',\n        marginTop: '0px'\n      }\n    }\n  }, passedStyles), { disableAlpha: disableAlpha });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'chrome-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        style: styles.Saturation,\n        hsl: hsl,\n        hsv: hsv,\n        pointer: ChromePointerCircle,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(\n        'div',\n        { style: styles.controls, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.color },\n          React.createElement(\n            'div',\n            { style: styles.swatch },\n            React.createElement('div', { style: styles.active }),\n            React.createElement(Checkboard, { renderers: renderers })\n          )\n        ),\n        React.createElement(\n          'div',\n          { style: styles.toggles },\n          React.createElement(\n            'div',\n            { style: styles.hue },\n            React.createElement(Hue, {\n              style: styles.Hue,\n              hsl: hsl,\n              pointer: ChromePointer,\n              onChange: onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(Alpha, {\n              style: styles.Alpha,\n              rgb: rgb,\n              hsl: hsl,\n              pointer: ChromePointer,\n              renderers: renderers,\n              onChange: onChange\n            })\n          )\n        )\n      ),\n      React.createElement(ChromeFields, {\n        rgb: rgb,\n        hsl: hsl,\n        hex: hex,\n        view: defaultView,\n        onChange: onChange,\n        disableAlpha: disableAlpha\n      })\n    )\n  );\n};\n\nChrome.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  disableAlpha: PropTypes.bool,\n  styles: PropTypes.object,\n  defaultView: PropTypes.oneOf([\"hex\", \"rgb\", \"hsl\"])\n};\n\nChrome.defaultProps = {\n  width: 225,\n  disableAlpha: false,\n  styles: {}\n};\n\nexport default ColorWrap(Chrome);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as colorUtils from '../../helpers/color';\n\nimport { Swatch } from '../common';\n\nexport var CompactColor = function CompactColor(_ref) {\n  var color = _ref.color,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      color: {\n        background: color,\n        width: '15px',\n        height: '15px',\n        float: 'left',\n        marginRight: '5px',\n        marginBottom: '5px',\n        position: 'relative',\n        cursor: 'pointer'\n      },\n      dot: {\n        absolute: '5px 5px 5px 5px',\n        background: colorUtils.getContrastingColor(color),\n        borderRadius: '50%',\n        opacity: '0'\n      }\n    },\n    'active': {\n      dot: {\n        opacity: '1'\n      }\n    },\n    'color-#FFFFFF': {\n      color: {\n        boxShadow: 'inset 0 0 0 1px #ddd'\n      },\n      dot: {\n        background: '#000'\n      }\n    },\n    'transparent': {\n      dot: {\n        background: '#000'\n      }\n    }\n  }, { active: active, 'color-#FFFFFF': color === '#FFFFFF', 'transparent': color === 'transparent' });\n\n  return React.createElement(\n    Swatch,\n    {\n      style: styles.color,\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: '0 0 4px ' + color }\n    },\n    React.createElement('div', { style: styles.dot })\n  );\n};\n\nexport default CompactColor;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nimport { EditableInput } from '../common';\n\nexport var CompactFields = function CompactFields(_ref) {\n  var hex = _ref.hex,\n      rgb = _ref.rgb,\n      onChange = _ref.onChange;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        display: 'flex',\n        paddingBottom: '6px',\n        paddingRight: '5px',\n        position: 'relative'\n      },\n      active: {\n        position: 'absolute',\n        top: '6px',\n        left: '5px',\n        height: '9px',\n        width: '9px',\n        background: hex\n      },\n      HEXwrap: {\n        flex: '6',\n        position: 'relative'\n      },\n      HEXinput: {\n        width: '80%',\n        padding: '0px',\n        paddingLeft: '20%',\n        border: 'none',\n        outline: 'none',\n        background: 'none',\n        fontSize: '12px',\n        color: '#333',\n        height: '16px'\n      },\n      HEXlabel: {\n        display: 'none'\n      },\n      RGBwrap: {\n        flex: '3',\n        position: 'relative'\n      },\n      RGBinput: {\n        width: '70%',\n        padding: '0px',\n        paddingLeft: '30%',\n        border: 'none',\n        outline: 'none',\n        background: 'none',\n        fontSize: '12px',\n        color: '#333',\n        height: '16px'\n      },\n      RGBlabel: {\n        position: 'absolute',\n        top: '3px',\n        left: '0px',\n        lineHeight: '16px',\n        textTransform: 'uppercase',\n        fontSize: '12px',\n        color: '#999'\n      }\n    }\n  });\n\n  var handleChange = function handleChange(data, e) {\n    if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    } else {\n      onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields, className: 'flexbox-fix' },\n    React.createElement('div', { style: styles.active }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n      label: 'hex',\n      value: hex,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'r',\n      value: rgb.r,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'g',\n      value: rgb.g,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'b',\n      value: rgb.b,\n      onChange: handleChange\n    })\n  );\n};\n\nexport default CompactFields;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, Raised } from '../common';\nimport CompactColor from './CompactColor';\nimport CompactFields from './CompactFields';\n\nexport var Compact = function Compact(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      rgb = _ref.rgb,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      Compact: {\n        background: '#f6f6f6',\n        radius: '4px'\n      },\n      compact: {\n        paddingTop: '5px',\n        paddingLeft: '5px',\n        boxSizing: 'initial',\n        width: '240px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else {\n      onChange(data, e);\n    }\n  };\n\n  return React.createElement(\n    Raised,\n    { style: styles.Compact, styles: passedStyles },\n    React.createElement(\n      'div',\n      { style: styles.compact, className: 'compact-picker ' + className },\n      React.createElement(\n        'div',\n        null,\n        map(colors, function (c) {\n          return React.createElement(CompactColor, {\n            key: c,\n            color: c,\n            active: c.toLowerCase() === hex,\n            onClick: handleChange,\n            onSwatchHover: onSwatchHover\n          });\n        }),\n        React.createElement('div', { style: styles.clear })\n      ),\n      React.createElement(CompactFields, { hex: hex, rgb: rgb, onChange: handleChange })\n    )\n  );\n};\n\nCompact.propTypes = {\n  colors: PropTypes.arrayOf(PropTypes.string),\n  styles: PropTypes.object\n};\n\nCompact.defaultProps = {\n  colors: ['#4D4D4D', '#999999', '#FFFFFF', '#F44E3B', '#FE9200', '#FCDC00', '#DBDF00', '#A4DD00', '#68CCCA', '#73D8FF', '#AEA1FF', '#FDA1FF', '#333333', '#808080', '#cccccc', '#D33115', '#E27300', '#FCC400', '#B0BC00', '#68BC00', '#16A5A5', '#009CE0', '#7B64FF', '#FA28FF', '#000000', '#666666', '#B3B3B3', '#9F0500', '#C45100', '#FB9E00', '#808900', '#194D33', '#0C797D', '#0062B1', '#653294', '#AB149E'],\n  styles: {}\n};\n\nexport default ColorWrap(Compact);","import React from 'react';\nimport reactCSS, { handleHover } from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var GithubSwatch = function GithubSwatch(_ref) {\n  var hover = _ref.hover,\n      color = _ref.color,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var hoverSwatch = {\n    position: 'relative',\n    zIndex: '2',\n    outline: '2px solid #fff',\n    boxShadow: '0 0 5px 2px rgba(0,0,0,0.25)'\n  };\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        width: '25px',\n        height: '25px',\n        fontSize: '0'\n      }\n    },\n    'hover': {\n      swatch: hoverSwatch\n    }\n  }, { hover: hover });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatch },\n    React.createElement(Swatch, {\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: hoverSwatch\n    })\n  );\n};\n\nexport default handleHover(GithubSwatch);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap } from '../common';\nimport GithubSwatch from './GithubSwatch';\n\nexport var Github = function Github(_ref) {\n  var width = _ref.width,\n      colors = _ref.colors,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        border: '1px solid rgba(0,0,0,0.2)',\n        boxShadow: '0 3px 12px rgba(0,0,0,0.15)',\n        borderRadius: '4px',\n        position: 'relative',\n        padding: '5px',\n        display: 'flex',\n        flexWrap: 'wrap'\n      },\n      triangle: {\n        position: 'absolute',\n        border: '7px solid transparent',\n        borderBottomColor: '#fff'\n      },\n      triangleShadow: {\n        position: 'absolute',\n        border: '8px solid transparent',\n        borderBottomColor: 'rgba(0,0,0,0.15)'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      },\n      triangleShadow: {\n        display: 'none'\n      }\n    },\n    'top-left-triangle': {\n      triangle: {\n        top: '-14px',\n        left: '10px'\n      },\n      triangleShadow: {\n        top: '-16px',\n        left: '9px'\n      }\n    },\n    'top-right-triangle': {\n      triangle: {\n        top: '-14px',\n        right: '10px'\n      },\n      triangleShadow: {\n        top: '-16px',\n        right: '9px'\n      }\n    },\n    'bottom-left-triangle': {\n      triangle: {\n        top: '35px',\n        left: '10px',\n        transform: 'rotate(180deg)'\n      },\n      triangleShadow: {\n        top: '37px',\n        left: '9px',\n        transform: 'rotate(180deg)'\n      }\n    },\n    'bottom-right-triangle': {\n      triangle: {\n        top: '35px',\n        right: '10px',\n        transform: 'rotate(180deg)'\n      },\n      triangleShadow: {\n        top: '37px',\n        right: '9px',\n        transform: 'rotate(180deg)'\n      }\n    }\n  }, passedStyles), {\n    'hide-triangle': triangle === 'hide',\n    'top-left-triangle': triangle === 'top-left',\n    'top-right-triangle': triangle === 'top-right',\n    'bottom-left-triangle': triangle === 'bottom-left',\n    'bottom-right-triangle': triangle === 'bottom-right'\n  });\n\n  var handleChange = function handleChange(hex, e) {\n    return onChange({ hex: hex, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'github-picker ' + className },\n    React.createElement('div', { style: styles.triangleShadow }),\n    React.createElement('div', { style: styles.triangle }),\n    map(colors, function (c) {\n      return React.createElement(GithubSwatch, {\n        color: c,\n        key: c,\n        onClick: handleChange,\n        onSwatchHover: onSwatchHover\n      });\n    })\n  );\n};\n\nGithub.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  triangle: PropTypes.oneOf(['hide', 'top-left', 'top-right', 'bottom-left', 'bottom-right']),\n  styles: PropTypes.object\n};\n\nGithub.defaultProps = {\n  width: 200,\n  colors: ['#B80000', '#DB3E00', '#FCCB00', '#008B02', '#006B76', '#1273DE', '#004DCF', '#5300EB', '#EB9694', '#FAD0C3', '#FEF3BD', '#C1E1C5', '#BEDADC', '#C4DEF6', '#BED3F3', '#D4C4FB'],\n  triangle: 'top-left',\n  styles: {}\n};\n\nexport default ColorWrap(Github);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderPointer = function SliderPointer(_ref) {\n  var direction = _ref.direction;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '18px',\n        height: '18px',\n        borderRadius: '50%',\n        transform: 'translate(-9px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    },\n    'vertical': {\n      picker: {\n        transform: 'translate(-3px, -9px)'\n      }\n    }\n  }, { vertical: direction === 'vertical' });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default SliderPointer;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Hue } from '../common';\nimport HuePointer from './HuePointer';\n\nexport var HuePicker = function HuePicker(_ref) {\n  var width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      hsl = _ref.hsl,\n      direction = _ref.direction,\n      pointer = _ref.pointer,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        position: 'relative',\n        width: width,\n        height: height\n      },\n      hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n\n  // Overwrite to provide pure hue color\n  var handleChange = function handleChange(data) {\n    return onChange({ a: 1, h: data.h, l: 0.5, s: 1 });\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'hue-picker ' + className },\n    React.createElement(Hue, _extends({}, styles.hue, {\n      hsl: hsl,\n      pointer: pointer,\n      onChange: handleChange,\n      direction: direction\n    }))\n  );\n};\n\nHuePicker.propTypes = {\n  styles: PropTypes.object\n};\nHuePicker.defaultProps = {\n  width: '316px',\n  height: '16px',\n  direction: 'horizontal',\n  pointer: HuePointer,\n  styles: {}\n};\n\nexport default ColorWrap(HuePicker);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Raised } from '../common';\n\nexport var Material = function Material(_ref) {\n  var onChange = _ref.onChange,\n      hex = _ref.hex,\n      rgb = _ref.rgb,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      material: {\n        width: '98px',\n        height: '98px',\n        padding: '16px',\n        fontFamily: 'Roboto'\n      },\n      HEXwrap: {\n        position: 'relative'\n      },\n      HEXinput: {\n        width: '100%',\n        marginTop: '12px',\n        fontSize: '15px',\n        color: '#333',\n        padding: '0px',\n        border: '0px',\n        borderBottom: '2px solid ' + hex,\n        outline: 'none',\n        height: '30px'\n      },\n      HEXlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        fontSize: '11px',\n        color: '#999999',\n        textTransform: 'capitalize'\n      },\n      Hex: {\n        style: {}\n      },\n      RGBwrap: {\n        position: 'relative'\n      },\n      RGBinput: {\n        width: '100%',\n        marginTop: '12px',\n        fontSize: '15px',\n        color: '#333',\n        padding: '0px',\n        border: '0px',\n        borderBottom: '1px solid #eee',\n        outline: 'none',\n        height: '30px'\n      },\n      RGBlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        fontSize: '11px',\n        color: '#999999',\n        textTransform: 'capitalize'\n      },\n      split: {\n        display: 'flex',\n        marginRight: '-10px',\n        paddingTop: '11px'\n      },\n      third: {\n        flex: '1',\n        paddingRight: '10px'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    Raised,\n    { styles: passedStyles },\n    React.createElement(\n      'div',\n      { style: styles.material, className: 'material-picker ' + className },\n      React.createElement(EditableInput, {\n        style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n        label: 'hex',\n        value: hex,\n        onChange: handleChange\n      }),\n      React.createElement(\n        'div',\n        { style: styles.split, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'r', value: rgb.r,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'g',\n            value: rgb.g,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'b',\n            value: rgb.b,\n            onChange: handleChange\n          })\n        )\n      )\n    )\n  );\n};\n\nexport default ColorWrap(Material);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\n\nimport { EditableInput } from '../common';\n\nexport var PhotoshopPicker = function PhotoshopPicker(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsv = _ref.hsv,\n      hex = _ref.hex;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        paddingTop: '5px',\n        paddingBottom: '9px',\n        width: '80px',\n        position: 'relative'\n      },\n      divider: {\n        height: '5px'\n      },\n      RGBwrap: {\n        position: 'relative'\n      },\n      RGBinput: {\n        marginLeft: '40%',\n        width: '40%',\n        height: '18px',\n        border: '1px solid #888888',\n        boxShadow: 'inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC',\n        marginBottom: '5px',\n        fontSize: '13px',\n        paddingLeft: '3px',\n        marginRight: '10px'\n      },\n      RGBlabel: {\n        left: '0px',\n        top: '0px',\n        width: '34px',\n        textTransform: 'uppercase',\n        fontSize: '13px',\n        height: '18px',\n        lineHeight: '22px',\n        position: 'absolute'\n      },\n      HEXwrap: {\n        position: 'relative'\n      },\n      HEXinput: {\n        marginLeft: '20%',\n        width: '80%',\n        height: '18px',\n        border: '1px solid #888888',\n        boxShadow: 'inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC',\n        marginBottom: '6px',\n        fontSize: '13px',\n        paddingLeft: '3px'\n      },\n      HEXlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        width: '14px',\n        textTransform: 'uppercase',\n        fontSize: '13px',\n        height: '18px',\n        lineHeight: '22px'\n      },\n      fieldSymbols: {\n        position: 'absolute',\n        top: '5px',\n        right: '-7px',\n        fontSize: '13px'\n      },\n      symbol: {\n        height: '20px',\n        lineHeight: '22px',\n        paddingBottom: '7px'\n      }\n    }\n  });\n\n  var handleChange = function handleChange(data, e) {\n    if (data['#']) {\n      color.isValidHex(data['#']) && onChange({\n        hex: data['#'],\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    } else if (data.h || data.s || data.v) {\n      onChange({\n        h: data.h || hsv.h,\n        s: data.s || hsv.s,\n        v: data.v || hsv.v,\n        source: 'hsv'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields },\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'h',\n      value: Math.round(hsv.h),\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 's',\n      value: Math.round(hsv.s * 100),\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'v',\n      value: Math.round(hsv.v * 100),\n      onChange: handleChange\n    }),\n    React.createElement('div', { style: styles.divider }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'r',\n      value: rgb.r,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'g',\n      value: rgb.g,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'b',\n      value: rgb.b,\n      onChange: handleChange\n    }),\n    React.createElement('div', { style: styles.divider }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n      label: '#',\n      value: hex.replace('#', ''),\n      onChange: handleChange\n    }),\n    React.createElement(\n      'div',\n      { style: styles.fieldSymbols },\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '\\xB0'\n      ),\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '%'\n      ),\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '%'\n      )\n    )\n  );\n};\n\nexport default PhotoshopPicker;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPointerCircle = function PhotoshopPointerCircle(_ref) {\n  var hsl = _ref.hsl;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        boxShadow: 'inset 0 0 0 1px #fff',\n        transform: 'translate(-6px, -6px)'\n      }\n    },\n    'black-outline': {\n      picker: {\n        boxShadow: 'inset 0 0 0 1px #000'\n      }\n    }\n  }, { 'black-outline': hsl.l > 0.5 });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default PhotoshopPointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPointerCircle = function PhotoshopPointerCircle() {\n  var styles = reactCSS({\n    'default': {\n      triangle: {\n        width: 0,\n        height: 0,\n        borderStyle: 'solid',\n        borderWidth: '4px 0 4px 6px',\n        borderColor: 'transparent transparent transparent #fff',\n        position: 'absolute',\n        top: '1px',\n        left: '1px'\n      },\n      triangleBorder: {\n        width: 0,\n        height: 0,\n        borderStyle: 'solid',\n        borderWidth: '5px 0 5px 8px',\n        borderColor: 'transparent transparent transparent #555'\n      },\n\n      left: {\n        Extend: 'triangleBorder',\n        transform: 'translate(-13px, -4px)'\n      },\n      leftInside: {\n        Extend: 'triangle',\n        transform: 'translate(-8px, -5px)'\n      },\n\n      right: {\n        Extend: 'triangleBorder',\n        transform: 'translate(20px, -14px) rotate(180deg)'\n      },\n      rightInside: {\n        Extend: 'triangle',\n        transform: 'translate(-8px, -5px)'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.pointer },\n    React.createElement(\n      'div',\n      { style: styles.left },\n      React.createElement('div', { style: styles.leftInside })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.right },\n      React.createElement('div', { style: styles.rightInside })\n    )\n  );\n};\n\nexport default PhotoshopPointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopButton = function PhotoshopButton(_ref) {\n  var onClick = _ref.onClick,\n      label = _ref.label,\n      children = _ref.children,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      button: {\n        backgroundImage: 'linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)',\n        border: '1px solid #878787',\n        borderRadius: '2px',\n        height: '20px',\n        boxShadow: '0 1px 0 0 #EAEAEA',\n        fontSize: '14px',\n        color: '#000',\n        lineHeight: '20px',\n        textAlign: 'center',\n        marginBottom: '10px',\n        cursor: 'pointer'\n      }\n    },\n    'active': {\n      button: {\n        boxShadow: '0 0 0 1px #878787'\n      }\n    }\n  }, { active: active });\n\n  return React.createElement(\n    'div',\n    { style: styles.button, onClick: onClick },\n    label || children\n  );\n};\n\nexport default PhotoshopButton;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPreviews = function PhotoshopPreviews(_ref) {\n  var rgb = _ref.rgb,\n      currentColor = _ref.currentColor;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        border: '1px solid #B3B3B3',\n        borderBottom: '1px solid #F0F0F0',\n        marginBottom: '2px',\n        marginTop: '1px'\n      },\n      new: {\n        height: '34px',\n        background: 'rgb(' + rgb.r + ',' + rgb.g + ', ' + rgb.b + ')',\n        boxShadow: 'inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000'\n      },\n      current: {\n        height: '34px',\n        background: currentColor,\n        boxShadow: 'inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000'\n      },\n      label: {\n        fontSize: '14px',\n        color: '#000',\n        textAlign: 'center'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    null,\n    React.createElement(\n      'div',\n      { style: styles.label },\n      'new'\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatches },\n      React.createElement('div', { style: styles.new }),\n      React.createElement('div', { style: styles.current })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.label },\n      'current'\n    )\n  );\n};\n\nexport default PhotoshopPreviews;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue } from '../common';\nimport PhotoshopFields from './PhotoshopFields';\nimport PhotoshopPointerCircle from './PhotoshopPointerCircle';\nimport PhotoshopPointer from './PhotoshopPointer';\nimport PhotoshopButton from './PhotoshopButton';\nimport PhotoshopPreviews from './PhotoshopPreviews';\n\nexport var Photoshop = function (_React$Component) {\n  _inherits(Photoshop, _React$Component);\n\n  function Photoshop(props) {\n    _classCallCheck(this, Photoshop);\n\n    var _this = _possibleConstructorReturn(this, (Photoshop.__proto__ || Object.getPrototypeOf(Photoshop)).call(this));\n\n    _this.state = {\n      currentColor: props.hex\n    };\n    return _this;\n  }\n\n  _createClass(Photoshop, [{\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          _props$styles = _props.styles,\n          passedStyles = _props$styles === undefined ? {} : _props$styles,\n          _props$className = _props.className,\n          className = _props$className === undefined ? '' : _props$className;\n\n      var styles = reactCSS(merge({\n        'default': {\n          picker: {\n            background: '#DCDCDC',\n            borderRadius: '4px',\n            boxShadow: '0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)',\n            boxSizing: 'initial',\n            width: '513px'\n          },\n          head: {\n            backgroundImage: 'linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)',\n            borderBottom: '1px solid #B1B1B1',\n            boxShadow: 'inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)',\n            height: '23px',\n            lineHeight: '24px',\n            borderRadius: '4px 4px 0 0',\n            fontSize: '13px',\n            color: '#4D4D4D',\n            textAlign: 'center'\n          },\n          body: {\n            padding: '15px 15px 0',\n            display: 'flex'\n          },\n          saturation: {\n            width: '256px',\n            height: '256px',\n            position: 'relative',\n            border: '2px solid #B3B3B3',\n            borderBottom: '2px solid #F0F0F0',\n            overflow: 'hidden'\n          },\n          hue: {\n            position: 'relative',\n            height: '256px',\n            width: '19px',\n            marginLeft: '10px',\n            border: '2px solid #B3B3B3',\n            borderBottom: '2px solid #F0F0F0'\n          },\n          controls: {\n            width: '180px',\n            marginLeft: '10px'\n          },\n          top: {\n            display: 'flex'\n          },\n          previews: {\n            width: '60px'\n          },\n          actions: {\n            flex: '1',\n            marginLeft: '20px'\n          }\n        }\n      }, passedStyles));\n\n      return React.createElement(\n        'div',\n        { style: styles.picker, className: 'photoshop-picker ' + className },\n        React.createElement(\n          'div',\n          { style: styles.head },\n          this.props.header\n        ),\n        React.createElement(\n          'div',\n          { style: styles.body, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.saturation },\n            React.createElement(Saturation, {\n              hsl: this.props.hsl,\n              hsv: this.props.hsv,\n              pointer: PhotoshopPointerCircle,\n              onChange: this.props.onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.hue },\n            React.createElement(Hue, {\n              direction: 'vertical',\n              hsl: this.props.hsl,\n              pointer: PhotoshopPointer,\n              onChange: this.props.onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.controls },\n            React.createElement(\n              'div',\n              { style: styles.top, className: 'flexbox-fix' },\n              React.createElement(\n                'div',\n                { style: styles.previews },\n                React.createElement(PhotoshopPreviews, {\n                  rgb: this.props.rgb,\n                  currentColor: this.state.currentColor\n                })\n              ),\n              React.createElement(\n                'div',\n                { style: styles.actions },\n                React.createElement(PhotoshopButton, { label: 'OK', onClick: this.props.onAccept, active: true }),\n                React.createElement(PhotoshopButton, { label: 'Cancel', onClick: this.props.onCancel }),\n                React.createElement(PhotoshopFields, {\n                  onChange: this.props.onChange,\n                  rgb: this.props.rgb,\n                  hsv: this.props.hsv,\n                  hex: this.props.hex\n                })\n              )\n            )\n          )\n        )\n      );\n    }\n  }]);\n\n  return Photoshop;\n}(React.Component);\n\nPhotoshop.propTypes = {\n  header: PropTypes.string,\n  styles: PropTypes.object\n};\n\nPhotoshop.defaultProps = {\n  header: 'Color Picker',\n  styles: {}\n};\n\nexport default ColorWrap(Photoshop);","/* eslint-disable no-param-reassign */\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\n\nimport { EditableInput } from '../common';\n\nexport var SketchFields = function SketchFields(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hex = _ref.hex,\n      disableAlpha = _ref.disableAlpha;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        display: 'flex',\n        paddingTop: '4px'\n      },\n      single: {\n        flex: '1',\n        paddingLeft: '6px'\n      },\n      alpha: {\n        flex: '1',\n        paddingLeft: '6px'\n      },\n      double: {\n        flex: '2'\n      },\n      input: {\n        width: '80%',\n        padding: '4px 10% 3px',\n        border: 'none',\n        boxShadow: 'inset 0 0 0 1px #ccc',\n        fontSize: '11px'\n      },\n      label: {\n        display: 'block',\n        textAlign: 'center',\n        fontSize: '11px',\n        color: '#222',\n        paddingTop: '3px',\n        paddingBottom: '4px',\n        textTransform: 'capitalize'\n      }\n    },\n    'disableAlpha': {\n      alpha: {\n        display: 'none'\n      }\n    }\n  }, { disableAlpha: disableAlpha });\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        a: rgb.a,\n        source: 'rgb'\n      }, e);\n    } else if (data.a) {\n      if (data.a < 0) {\n        data.a = 0;\n      } else if (data.a > 100) {\n        data.a = 100;\n      }\n\n      data.a /= 100;\n      onChange({\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: data.a,\n        source: 'rgb'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields, className: 'flexbox-fix' },\n    React.createElement(\n      'div',\n      { style: styles.double },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'hex',\n        value: hex.replace('#', ''),\n        onChange: handleChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'r',\n        value: rgb.r,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'g',\n        value: rgb.g,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'b',\n        value: rgb.b,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.alpha },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'a',\n        value: Math.round(rgb.a * 100),\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '100'\n      })\n    )\n  );\n};\n\nexport default SketchFields;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var SketchPresetColors = function SketchPresetColors(_ref) {\n  var colors = _ref.colors,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var styles = reactCSS({\n    'default': {\n      colors: {\n        margin: '0 -10px',\n        padding: '10px 0 0 10px',\n        borderTop: '1px solid #eee',\n        display: 'flex',\n        flexWrap: 'wrap',\n        position: 'relative'\n      },\n      swatchWrap: {\n        width: '16px',\n        height: '16px',\n        margin: '0 10px 10px 0'\n      },\n      swatch: {\n        borderRadius: '3px',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15)'\n      }\n    },\n    'no-presets': {\n      colors: {\n        display: 'none'\n      }\n    }\n  }, {\n    'no-presets': !colors || !colors.length\n  });\n\n  var handleClick = function handleClick(hex, e) {\n    onClick({\n      hex: hex,\n      source: 'hex'\n    }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.colors, className: 'flexbox-fix' },\n    colors.map(function (colorObjOrString) {\n      var c = typeof colorObjOrString === 'string' ? { color: colorObjOrString } : colorObjOrString;\n      var key = '' + c.color + (c.title || '');\n      return React.createElement(\n        'div',\n        { key: key, style: styles.swatchWrap },\n        React.createElement(Swatch, _extends({}, c, {\n          style: styles.swatch,\n          onClick: handleClick,\n          onHover: onSwatchHover,\n          focusStyle: {\n            boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px ' + c.color\n          }\n        }))\n      );\n    })\n  );\n};\n\nSketchPresetColors.propTypes = {\n  colors: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.shape({\n    color: PropTypes.string,\n    title: PropTypes.string\n  })])).isRequired\n};\n\nexport default SketchPresetColors;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue, Alpha, Checkboard } from '../common';\nimport SketchFields from './SketchFields';\nimport SketchPresetColors from './SketchPresetColors';\n\nexport var Sketch = function Sketch(_ref) {\n  var width = _ref.width,\n      rgb = _ref.rgb,\n      hex = _ref.hex,\n      hsv = _ref.hsv,\n      hsl = _ref.hsl,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      disableAlpha = _ref.disableAlpha,\n      presetColors = _ref.presetColors,\n      renderers = _ref.renderers,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': _extends({\n      picker: {\n        width: width,\n        padding: '10px 10px 0',\n        boxSizing: 'initial',\n        background: '#fff',\n        borderRadius: '4px',\n        boxShadow: '0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)'\n      },\n      saturation: {\n        width: '100%',\n        paddingBottom: '75%',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      Saturation: {\n        radius: '3px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n      controls: {\n        display: 'flex'\n      },\n      sliders: {\n        padding: '4px 0',\n        flex: '1'\n      },\n      color: {\n        width: '24px',\n        height: '24px',\n        position: 'relative',\n        marginTop: '4px',\n        marginLeft: '4px',\n        borderRadius: '3px'\n      },\n      activeColor: {\n        absolute: '0px 0px 0px 0px',\n        borderRadius: '2px',\n        background: 'rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ',' + rgb.a + ')',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n      hue: {\n        position: 'relative',\n        height: '10px',\n        overflow: 'hidden'\n      },\n      Hue: {\n        radius: '2px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n\n      alpha: {\n        position: 'relative',\n        height: '10px',\n        marginTop: '4px',\n        overflow: 'hidden'\n      },\n      Alpha: {\n        radius: '2px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      }\n    }, passedStyles),\n    'disableAlpha': {\n      color: {\n        height: '10px'\n      },\n      hue: {\n        height: '10px'\n      },\n      alpha: {\n        display: 'none'\n      }\n    }\n  }, passedStyles), { disableAlpha: disableAlpha });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'sketch-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        style: styles.Saturation,\n        hsl: hsl,\n        hsv: hsv,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.controls, className: 'flexbox-fix' },\n      React.createElement(\n        'div',\n        { style: styles.sliders },\n        React.createElement(\n          'div',\n          { style: styles.hue },\n          React.createElement(Hue, {\n            style: styles.Hue,\n            hsl: hsl,\n            onChange: onChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.alpha },\n          React.createElement(Alpha, {\n            style: styles.Alpha,\n            rgb: rgb,\n            hsl: hsl,\n            renderers: renderers,\n            onChange: onChange\n          })\n        )\n      ),\n      React.createElement(\n        'div',\n        { style: styles.color },\n        React.createElement(Checkboard, null),\n        React.createElement('div', { style: styles.activeColor })\n      )\n    ),\n    React.createElement(SketchFields, {\n      rgb: rgb,\n      hsl: hsl,\n      hex: hex,\n      onChange: onChange,\n      disableAlpha: disableAlpha\n    }),\n    React.createElement(SketchPresetColors, {\n      colors: presetColors,\n      onClick: onChange,\n      onSwatchHover: onSwatchHover\n    })\n  );\n};\n\nSketch.propTypes = {\n  disableAlpha: PropTypes.bool,\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  styles: PropTypes.object\n};\n\nSketch.defaultProps = {\n  disableAlpha: false,\n  width: 200,\n  styles: {},\n  presetColors: ['#D0021B', '#F5A623', '#F8E71C', '#8B572A', '#7ED321', '#417505', '#BD10E0', '#9013FE', '#4A90E2', '#50E3C2', '#B8E986', '#000000', '#4A4A4A', '#9B9B9B', '#FFFFFF']\n};\n\nexport default ColorWrap(Sketch);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderSwatch = function SliderSwatch(_ref) {\n  var hsl = _ref.hsl,\n      offset = _ref.offset,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      active = _ref.active,\n      first = _ref.first,\n      last = _ref.last;\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        height: '12px',\n        background: 'hsl(' + hsl.h + ', 50%, ' + offset * 100 + '%)',\n        cursor: 'pointer'\n      }\n    },\n    'first': {\n      swatch: {\n        borderRadius: '2px 0 0 2px'\n      }\n    },\n    'last': {\n      swatch: {\n        borderRadius: '0 2px 2px 0'\n      }\n    },\n    'active': {\n      swatch: {\n        transform: 'scaleY(1.8)',\n        borderRadius: '3.6px/2px'\n      }\n    }\n  }, { active: active, first: first, last: last });\n\n  var handleClick = function handleClick(e) {\n    return onClick({\n      h: hsl.h,\n      s: 0.5,\n      l: offset,\n      source: 'hsl'\n    }, e);\n  };\n\n  return React.createElement('div', { style: styles.swatch, onClick: handleClick });\n};\n\nexport default SliderSwatch;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nimport SliderSwatch from './SliderSwatch';\n\nexport var SliderSwatches = function SliderSwatches(_ref) {\n  var onClick = _ref.onClick,\n      hsl = _ref.hsl;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        marginTop: '20px'\n      },\n      swatch: {\n        boxSizing: 'border-box',\n        width: '20%',\n        paddingRight: '1px',\n        float: 'left'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  });\n\n  // Acceptible difference in floating point equality\n  var epsilon = 0.1;\n\n  return React.createElement(\n    'div',\n    { style: styles.swatches },\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.80',\n        active: Math.abs(hsl.l - 0.80) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick,\n        first: true\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.65',\n        active: Math.abs(hsl.l - 0.65) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.50',\n        active: Math.abs(hsl.l - 0.50) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.35',\n        active: Math.abs(hsl.l - 0.35) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.20',\n        active: Math.abs(hsl.l - 0.20) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick,\n        last: true\n      })\n    ),\n    React.createElement('div', { style: styles.clear })\n  );\n};\n\nexport default SliderSwatches;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderPointer = function SliderPointer() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '14px',\n        height: '14px',\n        borderRadius: '6px',\n        transform: 'translate(-7px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default SliderPointer;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Hue } from '../common';\nimport SliderSwatches from './SliderSwatches';\nimport SliderPointer from './SliderPointer';\n\nexport var Slider = function Slider(_ref) {\n  var hsl = _ref.hsl,\n      onChange = _ref.onChange,\n      pointer = _ref.pointer,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      hue: {\n        height: '12px',\n        position: 'relative'\n      },\n      Hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap || {}, className: 'slider-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.hue },\n      React.createElement(Hue, {\n        style: styles.Hue,\n        hsl: hsl,\n        pointer: pointer,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatches },\n      React.createElement(SliderSwatches, { hsl: hsl, onClick: onChange })\n    )\n  );\n};\n\nSlider.propTypes = {\n  styles: PropTypes.object\n};\nSlider.defaultProps = {\n  pointer: SliderPointer,\n  styles: {}\n};\n\nexport default ColorWrap(Slider);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as colorUtils from '../../helpers/color';\n\nimport { Swatch } from '../common';\nimport CheckIcon from '@icons/material/CheckIcon';\n\nexport var SwatchesColor = function SwatchesColor(_ref) {\n  var color = _ref.color,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      first = _ref.first,\n      last = _ref.last,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      color: {\n        width: '40px',\n        height: '24px',\n        cursor: 'pointer',\n        background: color,\n        marginBottom: '1px'\n      },\n      check: {\n        color: colorUtils.getContrastingColor(color),\n        marginLeft: '8px',\n        display: 'none'\n      }\n    },\n    'first': {\n      color: {\n        overflow: 'hidden',\n        borderRadius: '2px 2px 0 0'\n      }\n    },\n    'last': {\n      color: {\n        overflow: 'hidden',\n        borderRadius: '0 0 2px 2px'\n      }\n    },\n    'active': {\n      check: {\n        display: 'block'\n      }\n    },\n    'color-#FFFFFF': {\n      color: {\n        boxShadow: 'inset 0 0 0 1px #ddd'\n      },\n      check: {\n        color: '#333'\n      }\n    },\n    'transparent': {\n      check: {\n        color: '#333'\n      }\n    }\n  }, {\n    first: first,\n    last: last,\n    active: active,\n    'color-#FFFFFF': color === '#FFFFFF',\n    'transparent': color === 'transparent'\n  });\n\n  return React.createElement(\n    Swatch,\n    {\n      color: color,\n      style: styles.color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: '0 0 4px ' + color }\n    },\n    React.createElement(\n      'div',\n      { style: styles.check },\n      React.createElement(CheckIcon, null)\n    )\n  );\n};\n\nexport default SwatchesColor;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\n\nimport SwatchesColor from './SwatchesColor';\n\nexport var SwatchesGroup = function SwatchesGroup(_ref) {\n  var onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      group = _ref.group,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      group: {\n        paddingBottom: '10px',\n        width: '40px',\n        float: 'left',\n        marginRight: '10px'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.group },\n    map(group, function (color, i) {\n      return React.createElement(SwatchesColor, {\n        key: color,\n        color: color,\n        active: color.toLowerCase() === active,\n        first: i === 0,\n        last: i === group.length - 1,\n        onClick: onClick,\n        onSwatchHover: onSwatchHover\n      });\n    })\n  );\n};\n\nexport default SwatchesGroup;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as material from 'material-colors';\n\nimport { ColorWrap, Raised } from '../common';\nimport SwatchesGroup from './SwatchesGroup';\n\nexport var Swatches = function Swatches(_ref) {\n  var width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        height: height\n      },\n      overflow: {\n        height: height,\n        overflowY: 'scroll'\n      },\n      body: {\n        padding: '16px 0 6px 16px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    return onChange({ hex: data, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'swatches-picker ' + className },\n    React.createElement(\n      Raised,\n      null,\n      React.createElement(\n        'div',\n        { style: styles.overflow },\n        React.createElement(\n          'div',\n          { style: styles.body },\n          map(colors, function (group) {\n            return React.createElement(SwatchesGroup, {\n              key: group.toString(),\n              group: group,\n              active: hex,\n              onClick: handleChange,\n              onSwatchHover: onSwatchHover\n            });\n          }),\n          React.createElement('div', { style: styles.clear })\n        )\n      )\n    )\n  );\n};\n\nSwatches.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string)),\n  styles: PropTypes.object\n\n  /* eslint-disable max-len */\n};Swatches.defaultProps = {\n  width: 320,\n  height: 240,\n  colors: [[material.red['900'], material.red['700'], material.red['500'], material.red['300'], material.red['100']], [material.pink['900'], material.pink['700'], material.pink['500'], material.pink['300'], material.pink['100']], [material.purple['900'], material.purple['700'], material.purple['500'], material.purple['300'], material.purple['100']], [material.deepPurple['900'], material.deepPurple['700'], material.deepPurple['500'], material.deepPurple['300'], material.deepPurple['100']], [material.indigo['900'], material.indigo['700'], material.indigo['500'], material.indigo['300'], material.indigo['100']], [material.blue['900'], material.blue['700'], material.blue['500'], material.blue['300'], material.blue['100']], [material.lightBlue['900'], material.lightBlue['700'], material.lightBlue['500'], material.lightBlue['300'], material.lightBlue['100']], [material.cyan['900'], material.cyan['700'], material.cyan['500'], material.cyan['300'], material.cyan['100']], [material.teal['900'], material.teal['700'], material.teal['500'], material.teal['300'], material.teal['100']], ['#194D33', material.green['700'], material.green['500'], material.green['300'], material.green['100']], [material.lightGreen['900'], material.lightGreen['700'], material.lightGreen['500'], material.lightGreen['300'], material.lightGreen['100']], [material.lime['900'], material.lime['700'], material.lime['500'], material.lime['300'], material.lime['100']], [material.yellow['900'], material.yellow['700'], material.yellow['500'], material.yellow['300'], material.yellow['100']], [material.amber['900'], material.amber['700'], material.amber['500'], material.amber['300'], material.amber['100']], [material.orange['900'], material.orange['700'], material.orange['500'], material.orange['300'], material.orange['100']], [material.deepOrange['900'], material.deepOrange['700'], material.deepOrange['500'], material.deepOrange['300'], material.deepOrange['100']], [material.brown['900'], material.brown['700'], material.brown['500'], material.brown['300'], material.brown['100']], [material.blueGrey['900'], material.blueGrey['700'], material.blueGrey['500'], material.blueGrey['300'], material.blueGrey['100']], ['#000000', '#525252', '#969696', '#D9D9D9', '#FFFFFF']],\n  styles: {}\n};\n\nexport default ColorWrap(Swatches);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Swatch } from '../common';\n\nexport var Twitter = function Twitter(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      hex = _ref.hex,\n      colors = _ref.colors,\n      width = _ref.width,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        border: '0 solid rgba(0,0,0,0.25)',\n        boxShadow: '0 1px 4px rgba(0,0,0,0.25)',\n        borderRadius: '4px',\n        position: 'relative'\n      },\n      body: {\n        padding: '15px 9px 9px 15px'\n      },\n      label: {\n        fontSize: '18px',\n        color: '#fff'\n      },\n      triangle: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 9px 10px 9px',\n        borderColor: 'transparent transparent #fff transparent',\n        position: 'absolute'\n      },\n      triangleShadow: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 9px 10px 9px',\n        borderColor: 'transparent transparent rgba(0,0,0,.1) transparent',\n        position: 'absolute'\n      },\n      hash: {\n        background: '#F0F0F0',\n        height: '30px',\n        width: '30px',\n        borderRadius: '4px 0 0 4px',\n        float: 'left',\n        color: '#98A1A4',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center'\n      },\n      input: {\n        width: '100px',\n        fontSize: '14px',\n        color: '#666',\n        border: '0px',\n        outline: 'none',\n        height: '28px',\n        boxShadow: 'inset 0 0 0 1px #F0F0F0',\n        boxSizing: 'content-box',\n        borderRadius: '0 4px 4px 0',\n        float: 'left',\n        paddingLeft: '8px'\n      },\n      swatch: {\n        width: '30px',\n        height: '30px',\n        float: 'left',\n        borderRadius: '4px',\n        margin: '0 6px 6px 0'\n      },\n      clear: {\n        clear: 'both'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      },\n      triangleShadow: {\n        display: 'none'\n      }\n    },\n    'top-left-triangle': {\n      triangle: {\n        top: '-10px',\n        left: '12px'\n      },\n      triangleShadow: {\n        top: '-11px',\n        left: '12px'\n      }\n    },\n    'top-right-triangle': {\n      triangle: {\n        top: '-10px',\n        right: '12px'\n      },\n      triangleShadow: {\n        top: '-11px',\n        right: '12px'\n      }\n    }\n  }, passedStyles), {\n    'hide-triangle': triangle === 'hide',\n    'top-left-triangle': triangle === 'top-left',\n    'top-right-triangle': triangle === 'top-right'\n  });\n\n  var handleChange = function handleChange(hexcode, e) {\n    color.isValidHex(hexcode) && onChange({\n      hex: hexcode,\n      source: 'hex'\n    }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'twitter-picker ' + className },\n    React.createElement('div', { style: styles.triangleShadow }),\n    React.createElement('div', { style: styles.triangle }),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      map(colors, function (c, i) {\n        return React.createElement(Swatch, {\n          key: i,\n          color: c,\n          hex: c,\n          style: styles.swatch,\n          onClick: handleChange,\n          onHover: onSwatchHover,\n          focusStyle: {\n            boxShadow: '0 0 4px ' + c\n          }\n        });\n      }),\n      React.createElement(\n        'div',\n        { style: styles.hash },\n        '#'\n      ),\n      React.createElement(EditableInput, {\n        label: null,\n        style: { input: styles.input },\n        value: hex.replace('#', ''),\n        onChange: handleChange\n      }),\n      React.createElement('div', { style: styles.clear })\n    )\n  );\n};\n\nTwitter.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  triangle: PropTypes.oneOf(['hide', 'top-left', 'top-right']),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  styles: PropTypes.object\n};\n\nTwitter.defaultProps = {\n  width: 276,\n  colors: ['#FF6900', '#FCB900', '#7BDCB5', '#00D084', '#8ED1FC', '#0693E3', '#ABB8C3', '#EB144C', '#F78DA7', '#9900EF'],\n  triangle: 'top-left',\n  styles: {}\n};\n\nexport default ColorWrap(Twitter);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport PropTypes from 'prop-types';\n\nexport var GooglePointerCircle = function GooglePointerCircle(props) {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '20px',\n        height: '20px',\n        borderRadius: '22px',\n        border: '2px #fff solid',\n        transform: 'translate(-12px, -13px)',\n        background: 'hsl(' + Math.round(props.hsl.h) + ', ' + Math.round(props.hsl.s * 100) + '%, ' + Math.round(props.hsl.l * 100) + '%)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nGooglePointerCircle.propTypes = {\n  hsl: PropTypes.shape({\n    h: PropTypes.number,\n    s: PropTypes.number,\n    l: PropTypes.number,\n    a: PropTypes.number\n  })\n};\n\nGooglePointerCircle.defaultProps = {\n  hsl: { a: 1, h: 249.94, l: 0.2, s: 0.50 }\n};\n\nexport default GooglePointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport PropTypes from 'prop-types';\n\nexport var GooglePointer = function GooglePointer(props) {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '20px',\n        height: '20px',\n        borderRadius: '22px',\n        transform: 'translate(-10px, -7px)',\n        background: 'hsl(' + Math.round(props.hsl.h) + ', 100%, 50%)',\n        border: '2px white solid'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nGooglePointer.propTypes = {\n  hsl: PropTypes.shape({\n    h: PropTypes.number,\n    s: PropTypes.number,\n    l: PropTypes.number,\n    a: PropTypes.number\n  })\n};\n\nGooglePointer.defaultProps = {\n  hsl: { a: 1, h: 249.94, l: 0.2, s: 0.50 }\n};\n\nexport default GooglePointer;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\nimport { EditableInput } from '../common';\n\nexport var GoogleFields = function GoogleFields(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hex = _ref.hex,\n      hsv = _ref.hsv;\n\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.rgb) {\n      var values = data.rgb.split(',');\n      color.isvalidColorString(data.rgb, 'rgb') && onChange({\n        r: values[0],\n        g: values[1],\n        b: values[2],\n        a: 1,\n        source: 'rgb'\n      }, e);\n    } else if (data.hsv) {\n      var _values = data.hsv.split(',');\n      if (color.isvalidColorString(data.hsv, 'hsv')) {\n        _values[2] = _values[2].replace('%', '');\n        _values[1] = _values[1].replace('%', '');\n        _values[0] = _values[0].replace('', '');\n        if (_values[1] == 1) {\n          _values[1] = 0.01;\n        } else if (_values[2] == 1) {\n          _values[2] = 0.01;\n        }\n        onChange({\n          h: Number(_values[0]),\n          s: Number(_values[1]),\n          v: Number(_values[2]),\n          source: 'hsv'\n        }, e);\n      }\n    } else if (data.hsl) {\n      var _values2 = data.hsl.split(',');\n      if (color.isvalidColorString(data.hsl, 'hsl')) {\n        _values2[2] = _values2[2].replace('%', '');\n        _values2[1] = _values2[1].replace('%', '');\n        _values2[0] = _values2[0].replace('', '');\n        if (hsvValue[1] == 1) {\n          hsvValue[1] = 0.01;\n        } else if (hsvValue[2] == 1) {\n          hsvValue[2] = 0.01;\n        }\n        onChange({\n          h: Number(_values2[0]),\n          s: Number(_values2[1]),\n          v: Number(_values2[2]),\n          source: 'hsl'\n        }, e);\n      }\n    }\n  };\n\n  var styles = reactCSS({\n    'default': {\n      wrap: {\n        display: 'flex',\n        height: '100px',\n        marginTop: '4px'\n      },\n      fields: {\n        width: '100%'\n      },\n      column: {\n        paddingTop: '10px',\n        display: 'flex',\n        justifyContent: 'space-between'\n      },\n      double: {\n        padding: '0px 4.4px',\n        boxSizing: 'border-box'\n      },\n      input: {\n        width: '100%',\n        height: '38px',\n        boxSizing: 'border-box',\n        padding: '4px 10% 3px',\n        textAlign: 'center',\n        border: '1px solid #dadce0',\n        fontSize: '11px',\n        textTransform: 'lowercase',\n        borderRadius: '5px',\n        outline: 'none',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      input2: {\n        height: '38px',\n        width: '100%',\n        border: '1px solid #dadce0',\n        boxSizing: 'border-box',\n        fontSize: '11px',\n        textTransform: 'lowercase',\n        borderRadius: '5px',\n        outline: 'none',\n        paddingLeft: '10px',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      label: {\n        textAlign: 'center',\n        fontSize: '12px',\n        background: '#fff',\n        position: 'absolute',\n        textTransform: 'uppercase',\n        color: '#3c4043',\n        width: '35px',\n        top: '-6px',\n        left: '0',\n        right: '0',\n        marginLeft: 'auto',\n        marginRight: 'auto',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      label2: {\n        left: '10px',\n        textAlign: 'center',\n        fontSize: '12px',\n        background: '#fff',\n        position: 'absolute',\n        textTransform: 'uppercase',\n        color: '#3c4043',\n        width: '32px',\n        top: '-6px',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      single: {\n        flexGrow: '1',\n        margin: '0px 4.4px'\n      }\n    }\n  });\n\n  var rgbValue = rgb.r + ', ' + rgb.g + ', ' + rgb.b;\n  var hslValue = Math.round(hsl.h) + '\\xB0, ' + Math.round(hsl.s * 100) + '%, ' + Math.round(hsl.l * 100) + '%';\n  var hsvValue = Math.round(hsv.h) + '\\xB0, ' + Math.round(hsv.s * 100) + '%, ' + Math.round(hsv.v * 100) + '%';\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap, className: 'flexbox-fix' },\n    React.createElement(\n      'div',\n      { style: styles.fields },\n      React.createElement(\n        'div',\n        { style: styles.double },\n        React.createElement(EditableInput, {\n          style: { input: styles.input, label: styles.label },\n          label: 'hex',\n          value: hex,\n          onChange: handleChange\n        })\n      ),\n      React.createElement(\n        'div',\n        { style: styles.column },\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'rgb',\n            value: rgbValue,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'hsv',\n            value: hsvValue,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'hsl',\n            value: hslValue,\n            onChange: handleChange\n          })\n        )\n      )\n    )\n  );\n};\n\nexport default GoogleFields;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue } from '../common';\nimport GooglePointerCircle from './GooglePointerCircle';\nimport GooglePointer from './GooglePointer';\nimport GoogleFields from './GoogleFields';\n\nexport var Google = function Google(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hsv = _ref.hsv,\n      hex = _ref.hex,\n      header = _ref.header,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        background: '#fff',\n        border: '1px solid #dfe1e5',\n        boxSizing: 'initial',\n        display: 'flex',\n        flexWrap: 'wrap',\n        borderRadius: '8px 8px 0px 0px'\n      },\n      head: {\n        height: '57px',\n        width: '100%',\n        paddingTop: '16px',\n        paddingBottom: '16px',\n        paddingLeft: '16px',\n        fontSize: '20px',\n        boxSizing: 'border-box',\n        fontFamily: 'Roboto-Regular,HelveticaNeue,Arial,sans-serif'\n      },\n      saturation: {\n        width: '70%',\n        padding: '0px',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      swatch: {\n        width: '30%',\n        height: '228px',\n        padding: '0px',\n        background: 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', 1)',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      body: {\n        margin: 'auto',\n        width: '95%'\n      },\n      controls: {\n        display: 'flex',\n        boxSizing: 'border-box',\n        height: '52px',\n        paddingTop: '22px'\n      },\n      color: {\n        width: '32px'\n      },\n      hue: {\n        height: '8px',\n        position: 'relative',\n        margin: '0px 16px 0px 16px',\n        width: '100%'\n      },\n      Hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'google-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.head },\n      header\n    ),\n    React.createElement('div', { style: styles.swatch }),\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        hsl: hsl,\n        hsv: hsv,\n        pointer: GooglePointerCircle,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(\n        'div',\n        { style: styles.controls, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.hue },\n          React.createElement(Hue, {\n            style: styles.Hue,\n            hsl: hsl,\n            radius: '4px',\n            pointer: GooglePointer,\n            onChange: onChange\n          })\n        )\n      ),\n      React.createElement(GoogleFields, {\n        rgb: rgb,\n        hsl: hsl,\n        hex: hex,\n        hsv: hsv,\n        onChange: onChange\n      })\n    )\n  );\n};\n\nGoogle.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  styles: PropTypes.object,\n  header: PropTypes.string\n\n};\n\nGoogle.defaultProps = {\n  width: 652,\n  styles: {},\n  header: 'Color picker'\n};\n\nexport default ColorWrap(Google);","import _extends from '@babel/runtime/helpers/esm/extends';\nimport _assertThisInitialized from '@babel/runtime/helpers/esm/assertThisInitialized';\nimport _inheritsLoose from '@babel/runtime/helpers/esm/inheritsLoose';\nimport memoizeOne from 'memoize-one';\nimport { createElement, PureComponent } from 'react';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\n\n// Animation frame based implementation of setTimeout.\n// Inspired by Joe Lambert, https://gist.github.com/joelambert/1002116#file-requesttimeout-js\nvar hasNativePerformanceNow = typeof performance === 'object' && typeof performance.now === 'function';\nvar now = hasNativePerformanceNow ? function () {\n  return performance.now();\n} : function () {\n  return Date.now();\n};\nfunction cancelTimeout(timeoutID) {\n  cancelAnimationFrame(timeoutID.id);\n}\nfunction requestTimeout(callback, delay) {\n  var start = now();\n\n  function tick() {\n    if (now() - start >= delay) {\n      callback.call(null);\n    } else {\n      timeoutID.id = requestAnimationFrame(tick);\n    }\n  }\n\n  var timeoutID = {\n    id: requestAnimationFrame(tick)\n  };\n  return timeoutID;\n}\n\nvar size = -1; // This utility copied from \"dom-helpers\" package.\n\nfunction getScrollbarSize(recalculate) {\n  if (recalculate === void 0) {\n    recalculate = false;\n  }\n\n  if (size === -1 || recalculate) {\n    var div = document.createElement('div');\n    var style = div.style;\n    style.width = '50px';\n    style.height = '50px';\n    style.overflow = 'scroll';\n    document.body.appendChild(div);\n    size = div.offsetWidth - div.clientWidth;\n    document.body.removeChild(div);\n  }\n\n  return size;\n}\nvar cachedRTLResult = null; // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n// Chrome does not seem to adhere; its scrollLeft values are positive (measured relative to the left).\n// Safari's elastic bounce makes detecting this even more complicated wrt potential false positives.\n// The safest way to check this is to intentionally set a negative offset,\n// and then verify that the subsequent \"scroll\" event matches the negative offset.\n// If it does not match, then we can assume a non-standard RTL scroll implementation.\n\nfunction getRTLOffsetType(recalculate) {\n  if (recalculate === void 0) {\n    recalculate = false;\n  }\n\n  if (cachedRTLResult === null || recalculate) {\n    var outerDiv = document.createElement('div');\n    var outerStyle = outerDiv.style;\n    outerStyle.width = '50px';\n    outerStyle.height = '50px';\n    outerStyle.overflow = 'scroll';\n    outerStyle.direction = 'rtl';\n    var innerDiv = document.createElement('div');\n    var innerStyle = innerDiv.style;\n    innerStyle.width = '100px';\n    innerStyle.height = '100px';\n    outerDiv.appendChild(innerDiv);\n    document.body.appendChild(outerDiv);\n\n    if (outerDiv.scrollLeft > 0) {\n      cachedRTLResult = 'positive-descending';\n    } else {\n      outerDiv.scrollLeft = 1;\n\n      if (outerDiv.scrollLeft === 0) {\n        cachedRTLResult = 'negative';\n      } else {\n        cachedRTLResult = 'positive-ascending';\n      }\n    }\n\n    document.body.removeChild(outerDiv);\n    return cachedRTLResult;\n  }\n\n  return cachedRTLResult;\n}\n\nvar IS_SCROLLING_DEBOUNCE_INTERVAL = 150;\n\nvar defaultItemKey = function defaultItemKey(_ref) {\n  var columnIndex = _ref.columnIndex,\n      data = _ref.data,\n      rowIndex = _ref.rowIndex;\n  return rowIndex + \":\" + columnIndex;\n}; // In DEV mode, this Set helps us only log a warning once per component instance.\n// This avoids spamming the console every time a render happens.\n\n\nvar devWarningsOverscanCount = null;\nvar devWarningsOverscanRowsColumnsCount = null;\nvar devWarningsTagName = null;\n\nif (process.env.NODE_ENV !== 'production') {\n  if (typeof window !== 'undefined' && typeof window.WeakSet !== 'undefined') {\n    devWarningsOverscanCount = /*#__PURE__*/new WeakSet();\n    devWarningsOverscanRowsColumnsCount = /*#__PURE__*/new WeakSet();\n    devWarningsTagName = /*#__PURE__*/new WeakSet();\n  }\n}\n\nfunction createGridComponent(_ref2) {\n  var _class;\n\n  var getColumnOffset = _ref2.getColumnOffset,\n      getColumnStartIndexForOffset = _ref2.getColumnStartIndexForOffset,\n      getColumnStopIndexForStartIndex = _ref2.getColumnStopIndexForStartIndex,\n      getColumnWidth = _ref2.getColumnWidth,\n      getEstimatedTotalHeight = _ref2.getEstimatedTotalHeight,\n      getEstimatedTotalWidth = _ref2.getEstimatedTotalWidth,\n      getOffsetForColumnAndAlignment = _ref2.getOffsetForColumnAndAlignment,\n      getOffsetForRowAndAlignment = _ref2.getOffsetForRowAndAlignment,\n      getRowHeight = _ref2.getRowHeight,\n      getRowOffset = _ref2.getRowOffset,\n      getRowStartIndexForOffset = _ref2.getRowStartIndexForOffset,\n      getRowStopIndexForStartIndex = _ref2.getRowStopIndexForStartIndex,\n      initInstanceProps = _ref2.initInstanceProps,\n      shouldResetStyleCacheOnItemSizeChange = _ref2.shouldResetStyleCacheOnItemSizeChange,\n      validateProps = _ref2.validateProps;\n  return _class = /*#__PURE__*/function (_PureComponent) {\n    _inheritsLoose(Grid, _PureComponent);\n\n    // Always use explicit constructor for React components.\n    // It produces less code after transpilation. (#26)\n    // eslint-disable-next-line no-useless-constructor\n    function Grid(props) {\n      var _this;\n\n      _this = _PureComponent.call(this, props) || this;\n      _this._instanceProps = initInstanceProps(_this.props, _assertThisInitialized(_this));\n      _this._resetIsScrollingTimeoutId = null;\n      _this._outerRef = void 0;\n      _this.state = {\n        instance: _assertThisInitialized(_this),\n        isScrolling: false,\n        horizontalScrollDirection: 'forward',\n        scrollLeft: typeof _this.props.initialScrollLeft === 'number' ? _this.props.initialScrollLeft : 0,\n        scrollTop: typeof _this.props.initialScrollTop === 'number' ? _this.props.initialScrollTop : 0,\n        scrollUpdateWasRequested: false,\n        verticalScrollDirection: 'forward'\n      };\n      _this._callOnItemsRendered = void 0;\n      _this._callOnItemsRendered = memoizeOne(function (overscanColumnStartIndex, overscanColumnStopIndex, overscanRowStartIndex, overscanRowStopIndex, visibleColumnStartIndex, visibleColumnStopIndex, visibleRowStartIndex, visibleRowStopIndex) {\n        return _this.props.onItemsRendered({\n          overscanColumnStartIndex: overscanColumnStartIndex,\n          overscanColumnStopIndex: overscanColumnStopIndex,\n          overscanRowStartIndex: overscanRowStartIndex,\n          overscanRowStopIndex: overscanRowStopIndex,\n          visibleColumnStartIndex: visibleColumnStartIndex,\n          visibleColumnStopIndex: visibleColumnStopIndex,\n          visibleRowStartIndex: visibleRowStartIndex,\n          visibleRowStopIndex: visibleRowStopIndex\n        });\n      });\n      _this._callOnScroll = void 0;\n      _this._callOnScroll = memoizeOne(function (scrollLeft, scrollTop, horizontalScrollDirection, verticalScrollDirection, scrollUpdateWasRequested) {\n        return _this.props.onScroll({\n          horizontalScrollDirection: horizontalScrollDirection,\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          verticalScrollDirection: verticalScrollDirection,\n          scrollUpdateWasRequested: scrollUpdateWasRequested\n        });\n      });\n      _this._getItemStyle = void 0;\n\n      _this._getItemStyle = function (rowIndex, columnIndex) {\n        var _this$props = _this.props,\n            columnWidth = _this$props.columnWidth,\n            direction = _this$props.direction,\n            rowHeight = _this$props.rowHeight;\n\n        var itemStyleCache = _this._getItemStyleCache(shouldResetStyleCacheOnItemSizeChange && columnWidth, shouldResetStyleCacheOnItemSizeChange && direction, shouldResetStyleCacheOnItemSizeChange && rowHeight);\n\n        var key = rowIndex + \":\" + columnIndex;\n        var style;\n\n        if (itemStyleCache.hasOwnProperty(key)) {\n          style = itemStyleCache[key];\n        } else {\n          var _offset = getColumnOffset(_this.props, columnIndex, _this._instanceProps);\n\n          var isRtl = direction === 'rtl';\n          itemStyleCache[key] = style = {\n            position: 'absolute',\n            left: isRtl ? undefined : _offset,\n            right: isRtl ? _offset : undefined,\n            top: getRowOffset(_this.props, rowIndex, _this._instanceProps),\n            height: getRowHeight(_this.props, rowIndex, _this._instanceProps),\n            width: getColumnWidth(_this.props, columnIndex, _this._instanceProps)\n          };\n        }\n\n        return style;\n      };\n\n      _this._getItemStyleCache = void 0;\n      _this._getItemStyleCache = memoizeOne(function (_, __, ___) {\n        return {};\n      });\n\n      _this._onScroll = function (event) {\n        var _event$currentTarget = event.currentTarget,\n            clientHeight = _event$currentTarget.clientHeight,\n            clientWidth = _event$currentTarget.clientWidth,\n            scrollLeft = _event$currentTarget.scrollLeft,\n            scrollTop = _event$currentTarget.scrollTop,\n            scrollHeight = _event$currentTarget.scrollHeight,\n            scrollWidth = _event$currentTarget.scrollWidth;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollLeft === scrollLeft && prevState.scrollTop === scrollTop) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          }\n\n          var direction = _this.props.direction; // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n          // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n          // It's also easier for this component if we convert offsets to the same format as they would be in for ltr.\n          // So the simplest solution is to determine which browser behavior we're dealing with, and convert based on it.\n\n          var calculatedScrollLeft = scrollLeft;\n\n          if (direction === 'rtl') {\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                calculatedScrollLeft = -scrollLeft;\n                break;\n\n              case 'positive-descending':\n                calculatedScrollLeft = scrollWidth - clientWidth - scrollLeft;\n                break;\n            }\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          calculatedScrollLeft = Math.max(0, Math.min(calculatedScrollLeft, scrollWidth - clientWidth));\n          var calculatedScrollTop = Math.max(0, Math.min(scrollTop, scrollHeight - clientHeight));\n          return {\n            isScrolling: true,\n            horizontalScrollDirection: prevState.scrollLeft < scrollLeft ? 'forward' : 'backward',\n            scrollLeft: calculatedScrollLeft,\n            scrollTop: calculatedScrollTop,\n            verticalScrollDirection: prevState.scrollTop < scrollTop ? 'forward' : 'backward',\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._outerRefSetter = function (ref) {\n        var outerRef = _this.props.outerRef;\n        _this._outerRef = ref;\n\n        if (typeof outerRef === 'function') {\n          outerRef(ref);\n        } else if (outerRef != null && typeof outerRef === 'object' && outerRef.hasOwnProperty('current')) {\n          outerRef.current = ref;\n        }\n      };\n\n      _this._resetIsScrollingDebounced = function () {\n        if (_this._resetIsScrollingTimeoutId !== null) {\n          cancelTimeout(_this._resetIsScrollingTimeoutId);\n        }\n\n        _this._resetIsScrollingTimeoutId = requestTimeout(_this._resetIsScrolling, IS_SCROLLING_DEBOUNCE_INTERVAL);\n      };\n\n      _this._resetIsScrolling = function () {\n        _this._resetIsScrollingTimeoutId = null;\n\n        _this.setState({\n          isScrolling: false\n        }, function () {\n          // Clear style cache after state update has been committed.\n          // This way we don't break pure sCU for items that don't use isScrolling param.\n          _this._getItemStyleCache(-1);\n        });\n      };\n\n      return _this;\n    }\n\n    Grid.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n      validateSharedProps(nextProps, prevState);\n      validateProps(nextProps);\n      return null;\n    };\n\n    var _proto = Grid.prototype;\n\n    _proto.scrollTo = function scrollTo(_ref3) {\n      var scrollLeft = _ref3.scrollLeft,\n          scrollTop = _ref3.scrollTop;\n\n      if (scrollLeft !== undefined) {\n        scrollLeft = Math.max(0, scrollLeft);\n      }\n\n      if (scrollTop !== undefined) {\n        scrollTop = Math.max(0, scrollTop);\n      }\n\n      this.setState(function (prevState) {\n        if (scrollLeft === undefined) {\n          scrollLeft = prevState.scrollLeft;\n        }\n\n        if (scrollTop === undefined) {\n          scrollTop = prevState.scrollTop;\n        }\n\n        if (prevState.scrollLeft === scrollLeft && prevState.scrollTop === scrollTop) {\n          return null;\n        }\n\n        return {\n          horizontalScrollDirection: prevState.scrollLeft < scrollLeft ? 'forward' : 'backward',\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          scrollUpdateWasRequested: true,\n          verticalScrollDirection: prevState.scrollTop < scrollTop ? 'forward' : 'backward'\n        };\n      }, this._resetIsScrollingDebounced);\n    };\n\n    _proto.scrollToItem = function scrollToItem(_ref4) {\n      var _ref4$align = _ref4.align,\n          align = _ref4$align === void 0 ? 'auto' : _ref4$align,\n          columnIndex = _ref4.columnIndex,\n          rowIndex = _ref4.rowIndex;\n      var _this$props2 = this.props,\n          columnCount = _this$props2.columnCount,\n          height = _this$props2.height,\n          rowCount = _this$props2.rowCount,\n          width = _this$props2.width;\n      var _this$state = this.state,\n          scrollLeft = _this$state.scrollLeft,\n          scrollTop = _this$state.scrollTop;\n      var scrollbarSize = getScrollbarSize();\n\n      if (columnIndex !== undefined) {\n        columnIndex = Math.max(0, Math.min(columnIndex, columnCount - 1));\n      }\n\n      if (rowIndex !== undefined) {\n        rowIndex = Math.max(0, Math.min(rowIndex, rowCount - 1));\n      }\n\n      var estimatedTotalHeight = getEstimatedTotalHeight(this.props, this._instanceProps);\n      var estimatedTotalWidth = getEstimatedTotalWidth(this.props, this._instanceProps); // The scrollbar size should be considered when scrolling an item into view,\n      // to ensure it's fully visible.\n      // But we only need to account for its size when it's actually visible.\n\n      var horizontalScrollbarSize = estimatedTotalWidth > width ? scrollbarSize : 0;\n      var verticalScrollbarSize = estimatedTotalHeight > height ? scrollbarSize : 0;\n      this.scrollTo({\n        scrollLeft: columnIndex !== undefined ? getOffsetForColumnAndAlignment(this.props, columnIndex, align, scrollLeft, this._instanceProps, verticalScrollbarSize) : scrollLeft,\n        scrollTop: rowIndex !== undefined ? getOffsetForRowAndAlignment(this.props, rowIndex, align, scrollTop, this._instanceProps, horizontalScrollbarSize) : scrollTop\n      });\n    };\n\n    _proto.componentDidMount = function componentDidMount() {\n      var _this$props3 = this.props,\n          initialScrollLeft = _this$props3.initialScrollLeft,\n          initialScrollTop = _this$props3.initialScrollTop;\n\n      if (this._outerRef != null) {\n        var outerRef = this._outerRef;\n\n        if (typeof initialScrollLeft === 'number') {\n          outerRef.scrollLeft = initialScrollLeft;\n        }\n\n        if (typeof initialScrollTop === 'number') {\n          outerRef.scrollTop = initialScrollTop;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentDidUpdate = function componentDidUpdate() {\n      var direction = this.props.direction;\n      var _this$state2 = this.state,\n          scrollLeft = _this$state2.scrollLeft,\n          scrollTop = _this$state2.scrollTop,\n          scrollUpdateWasRequested = _this$state2.scrollUpdateWasRequested;\n\n      if (scrollUpdateWasRequested && this._outerRef != null) {\n        // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n        // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n        // So we need to determine which browser behavior we're dealing with, and mimic it.\n        var outerRef = this._outerRef;\n\n        if (direction === 'rtl') {\n          switch (getRTLOffsetType()) {\n            case 'negative':\n              outerRef.scrollLeft = -scrollLeft;\n              break;\n\n            case 'positive-ascending':\n              outerRef.scrollLeft = scrollLeft;\n              break;\n\n            default:\n              var clientWidth = outerRef.clientWidth,\n                  scrollWidth = outerRef.scrollWidth;\n              outerRef.scrollLeft = scrollWidth - clientWidth - scrollLeft;\n              break;\n          }\n        } else {\n          outerRef.scrollLeft = Math.max(0, scrollLeft);\n        }\n\n        outerRef.scrollTop = Math.max(0, scrollTop);\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      if (this._resetIsScrollingTimeoutId !== null) {\n        cancelTimeout(this._resetIsScrollingTimeoutId);\n      }\n    };\n\n    _proto.render = function render() {\n      var _this$props4 = this.props,\n          children = _this$props4.children,\n          className = _this$props4.className,\n          columnCount = _this$props4.columnCount,\n          direction = _this$props4.direction,\n          height = _this$props4.height,\n          innerRef = _this$props4.innerRef,\n          innerElementType = _this$props4.innerElementType,\n          innerTagName = _this$props4.innerTagName,\n          itemData = _this$props4.itemData,\n          _this$props4$itemKey = _this$props4.itemKey,\n          itemKey = _this$props4$itemKey === void 0 ? defaultItemKey : _this$props4$itemKey,\n          outerElementType = _this$props4.outerElementType,\n          outerTagName = _this$props4.outerTagName,\n          rowCount = _this$props4.rowCount,\n          style = _this$props4.style,\n          useIsScrolling = _this$props4.useIsScrolling,\n          width = _this$props4.width;\n      var isScrolling = this.state.isScrolling;\n\n      var _this$_getHorizontalR = this._getHorizontalRangeToRender(),\n          columnStartIndex = _this$_getHorizontalR[0],\n          columnStopIndex = _this$_getHorizontalR[1];\n\n      var _this$_getVerticalRan = this._getVerticalRangeToRender(),\n          rowStartIndex = _this$_getVerticalRan[0],\n          rowStopIndex = _this$_getVerticalRan[1];\n\n      var items = [];\n\n      if (columnCount > 0 && rowCount) {\n        for (var _rowIndex = rowStartIndex; _rowIndex <= rowStopIndex; _rowIndex++) {\n          for (var _columnIndex = columnStartIndex; _columnIndex <= columnStopIndex; _columnIndex++) {\n            items.push(createElement(children, {\n              columnIndex: _columnIndex,\n              data: itemData,\n              isScrolling: useIsScrolling ? isScrolling : undefined,\n              key: itemKey({\n                columnIndex: _columnIndex,\n                data: itemData,\n                rowIndex: _rowIndex\n              }),\n              rowIndex: _rowIndex,\n              style: this._getItemStyle(_rowIndex, _columnIndex)\n            }));\n          }\n        }\n      } // Read this value AFTER items have been created,\n      // So their actual sizes (if variable) are taken into consideration.\n\n\n      var estimatedTotalHeight = getEstimatedTotalHeight(this.props, this._instanceProps);\n      var estimatedTotalWidth = getEstimatedTotalWidth(this.props, this._instanceProps);\n      return createElement(outerElementType || outerTagName || 'div', {\n        className: className,\n        onScroll: this._onScroll,\n        ref: this._outerRefSetter,\n        style: _extends({\n          position: 'relative',\n          height: height,\n          width: width,\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch',\n          willChange: 'transform',\n          direction: direction\n        }, style)\n      }, createElement(innerElementType || innerTagName || 'div', {\n        children: items,\n        ref: innerRef,\n        style: {\n          height: estimatedTotalHeight,\n          pointerEvents: isScrolling ? 'none' : undefined,\n          width: estimatedTotalWidth\n        }\n      }));\n    };\n\n    _proto._callPropsCallbacks = function _callPropsCallbacks() {\n      var _this$props5 = this.props,\n          columnCount = _this$props5.columnCount,\n          onItemsRendered = _this$props5.onItemsRendered,\n          onScroll = _this$props5.onScroll,\n          rowCount = _this$props5.rowCount;\n\n      if (typeof onItemsRendered === 'function') {\n        if (columnCount > 0 && rowCount > 0) {\n          var _this$_getHorizontalR2 = this._getHorizontalRangeToRender(),\n              _overscanColumnStartIndex = _this$_getHorizontalR2[0],\n              _overscanColumnStopIndex = _this$_getHorizontalR2[1],\n              _visibleColumnStartIndex = _this$_getHorizontalR2[2],\n              _visibleColumnStopIndex = _this$_getHorizontalR2[3];\n\n          var _this$_getVerticalRan2 = this._getVerticalRangeToRender(),\n              _overscanRowStartIndex = _this$_getVerticalRan2[0],\n              _overscanRowStopIndex = _this$_getVerticalRan2[1],\n              _visibleRowStartIndex = _this$_getVerticalRan2[2],\n              _visibleRowStopIndex = _this$_getVerticalRan2[3];\n\n          this._callOnItemsRendered(_overscanColumnStartIndex, _overscanColumnStopIndex, _overscanRowStartIndex, _overscanRowStopIndex, _visibleColumnStartIndex, _visibleColumnStopIndex, _visibleRowStartIndex, _visibleRowStopIndex);\n        }\n      }\n\n      if (typeof onScroll === 'function') {\n        var _this$state3 = this.state,\n            _horizontalScrollDirection = _this$state3.horizontalScrollDirection,\n            _scrollLeft = _this$state3.scrollLeft,\n            _scrollTop = _this$state3.scrollTop,\n            _scrollUpdateWasRequested = _this$state3.scrollUpdateWasRequested,\n            _verticalScrollDirection = _this$state3.verticalScrollDirection;\n\n        this._callOnScroll(_scrollLeft, _scrollTop, _horizontalScrollDirection, _verticalScrollDirection, _scrollUpdateWasRequested);\n      }\n    } // Lazily create and cache item styles while scrolling,\n    // So that pure component sCU will prevent re-renders.\n    // We maintain this cache, and pass a style prop rather than index,\n    // So that List can clear cached styles and force item re-render if necessary.\n    ;\n\n    _proto._getHorizontalRangeToRender = function _getHorizontalRangeToRender() {\n      var _this$props6 = this.props,\n          columnCount = _this$props6.columnCount,\n          overscanColumnCount = _this$props6.overscanColumnCount,\n          overscanColumnsCount = _this$props6.overscanColumnsCount,\n          overscanCount = _this$props6.overscanCount,\n          rowCount = _this$props6.rowCount;\n      var _this$state4 = this.state,\n          horizontalScrollDirection = _this$state4.horizontalScrollDirection,\n          isScrolling = _this$state4.isScrolling,\n          scrollLeft = _this$state4.scrollLeft;\n      var overscanCountResolved = overscanColumnCount || overscanColumnsCount || overscanCount || 1;\n\n      if (columnCount === 0 || rowCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getColumnStartIndexForOffset(this.props, scrollLeft, this._instanceProps);\n      var stopIndex = getColumnStopIndexForStartIndex(this.props, startIndex, scrollLeft, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || horizontalScrollDirection === 'backward' ? Math.max(1, overscanCountResolved) : 1;\n      var overscanForward = !isScrolling || horizontalScrollDirection === 'forward' ? Math.max(1, overscanCountResolved) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(columnCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    _proto._getVerticalRangeToRender = function _getVerticalRangeToRender() {\n      var _this$props7 = this.props,\n          columnCount = _this$props7.columnCount,\n          overscanCount = _this$props7.overscanCount,\n          overscanRowCount = _this$props7.overscanRowCount,\n          overscanRowsCount = _this$props7.overscanRowsCount,\n          rowCount = _this$props7.rowCount;\n      var _this$state5 = this.state,\n          isScrolling = _this$state5.isScrolling,\n          verticalScrollDirection = _this$state5.verticalScrollDirection,\n          scrollTop = _this$state5.scrollTop;\n      var overscanCountResolved = overscanRowCount || overscanRowsCount || overscanCount || 1;\n\n      if (columnCount === 0 || rowCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getRowStartIndexForOffset(this.props, scrollTop, this._instanceProps);\n      var stopIndex = getRowStopIndexForStartIndex(this.props, startIndex, scrollTop, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || verticalScrollDirection === 'backward' ? Math.max(1, overscanCountResolved) : 1;\n      var overscanForward = !isScrolling || verticalScrollDirection === 'forward' ? Math.max(1, overscanCountResolved) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(rowCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    return Grid;\n  }(PureComponent), _class.defaultProps = {\n    direction: 'ltr',\n    itemData: undefined,\n    useIsScrolling: false\n  }, _class;\n}\n\nvar validateSharedProps = function validateSharedProps(_ref5, _ref6) {\n  var children = _ref5.children,\n      direction = _ref5.direction,\n      height = _ref5.height,\n      innerTagName = _ref5.innerTagName,\n      outerTagName = _ref5.outerTagName,\n      overscanColumnsCount = _ref5.overscanColumnsCount,\n      overscanCount = _ref5.overscanCount,\n      overscanRowsCount = _ref5.overscanRowsCount,\n      width = _ref5.width;\n  var instance = _ref6.instance;\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof overscanCount === 'number') {\n      if (devWarningsOverscanCount && !devWarningsOverscanCount.has(instance)) {\n        devWarningsOverscanCount.add(instance);\n        console.warn('The overscanCount prop has been deprecated. ' + 'Please use the overscanColumnCount and overscanRowCount props instead.');\n      }\n    }\n\n    if (typeof overscanColumnsCount === 'number' || typeof overscanRowsCount === 'number') {\n      if (devWarningsOverscanRowsColumnsCount && !devWarningsOverscanRowsColumnsCount.has(instance)) {\n        devWarningsOverscanRowsColumnsCount.add(instance);\n        console.warn('The overscanColumnsCount and overscanRowsCount props have been deprecated. ' + 'Please use the overscanColumnCount and overscanRowCount props instead.');\n      }\n    }\n\n    if (innerTagName != null || outerTagName != null) {\n      if (devWarningsTagName && !devWarningsTagName.has(instance)) {\n        devWarningsTagName.add(instance);\n        console.warn('The innerTagName and outerTagName props have been deprecated. ' + 'Please use the innerElementType and outerElementType props instead.');\n      }\n    }\n\n    if (children == null) {\n      throw Error('An invalid \"children\" prop has been specified. ' + 'Value should be a React component. ' + (\"\\\"\" + (children === null ? 'null' : typeof children) + \"\\\" was specified.\"));\n    }\n\n    switch (direction) {\n      case 'ltr':\n      case 'rtl':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"direction\" prop has been specified. ' + 'Value should be either \"ltr\" or \"rtl\". ' + (\"\\\"\" + direction + \"\\\" was specified.\"));\n    }\n\n    if (typeof width !== 'number') {\n      throw Error('An invalid \"width\" prop has been specified. ' + 'Grids must specify a number for width. ' + (\"\\\"\" + (width === null ? 'null' : typeof width) + \"\\\" was specified.\"));\n    }\n\n    if (typeof height !== 'number') {\n      throw Error('An invalid \"height\" prop has been specified. ' + 'Grids must specify a number for height. ' + (\"\\\"\" + (height === null ? 'null' : typeof height) + \"\\\" was specified.\"));\n    }\n  }\n};\n\nvar DEFAULT_ESTIMATED_ITEM_SIZE = 50;\n\nvar getEstimatedTotalHeight = function getEstimatedTotalHeight(_ref, _ref2) {\n  var rowCount = _ref.rowCount;\n  var rowMetadataMap = _ref2.rowMetadataMap,\n      estimatedRowHeight = _ref2.estimatedRowHeight,\n      lastMeasuredRowIndex = _ref2.lastMeasuredRowIndex;\n  var totalSizeOfMeasuredRows = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredRowIndex >= rowCount) {\n    lastMeasuredRowIndex = rowCount - 1;\n  }\n\n  if (lastMeasuredRowIndex >= 0) {\n    var itemMetadata = rowMetadataMap[lastMeasuredRowIndex];\n    totalSizeOfMeasuredRows = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = rowCount - lastMeasuredRowIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedRowHeight;\n  return totalSizeOfMeasuredRows + totalSizeOfUnmeasuredItems;\n};\n\nvar getEstimatedTotalWidth = function getEstimatedTotalWidth(_ref3, _ref4) {\n  var columnCount = _ref3.columnCount;\n  var columnMetadataMap = _ref4.columnMetadataMap,\n      estimatedColumnWidth = _ref4.estimatedColumnWidth,\n      lastMeasuredColumnIndex = _ref4.lastMeasuredColumnIndex;\n  var totalSizeOfMeasuredRows = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredColumnIndex >= columnCount) {\n    lastMeasuredColumnIndex = columnCount - 1;\n  }\n\n  if (lastMeasuredColumnIndex >= 0) {\n    var itemMetadata = columnMetadataMap[lastMeasuredColumnIndex];\n    totalSizeOfMeasuredRows = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = columnCount - lastMeasuredColumnIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedColumnWidth;\n  return totalSizeOfMeasuredRows + totalSizeOfUnmeasuredItems;\n};\n\nvar getItemMetadata = function getItemMetadata(itemType, props, index, instanceProps) {\n  var itemMetadataMap, itemSize, lastMeasuredIndex;\n\n  if (itemType === 'column') {\n    itemMetadataMap = instanceProps.columnMetadataMap;\n    itemSize = props.columnWidth;\n    lastMeasuredIndex = instanceProps.lastMeasuredColumnIndex;\n  } else {\n    itemMetadataMap = instanceProps.rowMetadataMap;\n    itemSize = props.rowHeight;\n    lastMeasuredIndex = instanceProps.lastMeasuredRowIndex;\n  }\n\n  if (index > lastMeasuredIndex) {\n    var offset = 0;\n\n    if (lastMeasuredIndex >= 0) {\n      var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n      offset = itemMetadata.offset + itemMetadata.size;\n    }\n\n    for (var i = lastMeasuredIndex + 1; i <= index; i++) {\n      var size = itemSize(i);\n      itemMetadataMap[i] = {\n        offset: offset,\n        size: size\n      };\n      offset += size;\n    }\n\n    if (itemType === 'column') {\n      instanceProps.lastMeasuredColumnIndex = index;\n    } else {\n      instanceProps.lastMeasuredRowIndex = index;\n    }\n  }\n\n  return itemMetadataMap[index];\n};\n\nvar findNearestItem = function findNearestItem(itemType, props, instanceProps, offset) {\n  var itemMetadataMap, lastMeasuredIndex;\n\n  if (itemType === 'column') {\n    itemMetadataMap = instanceProps.columnMetadataMap;\n    lastMeasuredIndex = instanceProps.lastMeasuredColumnIndex;\n  } else {\n    itemMetadataMap = instanceProps.rowMetadataMap;\n    lastMeasuredIndex = instanceProps.lastMeasuredRowIndex;\n  }\n\n  var lastMeasuredItemOffset = lastMeasuredIndex > 0 ? itemMetadataMap[lastMeasuredIndex].offset : 0;\n\n  if (lastMeasuredItemOffset >= offset) {\n    // If we've already measured items within this range just use a binary search as it's faster.\n    return findNearestItemBinarySearch(itemType, props, instanceProps, lastMeasuredIndex, 0, offset);\n  } else {\n    // If we haven't yet measured this high, fallback to an exponential search with an inner binary search.\n    // The exponential search avoids pre-computing sizes for the full set of items as a binary search would.\n    // The overall complexity for this approach is O(log n).\n    return findNearestItemExponentialSearch(itemType, props, instanceProps, Math.max(0, lastMeasuredIndex), offset);\n  }\n};\n\nvar findNearestItemBinarySearch = function findNearestItemBinarySearch(itemType, props, instanceProps, high, low, offset) {\n  while (low <= high) {\n    var middle = low + Math.floor((high - low) / 2);\n    var currentOffset = getItemMetadata(itemType, props, middle, instanceProps).offset;\n\n    if (currentOffset === offset) {\n      return middle;\n    } else if (currentOffset < offset) {\n      low = middle + 1;\n    } else if (currentOffset > offset) {\n      high = middle - 1;\n    }\n  }\n\n  if (low > 0) {\n    return low - 1;\n  } else {\n    return 0;\n  }\n};\n\nvar findNearestItemExponentialSearch = function findNearestItemExponentialSearch(itemType, props, instanceProps, index, offset) {\n  var itemCount = itemType === 'column' ? props.columnCount : props.rowCount;\n  var interval = 1;\n\n  while (index < itemCount && getItemMetadata(itemType, props, index, instanceProps).offset < offset) {\n    index += interval;\n    interval *= 2;\n  }\n\n  return findNearestItemBinarySearch(itemType, props, instanceProps, Math.min(index, itemCount - 1), Math.floor(index / 2), offset);\n};\n\nvar getOffsetForIndexAndAlignment = function getOffsetForIndexAndAlignment(itemType, props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n  var size = itemType === 'column' ? props.width : props.height;\n  var itemMetadata = getItemMetadata(itemType, props, index, instanceProps); // Get estimated total size after ItemMetadata is computed,\n  // To ensure it reflects actual measurements instead of just estimates.\n\n  var estimatedTotalSize = itemType === 'column' ? getEstimatedTotalWidth(props, instanceProps) : getEstimatedTotalHeight(props, instanceProps);\n  var maxOffset = Math.max(0, Math.min(estimatedTotalSize - size, itemMetadata.offset));\n  var minOffset = Math.max(0, itemMetadata.offset - size + scrollbarSize + itemMetadata.size);\n\n  if (align === 'smart') {\n    if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n      align = 'auto';\n    } else {\n      align = 'center';\n    }\n  }\n\n  switch (align) {\n    case 'start':\n      return maxOffset;\n\n    case 'end':\n      return minOffset;\n\n    case 'center':\n      return Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n    case 'auto':\n    default:\n      if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n        return scrollOffset;\n      } else if (minOffset > maxOffset) {\n        // Because we only take into account the scrollbar size when calculating minOffset\n        // this value can be larger than maxOffset when at the end of the list\n        return minOffset;\n      } else if (scrollOffset < minOffset) {\n        return minOffset;\n      } else {\n        return maxOffset;\n      }\n\n  }\n};\n\nvar VariableSizeGrid = /*#__PURE__*/createGridComponent({\n  getColumnOffset: function getColumnOffset(props, index, instanceProps) {\n    return getItemMetadata('column', props, index, instanceProps).offset;\n  },\n  getColumnStartIndexForOffset: function getColumnStartIndexForOffset(props, scrollLeft, instanceProps) {\n    return findNearestItem('column', props, instanceProps, scrollLeft);\n  },\n  getColumnStopIndexForStartIndex: function getColumnStopIndexForStartIndex(props, startIndex, scrollLeft, instanceProps) {\n    var columnCount = props.columnCount,\n        width = props.width;\n    var itemMetadata = getItemMetadata('column', props, startIndex, instanceProps);\n    var maxOffset = scrollLeft + width;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < columnCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata('column', props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  getColumnWidth: function getColumnWidth(props, index, instanceProps) {\n    return instanceProps.columnMetadataMap[index].size;\n  },\n  getEstimatedTotalHeight: getEstimatedTotalHeight,\n  getEstimatedTotalWidth: getEstimatedTotalWidth,\n  getOffsetForColumnAndAlignment: function getOffsetForColumnAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    return getOffsetForIndexAndAlignment('column', props, index, align, scrollOffset, instanceProps, scrollbarSize);\n  },\n  getOffsetForRowAndAlignment: function getOffsetForRowAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    return getOffsetForIndexAndAlignment('row', props, index, align, scrollOffset, instanceProps, scrollbarSize);\n  },\n  getRowOffset: function getRowOffset(props, index, instanceProps) {\n    return getItemMetadata('row', props, index, instanceProps).offset;\n  },\n  getRowHeight: function getRowHeight(props, index, instanceProps) {\n    return instanceProps.rowMetadataMap[index].size;\n  },\n  getRowStartIndexForOffset: function getRowStartIndexForOffset(props, scrollTop, instanceProps) {\n    return findNearestItem('row', props, instanceProps, scrollTop);\n  },\n  getRowStopIndexForStartIndex: function getRowStopIndexForStartIndex(props, startIndex, scrollTop, instanceProps) {\n    var rowCount = props.rowCount,\n        height = props.height;\n    var itemMetadata = getItemMetadata('row', props, startIndex, instanceProps);\n    var maxOffset = scrollTop + height;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < rowCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata('row', props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  initInstanceProps: function initInstanceProps(props, instance) {\n    var _ref5 = props,\n        estimatedColumnWidth = _ref5.estimatedColumnWidth,\n        estimatedRowHeight = _ref5.estimatedRowHeight;\n    var instanceProps = {\n      columnMetadataMap: {},\n      estimatedColumnWidth: estimatedColumnWidth || DEFAULT_ESTIMATED_ITEM_SIZE,\n      estimatedRowHeight: estimatedRowHeight || DEFAULT_ESTIMATED_ITEM_SIZE,\n      lastMeasuredColumnIndex: -1,\n      lastMeasuredRowIndex: -1,\n      rowMetadataMap: {}\n    };\n\n    instance.resetAfterColumnIndex = function (columnIndex, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instance.resetAfterIndices({\n        columnIndex: columnIndex,\n        shouldForceUpdate: shouldForceUpdate\n      });\n    };\n\n    instance.resetAfterRowIndex = function (rowIndex, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instance.resetAfterIndices({\n        rowIndex: rowIndex,\n        shouldForceUpdate: shouldForceUpdate\n      });\n    };\n\n    instance.resetAfterIndices = function (_ref6) {\n      var columnIndex = _ref6.columnIndex,\n          rowIndex = _ref6.rowIndex,\n          _ref6$shouldForceUpda = _ref6.shouldForceUpdate,\n          shouldForceUpdate = _ref6$shouldForceUpda === void 0 ? true : _ref6$shouldForceUpda;\n\n      if (typeof columnIndex === 'number') {\n        instanceProps.lastMeasuredColumnIndex = Math.min(instanceProps.lastMeasuredColumnIndex, columnIndex - 1);\n      }\n\n      if (typeof rowIndex === 'number') {\n        instanceProps.lastMeasuredRowIndex = Math.min(instanceProps.lastMeasuredRowIndex, rowIndex - 1);\n      } // We could potentially optimize further by only evicting styles after this index,\n      // But since styles are only cached while scrolling is in progress-\n      // It seems an unnecessary optimization.\n      // It's unlikely that resetAfterIndex() will be called while a user is scrolling.\n\n\n      instance._getItemStyleCache(-1);\n\n      if (shouldForceUpdate) {\n        instance.forceUpdate();\n      }\n    };\n\n    return instanceProps;\n  },\n  shouldResetStyleCacheOnItemSizeChange: false,\n  validateProps: function validateProps(_ref7) {\n    var columnWidth = _ref7.columnWidth,\n        rowHeight = _ref7.rowHeight;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof columnWidth !== 'function') {\n        throw Error('An invalid \"columnWidth\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (columnWidth === null ? 'null' : typeof columnWidth) + \"\\\" was specified.\"));\n      } else if (typeof rowHeight !== 'function') {\n        throw Error('An invalid \"rowHeight\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (rowHeight === null ? 'null' : typeof rowHeight) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar IS_SCROLLING_DEBOUNCE_INTERVAL$1 = 150;\n\nvar defaultItemKey$1 = function defaultItemKey(index, data) {\n  return index;\n}; // In DEV mode, this Set helps us only log a warning once per component instance.\n// This avoids spamming the console every time a render happens.\n\n\nvar devWarningsDirection = null;\nvar devWarningsTagName$1 = null;\n\nif (process.env.NODE_ENV !== 'production') {\n  if (typeof window !== 'undefined' && typeof window.WeakSet !== 'undefined') {\n    devWarningsDirection = /*#__PURE__*/new WeakSet();\n    devWarningsTagName$1 = /*#__PURE__*/new WeakSet();\n  }\n}\n\nfunction createListComponent(_ref) {\n  var _class;\n\n  var getItemOffset = _ref.getItemOffset,\n      getEstimatedTotalSize = _ref.getEstimatedTotalSize,\n      getItemSize = _ref.getItemSize,\n      getOffsetForIndexAndAlignment = _ref.getOffsetForIndexAndAlignment,\n      getStartIndexForOffset = _ref.getStartIndexForOffset,\n      getStopIndexForStartIndex = _ref.getStopIndexForStartIndex,\n      initInstanceProps = _ref.initInstanceProps,\n      shouldResetStyleCacheOnItemSizeChange = _ref.shouldResetStyleCacheOnItemSizeChange,\n      validateProps = _ref.validateProps;\n  return _class = /*#__PURE__*/function (_PureComponent) {\n    _inheritsLoose(List, _PureComponent);\n\n    // Always use explicit constructor for React components.\n    // It produces less code after transpilation. (#26)\n    // eslint-disable-next-line no-useless-constructor\n    function List(props) {\n      var _this;\n\n      _this = _PureComponent.call(this, props) || this;\n      _this._instanceProps = initInstanceProps(_this.props, _assertThisInitialized(_this));\n      _this._outerRef = void 0;\n      _this._resetIsScrollingTimeoutId = null;\n      _this.state = {\n        instance: _assertThisInitialized(_this),\n        isScrolling: false,\n        scrollDirection: 'forward',\n        scrollOffset: typeof _this.props.initialScrollOffset === 'number' ? _this.props.initialScrollOffset : 0,\n        scrollUpdateWasRequested: false\n      };\n      _this._callOnItemsRendered = void 0;\n      _this._callOnItemsRendered = memoizeOne(function (overscanStartIndex, overscanStopIndex, visibleStartIndex, visibleStopIndex) {\n        return _this.props.onItemsRendered({\n          overscanStartIndex: overscanStartIndex,\n          overscanStopIndex: overscanStopIndex,\n          visibleStartIndex: visibleStartIndex,\n          visibleStopIndex: visibleStopIndex\n        });\n      });\n      _this._callOnScroll = void 0;\n      _this._callOnScroll = memoizeOne(function (scrollDirection, scrollOffset, scrollUpdateWasRequested) {\n        return _this.props.onScroll({\n          scrollDirection: scrollDirection,\n          scrollOffset: scrollOffset,\n          scrollUpdateWasRequested: scrollUpdateWasRequested\n        });\n      });\n      _this._getItemStyle = void 0;\n\n      _this._getItemStyle = function (index) {\n        var _this$props = _this.props,\n            direction = _this$props.direction,\n            itemSize = _this$props.itemSize,\n            layout = _this$props.layout;\n\n        var itemStyleCache = _this._getItemStyleCache(shouldResetStyleCacheOnItemSizeChange && itemSize, shouldResetStyleCacheOnItemSizeChange && layout, shouldResetStyleCacheOnItemSizeChange && direction);\n\n        var style;\n\n        if (itemStyleCache.hasOwnProperty(index)) {\n          style = itemStyleCache[index];\n        } else {\n          var _offset = getItemOffset(_this.props, index, _this._instanceProps);\n\n          var size = getItemSize(_this.props, index, _this._instanceProps); // TODO Deprecate direction \"horizontal\"\n\n          var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n          var isRtl = direction === 'rtl';\n          var offsetHorizontal = isHorizontal ? _offset : 0;\n          itemStyleCache[index] = style = {\n            position: 'absolute',\n            left: isRtl ? undefined : offsetHorizontal,\n            right: isRtl ? offsetHorizontal : undefined,\n            top: !isHorizontal ? _offset : 0,\n            height: !isHorizontal ? size : '100%',\n            width: isHorizontal ? size : '100%'\n          };\n        }\n\n        return style;\n      };\n\n      _this._getItemStyleCache = void 0;\n      _this._getItemStyleCache = memoizeOne(function (_, __, ___) {\n        return {};\n      });\n\n      _this._onScrollHorizontal = function (event) {\n        var _event$currentTarget = event.currentTarget,\n            clientWidth = _event$currentTarget.clientWidth,\n            scrollLeft = _event$currentTarget.scrollLeft,\n            scrollWidth = _event$currentTarget.scrollWidth;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollOffset === scrollLeft) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          }\n\n          var direction = _this.props.direction;\n          var scrollOffset = scrollLeft;\n\n          if (direction === 'rtl') {\n            // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n            // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n            // It's also easier for this component if we convert offsets to the same format as they would be in for ltr.\n            // So the simplest solution is to determine which browser behavior we're dealing with, and convert based on it.\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                scrollOffset = -scrollLeft;\n                break;\n\n              case 'positive-descending':\n                scrollOffset = scrollWidth - clientWidth - scrollLeft;\n                break;\n            }\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          scrollOffset = Math.max(0, Math.min(scrollOffset, scrollWidth - clientWidth));\n          return {\n            isScrolling: true,\n            scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n            scrollOffset: scrollOffset,\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._onScrollVertical = function (event) {\n        var _event$currentTarget2 = event.currentTarget,\n            clientHeight = _event$currentTarget2.clientHeight,\n            scrollHeight = _event$currentTarget2.scrollHeight,\n            scrollTop = _event$currentTarget2.scrollTop;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollOffset === scrollTop) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          var scrollOffset = Math.max(0, Math.min(scrollTop, scrollHeight - clientHeight));\n          return {\n            isScrolling: true,\n            scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n            scrollOffset: scrollOffset,\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._outerRefSetter = function (ref) {\n        var outerRef = _this.props.outerRef;\n        _this._outerRef = ref;\n\n        if (typeof outerRef === 'function') {\n          outerRef(ref);\n        } else if (outerRef != null && typeof outerRef === 'object' && outerRef.hasOwnProperty('current')) {\n          outerRef.current = ref;\n        }\n      };\n\n      _this._resetIsScrollingDebounced = function () {\n        if (_this._resetIsScrollingTimeoutId !== null) {\n          cancelTimeout(_this._resetIsScrollingTimeoutId);\n        }\n\n        _this._resetIsScrollingTimeoutId = requestTimeout(_this._resetIsScrolling, IS_SCROLLING_DEBOUNCE_INTERVAL$1);\n      };\n\n      _this._resetIsScrolling = function () {\n        _this._resetIsScrollingTimeoutId = null;\n\n        _this.setState({\n          isScrolling: false\n        }, function () {\n          // Clear style cache after state update has been committed.\n          // This way we don't break pure sCU for items that don't use isScrolling param.\n          _this._getItemStyleCache(-1, null);\n        });\n      };\n\n      return _this;\n    }\n\n    List.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n      validateSharedProps$1(nextProps, prevState);\n      validateProps(nextProps);\n      return null;\n    };\n\n    var _proto = List.prototype;\n\n    _proto.scrollTo = function scrollTo(scrollOffset) {\n      scrollOffset = Math.max(0, scrollOffset);\n      this.setState(function (prevState) {\n        if (prevState.scrollOffset === scrollOffset) {\n          return null;\n        }\n\n        return {\n          scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n          scrollOffset: scrollOffset,\n          scrollUpdateWasRequested: true\n        };\n      }, this._resetIsScrollingDebounced);\n    };\n\n    _proto.scrollToItem = function scrollToItem(index, align) {\n      if (align === void 0) {\n        align = 'auto';\n      }\n\n      var _this$props2 = this.props,\n          itemCount = _this$props2.itemCount,\n          layout = _this$props2.layout;\n      var scrollOffset = this.state.scrollOffset;\n      index = Math.max(0, Math.min(index, itemCount - 1)); // The scrollbar size should be considered when scrolling an item into view, to ensure it's fully visible.\n      // But we only need to account for its size when it's actually visible.\n      // This is an edge case for lists; normally they only scroll in the dominant direction.\n\n      var scrollbarSize = 0;\n\n      if (this._outerRef) {\n        var outerRef = this._outerRef;\n\n        if (layout === 'vertical') {\n          scrollbarSize = outerRef.scrollWidth > outerRef.clientWidth ? getScrollbarSize() : 0;\n        } else {\n          scrollbarSize = outerRef.scrollHeight > outerRef.clientHeight ? getScrollbarSize() : 0;\n        }\n      }\n\n      this.scrollTo(getOffsetForIndexAndAlignment(this.props, index, align, scrollOffset, this._instanceProps, scrollbarSize));\n    };\n\n    _proto.componentDidMount = function componentDidMount() {\n      var _this$props3 = this.props,\n          direction = _this$props3.direction,\n          initialScrollOffset = _this$props3.initialScrollOffset,\n          layout = _this$props3.layout;\n\n      if (typeof initialScrollOffset === 'number' && this._outerRef != null) {\n        var outerRef = this._outerRef; // TODO Deprecate direction \"horizontal\"\n\n        if (direction === 'horizontal' || layout === 'horizontal') {\n          outerRef.scrollLeft = initialScrollOffset;\n        } else {\n          outerRef.scrollTop = initialScrollOffset;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentDidUpdate = function componentDidUpdate() {\n      var _this$props4 = this.props,\n          direction = _this$props4.direction,\n          layout = _this$props4.layout;\n      var _this$state = this.state,\n          scrollOffset = _this$state.scrollOffset,\n          scrollUpdateWasRequested = _this$state.scrollUpdateWasRequested;\n\n      if (scrollUpdateWasRequested && this._outerRef != null) {\n        var outerRef = this._outerRef; // TODO Deprecate direction \"horizontal\"\n\n        if (direction === 'horizontal' || layout === 'horizontal') {\n          if (direction === 'rtl') {\n            // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n            // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n            // So we need to determine which browser behavior we're dealing with, and mimic it.\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                outerRef.scrollLeft = -scrollOffset;\n                break;\n\n              case 'positive-ascending':\n                outerRef.scrollLeft = scrollOffset;\n                break;\n\n              default:\n                var clientWidth = outerRef.clientWidth,\n                    scrollWidth = outerRef.scrollWidth;\n                outerRef.scrollLeft = scrollWidth - clientWidth - scrollOffset;\n                break;\n            }\n          } else {\n            outerRef.scrollLeft = scrollOffset;\n          }\n        } else {\n          outerRef.scrollTop = scrollOffset;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      if (this._resetIsScrollingTimeoutId !== null) {\n        cancelTimeout(this._resetIsScrollingTimeoutId);\n      }\n    };\n\n    _proto.render = function render() {\n      var _this$props5 = this.props,\n          children = _this$props5.children,\n          className = _this$props5.className,\n          direction = _this$props5.direction,\n          height = _this$props5.height,\n          innerRef = _this$props5.innerRef,\n          innerElementType = _this$props5.innerElementType,\n          innerTagName = _this$props5.innerTagName,\n          itemCount = _this$props5.itemCount,\n          itemData = _this$props5.itemData,\n          _this$props5$itemKey = _this$props5.itemKey,\n          itemKey = _this$props5$itemKey === void 0 ? defaultItemKey$1 : _this$props5$itemKey,\n          layout = _this$props5.layout,\n          outerElementType = _this$props5.outerElementType,\n          outerTagName = _this$props5.outerTagName,\n          style = _this$props5.style,\n          useIsScrolling = _this$props5.useIsScrolling,\n          width = _this$props5.width;\n      var isScrolling = this.state.isScrolling; // TODO Deprecate direction \"horizontal\"\n\n      var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n      var onScroll = isHorizontal ? this._onScrollHorizontal : this._onScrollVertical;\n\n      var _this$_getRangeToRend = this._getRangeToRender(),\n          startIndex = _this$_getRangeToRend[0],\n          stopIndex = _this$_getRangeToRend[1];\n\n      var items = [];\n\n      if (itemCount > 0) {\n        for (var _index = startIndex; _index <= stopIndex; _index++) {\n          items.push(createElement(children, {\n            data: itemData,\n            key: itemKey(_index, itemData),\n            index: _index,\n            isScrolling: useIsScrolling ? isScrolling : undefined,\n            style: this._getItemStyle(_index)\n          }));\n        }\n      } // Read this value AFTER items have been created,\n      // So their actual sizes (if variable) are taken into consideration.\n\n\n      var estimatedTotalSize = getEstimatedTotalSize(this.props, this._instanceProps);\n      return createElement(outerElementType || outerTagName || 'div', {\n        className: className,\n        onScroll: onScroll,\n        ref: this._outerRefSetter,\n        style: _extends({\n          position: 'relative',\n          height: height,\n          width: width,\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch',\n          willChange: 'transform',\n          direction: direction\n        }, style)\n      }, createElement(innerElementType || innerTagName || 'div', {\n        children: items,\n        ref: innerRef,\n        style: {\n          height: isHorizontal ? '100%' : estimatedTotalSize,\n          pointerEvents: isScrolling ? 'none' : undefined,\n          width: isHorizontal ? estimatedTotalSize : '100%'\n        }\n      }));\n    };\n\n    _proto._callPropsCallbacks = function _callPropsCallbacks() {\n      if (typeof this.props.onItemsRendered === 'function') {\n        var itemCount = this.props.itemCount;\n\n        if (itemCount > 0) {\n          var _this$_getRangeToRend2 = this._getRangeToRender(),\n              _overscanStartIndex = _this$_getRangeToRend2[0],\n              _overscanStopIndex = _this$_getRangeToRend2[1],\n              _visibleStartIndex = _this$_getRangeToRend2[2],\n              _visibleStopIndex = _this$_getRangeToRend2[3];\n\n          this._callOnItemsRendered(_overscanStartIndex, _overscanStopIndex, _visibleStartIndex, _visibleStopIndex);\n        }\n      }\n\n      if (typeof this.props.onScroll === 'function') {\n        var _this$state2 = this.state,\n            _scrollDirection = _this$state2.scrollDirection,\n            _scrollOffset = _this$state2.scrollOffset,\n            _scrollUpdateWasRequested = _this$state2.scrollUpdateWasRequested;\n\n        this._callOnScroll(_scrollDirection, _scrollOffset, _scrollUpdateWasRequested);\n      }\n    } // Lazily create and cache item styles while scrolling,\n    // So that pure component sCU will prevent re-renders.\n    // We maintain this cache, and pass a style prop rather than index,\n    // So that List can clear cached styles and force item re-render if necessary.\n    ;\n\n    _proto._getRangeToRender = function _getRangeToRender() {\n      var _this$props6 = this.props,\n          itemCount = _this$props6.itemCount,\n          overscanCount = _this$props6.overscanCount;\n      var _this$state3 = this.state,\n          isScrolling = _this$state3.isScrolling,\n          scrollDirection = _this$state3.scrollDirection,\n          scrollOffset = _this$state3.scrollOffset;\n\n      if (itemCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getStartIndexForOffset(this.props, scrollOffset, this._instanceProps);\n      var stopIndex = getStopIndexForStartIndex(this.props, startIndex, scrollOffset, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || scrollDirection === 'backward' ? Math.max(1, overscanCount) : 1;\n      var overscanForward = !isScrolling || scrollDirection === 'forward' ? Math.max(1, overscanCount) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(itemCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    return List;\n  }(PureComponent), _class.defaultProps = {\n    direction: 'ltr',\n    itemData: undefined,\n    layout: 'vertical',\n    overscanCount: 2,\n    useIsScrolling: false\n  }, _class;\n} // NOTE: I considered further wrapping individual items with a pure ListItem component.\n// This would avoid ever calling the render function for the same index more than once,\n// But it would also add the overhead of a lot of components/fibers.\n// I assume people already do this (render function returning a class component),\n// So my doing it would just unnecessarily double the wrappers.\n\nvar validateSharedProps$1 = function validateSharedProps(_ref2, _ref3) {\n  var children = _ref2.children,\n      direction = _ref2.direction,\n      height = _ref2.height,\n      layout = _ref2.layout,\n      innerTagName = _ref2.innerTagName,\n      outerTagName = _ref2.outerTagName,\n      width = _ref2.width;\n  var instance = _ref3.instance;\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (innerTagName != null || outerTagName != null) {\n      if (devWarningsTagName$1 && !devWarningsTagName$1.has(instance)) {\n        devWarningsTagName$1.add(instance);\n        console.warn('The innerTagName and outerTagName props have been deprecated. ' + 'Please use the innerElementType and outerElementType props instead.');\n      }\n    } // TODO Deprecate direction \"horizontal\"\n\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n\n    switch (direction) {\n      case 'horizontal':\n      case 'vertical':\n        if (devWarningsDirection && !devWarningsDirection.has(instance)) {\n          devWarningsDirection.add(instance);\n          console.warn('The direction prop should be either \"ltr\" (default) or \"rtl\". ' + 'Please use the layout prop to specify \"vertical\" (default) or \"horizontal\" orientation.');\n        }\n\n        break;\n\n      case 'ltr':\n      case 'rtl':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"direction\" prop has been specified. ' + 'Value should be either \"ltr\" or \"rtl\". ' + (\"\\\"\" + direction + \"\\\" was specified.\"));\n    }\n\n    switch (layout) {\n      case 'horizontal':\n      case 'vertical':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"layout\" prop has been specified. ' + 'Value should be either \"horizontal\" or \"vertical\". ' + (\"\\\"\" + layout + \"\\\" was specified.\"));\n    }\n\n    if (children == null) {\n      throw Error('An invalid \"children\" prop has been specified. ' + 'Value should be a React component. ' + (\"\\\"\" + (children === null ? 'null' : typeof children) + \"\\\" was specified.\"));\n    }\n\n    if (isHorizontal && typeof width !== 'number') {\n      throw Error('An invalid \"width\" prop has been specified. ' + 'Horizontal lists must specify a number for width. ' + (\"\\\"\" + (width === null ? 'null' : typeof width) + \"\\\" was specified.\"));\n    } else if (!isHorizontal && typeof height !== 'number') {\n      throw Error('An invalid \"height\" prop has been specified. ' + 'Vertical lists must specify a number for height. ' + (\"\\\"\" + (height === null ? 'null' : typeof height) + \"\\\" was specified.\"));\n    }\n  }\n};\n\nvar DEFAULT_ESTIMATED_ITEM_SIZE$1 = 50;\n\nvar getItemMetadata$1 = function getItemMetadata(props, index, instanceProps) {\n  var _ref = props,\n      itemSize = _ref.itemSize;\n  var itemMetadataMap = instanceProps.itemMetadataMap,\n      lastMeasuredIndex = instanceProps.lastMeasuredIndex;\n\n  if (index > lastMeasuredIndex) {\n    var offset = 0;\n\n    if (lastMeasuredIndex >= 0) {\n      var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n      offset = itemMetadata.offset + itemMetadata.size;\n    }\n\n    for (var i = lastMeasuredIndex + 1; i <= index; i++) {\n      var size = itemSize(i);\n      itemMetadataMap[i] = {\n        offset: offset,\n        size: size\n      };\n      offset += size;\n    }\n\n    instanceProps.lastMeasuredIndex = index;\n  }\n\n  return itemMetadataMap[index];\n};\n\nvar findNearestItem$1 = function findNearestItem(props, instanceProps, offset) {\n  var itemMetadataMap = instanceProps.itemMetadataMap,\n      lastMeasuredIndex = instanceProps.lastMeasuredIndex;\n  var lastMeasuredItemOffset = lastMeasuredIndex > 0 ? itemMetadataMap[lastMeasuredIndex].offset : 0;\n\n  if (lastMeasuredItemOffset >= offset) {\n    // If we've already measured items within this range just use a binary search as it's faster.\n    return findNearestItemBinarySearch$1(props, instanceProps, lastMeasuredIndex, 0, offset);\n  } else {\n    // If we haven't yet measured this high, fallback to an exponential search with an inner binary search.\n    // The exponential search avoids pre-computing sizes for the full set of items as a binary search would.\n    // The overall complexity for this approach is O(log n).\n    return findNearestItemExponentialSearch$1(props, instanceProps, Math.max(0, lastMeasuredIndex), offset);\n  }\n};\n\nvar findNearestItemBinarySearch$1 = function findNearestItemBinarySearch(props, instanceProps, high, low, offset) {\n  while (low <= high) {\n    var middle = low + Math.floor((high - low) / 2);\n    var currentOffset = getItemMetadata$1(props, middle, instanceProps).offset;\n\n    if (currentOffset === offset) {\n      return middle;\n    } else if (currentOffset < offset) {\n      low = middle + 1;\n    } else if (currentOffset > offset) {\n      high = middle - 1;\n    }\n  }\n\n  if (low > 0) {\n    return low - 1;\n  } else {\n    return 0;\n  }\n};\n\nvar findNearestItemExponentialSearch$1 = function findNearestItemExponentialSearch(props, instanceProps, index, offset) {\n  var itemCount = props.itemCount;\n  var interval = 1;\n\n  while (index < itemCount && getItemMetadata$1(props, index, instanceProps).offset < offset) {\n    index += interval;\n    interval *= 2;\n  }\n\n  return findNearestItemBinarySearch$1(props, instanceProps, Math.min(index, itemCount - 1), Math.floor(index / 2), offset);\n};\n\nvar getEstimatedTotalSize = function getEstimatedTotalSize(_ref2, _ref3) {\n  var itemCount = _ref2.itemCount;\n  var itemMetadataMap = _ref3.itemMetadataMap,\n      estimatedItemSize = _ref3.estimatedItemSize,\n      lastMeasuredIndex = _ref3.lastMeasuredIndex;\n  var totalSizeOfMeasuredItems = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredIndex >= itemCount) {\n    lastMeasuredIndex = itemCount - 1;\n  }\n\n  if (lastMeasuredIndex >= 0) {\n    var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n    totalSizeOfMeasuredItems = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = itemCount - lastMeasuredIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedItemSize;\n  return totalSizeOfMeasuredItems + totalSizeOfUnmeasuredItems;\n};\n\nvar VariableSizeList = /*#__PURE__*/createListComponent({\n  getItemOffset: function getItemOffset(props, index, instanceProps) {\n    return getItemMetadata$1(props, index, instanceProps).offset;\n  },\n  getItemSize: function getItemSize(props, index, instanceProps) {\n    return instanceProps.itemMetadataMap[index].size;\n  },\n  getEstimatedTotalSize: getEstimatedTotalSize,\n  getOffsetForIndexAndAlignment: function getOffsetForIndexAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    var direction = props.direction,\n        height = props.height,\n        layout = props.layout,\n        width = props.width; // TODO Deprecate direction \"horizontal\"\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var itemMetadata = getItemMetadata$1(props, index, instanceProps); // Get estimated total size after ItemMetadata is computed,\n    // To ensure it reflects actual measurements instead of just estimates.\n\n    var estimatedTotalSize = getEstimatedTotalSize(props, instanceProps);\n    var maxOffset = Math.max(0, Math.min(estimatedTotalSize - size, itemMetadata.offset));\n    var minOffset = Math.max(0, itemMetadata.offset - size + itemMetadata.size + scrollbarSize);\n\n    if (align === 'smart') {\n      if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        return Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n      case 'auto':\n      default:\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n          return scrollOffset;\n        } else if (scrollOffset < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getStartIndexForOffset: function getStartIndexForOffset(props, offset, instanceProps) {\n    return findNearestItem$1(props, instanceProps, offset);\n  },\n  getStopIndexForStartIndex: function getStopIndexForStartIndex(props, startIndex, scrollOffset, instanceProps) {\n    var direction = props.direction,\n        height = props.height,\n        itemCount = props.itemCount,\n        layout = props.layout,\n        width = props.width; // TODO Deprecate direction \"horizontal\"\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var itemMetadata = getItemMetadata$1(props, startIndex, instanceProps);\n    var maxOffset = scrollOffset + size;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < itemCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata$1(props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  initInstanceProps: function initInstanceProps(props, instance) {\n    var _ref4 = props,\n        estimatedItemSize = _ref4.estimatedItemSize;\n    var instanceProps = {\n      itemMetadataMap: {},\n      estimatedItemSize: estimatedItemSize || DEFAULT_ESTIMATED_ITEM_SIZE$1,\n      lastMeasuredIndex: -1\n    };\n\n    instance.resetAfterIndex = function (index, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instanceProps.lastMeasuredIndex = Math.min(instanceProps.lastMeasuredIndex, index - 1); // We could potentially optimize further by only evicting styles after this index,\n      // But since styles are only cached while scrolling is in progress-\n      // It seems an unnecessary optimization.\n      // It's unlikely that resetAfterIndex() will be called while a user is scrolling.\n\n      instance._getItemStyleCache(-1);\n\n      if (shouldForceUpdate) {\n        instance.forceUpdate();\n      }\n    };\n\n    return instanceProps;\n  },\n  shouldResetStyleCacheOnItemSizeChange: false,\n  validateProps: function validateProps(_ref5) {\n    var itemSize = _ref5.itemSize;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof itemSize !== 'function') {\n        throw Error('An invalid \"itemSize\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (itemSize === null ? 'null' : typeof itemSize) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar FixedSizeGrid = /*#__PURE__*/createGridComponent({\n  getColumnOffset: function getColumnOffset(_ref, index) {\n    var columnWidth = _ref.columnWidth;\n    return index * columnWidth;\n  },\n  getColumnWidth: function getColumnWidth(_ref2, index) {\n    var columnWidth = _ref2.columnWidth;\n    return columnWidth;\n  },\n  getRowOffset: function getRowOffset(_ref3, index) {\n    var rowHeight = _ref3.rowHeight;\n    return index * rowHeight;\n  },\n  getRowHeight: function getRowHeight(_ref4, index) {\n    var rowHeight = _ref4.rowHeight;\n    return rowHeight;\n  },\n  getEstimatedTotalHeight: function getEstimatedTotalHeight(_ref5) {\n    var rowCount = _ref5.rowCount,\n        rowHeight = _ref5.rowHeight;\n    return rowHeight * rowCount;\n  },\n  getEstimatedTotalWidth: function getEstimatedTotalWidth(_ref6) {\n    var columnCount = _ref6.columnCount,\n        columnWidth = _ref6.columnWidth;\n    return columnWidth * columnCount;\n  },\n  getOffsetForColumnAndAlignment: function getOffsetForColumnAndAlignment(_ref7, columnIndex, align, scrollLeft, instanceProps, scrollbarSize) {\n    var columnCount = _ref7.columnCount,\n        columnWidth = _ref7.columnWidth,\n        width = _ref7.width;\n    var lastColumnOffset = Math.max(0, columnCount * columnWidth - width);\n    var maxOffset = Math.min(lastColumnOffset, columnIndex * columnWidth);\n    var minOffset = Math.max(0, columnIndex * columnWidth - width + scrollbarSize + columnWidth);\n\n    if (align === 'smart') {\n      if (scrollLeft >= minOffset - width && scrollLeft <= maxOffset + width) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        // \"Centered\" offset is usually the average of the min and max.\n        // But near the edges of the list, this doesn't hold true.\n        var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n        if (middleOffset < Math.ceil(width / 2)) {\n          return 0; // near the beginning\n        } else if (middleOffset > lastColumnOffset + Math.floor(width / 2)) {\n          return lastColumnOffset; // near the end\n        } else {\n          return middleOffset;\n        }\n\n      case 'auto':\n      default:\n        if (scrollLeft >= minOffset && scrollLeft <= maxOffset) {\n          return scrollLeft;\n        } else if (minOffset > maxOffset) {\n          // Because we only take into account the scrollbar size when calculating minOffset\n          // this value can be larger than maxOffset when at the end of the list\n          return minOffset;\n        } else if (scrollLeft < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getOffsetForRowAndAlignment: function getOffsetForRowAndAlignment(_ref8, rowIndex, align, scrollTop, instanceProps, scrollbarSize) {\n    var rowHeight = _ref8.rowHeight,\n        height = _ref8.height,\n        rowCount = _ref8.rowCount;\n    var lastRowOffset = Math.max(0, rowCount * rowHeight - height);\n    var maxOffset = Math.min(lastRowOffset, rowIndex * rowHeight);\n    var minOffset = Math.max(0, rowIndex * rowHeight - height + scrollbarSize + rowHeight);\n\n    if (align === 'smart') {\n      if (scrollTop >= minOffset - height && scrollTop <= maxOffset + height) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        // \"Centered\" offset is usually the average of the min and max.\n        // But near the edges of the list, this doesn't hold true.\n        var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n        if (middleOffset < Math.ceil(height / 2)) {\n          return 0; // near the beginning\n        } else if (middleOffset > lastRowOffset + Math.floor(height / 2)) {\n          return lastRowOffset; // near the end\n        } else {\n          return middleOffset;\n        }\n\n      case 'auto':\n      default:\n        if (scrollTop >= minOffset && scrollTop <= maxOffset) {\n          return scrollTop;\n        } else if (minOffset > maxOffset) {\n          // Because we only take into account the scrollbar size when calculating minOffset\n          // this value can be larger than maxOffset when at the end of the list\n          return minOffset;\n        } else if (scrollTop < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getColumnStartIndexForOffset: function getColumnStartIndexForOffset(_ref9, scrollLeft) {\n    var columnWidth = _ref9.columnWidth,\n        columnCount = _ref9.columnCount;\n    return Math.max(0, Math.min(columnCount - 1, Math.floor(scrollLeft / columnWidth)));\n  },\n  getColumnStopIndexForStartIndex: function getColumnStopIndexForStartIndex(_ref10, startIndex, scrollLeft) {\n    var columnWidth = _ref10.columnWidth,\n        columnCount = _ref10.columnCount,\n        width = _ref10.width;\n    var left = startIndex * columnWidth;\n    var numVisibleColumns = Math.ceil((width + scrollLeft - left) / columnWidth);\n    return Math.max(0, Math.min(columnCount - 1, startIndex + numVisibleColumns - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  getRowStartIndexForOffset: function getRowStartIndexForOffset(_ref11, scrollTop) {\n    var rowHeight = _ref11.rowHeight,\n        rowCount = _ref11.rowCount;\n    return Math.max(0, Math.min(rowCount - 1, Math.floor(scrollTop / rowHeight)));\n  },\n  getRowStopIndexForStartIndex: function getRowStopIndexForStartIndex(_ref12, startIndex, scrollTop) {\n    var rowHeight = _ref12.rowHeight,\n        rowCount = _ref12.rowCount,\n        height = _ref12.height;\n    var top = startIndex * rowHeight;\n    var numVisibleRows = Math.ceil((height + scrollTop - top) / rowHeight);\n    return Math.max(0, Math.min(rowCount - 1, startIndex + numVisibleRows - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  initInstanceProps: function initInstanceProps(props) {// Noop\n  },\n  shouldResetStyleCacheOnItemSizeChange: true,\n  validateProps: function validateProps(_ref13) {\n    var columnWidth = _ref13.columnWidth,\n        rowHeight = _ref13.rowHeight;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof columnWidth !== 'number') {\n        throw Error('An invalid \"columnWidth\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (columnWidth === null ? 'null' : typeof columnWidth) + \"\\\" was specified.\"));\n      }\n\n      if (typeof rowHeight !== 'number') {\n        throw Error('An invalid \"rowHeight\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (rowHeight === null ? 'null' : typeof rowHeight) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar FixedSizeList = /*#__PURE__*/createListComponent({\n  getItemOffset: function getItemOffset(_ref, index) {\n    var itemSize = _ref.itemSize;\n    return index * itemSize;\n  },\n  getItemSize: function getItemSize(_ref2, index) {\n    var itemSize = _ref2.itemSize;\n    return itemSize;\n  },\n  getEstimatedTotalSize: function getEstimatedTotalSize(_ref3) {\n    var itemCount = _ref3.itemCount,\n        itemSize = _ref3.itemSize;\n    return itemSize * itemCount;\n  },\n  getOffsetForIndexAndAlignment: function getOffsetForIndexAndAlignment(_ref4, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    var direction = _ref4.direction,\n        height = _ref4.height,\n        itemCount = _ref4.itemCount,\n        itemSize = _ref4.itemSize,\n        layout = _ref4.layout,\n        width = _ref4.width;\n    // TODO Deprecate direction \"horizontal\"\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var lastItemOffset = Math.max(0, itemCount * itemSize - size);\n    var maxOffset = Math.min(lastItemOffset, index * itemSize);\n    var minOffset = Math.max(0, index * itemSize - size + itemSize + scrollbarSize);\n\n    if (align === 'smart') {\n      if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        {\n          // \"Centered\" offset is usually the average of the min and max.\n          // But near the edges of the list, this doesn't hold true.\n          var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n          if (middleOffset < Math.ceil(size / 2)) {\n            return 0; // near the beginning\n          } else if (middleOffset > lastItemOffset + Math.floor(size / 2)) {\n            return lastItemOffset; // near the end\n          } else {\n            return middleOffset;\n          }\n        }\n\n      case 'auto':\n      default:\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n          return scrollOffset;\n        } else if (scrollOffset < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getStartIndexForOffset: function getStartIndexForOffset(_ref5, offset) {\n    var itemCount = _ref5.itemCount,\n        itemSize = _ref5.itemSize;\n    return Math.max(0, Math.min(itemCount - 1, Math.floor(offset / itemSize)));\n  },\n  getStopIndexForStartIndex: function getStopIndexForStartIndex(_ref6, startIndex, scrollOffset) {\n    var direction = _ref6.direction,\n        height = _ref6.height,\n        itemCount = _ref6.itemCount,\n        itemSize = _ref6.itemSize,\n        layout = _ref6.layout,\n        width = _ref6.width;\n    // TODO Deprecate direction \"horizontal\"\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var offset = startIndex * itemSize;\n    var size = isHorizontal ? width : height;\n    var numVisibleItems = Math.ceil((size + scrollOffset - offset) / itemSize);\n    return Math.max(0, Math.min(itemCount - 1, startIndex + numVisibleItems - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  initInstanceProps: function initInstanceProps(props) {// Noop\n  },\n  shouldResetStyleCacheOnItemSizeChange: true,\n  validateProps: function validateProps(_ref7) {\n    var itemSize = _ref7.itemSize;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof itemSize !== 'number') {\n        throw Error('An invalid \"itemSize\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (itemSize === null ? 'null' : typeof itemSize) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\n// Pulled from react-compat\n// https://github.com/developit/preact-compat/blob/7c5de00e7c85e2ffd011bf3af02899b63f699d3a/src/index.js#L349\nfunction shallowDiffers(prev, next) {\n  for (var attribute in prev) {\n    if (!(attribute in next)) {\n      return true;\n    }\n  }\n\n  for (var _attribute in next) {\n    if (prev[_attribute] !== next[_attribute]) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar _excluded = [\"style\"],\n    _excluded2 = [\"style\"];\n// It knows to compare individual style props and ignore the wrapper object.\n// See https://reactjs.org/docs/react-api.html#reactmemo\n\nfunction areEqual(prevProps, nextProps) {\n  var prevStyle = prevProps.style,\n      prevRest = _objectWithoutPropertiesLoose(prevProps, _excluded);\n\n  var nextStyle = nextProps.style,\n      nextRest = _objectWithoutPropertiesLoose(nextProps, _excluded2);\n\n  return !shallowDiffers(prevStyle, nextStyle) && !shallowDiffers(prevRest, nextRest);\n}\n\n// It knows to compare individual style props and ignore the wrapper object.\n// See https://reactjs.org/docs/react-component.html#shouldcomponentupdate\n\nfunction shouldComponentUpdate(nextProps, nextState) {\n  return !areEqual(this.props, nextProps) || shallowDiffers(this.state, nextState);\n}\n\nexport { FixedSizeGrid, FixedSizeList, VariableSizeGrid, VariableSizeList, areEqual, shouldComponentUpdate };\n//# sourceMappingURL=index.esm.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.autoprefix = undefined;\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar transforms = {\n  borderRadius: function borderRadius(value) {\n    return {\n      msBorderRadius: value,\n      MozBorderRadius: value,\n      OBorderRadius: value,\n      WebkitBorderRadius: value,\n      borderRadius: value\n    };\n  },\n  boxShadow: function boxShadow(value) {\n    return {\n      msBoxShadow: value,\n      MozBoxShadow: value,\n      OBoxShadow: value,\n      WebkitBoxShadow: value,\n      boxShadow: value\n    };\n  },\n  userSelect: function userSelect(value) {\n    return {\n      WebkitTouchCallout: value,\n      KhtmlUserSelect: value,\n      MozUserSelect: value,\n      msUserSelect: value,\n      WebkitUserSelect: value,\n      userSelect: value\n    };\n  },\n\n  flex: function flex(value) {\n    return {\n      WebkitBoxFlex: value,\n      MozBoxFlex: value,\n      WebkitFlex: value,\n      msFlex: value,\n      flex: value\n    };\n  },\n  flexBasis: function flexBasis(value) {\n    return {\n      WebkitFlexBasis: value,\n      flexBasis: value\n    };\n  },\n  justifyContent: function justifyContent(value) {\n    return {\n      WebkitJustifyContent: value,\n      justifyContent: value\n    };\n  },\n\n  transition: function transition(value) {\n    return {\n      msTransition: value,\n      MozTransition: value,\n      OTransition: value,\n      WebkitTransition: value,\n      transition: value\n    };\n  },\n\n  transform: function transform(value) {\n    return {\n      msTransform: value,\n      MozTransform: value,\n      OTransform: value,\n      WebkitTransform: value,\n      transform: value\n    };\n  },\n  absolute: function absolute(value) {\n    var direction = value && value.split(' ');\n    return {\n      position: 'absolute',\n      top: direction && direction[0],\n      right: direction && direction[1],\n      bottom: direction && direction[2],\n      left: direction && direction[3]\n    };\n  },\n  extend: function extend(name, otherElementStyles) {\n    var otherStyle = otherElementStyles[name];\n    if (otherStyle) {\n      return otherStyle;\n    }\n    return {\n      'extend': name\n    };\n  }\n};\n\nvar autoprefix = exports.autoprefix = function autoprefix(elements) {\n  var prefixed = {};\n  (0, _forOwn3.default)(elements, function (styles, element) {\n    var expanded = {};\n    (0, _forOwn3.default)(styles, function (value, key) {\n      var transform = transforms[key];\n      if (transform) {\n        expanded = _extends({}, expanded, transform(value));\n      } else {\n        expanded[key] = value;\n      }\n    });\n    prefixed[element] = expanded;\n  });\n  return prefixed;\n};\n\nexports.default = autoprefix;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.active = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar active = exports.active = function active(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n\n  return function (_React$Component) {\n    _inherits(Active, _React$Component);\n\n    function Active() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Active);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Active.__proto__ || Object.getPrototypeOf(Active)).call.apply(_ref, [this].concat(args))), _this), _this.state = { active: false }, _this.handleMouseDown = function () {\n        return _this.setState({ active: true });\n      }, _this.handleMouseUp = function () {\n        return _this.setState({ active: false });\n      }, _this.render = function () {\n        return _react2.default.createElement(\n          Span,\n          { onMouseDown: _this.handleMouseDown, onMouseUp: _this.handleMouseUp },\n          _react2.default.createElement(Component, _extends({}, _this.props, _this.state))\n        );\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    return Active;\n  }(_react2.default.Component);\n};\n\nexports.default = active;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.hover = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar hover = exports.hover = function hover(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n\n  return function (_React$Component) {\n    _inherits(Hover, _React$Component);\n\n    function Hover() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Hover);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Hover.__proto__ || Object.getPrototypeOf(Hover)).call.apply(_ref, [this].concat(args))), _this), _this.state = { hover: false }, _this.handleMouseOver = function () {\n        return _this.setState({ hover: true });\n      }, _this.handleMouseOut = function () {\n        return _this.setState({ hover: false });\n      }, _this.render = function () {\n        return _react2.default.createElement(\n          Span,\n          { onMouseOver: _this.handleMouseOver, onMouseOut: _this.handleMouseOut },\n          _react2.default.createElement(Component, _extends({}, _this.props, _this.state))\n        );\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    return Hover;\n  }(_react2.default.Component);\n};\n\nexports.default = hover;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.flattenNames = undefined;\n\nvar _isString2 = require('lodash/isString');\n\nvar _isString3 = _interopRequireDefault(_isString2);\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _isPlainObject2 = require('lodash/isPlainObject');\n\nvar _isPlainObject3 = _interopRequireDefault(_isPlainObject2);\n\nvar _map2 = require('lodash/map');\n\nvar _map3 = _interopRequireDefault(_map2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar flattenNames = exports.flattenNames = function flattenNames() {\n  var things = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n  var names = [];\n\n  (0, _map3.default)(things, function (thing) {\n    if (Array.isArray(thing)) {\n      flattenNames(thing).map(function (name) {\n        return names.push(name);\n      });\n    } else if ((0, _isPlainObject3.default)(thing)) {\n      (0, _forOwn3.default)(thing, function (value, key) {\n        value === true && names.push(key);\n        names.push(key + '-' + value);\n      });\n    } else if ((0, _isString3.default)(thing)) {\n      names.push(thing);\n    }\n  });\n\n  return names;\n};\n\nexports.default = flattenNames;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReactCSS = exports.loop = exports.handleActive = exports.handleHover = exports.hover = undefined;\n\nvar _flattenNames = require('./flattenNames');\n\nvar _flattenNames2 = _interopRequireDefault(_flattenNames);\n\nvar _mergeClasses = require('./mergeClasses');\n\nvar _mergeClasses2 = _interopRequireDefault(_mergeClasses);\n\nvar _autoprefix = require('./autoprefix');\n\nvar _autoprefix2 = _interopRequireDefault(_autoprefix);\n\nvar _hover2 = require('./components/hover');\n\nvar _hover3 = _interopRequireDefault(_hover2);\n\nvar _active = require('./components/active');\n\nvar _active2 = _interopRequireDefault(_active);\n\nvar _loop2 = require('./loop');\n\nvar _loop3 = _interopRequireDefault(_loop2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.hover = _hover3.default;\nexports.handleHover = _hover3.default;\nexports.handleActive = _active2.default;\nexports.loop = _loop3.default;\nvar ReactCSS = exports.ReactCSS = function ReactCSS(classes) {\n  for (var _len = arguments.length, activations = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    activations[_key - 1] = arguments[_key];\n  }\n\n  var activeNames = (0, _flattenNames2.default)(activations);\n  var merged = (0, _mergeClasses2.default)(classes, activeNames);\n  return (0, _autoprefix2.default)(merged);\n};\n\nexports.default = ReactCSS;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar loopable = function loopable(i, length) {\n  var props = {};\n  var setProp = function setProp(name) {\n    var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    props[name] = value;\n  };\n\n  i === 0 && setProp('first-child');\n  i === length - 1 && setProp('last-child');\n  (i === 0 || i % 2 === 0) && setProp('even');\n  Math.abs(i % 2) === 1 && setProp('odd');\n  setProp('nth-child', i);\n\n  return props;\n};\n\nexports.default = loopable;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mergeClasses = undefined;\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _cloneDeep2 = require('lodash/cloneDeep');\n\nvar _cloneDeep3 = _interopRequireDefault(_cloneDeep2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar mergeClasses = exports.mergeClasses = function mergeClasses(classes) {\n  var activeNames = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  var styles = classes.default && (0, _cloneDeep3.default)(classes.default) || {};\n  activeNames.map(function (name) {\n    var toMerge = classes[name];\n    if (toMerge) {\n      (0, _forOwn3.default)(toMerge, function (value, key) {\n        if (!styles[key]) {\n          styles[key] = {};\n        }\n\n        styles[key] = _extends({}, styles[key], toMerge[key]);\n      });\n    }\n\n    return name;\n  });\n  return styles;\n};\n\nexports.default = mergeClasses;","/**\n * @license React\n * use-sync-external-store-shim.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"react\");function h(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var k=\"function\"===typeof Object.is?Object.is:h,l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];n(function(){c.value=d;c.getSnapshot=b;r(c)&&g({inst:c})},[a,d,b]);m(function(){r(c)&&g({inst:c});return a(function(){r(c)&&g({inst:c})})},[a]);p(d);return d}\nfunction r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}function t(a,b){return b()}var u=\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement?t:q;exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u;\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var h=require(\"react\"),n=require(\"use-sync-external-store/shim\");function p(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var q=\"function\"===typeof Object.is?Object.is:p,r=n.useSyncExternalStore,t=h.useRef,u=h.useEffect,v=h.useMemo,w=h.useDebugValue;\nexports.useSyncExternalStoreWithSelector=function(a,b,e,l,g){var c=t(null);if(null===c.current){var f={hasValue:!1,value:null};c.current=f}else f=c.current;c=v(function(){function a(a){if(!c){c=!0;d=a;a=l(a);if(void 0!==g&&f.hasValue){var b=f.value;if(g(b,a))return k=b}return k=a}b=k;if(q(d,a))return b;var e=l(a);if(void 0!==g&&g(b,e))return b;d=a;return k=e}var c=!1,d,k,m=void 0===e?null:e;return[function(){return a(b())},null===m?void 0:function(){return a(m())}]},[b,e,l,g]);var d=r(a,c[0],c[1]);\nu(function(){f.hasValue=!0;f.value=d},[d]);w(d);return d};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"\n      );\n    }\n    listeners.clear();\n  };\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = (createState) => createState ? createStoreImpl(createState) : createStoreImpl;\nvar vanilla = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\"\n    );\n  }\n  return createStore(createState);\n};\n\nexport { createStore, vanilla as default };\n","import { createStore } from 'zustand/vanilla';\nexport * from 'zustand/vanilla';\nimport ReactExports from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\n\nconst { useDebugValue } = ReactExports;\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nlet didWarnAboutEqualityFn = false;\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity, equalityFn) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && equalityFn && !didWarnAboutEqualityFn) {\n    console.warn(\n      \"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && typeof createState !== \"function\") {\n    console.warn(\n      \"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\"\n    );\n  }\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useBoundStore = (selector, equalityFn) => useStore(api, selector, equalityFn);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = (createState) => createState ? createImpl(createState) : createImpl;\nvar react = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\"\n    );\n  }\n  return create(createState);\n};\n\nexport { create, react as default, useStore };\n","const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...a) => api.dispatch(...a), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (_e) {\n  }\n  if (!extensionConnector) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && enabled) {\n      console.warn(\n        \"[zustand devtools middleware] Please install/enable Redux devtools extension\"\n      );\n    }\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = (state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? { type: anonymousActionType || \"anonymous\" } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...a) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && a[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...a);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, f) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) f(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = (selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  };\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nconst combine = (initialState, create) => (...a) => Object.assign({}, initialState, create(...a));\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (_e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(\n      name,\n      JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n    ),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst oldImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    getStorage: () => localStorage,\n    serialize: JSON.stringify,\n    deserialize: JSON.parse,\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage;\n  try {\n    storage = options.getStorage();\n  } catch (_e) {\n  }\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const thenableSerialize = toThenable(options.serialize);\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    let errorInSync;\n    const thenable = thenableSerialize({ state, version: options.version }).then(\n      (serializedValue) => storage.setItem(options.name, serializedValue)\n    ).catch((e) => {\n      errorInSync = e;\n    });\n    if (errorInSync) {\n      throw errorInSync;\n    }\n    return thenable;\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => cb(get()));\n    const postRehydrationCallback = ((_a = options.onRehydrateStorage) == null ? void 0 : _a.call(options, get())) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((storageValue) => {\n      if (storageValue) {\n        return options.deserialize(storageValue);\n      }\n    }).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return deserializedStorageValue.state;\n        }\n      }\n    }).then((migratedState) => {\n      var _a2;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      return setItem();\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.getStorage) {\n        storage = newOptions.getStorage();\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  hydrate();\n  return stateFromStorage || configResult;\n};\nconst newImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return [\n              true,\n              options.migrate(\n                deserializedStorageValue.state,\n                deserializedStorageValue.version\n              )\n            ];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persistImpl = (config, baseOptions) => {\n  if (\"getStorage\" in baseOptions || \"serialize\" in baseOptions || \"deserialize\" in baseOptions) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead.\"\n      );\n    }\n    return oldImpl(config, baseOptions);\n  }\n  return newImpl(config, baseOptions);\n};\nconst persist = persistImpl;\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector };\n"],"names":["FullDateInterface","constructor","date","this","fullDate","getTimeInSec","dateString","substring","timeString","yyyy","parseInt","mm","length","undefined","dd","isNaN","Error","dateJS","Date","HH","MM","SS","fractionalStr","FFFFFF","Math","pow","timeInSec","getTime","getTimeInMicroSec","combineDateTime","time","hours","padStart","minutes","seconds","month","day","fractionalSeconds","padEnd","year","parseDA","d","m","y","daysInMonth","parseTM","hh","ss","ffffff","dateTimeToFullDateInterface","dateTime","calculateDecayCorrection","instances","RadionuclideTotalDose","RadionuclideHalfLife","RadiopharmaceuticalStartDateTime","RadiopharmaceuticalStartTime","SeriesDate","scanTimes","SeriesTime","GEPrivatePostInjectionDateTime","results","Array","seriesDateTime","earliestAcquisitionDateTime","timeError","forEach","instance","AcquisitionDate","AcquisitionTime","acquisitionDateTime","fill","calculateScanTimes","startTime","input","calculateStartTime","map","_","index","decayTimeInSec","deepEquals","a","b","isArray","every","val","calculateSUVScalingFactors","CorrectedImage","Units","PhilipsPETPrivateGroup","PatientWeight","PatientSex","PatientSize","includes","DecayCorrection","decayCorrectionArray","weightInGrams","value","hasValidSUVScaleFactor","_instance$PhilipsPETP","_instance$PhilipsPETP2","_instance$PhilipsPETP3","SUVScaleFactor","hasValidActivityConcentrationScaleFactor","_instance$PhilipsPETP4","_instance$PhilipsPETP5","_instance$PhilipsPETP6","ActivityConcentrationScaleFactor","JSON","stringify","suvbsaFactor","suvlbmFactor","suvlbmJenmaFactor","console","warn","inputs","calculateSUVbsaScalingFactor","suvlbmInputs","LBM","weightSizeFactor","calculateSUVlbmScalingFactor","bodyMassIndex","calculateSUVlbmJanmahasatianScalingFactor","result","factors","suvbw","suvbsa","suvlbm","suvlbmJanma","DEFINED_CURSORS","Symbol","STANDARD_CURSORS","Set","MouseCursor","name","fallback","getName","addFallbackStyleProperty","style","getStyleProperty","getDefinedCursor","definedCursors","getDefinedCursors","mouseCursor","get","has","set","setDefinedCursor","cursor","context","symbol","Map","Object","defineProperty","standardCursorNames","values","ELEMENT_CURSORS_MAP","initElementCursor","element","_getElementCursors","_setElementCursor","cursors","resetElementCursor","hideElementCursor","WeakMap","ImageMouseCursor","url","x","super","getUniqueInstanceName","Number","prefix","utilities","BASE","iconContent","iconSize","viewBox","mousePoint","mousePointerGroupString","SEGMENTATION_CURSOR_BOUNDARIES","MINUS_RECT","PLUS_RECT","SCISSOR_ICON","RECTANGLE_ICON","CIRCLE_ICON","CursorSVG","Angle","extend","ArrowAnnotate","Bidirectional","CobbAngle","CircleROI","EllipticalROI","FreehandROI","FreehandROISculptor","Length","Height","Probe","RectangleROI","TextMarker","Crosshairs","Eraser","Magnify","Pan","Rotate","StackScroll","WindowLevelRegion","WindowLevel","Zoom","SegmentationFreeHandEraseInside","SegmentationFreeHandFillInside","SegmentationFreeHandEraseOutside","SegmentationFreeHandFillOutside","SegmentationRectangleEraseInside","RectangleScissor","CircleScissor","base","assign","create","registerCursor","toolName","svgCursorNames","keys","STATE","AnnotationStyleStates","Highlighted","MODE","ToolModes","Active","SVGMouseCursor","pointer","color","urn","type","getCursorURN","descriptor","getDefinedSVGCursorDescriptor","options","blob","svgString","createSVGIconWithPointer","createSVGIcon","Blob","createSVGIconBlob","URL","createObjectURL","createSVGIconUrl","createSVGMouseCursor","format","template","dictionary","dict","defined","prototype","hasOwnProperty","bind","replace","match","key","svgSize","max","cursorName","log","setElementCursor","CursorNames","VIEWPORT_ELEMENT","getSvgNode","canvasHash","cacheKey","state","svgNodeCache","domRef","appendNode","svgLayerElement","svgNode","touched","appendChild","setNodeTouched","clearUntouched","cacheEntry","removeChild","enabledElement","getEnabledElement","viewportId","renderingEngineId","viewportElement","internalDivElement","querySelector","svgLayer","_getSvgLayer","svgNodeCacheForCanvas","fn","svgDrawingHelper","attributes","currentValue","getAttribute","newValue","removeAttribute","setAttribute","annotationUID","circleUID","center","radius","dataId","width","lineWidth","lineDash","fillOpacity","strokeOpacity","strokeWidth","svgNodeHash","_getHash","existingCircleElement","cx","cy","r","stroke","newCircleElement","document","createElementNS","ellipseUID","canvasCoordinates","existingEllipse","bottom","top","left","right","w","hypot","h","angle","atan2","PI","rx","ry","transform","svgEllipseElement","corner1","corner2","handleGroupUID","handle","uniqueIndex","handleRadius","opacity","side","parseFloat","height","existingHandleElement","newHandleElement","handlePoints","i","drawLine","lineUID","start","end","shadow","existingLine","dropShadowStyle","id","x1","y1","x2","y2","newLine","drawHeight","heightUID","midX","endfirstLine","endsecondLine","firstLine","secondLine","threeLine","drawPolyline","polylineUID","points","fillColor","closePath","existingPolyLine","pointsAttribute","point","toFixed","firstPoint","newPolyLine","drawPath","pathUID","pointsArrays","existingNode","numArrays","numPoints","j","newNode","_createTextSpan","text","textSpanElement","textContent","_drawTextBackground","group","getBBox","insertBefore","firstChild","bBox","textUID","textLines","position","padding","fontFamily","fontSize","background","textGroupBoundingBox","svgns","existingTextGroup","textElement","textSpans","from","children","textSpan","textGroupAttributes","textGroup","noSelectStyle","combinedStyle","_createTextElement","_drawTextGroup","centerX","centerY","linkUID","annotationAnchorPoints","refPoint","boundingBox","findClosestPoint","boundingBoxPoints","halfWidth","halfHeight","_boundingBoxPoints","textBoxUID","textBoxPosition","textBox","mergedOptions","centering","canvasBoundingBox","drawRectByCoordinates","rectangleUID","_width","existingRect","topLeft","topRight","bottomLeft","bottomRight","leftEdgeCenter","svgRectElement","drawRect","drawArrow","arrowUID","cos","sin","drawRedactionRect","tlhc","min","abs","ChangeTypes","Events","StrategyCallbacks","Swipe","DEFAULT_CONTOUR_SEG_TOOL_NAME","async","contourSegmentationCompletedListener","evt","sourceAnnotation","detail","annotation","isContourSegmentationAnnotation","viewport","viewports","viewportWithToolRegistered","find","isFreehandContourSegToolRegisteredForViewport","getViewport","contourSegmentationAnnotations","sourceAnnotationUID","getAllAnnotations","filter","targetAnnotation","areSameSegment","isReferenceViewable","metadata","getValidContourSegmentationAnnotations","sourcePolyline","convertContourPolylineToCanvasSpace","data","contour","polyline","targetAnnotationInfo","sourceAABB","targetPolyline","targetAABB","aabbIntersect","lineSegmentsIntersect","isContourHole","findIntersectingContour","contourHoleProcessingEnabled","createPolylineHole","sourceStartPoint","mergePolylines","contourHolesData","getChildAnnotations","holeAnnotation","getContourHolesData","unassignedContourHolesSet","reassignedContourHolesMap","assignHoleToPolyline","parentPolyline","holeData","holes","push","delete","newPolylines","mergedPolyline","newPolyline","contourHolesDataArray","contourHoleData","clearParentAnnotation","handles","segmentation","removeAnnotation","startPoint","canvasToWorld","endPoint","newAnnotation","originalToolName","cachedStats","closed","spline","highlighted","invalidated","isLocked","isVisible","interpolationUID","interpolationCompleted","targetWindingDirection","Clockwise","addAnnotation","addContourSegmentationAnnotation","addChildAnnotation","updatedTtoolNames","viewportIdsToRender","getViewportIdsWithToolToRender","Promise","resolve","window","requestAnimationFrame","updateViewports","combinePolylines","silent","toolGroup","getToolGroupForViewport","errorMessage","hasTool","getToolOptions","projectedPolyline","worldToCanvas","windingDirection","holeWindingDirection","removeContourSegmentationAnnotation","holeContour","holePolyline","updatedToolNames","disable","removeEventListener","mouseDoubleClickListener","mouseDownListener","mouseMoveListener","capture","enable","addEventListener","preventGhostClick","touchStartListener","passive","wheelListener","segmentationId","modifiedSlicesToUse","representationData","viewportIds","hasVolumeViewport","some","getEnabledElementByViewportId","VolumeViewport","hasStackViewport","StackViewport","hasBothStackAndVolume","segmentationVolume","cache","getVolume","volumeId","imageData","vtkOpenGLTexture","slicesToUpdate","numSlices","getDimensions","setUpdatedFrame","modified","performVolumeLabelmapUpdate","SegmentationRepresentations","Labelmap","representations","representation","actorEntry","segImageData","actor","getMapper","getInputData","currentSegmentationImageId","segmentationImage","getImage","performStackLabelmapUpdate","getSegmentation","_imageChangeEventListener","eventData","getEnabledElementByIds","getSegmentationRepresentation","labelmapRepresentations","actors","getActors","updateLabelmapSegmentationImageReferences","labelmapActors","getCurrentLabelmapImageIdForViewport","referencedId","removeActors","uid","currentImageId","getCurrentImageId","derivedImageId","derivedImage","segmentationActorInput","dimensions","spacing","direction","getImageDataMetadata","currentImage","imageId","origin","currentOrigin","originToUse","voxelManager","getConstructor","newPixelData","getScalarData","scalarArray","numberOfComponents","setDimensions","setSpacing","setDirection","setOrigin","getPointData","setScalars","addImages","representationUID","callback","imageActor","setInputData","segmentationImageData","setDerivedImage","render","Enums","IMAGE_RENDERED","BaseVolumeViewport","STACK_NEW_IMAGE","annotationCompletedListener","contourSegmentationCompleted","removed","getRenderingEngines","renderingEngine","getViewports","vp","triggerAnnotationRenderForViewportIds","t","annotationRemovedListener","onImageRendered","triggerAnnotationRender","MOUSE_CLICK","MOUSE_DOWN","MOUSE_DOWN_ACTIVATE","MOUSE_DOUBLE_CLICK","MOUSE_DRAG","MOUSE_MOVE","MOUSE_UP","MOUSE_WHEEL","KEY_DOWN","KEY_UP","Passive","Enabled","onCameraModified","getToolsWithModesForMouseEvent","tool","CAMERA_MODIFIED","onImageSpacingCalibrated","IMAGE_SPACING_CALIBRATED","TOUCH_START","TOUCH_START_ACTIVATE","TOUCH_DRAG","TOUCH_END","TOUCH_TAP","TOUCH_PRESS","eventTarget","ANNOTATION_COMPLETED","InterpolationManager","handleAnnotationCompleted","ANNOTATION_MODIFIED","handleAnnotationUpdate","ANNOTATION_REMOVED","handleAnnotationDelete","onCameraReset","onResetCamera","CAMERA_RESET","addEnabledElement","svgLayerId","classList","add","pointerEvents","defs","feOffset","feColorMatrix","feBlend","_createSvgAnnotationLayer","viewportUid","renderingEngineUid","dataset","elementHash","_setSvgNodeCache","addViewportElement","imageRenderedEventDispatcher","cameraModifiedEventDispatcher","imageSpacingCalibratedEventDispatcher","cameraResetEventDispatcher","enabledElements","synchronizersFilteredByIds","synchronizers","synchronizer","notDisabled","isDisabled","hasSourceViewport","hasTargetViewport","_removeViewportFromSynchronizers","sync","remove","_removeViewportFromToolGroup","removeViewports","_removeEnabledElement","foundElementIndex","findIndex","el","splice","elementDisabledEvt","_resetSvgNodeCache","internalViewportNode","_removeSvgNode","removeViewportElement","cancelActiveManipulations","tools","toolsWithData","cancel","_getViewportIndex","arr","ar","_containsViewport","synchronizerId","eventName","eventHandler","_viewportOptions","_onEvent","_ignoreFiredEvents","_targetViewports","_eventSource","currentTarget","_sourceViewports","s","fireEvent","_enabled","_eventName","_eventHandler","_options","eventSource","_auxiliaryEvents","auxiliaryEvents","_hasSourceElements","setOptions","setEnabled","enabled","getOptions","viewportInfo","addTarget","addSource","getRenderingEngine","source","_updateDisableHandlers","getSourceViewports","getTargetViewports","destroy","removeSource","removeTarget","getViewportElement","sourceViewport","sourceEvent","promises","targetViewport","ex","allSettled","then","vp1","vp2","unique","vps","concat","u","_getUniqueViewports","_remove","disableHandler","elementDisabledEvent","getEventSource","ELEMENT_DISABLED","pop","synchronizerIndex","csToolsInitialized","init","defaultConfiguration","_removeCornerstoneEventListeners","elementEnabledEvent","ELEMENT_ENABLED","annotationInterpolationEventDispatcher","_addCornerstoneEventListeners","_removeCornerstoneToolsEventListeners","ANNOTATION_SELECTION_CHANGE","SEGMENTATION_MODIFIED","SEGMENTATION_DATA_MODIFIED","SEGMENTATION_REPRESENTATION_MODIFIED","SEGMENTATION_REPRESENTATION_ADDED","ToolGroupManager","annotationManager","getAnnotationManager","segmentationStateManager","restoreAnnotations","resetState","cameraSyncCallback","synchronizerInstance","cameraModifiedEvent","camera","tViewport","setCamera","createCameraPositionSynchronizer","synchronizerName","presentationViewSyncCallback","_synchronizerInstance","_sourceEvent","presentationView","getViewPresentation","setViewPresentation","createPresentationViewSynchronizer","viewPresentation","voiSyncCallback","modifiedEvent","eventDetail","range","invertStateChanged","invert","colormap","tProperties","voiRange","syncInvertState","syncColormap","_actors","size","setProperties","createVOISynchronizer","VOI_MODIFIED","COLORMAP_MODIFIED","zoomPanSyncCallback","sViewport","syncZoom","srcZoom","getZoom","setZoom","syncPan","srcPan","getPan","setPan","createZoomPanSynchronizer","getSpatialRegistration","targetId","sourceId","imageSliceSyncCallback","disabled","imageId1","sourceImagePositionPatient","metaData","imagePositionPatient","targetImageIds","getImageIds","viewport1","viewport2","viewPlaneNormal","viewPlaneNormal1","getCamera","viewPlaneNormal2","dotProducts","areViewportsCoplanar","registrationMatrixMat4","getFrameOfReferenceUID","useInitialPosition","targetImagePositionPatientWithRegistrationMatrix","closestImageIdIndex2","targetPoint","reduce","closestImageIdIndex","distance","Infinity","imageIndexToSet","getCurrentImageIdIndex","imageIndex","VOLUME_NEW_IMAGE","createImageSliceSynchronizer","slabThicknessSyncCallback","slabThickness","getSlabThickness","setSlabThickness","createStackImageSynchronizer","PanTool","toolProps","defaultToolProps","supportedInteractionTypes","touchDragCallback","_dragCallback","mouseDragCallback","deltaPoints","deltaPointsWorld","world","focalPoint","updatedPosition","updatedFocalPoint","TrackballRotateTool","configuration","rotateIncrementDegrees","_resizeObservers","_hasResolutionChanged","preMouseDownCallback","mapper","getDefaultActor","originalSampleDistance","getSampleDistance","setSampleDistance","cleanUp","once","_getViewportsInfo","getToolGroup","toolGroupId","viewportsInfo","onSetToolActive","subscribeToElementResize","resizeObserver","ResizeObserver","resetCamera","observe","_viewportAddedListener","TOOLGROUP_VIEWPORT_ADDED","onSetToolDisabled","disconnect","rotateCamera","centerWorld","axis","vtkCamera","getVtkActiveCamera","viewUp","getViewUp","getFocalPoint","getPosition","newPosition","newFocalPoint","newViewUp","Float32Array","currentPoints","lastPoints","currentPointsCanvas","canvas","lastPointsCanvas","clientWidth","clientHeight","normalizedPosition","normalizedPreviousPosition","radsq","op","oe","opsq","oesq","lop","sqrt","loe","nop","noe","dot","angleX","acos","sign","upVec","atV","rightV","forwardV","angleY","WindowLevelTool","_getImageDynamicRangeFromMiddleSlice","scalarData","middleSliceIndex","floor","frameLength","bytesPerVoxel","TypedArrayConstructor","Uint8Array","Uint16Array","Int16Array","frame","buffer","_getMinMax","lower","upper","modality","newRange","viewportsContainingVolumeUID","isPreScaled","properties","getProperties","getVolumeId","volume","Modality","scaling","preScale","scaled","getImageData","scalingParameters","getPTScaledNewRange","deltaPointsCanvas","getNewRange","multiplier","_getMultiplierFromDynamicRange","wwDelta","wcDelta","windowWidth","windowCenter","imageDynamicRange","imageVolume","calculatedDynamicRange","getMiddleSliceData","acc","pixel","BitsStored","metadataDynamicRange","_getImageDynamicRangeFromViewport","ratio","round","getRange","imageDataRange","getScalars","getData","voxel","WindowLevelRegionTool","minWindowWidth","addNewAnnotation","worldPos","isDrawing","referencedImageId","getReferencedImageId","FrameOfReferenceUID","getToolName","editData","_activateDraw","preventDefault","_endCallback","_deactivateDraw","applyWindowLevelRegion","bottomLeftCanvas","topRightCanvas","bottomRightCanvas","topLeftCanvas","bottomRightWorld","topLeftWorld","isInteractingWithTool","renderAnnotation","renderStatus","annotations","filterInteractableAnnotationsForElement","styleSpecifier","p","getAnnotationStyle","windowLevel","startCanvas","endCanvas","pixelLuminanceData","minMaxMean","minPixelValue","maxPixelValue","mean","isPointNearTool","toolSelectedCallback","handleSelectedCallback","_activateModify","_deactivateModify","StackScrollTool","debounceIfNotLoaded","loop","deltaY","mouseWheelCallback","_scroll","_scrollDrag","deltaPointY","pixelsPerImage","_getPixelPerImage","imageIdIndexOffset","delta","debounceLoading","wheel","scrollSlabs","numberOfSlices","getNumberOfSlices","offsetHeight","PlanarRotateTool","setAngle","startPoints","currentPointWorld","startPointWorld","centerCanvas","angleBetweenLines","v1","v2","cross","rotAngle","rotMat","rotatedViewUp","rotation","ZoomTool","zoomToCenter","minZoomScale","maxZoomScale","pinchToZoom","pan","initialMousePosWorld","dirVec","preTouchStartCallback","_dragParallelProjection","pinch","deltaDistance","parallelScale","k","parallelScaleToSet","focalPointToSet","positionToSet","distanceToCanvasCenter","scale","cappedParallelScale","thresholdExceeded","_dragPerspectiveProjection","zoomScale","directionOfProjection","tmp","_pinchCallback","currentPointsList","parallelProjection","_panCallback","MIPJumpToClickTool","targetViewportIds","mouseClickCallback","maxIntensity","brightestPoint","getPointInLineOfSightWithCriteria","intensity","indexOf","foundToolGroup","jumpToWorld","RENDERING_DEFAULTS","CONSTANTS","defaultReferenceLineColor","defaultReferenceLineControllable","defaultReferenceLineDraggableRotatable","defaultReferenceLineSlabThicknessControlsOn","OPERATION","CrosshairsTool","viewportIndicators","viewportIndicatorsConfig","autoPan","panSize","referenceLinesCenterGapRadius","filterActorUIDsToSetSlabThickness","slabThicknessBlendMode","MAXIMUM_INTENSITY_BLEND","mobile","toolCenter","initializeViewport","_getAnnotations","cameraPosition","cameraFocalPoint","rotationPoints","slabThicknessPoints","activeOperation","activeViewportIds","normal","resetCrosshairs","resetPan","resetZoom","resetToCenter","resetRotation","suppressEvents","resetSlabThickness","_computeToolCenter","computeToolCenter","firstViewport","secondViewport","thirdViewport","normal1","point1","normal2","point2","normal3","point3","firstPlane","secondPlane","thirdPlane","jumpWorld","_jump","filteredAnnotations","viewportIdArray","otherViewport","viewportControllable","_getReferenceLineControllable","viewportDraggableRotatable","_getReferenceLineDraggableRotatable","canvasCoords","proximity","_pointNearTool","interactionType","viewportAnnotation","currentCamera","oldCameraPosition","deltaCameraPosition","oldCameraFocalPoint","deltaCameraFocalPoint","isRotation","cameraModifiedInPlane","getViewportIds","_autoPanViewportIfNecessary","mouseMoveCallback","filteredToolAnnotations","imageNeedsUpdate","isAnnotationLocked","previousActiveOperation","previousActiveViewportIds","near","getHandleNearImagePoint","_areViewportIdArraysEqual","viewportUIDSpecificCrosshairs","canvasDiagonalLength","canvasMinDimensionLength","crosshairCenterCanvas","otherViewportAnnotations","_filterAnnotationsByUniqueViewportOrientations","referenceLines","canvasBox","otherCamera","otherViewportControllable","otherViewportDraggableRotatable","otherViewportSlabThicknessControlsOn","_getReferenceLineSlabThicknessControlsOn","otherCanvasDiagonalLength","otherCanvasCenter","otherViewportCenterWorld","pointWorld0","pointWorld1","pointCanvas0","otherViewportCenterCanvas","canvasUnitVectorFromCenter","canvasVectorFromCenterLong","canvasVectorFromCenterMid","canvasVectorFromCenterShort","canvasVectorFromCenterStart","centerGap","refLinePointOne","refLinePointTwo","refLinePointThree","refLinePointFour","refLinesCenter","liangBarksyClip","rotHandleOne","rotHandleTwo","stHandlesCenterCanvas","stHandlesCenterWorld","worldUnitVectorFromCenter","matrix","buildFromDegree","rotate","worldUnitOrthoVectorFromCenter","slabThicknessValue","worldOrthoVectorFromCenter","worldVerticalRefPoint","canvasVerticalRefPoint","canvasOrthoVectorFromCenter","stLinePointOne","stLinePointTwo","stLinePointThree","stLinePointFour","stHandleOne","stHandleTwo","stHandleThree","stHandleFour","newRtpoints","newStpoints","viewportColor","_getReferenceLineColor","line","lineIndex","viewportSlabThicknessControlsOn","selectedViewportId","lineActive","rotHandlesActive","rotationHandles","rotHandleWorldOne","rotHandleWorldTwo","slabThicknessHandlesActive","slabThicknessHandles","slabThicknessHandleWorldOne","slabThicknessHandleWorldTwo","slabThicknessHandleWorldThree","slabThicknessHandleWorldFour","handleUID","drawHandles","referenceColorCoordinates","xOffset","yOffset","circleRadius","drawCircle","getAnnotations","toolGroupAnnotations","_onNewVolume","viewportIdArrayOne","viewportIdArrayTwo","itemFound","_getAnnotationsForViewportsWithDifferentCameras","viewportsWithDifferentCameras","cameraOfTarget","_filterViewportWithSameOrientation","referenceAnnotation","linkedViewportAnnotations","otherViewportsAnnotationsWithSameCameraDirection","otherViewPlaneNormal","otherLinkedViewportAnnotationsFromSameScene","otherViewportsAnnotationsWithUniqueCameras","cameraFound","jj","cameraOfStocked","otherNonLinkedViewportAnnotationsFromSameScene","_checkIfViewportsRenderingSameScene","volumeIds","getAllVolumeIds","otherVolumeIds","viewportsAnnotationsToUpdate","sameScene","_applyDeltaShiftToSelectedViewportCameras","dir1","dir2","finalPointCanvas","originalPointCanvas","_isClockWise","rotationAxis","buildFromRadian","translate","otherViewportsIds","renderViewports","referenceAnnotations","viewportsIds","dotProd","projectedDelta","mod","currentPoint","currentCenter","otherViewportRotationPoints","dotProdDirection","projectedDirection","normalizedProjectedDirection","normalizedProjectedDelta","MINIMUM_SLAB_THICKNESS","_pointNearReferenceLine","getToolInstance","lineViewport","lineSegment1","distanceToPoint1","lineSegment2","distanceToPoint2","getReferenceLineColor","getReferenceLineControllable","getReferenceLineDraggableRotatable","getReferenceLineSlabThicknessControlsOn","_unsubscribeToViewportNewVolumeSet","_subscribeToViewportNewVolumeSet","onSetToolPassive","onSetToolEnabled","_getRotationHandleNearImagePoint","_getSlabThicknessHandleNearImagePoint","VOLUME_VIEWPORT_NEW_VOLUME","toolCenterCanvas","visiblePointCanvas","visiblePointWorld","actorUIDs","blendModeToUse","COMPOSITE","setBlendMode","c","_applyDeltaShiftToViewportCamera","annotationCanvasCoordinate","stPointLineCanvas1","stPointLineCanvas2","stPointLineCanvas1Start","stPointLineCanvas2Start","MAGNIFY_VIEWPORT_ID","MagnifyTool","magnifySize","magnifyWidth","magnifyHeight","_hasBeenRemoved","_getReferencedImageId","_createMagnificationViewport","viewportProperties","canvasPos","magnifyToolElement","magnifyElement","createElement","display","viewportInput","STACK","enableElement","magnifyViewport","setStack","_dragEndCallback","disableElement","getTargetId","split","csEvents","isSegmentation","AdvancedMagnifyToolActions","PARALLEL_THRESHOLD","AdvancedMagnifyTool","Actions","magnifyingGlass","zoomFactor","zoomFactorList","actions","showZoomFactorsList","method","bindings","mouseButton","MouseBindings","Secondary","modifierKey","KeyboardBindings","Shift","config","canvasHandlePoints","_getCanvasHandlePoints","magnifyViewportId","sourceViewportId","isCanvasAnnotation","activeHandleIndex","magnifyViewportManager","createViewport","sourceEnabledElement","annotationPoints","canvasDelta","len","dispose","canvasTop","canvasBottom","canvasLeft","radiusPoint","handleIndex","_dragDrawCallback","hasMoved","_dragModifyCallback","_dragHandle","canvasCenter","currentCanvasPoints","newRadius","newCanvasHandlePoints","getStyle","activeHandleCanvasCoords","isAnnotationVisible","update","canvasCenterPos","canvasRadius","AdvancedMagnifyViewportManager","getInstance","canvasPoint","currentZoomFactor","dropdown","_getZoomFactorsListDropdown","newZoomFactor","parentElement","focus","onChangeCallback","stopPropagation","keyCode","which","toLowerCase","option","label","title","defaultSelected","sourceElement","AdvancedMagnifyViewport","_addSourceElementEventListener","_magnifyViewportsMap","magnifyViewportInfo","_annotationRemovedCallback","destroyViewport","_newStackImageCallback","magnifyViewportsMapEntries","_getMagnifyViewportsMapEntriesBySourceViewportId","stackActorReInitialized","_reset","_newVolumeImageCallback","currentViewPlaneNormal","worldImagePlanePoint","vecHandleToImagePlane","worldDist","worldDelta","_initialize","_singleton","_removeEventListeners","_destroyViewports","magnifyViewportMapEntry","_removeSourceElementEventListener","newEnabledElement","_addEventListeners","newStackHandler","VIEWPORT_NEW_IMAGE_SET","newVolumeHandler","_enabledElement","_sourceToolGroup","_magnifyToolGroup","_isViewportReady","_radius","_resized","_canAutoPan","_viewportId","_sourceEnabledElement","_autoPan","visible","_browserMouseDownCallback","_browserMouseUpCallback","_handleToolModeChanged","_mouseDragCallback","_resizeViewportAsync","debounce","_resizeViewport","_syncViewports","parentNode","magnifyToolGroup","mode","toolBindingsOptions","setToolActive","setToolPassive","setToolEnabled","Disabled","setToolDisabled","_inheritBorderRadius","borderRadius","_createViewportNode","overflow","boxSizing","_convertZoomFactorToParallelScale","offsetWidth","_isStackViewport","_isVolumeViewport","_cloneToolGroups","sourceActors","magnifyToolGroupId","sourceToolGroup","clone","toolInstance","addViewport","addSegmentationRepresentations","_cloneStack","imageIds","_cloneVolumes","volumeInputArray","setVolumes","_cloneViewport","sourceViewportOptions","defaultOptions","toolGroups","_cancelMouseEventCallback","target","closest","canvasCurrent","magnifyRadius","dist","distanceToPoint","maxDist","panDist","canvasDeltaPos","newCanvasPosition","currentWorldPos","newWorldPos","worldDeltaPos","autoPanCallbackData","currentPosition","_addBrowserEventListeners","_removeBrowserEventListeners","TOOL_MODE_CHANGED","sourceCanvas","_syncViewportsCameras","_syncStackViewports","setImageIdIndex","sourceProperties","resize","EPSILON","ReferenceLines","AnnotationDisplayTool","A","enforceSameFrameOfReference","showFullDimension","_init","filterViewportsWithToolEnabled","sourceViewportCanvasCornersInWorld","onSetToolConfiguration","sourceViewPlaneNormal","isParallel","targetViewportPlane","pointSet1","pointSet2","pointSetToUse","topBottomVec","topRightVec","newNormal","isPerpendicular","lineStartWorld","lineEndWorld","handleFullDimension","vec1","vec2","targetImage","getTargetImageData","topLeftImageCoord","topRightImageCoord","bottomRightImageCoord","bottomLeftImageCoord","indexToWorld","lineStartImageCoord","lineEndImageCoord","intersectInfiniteLines","isInBound","err","line1Start","line1End","line2Start","line2End","x3","y3","x4","y4","a1","b1","c1","a2","b2","c2","OverlayGridTool","sourceImageIds","imagePlaneModule","frameOfReferenceUID","pointSets","calculateImageIdPointSets","viewportData","rows","columns","rowCosines","columnCosines","rowPixelSpacing","columnPixelSpacing","imageIdNormal","getImageIdNormal","targetData","initializeViewportData","pointSetsToUse","lineStartsWorld","lineEndsWorld","imageOrientationPatient","rowCosineVec","colCosineVec","SegmentationIntersectionTool","actorsWorldPointsMap","calculateSurfaceSegmentationIntersectionsForViewport","calculateSurfaceSegmentationIntersections","actorEntries","cacheId","getCacheId","clippingFilter","actorWorldPointMap","polyLineIdx","worldPointsSet","canvasPoints","polyLineUID","actorWorldPointsMap","polyData","getOutputData","polyDataUtils","colorArray","colorComponentToString","component","componentString","toString","colorToString","getProperty","getColor","pointToString","ReferenceCursors","preventHandleOutsideImage","displayThreshold","positionSync","disableCursor","isHandleOutsideImage","_elementWithCursor","_currentCursorWorldPosition","_currentCanvasPosition","_disableCursorEnabled","getActiveAnnotation","createInitialAnnotation","updateAnnotationPosition","worldPosition","worldBoundingBox","previousCamera","oldFocalPoint","cameraNormal","dotProduct","isElementWithCursor","updateViewportImage","lineWidthBase","e","crosshairUIDs","centerSpace","lineLength","plane","currentMousePosition","closestIndex","currentDistance","normalizedViewPlane","scaledPlaneNormal","renderViewport","viewportsWithAnnotations","ScaleOverlayTool","scaleLocation","viewportCanvasCornersInWorld","thisAnnotation","computeScaleSize","worldWidthViewport","worldHeightViewport","location","scaleSizes","currentScaleSize","scaleSize","computeEndScaleTicks","locationTickOffset","endTick1","endTick2","computeInnerScaleTicks","leftTick","rightTick","canvasScaleSize","tickIds","tickUIDs","tickCoordinates","numberSmallTicks","tickSpacing","locationOffset","computeWorldScaleCoordinates","pointSet","worldCoordinates","midpointLocation","midpoint","offset","computeCanvasScaleCoordinates","canvasSize","vscaleBounds","hscaleBounds","scaleCanvasCoordinates","worldDistanceOnCanvas","computeScaleBounds","horizontalReduction","verticalReduction","hReduction","vReduction","locationBounds","canvasBounds","devicePixelRatio","scaleTicks","scaleId","leftTickId","rightTickId","locationTextOffest","textCanvasCoordinates","textBoxLines","_getTextLines","drawTextBox","scaleSizeDisplayValue","scaleSizeUnits","SculptorTool","minSpacing","referencedToolNames","toolShape","referencedToolName","registeredShapes","isActive","commonData","activeAnnotationUID","isEditingOpenContour","canvasLocation","configureToolSize","selectFreehandTool","activateModify","updateCursor","endCallback","deactivateModify","activeAnnotation","filterSculptableAnnotationsForElement","calculateStats","dragCallback","sculpt","registerShapes","CircleSculptCursor","shapeName","setToolShape","shapeClass","shape","cursorShape","selectedShape","sculptData","mouseCanvasPoint","maxSpacing","getMaxSpacing","pushedHandles","pushHandles","first","insertNewHandles","interpolatePointsWithinMaxSpacing","indicesToInsertAfter","nextHandleIndex","contourIndex","currentCanvasPoint","nextCanvasPoint","updateToolSize","sculptableAnnotations","findNewHandleIndices","newIndexModifier","insertIndex","insertHandleRadially","last","previousIndex","nextIndex","handleData","getInsertPosition","closestAnnotationUID","getClosestFreehandToolOnElement","toolIndex","distanceFromTool","distancePointToContour","Default","renderShape","DIRECTIONS","VolumeRotateTool","cz","ax","ay","az","transformWorldToIndex","LengthTool","getTextLines","defaultGetTextLines","getViewReference","movingTextBox","canvasPoint1","canvasPoint2","worldPosDelta","unit","_throttledCalculateCachedStats","_calculateCachedStats","getLinkedTextBoxStyle","visibility","canvasTextBoxCoords","getTextBoxCoordsCanvas","drawLinkedTextBox","throttle","trailing","hydrate","autoGenerated","_calculateLength","pos1","pos2","dx","dy","dz","worldPos1","worldPos2","targetIds","image","index1","index2","_isInsideVolume","cachedVolumeStats","HeightTool","_calculateHeight","outside","ProbeTool","eventDispatchDetail","startsWith","getStackViewports","referencedImageURI","hasImageURI","currentImageURI","pixelUnitsOptions","isViewportPreScaled","isSuvScaled","ijk","modalityUnit","getAtIJKPoint","imageURI","calibratedResults","hasEnhancedRegionValues","units","getPixelValueUnits","DragProbeTool","postMouseDownCallback","postTouchStartCallback","EllipticalROITool","storePointData","centerPointRadius","statsCalculator","BasicStatsCalculator","initialRotation","getRotation","canvasCorners","getCanvasEllipseCorners","minorEllipse","majorEllipse","pointInMinorEllipse","_pointInEllipseCanvas","canvasWidth","canvasHeight","originalHandleCanvas","pointsCanvas","dX","dY","bottomCanvas","topCanvas","leftCanvas","rightCanvas","dYCanvas","newHalfCanvasWidth","canvasRight","dXCanvas","newHalfCanvasHeight","areaUnit","area","stdDev","centerPoint","_getCanvasEllipseCenter","pos1Index","post2Index","boundsIJK","ellipseObj","xRadius","yRadius","zRadius","worldWidth","worldHeight","getWorldWidthAndHeightFromTwoPoints","isEmptyArea","pointsInShape","statsCallback","isInObject","pointLPS","pointInEllipse","fast","returnPoints","stats","getStatistics","statsArray","array","ellipse","normalized","ellipseCanvasPoints","areaLine","CircleROITool","canvasEnd","radiusUnit","perimeter","pos2Index","aspect","radiusLine","ETDRSGridTool","degrees","diameters","diametersCanvas","diameter","worldMeasureToCanvas","degreesRad","angleRadians","degree","measurement","p1","p2","p1Canvas","p2Canvas","DEFAULT_SPLINE_CONFIG","resolution","controlPointAdditionDistance","controlPointDeletionDistance","showControlPointsConnectors","controlPointAdditionEnabled","controlPointDeletionEnabled","SplineTypesEnum","SplineToolActions","SplineROITool","ContourSegmentationBaseTool","SplineTypes","contourHoleAdditionModifierKey","decimate","epsilon","Cardinal","Class","CardinalSpline","CatmullRom","CatmullRomSpline","Linear","LinearSpline","BSpline","drawPreviewEnabled","lastControlPointDeletionKeys","AddControlPoint","Primary","DeleteControlPoint","Ctrl","fireChangeOnUpdate","isPointNearCurve","changeType","Completed","HandlesUpdated","_keyDownCallback","controlPointIndex","_deleteControlPointByIndex","_mouseMoveCallback","lastCanvasPoint","_mouseDownCallback","doubleClick","worldPoint","closeContour","addNewPoint","closestControlPoint","getClosestControlPointWithinDistance","moveAnnotation","triggerAnnotationCompleted","eventType","triggerEvent","triggerAnnotationModified","StatsUpdated","triggerChangeEvent","_renderStats","textboxStyle","addControlPointCallback","splineType","splineConfig","_getSplineConfig","closestPointInfo","getClosestPoint","addControlPointAtU","uValue","deleteControlPointCallback","originalWorldPoint","deltaXPoint","deltaYPoint","deltaInX","deltaInY","maxX","canvasMaxX","maxY","canvasMaxY","minX","canvasMinX","minY","canvasMinY","math","getAABB","topLeftBBWorld","topLeftBBIndex","bottomRightBBWorld","getArea","getMouseModifier","event","createAnnotation","cancelAnnotation","isContourSegmentationTool","renderAnnotationInstance","renderContext","annotationStyle","controlPoints","locked","annotationLocked","childAnnotations","it","childAnnotationUIDs","join","_isSplineROIAnnotation","splinePolylineCanvas","_updateSplineInstance","getPolylinePoints","updateContourPolyline","updateWindingDirection","numControlPoints","previewPolylinePoints","getPreviewPolylinePoints","controlPointsConnectors","textbox","createInterpolatedSplineControl","increment","contourAnnotation","createSpline","onInterpolationComplete","interpolation","splineConfigs","setControlPoints","fixedResolution","fixedScale","splineInstance","SplineClass","splinePolylineWorld","SplineContourSegmentationTool","LivewireContourTool","snapHandleNearby","nearestEdge","showInterpolationPolyline","undo","proximitySquared","lineSegment","distanceToPointSquared","clearAnnotation","clearEditData","worldToSlice","sliceToWorld","worldPosOriginal","currentPath","getControlPoints","closestHandlePoint","distSquared","worldControlPoint","canvasControlPoint","snapPoint","scissors","findMinNearby","pathPoints","findPathToPoint","addPoints","prependPath","confirmedPath","lastPoint","getLastPoint","addControlPoint","startSearch","updateAnnotation","imgWidth","imgHeight","slicePoint","editHandle","getCalibratedLengthUnitsAndScale","setupBaseEditData","nextPos","viewportImageData","vtkImageData","sliceImageData","sliceToIndexMatrix","indexToSliceMatrix","ijkPoint","startPos","LivewireScissors","createInstanceFromRawPixelData","scissorsNext","currentPathNext","addPoint","confirmedPathNext","numHandles","previousHandle","nextHandle","findHandlePolylineIndex","slice","slicePos","pathPointsLeft","pathPointsRight","reverse","appendPath","contourSegmentationAnnotation","canvasHandles","livewirePath","pointArray","imagePoints","LivewireContourSegmentationTool","updateInterpolatedAnnotation","interpolationSources","originalPolyline","queueMicrotask","count","repeatInterpolation","originalPoints","handleSmoothing","hIndex","testPoint","minPoint","acceptedPath","path","InterpolationUpdated","rendered","polylineCanvasPoints","ArrowAnnotateTool","getTextCallback","changeTextCallback","arrowFirst","touchTapCallback","taps","doubleClickCallback","clickedAnnotation","_doneChangingTextCallback","stopImmediatePropagation","updatedText","doneChangingTextCallback","prompt","AngleTool","angleStartedNotYetCompleted","line1","canvasPoint3","line2","worldPos3","String","fromCharCode","CobbAngleTool","showArcLines","distanceToLines","isNearFirstLine","isNearSecondLine","_mouseUpCallback","arc1Angle","arc2Angle","arc1Start","arc1End","arc2Start","arc2End","mid1","midPoint","mid2","arc1TextBoxUID","arc1TextLine","arch1TextPosCanvas","arc2TextBoxUID","arc2TextLine","arch2TextPosCanvas","point4","canvasPoint4","getArcsStartEndPoints","linkLine","arc1Side","arc2Side","midLinkLine","linkLineLength","midFirstLine","midSecondLine","directionVectorStartArc1","magnitudeStartArc1","normalizedDirectionStartArc1","directionVectorEndArc1","magnitudeEndArc1","normalizedDirectionEndArc1","directionVectorStartArc2","magnitudeStartArc2","normalizedDirectionStartArc2","directionVectorEndArc2","magnitudeEndArc2","normalizedDirectionEndArc2","seg1","seg2","minDist","MAX_VALUE","UltrasoundDirectionalTool","displayBothAxesDistances","startedDrawing","xValues","yValues","isHorizontal","isUnitless","drawHandle","canvasDeltaY","canvasDeltaX","projectedPointCanvas","imageIndex1","imageIndex2","values1","units1","values2","units2","dist1","dist2","KeyImageTool","canvasPosition","AnnotationEraserTool","_deleteNearbyAnnotations","_toolInstances","annotationsToRemove","interactableAnnotations","setAnnotationSelected","RectangleScissorsTool","strategies","FILL_INSIDE","ERASE_INSIDE","defaultStrategy","activeStrategy","activeLabelmapSegmentation","activeSegmentation","segmentIndex","segmentsLocked","segmentLocking","segmentColor","labelmapData","referencedVolumeId","segmentationImageId","bottomLeftWorld","topRightWorld","operationData","applyActiveStrategy","toolMetadata","CircleScissorsTool","strategySpecificConfiguration","SphereScissorsTool","activeSegmentationRepresentation","CircleROIStartEndThresholdTool","numSlicesToPropagate","calculatePointsInsideVolume","showTextBox","spacingInNormal","startCoord","_getStartCoordinate","endCoord","_getEndCoordinate","startCoordinate","endCoordinate","pointsInVolume","projectionPoints","statistics","labelmapUID","_computeProjectionPoints","_computePointsInsideVolume","filterAnnotationsWithinSamePlane","viewplaneNormal","tempStartCoordinate","tempEndCoordinate","_getCoordinateForViewplaneNormal","roundedStartCoordinate","roundedEndCoordinate","cameraCoordinate","roundedCameraCoordinate","middleCoordinate","isMiddleSlice","_getIndexOfCoordinatesForViewplaneNormal","lineWidthToUse","lineDashToUse","_calculateCachedStatsTool","startIJK","endIJK","handlesToStart","startWorld","indexToWorldVec3","endWorld","newProjectionPoints","newPoint","pointsInsideVolume","measureInfo","modalityUnitOptions","worldPos1Index","worldProjectionPointIndex","indexOfProjection","worldPos2Index","numSlicesToPropagateFromStart","numSlicesToPropagateToEnd","endPos","viewplaneNormalAbs","pos","PaintFillTool","getDirection","fixedDimension","getFixedDimension","floodFillGetter","getLabelValue","getScalarDataPositionFromPlane","inPlaneSeedPoint","fixedDimensionValue","generateHelpers","clickedLabelValue","floodFillResult","floodFill","flooded","scalarDataIndex","setAtIndex","framesModified","getFramesModified","triggerSegmentationDataModified","boundaries","minJ","maxJ","seedIndex3D","z","getAtIJK","generateFloodFillGetter","generateGetScalarDataPositionFromPlane","toIndex","getScalarDataPosition","xDirection","yDirection","zDirection","absoluteOfViewPlaneNormal","absoluteOfXDirection","isEqual","absoluteOfYDirection","absoluteOfZDirection","OverlayMarkerType","OrientationMarkerTool","CUBE","AXIS","VTPFILE","OVERLAY_MARKER_TYPES","orientationWidget","viewportCorner","Corners","BOTTOM_RIGHT","viewportSize","minPixelSize","maxPixelSize","overlayMarkerType","ANNOTATED_CUBE","overlayConfiguration","faceProperties","xPlus","faceColor","faceRotation","xMinus","yPlus","fontColor","yMinus","zPlus","zMinus","defaultStyle","fontStyle","fontSizeScale","res","edgeThickness","edgeColor","AXES","CUSTOM","polyDataURL","initViewports","_subscribeToViewportEvents","cleanUpData","orientationMarker","orientationMarkers","updateViewport","updatingOrientationMarker","unsubscribe","unobserve","setTimeout","offscreenMultiRenderWindow","getRenderWindow","widget","getWidget","isDeleted","addAxisActorInViewport","getRenderer","removeActor","createAnnotationCube","createCustomActor","renderer","renderWindow","interactor","getInteractor","parentRenderer","setViewportCorner","setViewportSize","setMinPixelSize","setMaxPixelSize","updateMarkerOrientation","addWidget","response","fetch","arrayBuffer","vtpReader","parseAsArrayBuffer","shallowCopy","setActiveScalars","setColorModeToDirectScalars","setMapper","rotateZ","setDefaultStyle","setXPlusFaceProperty","setXMinusFaceProperty","setYPlusFaceProperty","setYMinusFaceProperty","setZPlusFaceProperty","setZMinusFaceProperty","createAnnotatedCubeActor","axes","annotatedCube","methodName","charAt","toUpperCase","SegmentSelectTool","SelectMode","Inside","Border","hoverTimeout","searchRadius","hoverTimer","clearTimeout","_setActiveSegment","getActiveSegmentation","_setActiveSegmentForType","hoveredSegmentIndex","getSegmentIndexAtWorldPoint","getSegmentIndexAtLabelmapBorder","Contour","getHoveredContourSegmentationAnnotation","Surface","setActiveSegmentIndex","v","triggerSegmentationModified","VideoRedactionTool","toolConfiguration","active","viewportUIDsToRender","toolDataCanvasCoordinate","rect","_getRectangleImageCoordinates","rectangle","point0","viewportUID","renderingEngineUID","sceneUID","targetUIDs","targetUID","_getImageVolumeFromTargetUID","worldToIndexVec3","iMin","iMax","jMin","jMax","kMin","kMax","yMultiple","zMultiple","valueMinusMean","_getTargetVolumeUID","scene","volumeUID","volumeActors","getVolumeActors","coloneIndex","_getTargetStackUID","annotationRenderingEngine","_needsRender","_animationFrameSet","_animationFrameHandle","_renderFlaggedViewports","_throwIfDestroyed","elements","_viewportElements","_triggerRender","_render","_setViewportsToBeRenderedNextFrame","hasBeenDestroyed","_setAllViewportsToBeRenderedNextFrame","elementsEnabled","enabledTools","draw","anyRendered","ANNOTATION_RENDERED","cancelAnimationFrame","clear","FrameOfReferenceSpecificAnnotationManager","getGroupKey","annotationGroupSelector","_imageVolumeModifiedHandler","frameOfReferenceSpecificAnnotations","getFramesOfReference","groupKey","getAnnotation","frameOfReferenceAnnotations","toolSpecificAnnotations","getNumberOfAnnotations","total","preprocessingFn","groupAnnotations","toolAnnotations","removeAnnotations","removedAnnotations","annotationsForTool","saveAnnotations","structuredClone","flat","getNumberOfAllAnnotations","removeAllAnnotations","IMAGE_VOLUME_MODIFIED","setPreprocessingFn","defaultFrameOfReferenceSpecificAnnotationManager","globalLockedAnnotationUIDsSet","setAnnotationLocked","makeEventDetail","lockedAnnotationUIDsSet","added","g","lock","unlock","publish","unlockAllAnnotations","clearLockedAnnotationsSet","getAnnotationsLocked","getAnnotationsLockedCount","checkAndSetAnnotationLocked","freeze","item","ANNOTATION_LOCK_CHANGE","selectedAnnotationUIDs","selected","preserveSelected","clearSelectionSet","isSelected","selectAnnotation","deselectAnnotation","getAnnotationsSelected","getAnnotationsSelectedByToolName","isAnnotationSelected","getAnnotationsSelectedCount","selection","selectionSet","defaultManager","setAnnotationManager","resetAnnotationManager","manager","childUID","parentAnnotationUID","parentAnnotation","childUIDIndex","childAnnotation","parentUID","getParentAnnotation","childAnnotationUID","HTMLDivElement","annotationManagerUID","invalidateAnnotation","currAnnotation","checkAndSetAnnotationVisibility","globalHiddenAnnotationUIDsSet","setAnnotationVisibility","show","annotationUIDsSet","lastHidden","hide","showAllAnnotations","lastVisible","hidden","ANNOTATION_VISIBILITY_CHANGE","_initializeConfig","colorHighlighted","colorSelected","colorLocked","textBoxVisibility","textBoxFontFamily","textBoxFontSize","textBoxColor","textBoxColorHighlighted","textBoxColorSelected","textBoxColorLocked","textBoxBackground","textBoxLinkLineWidth","textBoxLinkLineDash","textBoxShadow","getAnnotationToolStyles","getViewportToolStyles","getToolGroupToolStyles","getDefaultToolStyles","default","setAnnotationStyles","styles","annotationSpecificStyles","setViewportToolStyles","viewportSpecificStyles","setToolGroupToolStyles","toolGroupSpecificStyles","setDefaultToolStyles","toolStyle","specifications","_getToolStyle","property","annotationToolStyles","viewportToolStyles","global","toolGroupToolStyles","globalStyles","toolStyles","alternatives","list","getHierarchalPropertyStyles","Selected","Locked","AutoGenerated","triggerAnnotationAddedForElement","ANNOTATION_ADDED","triggerAnnotationAddedForFOR","getToolGroupsWithToolName","viewportsToRender","triggerAnnotationRemoved","_triggerAnnotationCompleted","triggerContourAnnotationCompleted","AnnotationGroup","annotationUIDs","_isVisible","visibleFilter","unboundVisibleFilter","setVisible","baseEvent","findNearby","uids","renderers","planarContourToolName","triggerSegmentationRender","segmentationRenderingEngine","renderSegmentationsForViewport","triggerSegmentationRenderBySegmentationId","renderSegmentation","_getAllViewports","flatMap","_renderFlaggedSegmentations","_getViewportIdsForSegmentation","segmentationRepresentations","viewportRenderList","segmentationRenderList","_addPlanarFreeHandToolIfAbsent","error","segmentationDetails","status","onSegmentationRender","SEGMENTATION_RENDERED","addTool","initialDefaultState","colorLUT","segmentations","viewportSegRepresentations","internalComputeVolumeLabelmapFromStack","segmentationImageIds","volumeLoader","internalConvertStackToVolumeLabelmap","defaultSegmentationStateManager","getDefaultRenderingConfig","cfun","ofun","_stackLabelmapImageIdReferenceMap","getState","updateState","updater","newState","getColorLUT","lutIndex","getNextColorLUTIndex","updateSegmentation","payload","draftState","addSegmentation","newSegmentation","getLabelmapImageIds","removeSegmentation","filteredSegmentations","triggerSegmentationRemoved","addSegmentationRepresentation","renderingConfig","getSegmentationRepresentations","debug","setRenderInactiveSegmentations","addDefaultSegmentationRepresentation","addLabelmapRepresentation","triggerSegmentationRepresentationModified","segmentReps","segments","colorLUTIndex","_setActiveSegmentation","processLabelmapRepresentationAddition","volumeViewport","isBaseVolumeSegmentation","_updateLabelmapSegmentationReferences","labelmapImageIds","updateCallback","viewableLabelmapImageIdFound","labelmapImageId","asOverlay","stackViewport","_updateAllLabelmapSegmentationImageReferences","sliceIndex","withNavigation","getStackSegmentationImageIdsForViewport","associatedReferenceImageAndLabelmapImageIds","removeSegmentationRepresentationsInternal","specifier","removedRepresentations","currentRepresentations","activeRepresentationRemoved","shouldRemove","removeSegmentationRepresentations","triggerSegmentationRepresentationRemoved","remainingRepresentations","removeSegmentationRepresentation","suppressEvent","setActiveSegmentation","activeSegRep","segRep","viewportRepresentations","typeMatch","idMatch","getSegmentationRepresentationVisibility","viewportRepresentation","setSegmentationRepresentationVisibility","entries","segment","addColorLUT","removeColorLUT","_getStackIdForImageIds","getAllViewportSegmentationRepresentations","getSegmentationRepresentationsBySegmentationId","viewportReps","filteredReps","segmentationStyle","viewportsStyle","setStyle","currentStyles","updatedStyles","copyActiveToInactiveIfNotProvided","renderInactiveSegmentations","repConfig","perSegment","allSegments","ALL_SEGMENTATIONS_KEY","segConfig","processedStyles","labelmapStyles","renderOutlineInactive","renderOutline","outlineWidthInactive","outlineWidth","renderFillInactive","renderFill","fillAlphaInactive","fillAlpha","outlineOpacityInactive","outlineOpacity","contourStyles","outlineDashInactive","outlineDash","getDefaultStyle","allSegmentationsKey","getRenderInactiveSegmentations","clearSegmentationStyle","clearAllSegmentationStyles","clearViewportStyle","clearAllViewportStyles","resetToGlobalStyle","hasCustomStyle","indexToUse","colorLUTToUse","missingColorLUTs","getColorLUTIndex","colorLUTOrIndex","parse","segmentationInputArray","segmentationInput","representationInput","internalAddSegmentationRepresentation","addContourRepresentationToViewport","contourInputArray","addContourRepresentationToViewportMap","viewportInputMap","inputArray","addLabelmapRepresentationToViewport","labelmapInputArray","addLabelmapRepresentationToViewportMap","addSurfaceRepresentationToViewport","surfaceInputArray","addSurfaceRepresentationToViewportMap","inputData","contourData","geometryIds","annotationUIDsMap","normalizedSegments","segmentsConfig","surfaceData","geometryId","geometry","getGeometry","normalizeSurfaceSegments","normalizeSegments","addSegmentations","setColorLUT","colorLUTsIndex","segmentationRepresentation","getSegmentIndexColor","colorValue","setSegmentIndexColor","colorReference","getActiveSegmentIndex","activeSegmentIndex","getSegmentations","getViewportIdsWithSegmentation","viewportSegmentations","getViewportSegmentations","computeVolumeLabelmapFromStack","args","updateSegmentations","segmentationUpdateArray","segmentationUpdate","setSegmentIndexVisibility","getSegmentIndexVisibility","getHiddenSegmentIndices","clearSegmentValue","removeSegment","setNextSegmentAsActive","isThisSegmentActive","updatedSegments","segmentIndices","sort","currentIndex","nextSegmentIndex","previousSegmentIndex","helpers","convertStackToVolumeLabelmap","convertVolumeToStackLabelmap","computeAndAddContourRepresentation","computeAndAddLabelmapRepresentation","computeAndAddSurfaceRepresentation","computeAndAddRepresentation","surfacesObj","indices","getUniqueSegmentIndices","surface","polys","surfaceRepresentation","createAndCacheSurfacesFromRaw","all","updateSurfaceData","rawSurfacesData","rawSurfaceData","closedSurface","geometryLoader","SURFACE","geometryData","workerManager","getWebWorkerManager","triggerWorkerProgress","progress","WEB_WORKER_PROGRESS","WorkerTypes","POLYSEG_CONTOUR_TO_SURFACE","POLYSEG_LABELMAP_TO_SURFACE","computeSurfaceData","contourRepresentationData","polylines","numPointsArray","executeTask","callbacks","convertContourToSurface","computeSurfaceFromContourSegmentation","computeSurfaceFromLabelmapSegmentation","labelmapRepresentationData","getCompleteScalarDataArray","convertLabelmapToSurface","surfaces","errors","Boolean","conversionPaths","canComputeRequestedRepresentation","existingRepresentationTypes","supportedTypes","representationType","representationTypeData","validateFn","getExistingRepresentationTypes","existingRepresentationType","fromRepresentationType","toRepresentationType","canConvertFromTo","computedRepresentations","computeFunction","updateFunction","onComputationComplete","debouncedUpdateFunction","_debouncedSegmentationModified","_debouncedUpdateFunction","subscribeToSegmentationChanges","rep","removeAllSegmentations","immediate","_removeSegmentationRepresentations","labelmapDisplay","contourDisplay","removeRepresentation","surfaceDisplay","_removeRepresentationObject","removeAllSegmentationRepresentations","removeLabelmapRepresentation","removeContourRepresentation","removeSurfaceRepresentation","isSegmentIndexLocked","setSegmentIndexLocked","getLockedSegmentIndices","re","toolGroupFilteredByIds","tg","PRIMARY_BINDINGS","ToolGroup","toolOptions","currentActivePrimaryToolName","prevActivePrimaryToolName","restoreToolOptions","getViewportsInfo","toolInstanceName","getToolInstances","toolDefinition","hasToolName","localToolInstance","toolClass","ToolClass","instantiatedTool","addToolInstance","parentClassName","ToolClassToUse","ParentClass","ToolInstance","renderingEngineUIDToUse","_findRenderingEngine","vpId","getActivePrimaryMouseButtonTool","Settings","getRuntimeSettings","setViewportsCursorByToolName","vpInfo","TOOLGROUP_VIEWPORT_REMOVED","setActiveStrategy","strategyName","setToolMode","binding","TouchBinding","numTouchPoints","MouseBinding","obj","hasSameBinding","useCursor","_hasMousePrimaryButtonBinding","_setCursorForViewports","_renderViewports","TOOL_ACTIVATED","_triggerToolModeChangedEvent","prevToolOptions","matchBindings","removeAllBindings","getDefaultPrimaryBindings","matchBinding","toolOptionsForTool","_getCursor","setToolConfiguration","overwrite","_configuration","getDefaultMousePrimary","getToolConfiguration","configurationPath","getPrevActivePrimaryToolName","setActivePrimaryTool","activeToolName","getCurrentActivePrimaryToolName","newToolGroupId","fnToolFilter","sourceToolInstance","sourceToolOptions","sourceToolMode","primaryBindings","primary","renderingEngines","matchingEngines","engine","binding1","binding2","toolGroupIndex","MODES","toolGroupToolNames","hasToolByName","removeTool","defaultState","isMultiPartToolActive","resetCornerstoneToolsState","resetSvgNodeCache","BidirectionalTool","firstLineSegmentLength","longAxis","shortAxisPoint0","shortAxisPoint1","longAxisVector","counterClockWisePerpendicularToLongAxis","currentShortAxisVector","shortAxis","canvasCoordPoints","shortAxisDistFromCenter","vectorX","vectorY","xMid","yMid","startX","startY","endX","endY","_dragModifyHandle","movingHandleIndex","canvasCoordHandlesCurrent","firstLineSegment","secondLineSegment","proposedPoint","proposedCanvasCoord","fixedHandleCanvasCoord","fixedHandleToProposedCoordVec","fixedHandleToOldCoordVec","proposedFirstLineSegment","_movingLongAxisWouldPutItThroughShortAxis","centerOfRotation","_getSignedAngle","firstPointX","firstPointY","secondPointX","secondPointY","rotatedFirstPoint","rotatedFirstPointY","rotatedSecondPoint","rotatedSecondPointY","newFirstPoint","newSecondPoint","translateHandleIndex","canvasCoordsCurrent","longLineSegment","shortLineSegment","longLineSegmentVec","longLineSegmentVecNormalized","proposedToCurrentVec","movementLength","movementAlongLineSegmentLength","newTranslatedPoint","dataId1","dataId2","secondLineUID","vectorInSecondLineDirection","extendedSecondLineSegment","worldPos4","index3","index4","handles1","handles2","scale1","scale2","widthUnit","vector1","vector2","PlanarFreehandContourSegmentationTool","allowOpenContours","renderResult","pointCanProjectOnLine","PlanarFreehandROITool","alwaysRenderOpenContourHandles","closeContourProximity","checkCanvasEditFallbackProximity","makeClockWise","subPixelResolution","smoothing","smoothOnAdd","smoothOnEdit","knotsRatioPercentageOnAdd","knotsRatioPercentageOnEdit","displayOnePointAsCrosshairs","isEditingClosed","isEditingOpen","activateDraw","activateOpenContourEndEdit","activateClosedContourEdit","activateOpenContourEdit","previousPoint","pStart","pEnd","cancelDrawing","cancelOpenContourEdit","cancelClosedContourEdit","calibratedScale","updateClosedCachedStats","updateOpenCachedStats","annotationsToDisplay","spacingInNormalDirection","filterAnnotationsWithinSlice","filterAnnotationsForDisplay","annotationsWithParallelNormals","td","annotationViewPlaneNormal","halfSpacingInNormalDirection","annotationsWithinSlice","dir","renderContourBeingDrawn","renderClosedContourBeingEdited","renderOpenContourBeingEdited","renderPointContourWithMarker","renderContour","_calculateStatsIfActive","worldPosIndex","worldPosIndex2","iDelta","jDelta","kDelta","ceil","worldPosEnd","canvasPosEnd","curRow","intersections","intersectionCounter","_pointIJK","getLineSegmentIntersectionsCoordinates","shift","getPixelValueUnitunit","isFinite","RectangleROITool","arguments","frameOfReference","BaseTool","initialProps","strategyOptions","call","applyActiveStrategyCallback","callbackType","setConfiguration","newConfiguration","getViewReferenceId","polySegConversionInProgress","contourRepresentation","renderImmediate","MAX_NUMBER_COLORS","labelMapConfigCache","_getLabelmapConfig","labelmapConfig","isActiveLabelmap","segmentsLabelmapConfig","configToUse","activeSegmentOutlineWidthDelta","_needsTransferFunctionUpdate","segmentsHidden","cacheUID","oldConfig","cfunMTime","getMTime","ofunMTime","forceOpacityUpdate","forceColorUpdate","oldFillAlpha","oldRenderFill","oldRenderOutline","oldOutlineWidth","oldSegmentColor","oldSegmentsHidden","oldCfunMTime","oldOfunMTime","_addLabelmapToViewport","labelmapActorEntry","labelmapStyle","numColors","segmentSpecificLabelmapConfig","addRGBPoint","segmentOpacity","removePoint","addPointLong","labelmapActor","setRGBTransferFunction","setClamping","setScalarOpacity","setInterpolationTypeToNearest","setUseLabelOutline","setLabelOutlineOpacity","outlineWidths","setLabelOutlineThickness","setVisibility","_setLabelmapColorAndOpacity","ViewportType","SurfaceData","BrushTool","FILL_INSIDE_CIRCLE","ERASE_INSIDE_CIRCLE","FILL_INSIDE_SPHERE","ERASE_INSIDE_SPHERE","THRESHOLD_INSIDE_CIRCLE","THRESHOLD_INSIDE_SPHERE","THRESHOLD","threshold","thresholdVolumeId","brushSize","preview","previewColors","previewTimeMs","previewMoveDistance","dragMoveDistance","dragTimeMs","AcceptPreview","RejectPreview","_previewData","timerStart","timer","NaN","isDrag","_editData","createEditData","now","hoverData","_hoverData","createHoverData","getOperationData","OnInteractionStart","rejectPreview","previewCallback","Preview","OnInteractionEnd","acceptPreview","CustomEvent","ERROR_EVENT","message","cancelable","dispatchEvent","volumes","referencedVolumeIdToThreshold","referencedImageIds","override","getActiveSegmentationData","brushCursor","activeRepresentation","_calculateCursor","viewRight","centerCursorInWorld","bottomCursorInWorld","topCursorInWorld","leftCursorInWorld","rightCursorInWorld","strategy","computeInnerCircleRadius","invalidateBrushCursor","brushCursorUID","dynamicRadiusInCanvas","circleUID1","RectangleROIStartEndThresholdTool","computePointsInsideVolume","projectionPointsImageIds","roundedStartCoord","roundedEndCoord","coord","roundedCoord","firstOrLastSlice","habdles","projectionPoint","RectangleROIThresholdTool","ContourWindingDirection","getViewportsForAnnotation","getEnabledElements","roundNumber","sourcePoints","minDistance","MAX_SAFE_INTEGER","sourcePoint","_distanceBetween","cachedResult","keySet","addImageSegmentIndices","addVolumeSegmentIndices","handleLabelmapSegmentation","handleContourSegmentation","handleSurfaceSegmentation","equalsCheck","getVoxelOverlap","voxelSpacing","voxelCenter","halfSpacingX","halfSpacingY","halfSpacingZ","voxelCornersIJK","offsets","xOff","yOff","zOff","processVolumes","thresholdVolumeInformation","segmentationSpacing","scalarDataLength","getScalarDataLength","volumeInfoList","baseVolumeIdx","volumeSize","segmentIndicesCache","setSegmentationDirty","cached","isDirty","getCachedSegmentIndices","setCachedSegmentIndices","_extends","_react","_react2","__esModule","exports","_ref","_ref$fill","_ref$width","_ref$height","_ref$style","props","_objectWithoutProperties","_typeof","iterator","_defineProperties","enumerable","configurable","writable","arg","hint","prim","toPrimitive","TypeError","_toPrimitive","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","iter","_iterableToArray","o","minLen","n","test","_unsupportedIterableToArray","_nonIterableSpread","arr2","stringToUint8Array","str","charCodeAt","containsToken","token","findToken","maxSearchLength","searchLength","multipartEncode","datasets","boundary","s4","random","guid","contentTypeString","header","footer","headerArray","footerArray","headerLength","footerLength","contentArrays","datasetBuffer","contentArray","contentLength","multipartArray","multipartDecode","ArrayBuffer","isView","separator","headerIndex","itemLimit","uint8ArrayToString","boundaryString","parts","substr","identifyBoundary","boundaryIndex","boundaryLength","components","headerTokenIndex","isObject","isEmptyObject","getFirstResult","MEDIATYPES","DICOM","DICOM_JSON","OCTET_STREAM","PDF","JPEG","PNG","debugLog","api","DICOMwebClient","Constructor","_classCallCheck","baseURL","username","password","qidoURLPrefix","qidoURL","wadoURLPrefix","wadoURL","stowURLPrefix","stowURL","singlepart","requestHooks","headers","errorInterceptor","verbose","setDebug","protoProps","staticProps","debugLevel","debugLogFunction","_this","reject","request","XMLHttpRequest","open","responseType","setRequestHeader","functions","userHeaders","onloadstart","onloadend","onreadystatechange","readyState","contentType","getResponseHeader","progressCallback","onprogress","isValid","requestHook","areValidRequestHooks","combinedHeaders","pipedRequest","withCredentials","send","_httpRequest","params","urlWithQueryParams","_parseQueryParameters","Accept","_httpGet","mediaTypes","_buildAcceptHeaderFieldValue","byteRange","supportedMediaTypes","Range","_buildRangeHeaderFieldValue","_buildMultipartAcceptHeaderFieldValue","defaultMediaType","acceptableMediaTypes","mediaType","_httpPost","queryParams","_httpGetApplicationJson","studyInstanceUID","seriesInstanceUID","transferSyntax","sopInstanceUID","paramString","frameNumbers","_httpGetMultipartApplicationOctetStream","_getSharedMediaTypes","commonMediaType","_getCommonMediaType","_httpGetMultipartImage","_httpGetMultipartVideo","_httpGetImage","_httpGetVideo","_httpGetText","_httpGetApplicationPdf","_options$withCredenti","_options$progressCall","_httpGetMultipartApplicationDicom","_options$withCredenti2","_options$progressCall2","BulkDataURI","_options$withCredenti3","_options$progressCall3","_multipartEncode","_options$withCredenti4","queryString","encodeURIComponent","sepIndex","mediaTypeType","_assertMediaTypeIsValid","_this2","fieldValueParts","transferSyntaxUID","fieldValue","endsWith","expectedMediaTypes","actualType","_parseMediaType","expectedMediaType","expectedType","types","sharedMediaTypes","HASH_UNDEFINED","INFINITY","funcTag","genTag","symbolTag","reIsDeepProp","reIsPlainProp","reLeadingDot","rePropName","reEscapeChar","reIsHostCtor","freeGlobal","freeSelf","self","root","Function","arrayProto","funcProto","objectProto","coreJsData","maskSrcKey","exec","IE_PROTO","funcToString","objectToString","reIsNative","RegExp","getNative","nativeCreate","symbolProto","symbolToString","Hash","entry","ListCache","MapCache","assocIndexOf","other","baseGet","object","isSymbol","isKey","stringToPath","toKey","baseIsNative","func","pattern","tag","isFunction","isHostObject","toSource","getMapData","__data__","getValue","memoize","string","baseToString","number","quote","resolver","memoized","apply","Cache","isObjectLike","module","defaultValue","DataView","hashClear","hashDelete","hashGet","hashHas","hashSet","listCacheClear","listCacheDelete","listCacheGet","listCacheHas","listCacheSet","mapCacheClear","mapCacheDelete","mapCacheGet","mapCacheHas","mapCacheSet","setCacheAdd","setCacheHas","SetCache","stackClear","stackDelete","stackGet","stackHas","stackSet","Stack","iteratee","predicate","resIndex","baseTimes","isArguments","isBuffer","isIndex","isTypedArray","inherited","isArr","isArg","isBuff","isType","skipIndexes","baseAssignValue","eq","objValue","copyObject","keysIn","arrayEach","assignValue","baseAssign","baseAssignIn","cloneBuffer","copyArray","copySymbols","copySymbolsIn","getAllKeys","getAllKeysIn","getTag","initCloneArray","initCloneByTag","initCloneObject","isMap","isSet","argsTag","objectTag","cloneableTags","baseClone","bitmask","customizer","stack","isDeep","isFlat","isFull","isFunc","stacked","subValue","objectCreate","baseCreate","proto","baseForOwn","baseEach","createBaseEach","baseFor","createBaseFor","castPath","arrayPush","keysFunc","symbolsFunc","baseGetTag","baseIsEqualDeep","baseIsEqual","equalArrays","equalByTag","equalObjects","arrayTag","equalFunc","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","matchData","noCustomizer","srcValue","COMPARE_PARTIAL_FLAG","isMasked","isLength","typedArrayTags","baseMatches","baseMatchesProperty","identity","isPrototype","nativeKeys","nativeKeysIn","isProto","isArrayLike","collection","baseIsMatch","getMatchData","matchesStrictComparable","hasIn","isStrictComparable","arrayMap","byteLength","freeExports","nodeType","freeModule","Buffer","allocUnsafe","copy","cloneArrayBuffer","dataView","byteOffset","reFlags","regexp","lastIndex","symbolValueOf","valueOf","typedArray","isNew","getSymbols","getSymbolsIn","eachFunc","fromRight","iterable","arraySome","cacheHas","isPartial","arrLength","othLength","arrStacked","othStacked","seen","arrValue","othValue","compared","othIndex","mapToArray","setToArray","convert","objProps","objLength","objStacked","skipCtor","objCtor","othCtor","baseGetAllKeys","isKeyable","getPrototype","overArg","getPrototypeOf","arrayFilter","stubArray","propertyIsEnumerable","nativeGetSymbols","getOwnPropertySymbols","mapTag","promiseTag","setTag","weakMapTag","dataViewTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","Ctor","ctorString","hasFunc","cloneDataView","cloneRegExp","cloneSymbol","cloneTypedArray","reIsUint","freeProcess","process","nodeUtil","require","pairs","LARGE_ARRAY_SIZE","memoizeCapped","subString","CLONE_DEEP_FLAG","castFunction","baseHasIn","hasPath","baseIsArguments","stubFalse","baseIsMap","baseUnary","nodeIsMap","objectCtorString","baseIsSet","nodeIsSet","baseIsTypedArray","nodeIsTypedArray","arrayLikeKeys","baseKeys","baseKeysIn","baseIteratee","baseMap","baseProperty","basePropertyDeep","checkboardCache","serverCanvas","checkboard","ctx","getContext","fillStyle","fillRect","toDataURL","Checkboard","white","grey","boxShadow","grid","absolute","isValidElement","defaultProps","_createClass","defineProperties","_possibleConstructorReturn","ReferenceError","Alpha","_ref2","_temp","_len","_key","__proto__","handleChange","change","hsl","initialA","container","containerWidth","containerHeight","pageX","touches","pageY","getBoundingClientRect","pageXOffset","pageYOffset","l","_a","onChange","handleMouseDown","handleMouseUp","unbindEventListeners","subClass","superClass","setPrototypeOf","_inherits","rgb","alpha","gradient","margin","slider","marginTop","vertical","ref","onMouseDown","onTouchMove","onTouchStart","PureComponent","Component","VALID_KEY_CODES","idCounter","EditableInput","handleBlur","blurValue","setState","setUpdatedValue","handleKeyDown","getNumberValue","getArrowOffset","updatedValue","handleDrag","dragLabel","movementX","dragMax","getValueObjectWithLabel","inputId","prevProps","prevState","activeElement","_defineProperty","arrowOffset","onChangeValue","wrap","onKeyDown","onBlur","placeholder","spellCheck","hideLabel","htmlFor","Hue","_h","_props$direction","hue","className","nativeObjectToString","symToStringTag","toStringTag","isOwn","unmasked","srcIndex","mergeFunc","isCommon","isTyped","baseMerge","thisArg","nativeMax","otherArgs","nativeNow","lastCalled","stamp","remaining","assigner","sources","guard","Raised","zDepth","_ref$styles","passedStyles","content","bg","propTypes","reWhitespace","reTrimStart","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","isBinary","nativeMin","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","invokeFunc","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","flush","Saturation","_container$getBoundin","saturation","bright","getContainerRenderWindow","contains","parent","black","circle","hsv","trimLeft","trimRight","tinycolor","opts","ok","named","names","matchers","rgba","hsla","hsva","hex8","parseIntFromHex","convertHexToDecimal","hex6","hex4","hex3","stringInputToObject","isValidCSSUnit","bound01","convertToPercentage","f","q","hsvToRgb","hue2rgb","hslToRgb","boundAlpha","inputToRGB","_originalInput","_r","_g","_b","_roundA","_format","_gradientType","gradientType","_ok","rgbToHsl","rgbToHsv","rgbToHex","allow3Char","hex","pad2","rgbaToArgbHex","convertDecimalToHex","_desaturate","amount","toHsl","clamp01","_saturate","_greyscale","desaturate","_lighten","_brighten","toRgb","_darken","_spin","_complement","polyad","step","_splitcomplement","_analogous","slices","part","ret","_monochromatic","toHsv","modification","isDark","getBrightness","isLight","getOriginalInput","getFormat","getAlpha","getLuminance","RsRGB","GsRGB","BsRGB","setAlpha","toHsvString","toHslString","toHex","toHexString","toHex8","allow4Char","rgbaToHex","toHex8String","toRgbString","toPercentageRgb","toPercentageRgbString","toName","hexNames","toFilter","secondColor","hex8String","secondHex8String","formatSet","formattedString","hasAlpha","_applyModification","lighten","brighten","darken","saturate","greyscale","spin","_applyCombination","analogous","complement","monochromatic","splitcomplement","triad","tetrad","fromRatio","newColor","equals","color1","color2","mix","rgb1","rgb2","readability","isReadable","wcag2","wcag2Parms","out","parms","level","validateWCAG2Parms","mostReadable","baseColor","colorList","includeFallbackColors","bestColor","bestScore","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","burntsienna","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellow","yellowgreen","flipped","flip","isOnePointZero","processPercent","isPercentage","CSS_UNIT","PERMISSIVE_MATCH3","PERMISSIVE_MATCH4","simpleCheckForValidColor","checked","passed","letter","toState","oldHue","isValidHex","lh","getContrastingColor","col","isvalidColorString","Picker","ColorPicker","colors","onChangeComplete","handleSwatchHover","onSwatchHover","optionalEvents","nextProps","Span","_React$Component","Focus","handleFocus","onFocus","_ref$onClick","onClick","onHover","_ref$title","_ref$focusStyle","focusStyle","transparent","swatch","outline","onMouseOver","tabIndex","picker","backgroundColor","AlphaPicker","_ref$className","swatches","marginRight","float","marginBottom","Block","triangle","hexCode","card","head","alignItems","justifyContent","body","borderStyle","borderWidth","borderColor","marginLeft","border","deepPurple","lightBlue","lightGreen","amber","deepOrange","blueGrey","CircleSwatch","hover","circleSize","circleSpacing","transition","Swatch","Circle","flexWrap","ChromeFields","toggleViews","view","showHighlight","hideHighlight","paddingTop","fields","flex","field","paddingLeft","toggle","textAlign","icon","iconHighlight","textTransform","lineHeight","svg","UnfoldMoreHorizontalIcon","onMouseEnter","onMouseOut","Chrome","disableAlpha","defaultView","paddingBottom","controls","zIndex","toggles","paddingRight","HEXwrap","HEXinput","HEXlabel","RGBwrap","RGBinput","RGBlabel","Compact","compact","hoverSwatch","Github","borderBottomColor","triangleShadow","HuePicker","HuePointer","material","borderBottom","Hex","third","divider","fieldSymbols","triangleBorder","Extend","leftInside","rightInside","button","backgroundImage","currentColor","new","current","Photoshop","_props","_props$styles","_props$className","previews","PhotoshopPointer","onAccept","onCancel","PhotoshopFields","single","double","SketchPresetColors","borderTop","swatchWrap","handleClick","colorObjOrString","isRequired","Sketch","presetColors","sliders","activeColor","Slider","check","CheckIcon","Swatches","overflowY","Twitter","hash","hexcode","GooglePointerCircle","GooglePointer","_values","_values2","hsvValue","column","input2","label2","flexGrow","rgbValue","hslValue","Google","performance","cancelTimeout","timeoutID","requestTimeout","delay","tick","getScrollbarSize","recalculate","div","cachedRTLResult","getRTLOffsetType","outerDiv","outerStyle","innerDiv","innerStyle","scrollLeft","defaultItemKey$1","createListComponent","_class","getItemOffset","getEstimatedTotalSize","getItemSize","getOffsetForIndexAndAlignment","getStartIndexForOffset","getStopIndexForStartIndex","initInstanceProps","shouldResetStyleCacheOnItemSizeChange","validateProps","_PureComponent","List","_instanceProps","_outerRef","_resetIsScrollingTimeoutId","isScrolling","scrollDirection","scrollOffset","initialScrollOffset","scrollUpdateWasRequested","_callOnItemsRendered","overscanStartIndex","overscanStopIndex","visibleStartIndex","visibleStopIndex","onItemsRendered","_callOnScroll","onScroll","_getItemStyle","_this$props","itemSize","layout","itemStyleCache","_getItemStyleCache","_offset","isRtl","offsetHorizontal","__","___","_onScrollHorizontal","_event$currentTarget","scrollWidth","_resetIsScrollingDebounced","_onScrollVertical","_event$currentTarget2","scrollHeight","scrollTop","_outerRefSetter","outerRef","_resetIsScrolling","getDerivedStateFromProps","validateSharedProps$1","_proto","scrollTo","scrollToItem","align","_this$props2","itemCount","scrollbarSize","componentDidMount","_this$props3","_callPropsCallbacks","componentDidUpdate","_this$props4","_this$state","componentWillUnmount","_this$props5","innerRef","innerElementType","innerTagName","itemData","_this$props5$itemKey","itemKey","outerElementType","outerTagName","useIsScrolling","_this$_getRangeToRend","_getRangeToRender","startIndex","stopIndex","items","_index","estimatedTotalSize","WebkitOverflowScrolling","willChange","_this$_getRangeToRend2","_overscanStartIndex","_overscanStopIndex","_visibleStartIndex","_visibleStopIndex","_this$state2","_scrollDirection","_scrollOffset","_scrollUpdateWasRequested","_this$props6","overscanCount","_this$state3","overscanBackward","overscanForward","_ref3","getItemMetadata$1","instanceProps","itemMetadataMap","lastMeasuredIndex","itemMetadata","findNearestItemBinarySearch$1","high","low","middle","currentOffset","findNearestItemExponentialSearch$1","interval","estimatedItemSize","totalSizeOfMeasuredItems","VariableSizeList","maxOffset","minOffset","findNearestItem$1","resetAfterIndex","shouldForceUpdate","forceUpdate","_ref5","autoprefix","_forOwn2","_forOwn3","transforms","msBorderRadius","MozBorderRadius","OBorderRadius","WebkitBorderRadius","msBoxShadow","MozBoxShadow","OBoxShadow","WebkitBoxShadow","userSelect","WebkitTouchCallout","KhtmlUserSelect","MozUserSelect","msUserSelect","WebkitUserSelect","WebkitBoxFlex","MozBoxFlex","WebkitFlex","msFlex","flexBasis","WebkitFlexBasis","WebkitJustifyContent","msTransition","MozTransition","OTransition","WebkitTransition","msTransform","MozTransform","OTransform","WebkitTransform","otherElementStyles","otherStyle","prefixed","expanded","onMouseUp","Hover","handleMouseOver","handleMouseOut","flattenNames","_isString3","_interopRequireDefault","_isPlainObject3","_map3","things","thing","_flattenNames2","_mergeClasses2","_autoprefix2","_hover3","_active2","_loop3","ReactCSS","classes","activations","activeNames","merged","setProp","mergeClasses","_cloneDeep3","toMerge","is","useState","useEffect","useLayoutEffect","useDebugValue","getSnapshot","inst","useSyncExternalStore","useRef","useMemo","useSyncExternalStoreWithSelector","hasValue","createStoreImpl","createState","listeners","partial","nextState","previousState","listener","getInitialState","initialState","subscribe","createStore","didWarnAboutEqualityFn","createImpl","useBoundStore","selector","equalityFn","getServerState","useStore","trackedConnections","getTrackedConnectionState","fromEntries","stores","api2","devtools","devtoolsOptions","anonymousActionType","store","extensionConnector","__REDUX_DEVTOOLS_EXTENSION__","_e","connection","connectionInformation","connect","existingConnection","newConnection","extractConnectionInformation","isRecording","nameOrAction","action","setStateFromDevtools","originalIsRecording","store2","dispatchFromDevtools","dispatch","didWarnAboutReservedActionType","originalDispatch","parseJsonThen","stateFromDevtools","nextLiftedState","lastComputedState","computedStates","stringified","parsed"],"sourceRoot":""}